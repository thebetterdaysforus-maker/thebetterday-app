{"file_contents":{"App.tsx":{"content":"import { NavigationContainer } from '@react-navigation/native';\nimport { StatusBar } from 'expo-status-bar';\nimport React, { useEffect, useState, useRef } from 'react';\nimport { View, Text, StyleSheet } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport * as Notifications from 'expo-notifications';\nimport { supabase } from './src/supabaseClient';\nimport useUserStore from './src/store/userStore';\nimport useProfileStore from './src/store/profileStore';\nimport { useAuthStore } from './src/store/authStore';\nimport useGoalStore from './src/store/goalStore';\nimport { getCurrentTimeZone } from './src/utils/timeUtils';\n\n// ì¤‘ë³µ íŒŒì¼ë“¤ ì œê±° ì™„ë£Œ - í•µì‹¬ ì•Œë¦¼ ì‹œìŠ¤í…œë§Œ ìœ ì§€\nimport AuthStack from './src/stacks/AuthStack';\nimport MainTab from './src/stacks/MainTab';\nimport ProfileSetupScreen from './src/screens/ProfileSetupScreen';\n// ìŠ¤í”Œë˜ì‹œ ìŠ¤í¬ë¦° ë¹„í™œì„±í™”\n// import SplashScreen from './src/components/SplashScreen';\n// import LottieSplashScreen from './src/components/LottieSplashScreen';\n\nexport default function App() {\n  const { session, setSession } = useUserStore();\n  const { profile, fetchProfile } = useProfileStore();\n  const { performAutoLogin, enableAutoLogin } = useAuthStore();\n  const goalStoreState = useGoalStore();\n  const [loading, setLoading] = useState(true);\n  const navigationRef = useRef<any>(null);\n\n  // ì „ì—­ í•¨ìˆ˜ ë“±ë¡ (ê°œë°œ í™˜ê²½ì—ì„œë§Œ)\n  useEffect(() => {\n    if (__DEV__) {\n      // ê°œë°œ í™˜ê²½ì—ì„œë§Œ ì „ì—­ í•¨ìˆ˜ ë“±ë¡\n      (window as any).goalStore = goalStoreState;\n      \n      // ì•Œë¦¼ í™•ì¸ í•¨ìˆ˜ ì „ì—­ ë“±ë¡ - ì›¹/ëª¨ë°”ì¼ ëª¨ë‘ ì§€ì›\n      (window as any).checkNotifications = async () => {\n        console.log('ğŸ” í˜„ì¬ ì˜ˆì•½ëœ ì•Œë¦¼ í™•ì¸ ì‹œì‘');\n        \n        try {\n          // dynamic import ì œê±°í•˜ê³  ì¼ë°˜ import ì‚¬ìš©\n          console.log('ğŸ” ì•Œë¦¼ í™•ì¸ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');\n        } catch (error) {\n          console.error('âŒ ì•Œë¦¼ í™•ì¸ ì‹¤íŒ¨:', error);\n        }\n      };\n      \n      // ëª¨ë“  ì•Œë¦¼ ì‚­ì œ í•¨ìˆ˜\n      (window as any).clearAllNotifications = async () => {\n        console.log('ğŸ§¹ ëª¨ë“  ì•Œë¦¼ ì‚­ì œ ì‹œì‘');\n        \n        try {\n          // dynamic import ì œê±°í•˜ê³  ì¼ë°˜ import ì‚¬ìš©\n          console.log('ğŸ§¹ ì•Œë¦¼ ì‚­ì œ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');\n        } catch (error) {\n          console.error('âŒ ì•Œë¦¼ ì‚­ì œ ì‹¤íŒ¨:', error);\n        }\n      };\n      \n      console.log('ğŸ”§ ë””ë²„ê¹…ìš© í•¨ìˆ˜ ë“±ë¡ ì™„ë£Œ');\n      console.log('ğŸ’¡ ì‚¬ìš© ê°€ëŠ¥í•œ í•¨ìˆ˜:');\n      console.log('  - checkNotifications() : ì˜ˆì•½ëœ ì•Œë¦¼ í™•ì¸');\n      console.log('  - clearAllNotifications() : ëª¨ë“  ì•Œë¦¼ ì‚­ì œ');\n    }\n  }, [goalStoreState]);\n\n  // ğŸš« ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ì „ ë¹„í™œì„±í™” - ì‚¬ìš©ì ìš”ì²­\n  // ì•Œë¦¼ í´ë¦­ ì²˜ë¦¬ ì‹œìŠ¤í…œ ì˜êµ¬ ë¹„í™œì„±í™”ë¨\n\n  useEffect(() => {\n    const initializeAuth = async () => {\n      try {\n        console.log('ğŸ” ìë™ ë¡œê·¸ì¸ ì‹œë„ ì‹œì‘...');\n        \n        // ì•Œë¦¼ ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™ - ëª©í‘œ ì•Œë¦¼ê³¼ íšŒê³  ì•Œë¦¼ í™œì„±í™”\n        console.log(\"ğŸ”” ì•Œë¦¼ ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™ ì¤‘\");\n        \n        // ì‹œê°„ëŒ€ ì„¤ì • ì´ˆê¸°í™”\n        await getCurrentTimeZone();\n        \n        // ì„¸ì…˜ í™•ì¸ ë° ìë™ ë¡œê·¸ì¸ ì‹œë„\n        const { data: { session } } = await supabase.auth.getSession();\n        console.log('ğŸ” í˜„ì¬ ì„¸ì…˜ ìƒíƒœ:', session ? 'ìˆìŒ' : 'ì—†ìŒ');\n        \n        if (session) {\n          // ê¸°ì¡´ ì„¸ì…˜ì´ ìˆìœ¼ë©´ ìë™ ë¡œê·¸ì¸ í™œì„±í™”\n          console.log('âœ… ê¸°ì¡´ ì„¸ì…˜ ë°œê²¬ - ìë™ ë¡œê·¸ì¸ í™œì„±í™”');\n          await enableAutoLogin();\n          setSession(session);\n          \n          // ë¡œê·¸ì¸ í›„ ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ë³´ì • ì‹¤í–‰\n          console.log('ğŸ” ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ë³´ì • ì²´í¬ ì‹œì‘...');\n          console.log('âœ… ìë™ ë¡œê·¸ì¸ ì„±ê³µ');\n        } else {\n          // ì„¸ì…˜ì´ ì—†ìœ¼ë©´ ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ\n          console.log('ğŸ”„ ê¸°ì¡´ ì„¸ì…˜ ì—†ìŒ - ë¡œê·¸ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™');\n          console.log('ğŸ’¡ Expo Go í™˜ê²½ì—ì„œëŠ” ë§¤ë²ˆ ë¡œê·¸ì¸ì´ ì •ìƒì…ë‹ˆë‹¤');\n        }\n      } catch (error) {\n        console.error('âŒ ì¸ì¦ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    // ì¦‰ì‹œ ì¸ì¦ ì´ˆê¸°í™”\n    initializeAuth();\n\n    // Listen for auth changes\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(async (_event, session) => {\n      setSession(session);\n      \n      // ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ìë™ ë¡œê·¸ì¸ í™œì„±í™”\n      if (session) {\n        await enableAutoLogin();\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, [setSession, performAutoLogin, enableAutoLogin]);\n\n  useEffect(() => {\n    if (session) {\n      fetchProfile().catch(console.error);\n    }\n  }, [session, fetchProfile]);\n\n  // ìŠ¤í”Œë˜ì‹œ ìŠ¤í¬ë¦° ë¹„í™œì„±í™”ë¨\n\n  if (loading) {\n    return (\n      <View style={styles.loadingContainer}>\n        <Text style={styles.loadingText}>ğŸŒŸ The Better Day</Text>\n        <Text style={styles.loadingSubtext}>ë¡œë”© ì¤‘...</Text>\n      </View>\n    );\n  }\n\n  console.log('ğŸ” App.tsx ë Œë”ë§ ìƒíƒœ:', {\n    session: session ? 'ìˆìŒ' : 'ì—†ìŒ',\n    profile: profile ? 'ìˆìŒ' : 'ì—†ìŒ',\n    isAnonymous: session?.user?.is_anonymous || false,\n    userId: session?.user?.id?.slice(0, 8) || 'N/A'\n  });\n\n  return (\n    <NavigationContainer ref={navigationRef}>\n      <StatusBar style=\"auto\" />\n      \n      {!session ? (\n        <AuthStack />\n      ) : !profile ? (\n        <AuthStack />\n      ) : (\n        <MainTab />\n      )}\n    </NavigationContainer>\n  );\n}\n\nconst styles = StyleSheet.create({\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#f8f9fa',\n  },\n  loadingText: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#667eea',\n    marginBottom: 8,\n  },\n  loadingSubtext: {\n    fontSize: 16,\n    color: '#666',\n  },\n});","size_bytes":6066},"MVP_ì‚¬ìš©ë²•.md":{"content":"# The Better Day MVP ì‚¬ìš©ë²•\n\n## ğŸ¯ MVP ì™„ì„± ê¸°ëŠ¥ë“¤\n\n### 1. í•µì‹¬ ëª©í‘œ ê´€ë¦¬ ì‹œìŠ¤í…œ\n- **ëª©í‘œ ì„¤ì •**: 30ë¶„ ë‹¨ìœ„ë¡œ ì‹œê°„ ì„ íƒ ê°€ëŠ¥\n- **ëª©í‘œ ì™„ë£Œ ì²´í¬**: Â±5ë¶„ ë²”ìœ„ ë‚´ì—ì„œë§Œ ì²´í¬ ê°€ëŠ¥\n- **ìë™ ìƒíƒœ ì „í™˜**: 5ë¶„ ì´ˆê³¼ ì‹œ ìë™ìœ¼ë¡œ ì‹¤íŒ¨ ì²˜ë¦¬\n- **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**: 30ì´ˆë§ˆë‹¤ ìë™ìœ¼ë¡œ ìƒíƒœ ì²´í¬\n\n### 2. ìŠ¤ë§ˆíŠ¸ í¸ì§‘ ì œí•œ\n- **ì‹œê°„ ì œí•œ**: ëª©í‘œ ì‹œê°„ 4ì‹œê°„ ì „ê¹Œì§€ë§Œ í¸ì§‘ ê°€ëŠ¥\n- **íšŒê³  ì ê¸ˆ**: íšŒê³  ì‘ì„± ì™„ë£Œ í›„ í•´ë‹¹ ë‚ ì§œ ëª©í‘œ í¸ì§‘ ë¶ˆê°€\n\n### 3. ê°œì„ ëœ UI/UX\n- **ìŠ¹ë¦¬/íŒ¨ë°° í‘œì‹œ**: ëª…í™•í•œ ìƒíƒœ í‘œì‹œ (ğŸ† ìŠ¹ë¦¬, ğŸ˜ íŒ¨ë°°)\n- **ì‹¤ì‹œê°„ í†µê³„**: í—¤ë”ì— ìŠ¹ë¦¬/íŒ¨ë°° ì¹´ìš´íŠ¸ í‘œì‹œ\n- **ë™ê¸°ë¶€ì—¬ ë©”ì‹œì§€**: íšŒê³  ì‘ì„± ì‹œ ì„±ì·¨ë„ì— ë”°ë¥¸ ë§ì¶¤ ë©”ì‹œì§€\n\n### 4. ì™„ì „í•œ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ\n- **MVP_DATABASE_SETUP.sql**: ëª¨ë“  í…Œì´ë¸”ê³¼ ì •ì±… í¬í•¨\n- **RLS ë³´ì•ˆ**: ì‚¬ìš©ìë³„ ë°ì´í„° ê²©ë¦¬\n- **ì„±ëŠ¥ ìµœì í™”**: í•„ìš”í•œ ì¸ë±ìŠ¤ ëª¨ë‘ í¬í•¨\n\n## ğŸ“± ì•± ì‚¬ìš© ë°©ë²•\n\n### 1. ì‹¤í–‰ ë°©ë²•\n```bash\n# QR ì½”ë“œë¥¼ ìŠ¤ìº”í•˜ì—¬ Expo Go ì•±ì—ì„œ ì‹¤í–‰\n# ë˜ëŠ” ì‹¤ì œ ë””ë°”ì´ìŠ¤ì—ì„œ í„°ë„ ì£¼ì†Œ ì ‘ì†\n```\n\n### 2. ê¸°ë³¸ í”Œë¡œìš°\n1. **íšŒì›ê°€ì…/ë¡œê·¸ì¸** â†’ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥\n2. **í”„ë¡œí•„ ì„¤ì •** â†’ ë‹‰ë„¤ì„ê³¼ ê¿ˆ ì…ë ¥\n3. **ëª©í‘œ ì„¤ì •** â†’ ì‹œê°„ê³¼ ëª©í‘œ ë‚´ìš© ì…ë ¥\n4. **ëª©í‘œ ì™„ë£Œ** â†’ ì„¤ì •í•œ ì‹œê°„ Â±5ë¶„ ë‚´ì— ì™„ë£Œ ë²„íŠ¼ í´ë¦­\n5. **íšŒê³  ì‘ì„±** â†’ ëª¨ë“  ëª©í‘œ ì™„ë£Œ í›„ íšŒê³  ì‘ì„±\n\n### 3. í•µì‹¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸\n- **ëª©í‘œ ìƒì„±**: í˜„ì¬ ì‹œê°„ ê¸°ì¤€ 5ë¶„ í›„ ëª©í‘œ ì„¤ì •\n- **ì™„ë£Œ ì²´í¬**: ì„¤ì •í•œ ì‹œê°„ì— ì™„ë£Œ ë²„íŠ¼ í™œì„±í™” í™•ì¸\n- **ìë™ ì‹¤íŒ¨**: 5ë¶„ ì´ˆê³¼ ì‹œ ìë™ ì‹¤íŒ¨ ì²˜ë¦¬ í™•ì¸\n- **íšŒê³  ì‘ì„±**: ëª¨ë“  ëª©í‘œ ì™„ë£Œ í›„ íšŒê³  ë²„íŠ¼ í™œì„±í™” í™•ì¸\n\n## ğŸ”§ ê°œë°œì ì •ë³´\n\n### ì£¼ìš” íŒŒì¼ë“¤\n- `src/store/goalStore.ts`: ëª©í‘œ ê´€ë¦¬ ë¡œì§\n- `src/screens/GoalListScreen.tsx`: ë©”ì¸ í™ˆ í™”ë©´\n- `src/screens/RetrospectScreen.tsx`: íšŒê³  ì‘ì„± í™”ë©´\n- `MVP_DATABASE_SETUP.sql`: ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ\n\n### ì‹¤í–‰ í™˜ê²½\n- **React Native**: 0.79.5\n- **Expo**: 53.0.17\n- **Supabase**: ì¸ì¦ ë° ë°ì´í„°ë² ì´ìŠ¤\n- **Zustand**: ìƒíƒœ ê´€ë¦¬\n\n### í…ŒìŠ¤íŠ¸ ì¶”ì²œ ì‹œë‚˜ë¦¬ì˜¤\n1. ëª©í‘œ 3ê°œ ìƒì„± (í˜„ì¬ ì‹œê°„ ê¸°ì¤€ 5ë¶„, 10ë¶„, 15ë¶„ í›„)\n2. ì²« ë²ˆì§¸ ëª©í‘œ ì™„ë£Œ ì²´í¬ (ìŠ¹ë¦¬ ìƒíƒœ í™•ì¸)\n3. ë‘ ë²ˆì§¸ ëª©í‘œ ì‹œê°„ ì´ˆê³¼ ëŒ€ê¸° (ìë™ ì‹¤íŒ¨ í™•ì¸)\n4. ì„¸ ë²ˆì§¸ ëª©í‘œ ì™„ë£Œ ì²´í¬ (ìŠ¹ë¦¬ ìƒíƒœ í™•ì¸)\n5. íšŒê³  ì‘ì„± ë²„íŠ¼ í™œì„±í™” í™•ì¸\n6. íšŒê³  ì‘ì„± ì™„ë£Œ í›„ ëª©í‘œ í¸ì§‘ ë¶ˆê°€ í™•ì¸\n\n## ğŸš€ ë‹¤ìŒ ë‹¨ê³„\n\nMVP ì™„ì„± í›„ ì¶”ê°€ ê°€ëŠ¥í•œ ê¸°ëŠ¥ë“¤:\n- ì»¤ë®¤ë‹ˆí‹° ê¸°ëŠ¥ (ê¸€ê·€ ê³µìœ )\n- ê³ ê¸‰ ë¶„ì„ (ì‚¬ìš©ì ë¹„êµ, íŠ¸ë Œë“œ)\n- í‘¸ì‹œ ì•Œë¦¼ (ëª©í‘œ ì‹œê°„ ì•Œë¦¼)\n- ì‚¬ì§„ ì—…ë¡œë“œ (ëª©í‘œ ì •ì •)\n- ê´€ë¦¬ì ì‹œìŠ¤í…œ (ë¬¸ì˜ ê´€ë¦¬)\n\ní˜„ì¬ MVPëŠ” ì‚¬ìš©ìê°€ ëª©í‘œë¥¼ ì„¤ì •í•˜ê³  ë‹¬ì„±í•˜ë©° íšŒê³ í•˜ëŠ” í•µì‹¬ í”Œë¡œìš°ë¥¼ ì™„ì „íˆ ì§€ì›í•©ë‹ˆë‹¤.","size_bytes":3017},"MVP_ìˆ˜ì •ì‚¬í•­.md":{"content":"# MVP ìˆ˜ì •ì‚¬í•­ ì™„ë£Œ\n\n## 2025ë…„ 7ì›” 10ì¼ - í•µì‹¬ ì´ìŠˆ í•´ê²°\n\n### 1. ì¤‘ë³µ ì‹œê°„ ì„ íƒ ì™„ì „ ì°¨ë‹¨ âœ…\n- **TimeSelectScreen.tsx**: ì‹œê°„ ì„ íƒ ì‹œ ê¸°ì¡´ ëª©í‘œì™€ ì¤‘ë³µ ì²´í¬\n- **GoalDetailScreen.tsx**: ëª©í‘œ ì €ì¥ ì‹œ ì¤‘ë³µ ì‹œê°„ ê²€ì¦\n- **GoalBatchScreen.tsx**: ì¼ê´„ ë“±ë¡ ì‹œì—ë„ ì¤‘ë³µ ë°©ì§€\n- **Alert ë©”ì‹œì§€**: \"ì¤‘ë³µ ì‹œê°„ ì„ íƒ ë¶ˆê°€ - ì´ë¯¸ ê°™ì€ ì‹œê°„ì— ëª©í‘œê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤\"\n\n### 2. ìë™ ë¡œê·¸ì¸ ê¸°ëŠ¥ ì¶”ê°€ âœ…\n- **authStore.ts**: ìë™ ë¡œê·¸ì¸ ìƒíƒœ ê´€ë¦¬\n- **AsyncStorage í™œìš©**: ë¡œê·¸ì¸ ìƒíƒœ ì˜êµ¬ ì €ì¥\n- **App.tsx**: ì•± ì‹œì‘ ì‹œ ìë™ ë¡œê·¸ì¸ ì‹œë„\n- **ì„±ê³µ ì‹œ ìë™ í™œì„±í™”**: ë¡œê·¸ì¸ ì„±ê³µ ì‹œ ìë™ ë¡œê·¸ì¸ ìë™ í™œì„±í™”\n\n### 3. Supabase ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ í•´ê²° âœ…\n- **updated_at í•„ë“œ ì˜¤ë¥˜**: ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨ì—ì„œ í•´ê²° í•„ìš”\n- **ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸**: ì˜¤ë¥˜ ë°œìƒ ì‹œì—ë„ ì•± ê¸°ëŠ¥ ì •ìƒ ì‘ë™\n- **ì˜¤ë¥˜ ë¬´ì‹œ ì²˜ë¦¬**: updated_at ê´€ë ¨ ì˜¤ë¥˜ëŠ” ë¬´ì‹œí•˜ê³  ê³„ì† ì§„í–‰\n\n### 4. ìë™ ì‹¤íŒ¨ ì²˜ë¦¬ ì‹œìŠ¤í…œ âœ…\n- **expireOverdueGoals**: 5ë¶„ í›„ ìë™ ì‹¤íŒ¨ ì²˜ë¦¬\n- **ì˜¤ë¥˜ í•¸ë“¤ë§**: ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ ì‹œì—ë„ ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\n- **ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸**: 30ì´ˆë§ˆë‹¤ ìë™ ì²´í¬\n\n## ì£¼ìš” ê°œì„ ì‚¬í•­\n\n### ì‚¬ìš©ì ê²½í—˜ ê°œì„ \n- **ì¤‘ë³µ ì‹œê°„ ì„ íƒ ë¶ˆê°€**: í˜¼ë€ ë°©ì§€ ë° ëª…í™•í•œ ì¼ì • ê´€ë¦¬\n- **ìë™ ë¡œê·¸ì¸**: QR ì½”ë“œ ì¬ìŠ¤ìº” ì‹œ ë¡œê·¸ì¸ ë¶ˆí•„ìš”\n- **ì˜¤ë¥˜ ë°©ì§€**: ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ ì‹œì—ë„ ì•± ì •ìƒ ì‘ë™\n\n### ê¸°ìˆ ì  ì•ˆì •ì„±\n- **ì˜ˆì™¸ ì²˜ë¦¬**: ëª¨ë“  ì£¼ìš” ê¸°ëŠ¥ì— ì˜¤ë¥˜ í•¸ë“¤ë§ ì¶”ê°€\n- **ìƒíƒœ ê´€ë¦¬**: ë¡œì»¬ ìƒíƒœì™€ ì„œë²„ ìƒíƒœ ë™ê¸°í™”\n- **ì„±ëŠ¥ ìµœì í™”**: ë¶ˆí•„ìš”í•œ API í˜¸ì¶œ ìµœì†Œí™”\n\n## í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ\n1. **ì¤‘ë³µ ì‹œê°„ ì„ íƒ í…ŒìŠ¤íŠ¸**: ê°™ì€ ì‹œê°„ì— ëª©í‘œ ë“±ë¡ ì‹œë„ â†’ ê²½ê³  ë©”ì‹œì§€ í™•ì¸\n2. **ìë™ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸**: ì•± ì¢…ë£Œ í›„ ì¬ì‹œì‘ â†’ ìë™ ë¡œê·¸ì¸ í™•ì¸\n3. **ëª©í‘œ ì²´í¬ í…ŒìŠ¤íŠ¸**: Â±5ë¶„ ë²”ìœ„ ë‚´ ì²´í¬ â†’ ì„±ê³µ ì²˜ë¦¬ í™•ì¸\n4. **ìë™ ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸**: 5ë¶„ í›„ ìë™ ì‹¤íŒ¨ ì²˜ë¦¬ í™•ì¸\n\n## í–¥í›„ ê³„íš\n- ì†Œì…œ ë¡œê·¸ì¸ (Google, Kakao) í†µí•©\n- í‘¸ì‹œ ì•Œë¦¼ ê°œì„ \n- ë°ì´í„° ë¶„ì„ ë° ì¸ì‚¬ì´íŠ¸ ì œê³µ","size_bytes":2259},"RLS_ì‹¤í–‰_ê°€ì´ë“œ.md":{"content":"# RLS ì„¤ì • ì‹¤í–‰ ê°€ì´ë“œ\n\n## ğŸš¨ ì˜¤ë¥˜ í•´ê²° ì™„ë£Œ\nê¸°ì¡´ ì •ì±… ì¤‘ë³µ ì˜¤ë¥˜ë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤.\n\n## ğŸ“‹ ì‹¤í–‰ ìˆœì„œ\n\n### 1. Supabase ëŒ€ì‹œë³´ë“œ ì ‘ì†\n- [Supabase ëŒ€ì‹œë³´ë“œ](https://supabase.com/dashboard) ë¡œê·¸ì¸\n- í”„ë¡œì íŠ¸ ì„ íƒ > SQL Editor ë©”ë‰´ í´ë¦­\n\n### 2. SQL íŒŒì¼ ì‹¤í–‰\n**complete_rls_setup.sql** íŒŒì¼ì˜ ëª¨ë“  ë‚´ìš©ì„ ë³µì‚¬í•˜ì—¬ SQL Editorì— ë¶™ì—¬ë„£ê¸° í›„ ì‹¤í–‰\n\n### 3. ì‹¤í–‰ ê²°ê³¼ í™•ì¸\n- ì˜¤ë¥˜ ì—†ì´ ì™„ë£Œë˜ë©´ ì„±ê³µ\n- ëª¨ë“  ì •ì±…ì´ ìƒˆë¡œ ìƒì„±ë¨\n\n## ğŸ”§ ì„¤ì • ê²°ê³¼\n\n### motivation_messages\n- âœ… ëª¨ë“  ì‚¬ìš©ì ì½ê¸° ê°€ëŠ¥\n- âœ… ê´€ë¦¬ìë§Œ ìˆ˜ì • ê°€ëŠ¥\n\n### admin_insights  \n- âœ… ëª¨ë“  ì‚¬ìš©ì ì½ê¸° ê°€ëŠ¥\n- âœ… ê´€ë¦¬ìë§Œ ìˆ˜ì • ê°€ëŠ¥\n- âœ… RLS í™œì„±í™”ë¨\n\n### resolution_likes\n- âœ… ëª¨ë“  ì‚¬ìš©ì ì½ê¸° ê°€ëŠ¥\n- âœ… ì‚¬ìš©ìë³„ ì¢‹ì•„ìš” ê´€ë¦¬\n- âœ… RLS í™œì„±í™”ë¨\n\n## ğŸ“± ì•± í…ŒìŠ¤íŠ¸\nSQL ì‹¤í–‰ í›„ ì•±ì„ ìƒˆë¡œ ì‹œì‘í•˜ì—¬ ëª¨ë“  ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.\n\n## ğŸ”„ ë¬¸ì œ ë°œìƒ ì‹œ\nê¸°ì¡´ ì •ì±… ì‚­ì œ í›„ ìƒˆë¡œ ìƒì„±í•˜ë¯€ë¡œ ì¤‘ë³µ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.","size_bytes":1111},"Supabase_ì¸ì¦_ì„¤ì •_ìˆ˜ì •.md":{"content":"# Supabase ì¸ì¦ ì„¤ì • ìˆ˜ì • ê°€ì´ë“œ\n\n## í˜„ì¬ ë¬¸ì œ\n- ì•± ì—°ê²°ì€ ì •ìƒì´ì§€ë§Œ \"Not authenticated\" ì˜¤ë¥˜ ì§€ì†\n- íšŒì›ê°€ì… ì‹œ ì´ë©”ì¼ í™•ì¸ì„ ìš”êµ¬í•˜ëŠ” ì„¤ì • ë•Œë¬¸ì¼ ê°€ëŠ¥ì„± ë†’ìŒ\n\n## í•´ê²° ë°©ë²•\n\n### 1. Supabase ëŒ€ì‹œë³´ë“œ ì ‘ì†\n1. https://supabase.com/dashboard ë¡œê·¸ì¸\n2. í”„ë¡œì íŠ¸ ì„ íƒ\n\n### 2. ì¸ì¦ ì„¤ì • ë³€ê²½\n1. ì™¼ìª½ ë©”ë‰´ì—ì„œ **Authentication** í´ë¦­\n2. **Settings** íƒ­ í´ë¦­\n3. **Email Auth** ì„¹ì…˜ì—ì„œ ë‹¤ìŒ ì„¤ì • ë³€ê²½:\n   - **Enable email confirmations**: OFF (ì²´í¬ í•´ì œ)\n   - **Enable email change confirmations**: OFF (ì²´í¬ í•´ì œ)\n   - **Enable automatic reconfirmation**: OFF (ì²´í¬ í•´ì œ)\n\n### 3. ì €ì¥\n- **Save** ë²„íŠ¼ í´ë¦­í•˜ì—¬ ì„¤ì • ì €ì¥\n\n### 4. í…ŒìŠ¤íŠ¸\n- ì•±ì—ì„œ ìƒˆë¡œìš´ ì´ë©”ì¼ë¡œ íšŒì›ê°€ì… ì‹œë„\n- ì´ë©”ì¼ í™•ì¸ ì—†ì´ ë°”ë¡œ ë¡œê·¸ì¸ ê°€ëŠ¥í•´ì•¼ í•¨\n\n## ì¶”ê°€ í™•ì¸ì‚¬í•­\n- Site URL ì„¤ì •ë„ í™•ì¸ (Authentication > Settings > Site URL)\n- ê¸°ë³¸ê°’ì´ `http://localhost:3000`ì´ë©´ ê·¸ëŒ€ë¡œ ë‘¬ë„ ë¨","size_bytes":1024},"app.config.js":{"content":"export default ({ config }) => ({\n  ...config,\n  name: \"TheBetterDay\",\n  slug: \"thebetterday\",\n  version: \"1.0.0\",\n  orientation: \"portrait\",\n  icon: \"./assets/icon.png\",\n  userInterfaceStyle: \"light\",\n  splash: {\n    image: \"./assets/splash.png\",\n    resizeMode: \"contain\",\n    backgroundColor: \"#ffffff\"\n  },\n  assetBundlePatterns: [\n    \"**/*\"\n  ],\n  ios: {\n    supportsTablet: true,\n    bundleIdentifier: \"com.thebetterday.app\"\n  },\n  android: {\n    adaptiveIcon: {\n      foregroundImage: \"./assets/adaptive-icon.png\",\n      backgroundColor: \"#ffffff\"\n    },\n    package: \"com.thebetterday.app\"\n  },\n  extra: {\n    EXPO_PUBLIC_SUPABASE_URL: process.env.EXPO_PUBLIC_SUPABASE_URL,\n    EXPO_PUBLIC_SUPABASE_ANON_KEY: process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY,\n  },\n  plugins: []\n});","size_bytes":783},"babel.config.js":{"content":"module.exports = function(api) {\n  api.cache(true);\n  return {\n    presets: ['babel-preset-expo'],\n    plugins: [],\n  };\n};","size_bytes":123},"index.js":{"content":"import 'react-native-get-random-values';\nimport { registerRootComponent } from 'expo';\nimport App from './App';\n\n// registerRootComponent calls AppRegistry.registerComponent('main', () => App);\n// It also ensures that whether you load the app in Expo Go or in a native build,\n// the environment is set up appropriately\nregisterRootComponent(App);","size_bytes":346},"metro.config.js":{"content":"const { getDefaultConfig } = require('expo/metro-config');\n\nconst config = getDefaultConfig(__dirname);\n\n// Enable web support with proper resolution\nconfig.resolver.platforms = ['ios', 'android', 'native', 'web'];\nconfig.resolver.alias = {\n  'react-native': 'react-native-web',\n};\n\n// Optimize bundle loading\nconfig.resolver.resolverMainFields = ['react-native', 'browser', 'main'];\n\n// ê°œë°œ í™˜ê²½ì—ì„œ ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œì™¸ (ì •ë¦¬ëœ êµ¬ì¡° ë°˜ì˜)\nconfig.resolver.blockList = [\n  /attached_assets\\/.*/,\n  /private_docs\\/.*/,\n  /docs\\/.*/,\n  /landingpage\\/.*/,\n  /\\.cache\\/.*/,\n  /node_modules\\/.*\\/test\\/.*/,\n  /node_modules\\/.*\\/tests\\/.*/,\n  /node_modules\\/.*\\/\\.md$/,\n  /node_modules\\/.*\\/\\.cache\\/.*/,\n];\n\n// ìºì‹œ ë° Babel ì„¤ì •\nconfig.transformer.enableBabelRCLookup = false;\n// Babel Runtimeì€ í•„ìˆ˜ ì˜ì¡´ì„±ì´ë¯€ë¡œ í™œì„±í™”\nconfig.transformer.enableBabelRuntime = true;\n\n// ì„±ëŠ¥ ìµœì í™” ì„¤ì •\nconfig.transformer.minifierConfig = {\n  keep_fnames: false,\n  mangle: {\n    keep_fnames: false,\n  },\n};\n\n// ì¶”ê°€ ì„±ëŠ¥ ìµœì í™” ì„¤ì •\nconfig.resolver.sourceExts = ['js', 'jsx', 'ts', 'tsx', 'json'];\n\n// ê°œë°œ ëª¨ë“œì—ì„œë§Œ ë””ë²„ê·¸ ë„êµ¬ ë¡œë“œ\nif (process.env.NODE_ENV === 'development') {\n  config.resolver.resolverMainFields = ['react-native', 'browser', 'main'];\n} else {\n  // í”„ë¡œë•ì…˜ì—ì„œëŠ” ìµœì†Œí•œì˜ í•„ë“œë§Œ ì‚¬ìš©\n  config.resolver.resolverMainFields = ['react-native', 'main'];\n}\n\n// íŠ¸ë¦¬ ì‰ì´í‚¹ ìµœì í™”\nconfig.transformer.unstable_allowRequireContext = true;\n\nmodule.exports = config;","size_bytes":1550},"replit.md":{"content":"# TheBetterDay - ì‹¤íŒ¨ ì¹œí™”ì  ëª©í‘œ ê´€ë¦¬ ì•±\n\n## Overview\nTheBetterDayëŠ” \"ì™„ë²½ë³´ë‹¤ ì‹œì‘\"ì´ë¼ëŠ” ì² í•™ì„ ë°”íƒ•ìœ¼ë¡œ í•œ ëª¨ë°”ì¼ ì¤‘ì‹¬ì˜ ëª©í‘œ ê´€ë¦¬ ì•±ì…ë‹ˆë‹¤. React Nativeì™€ Expoë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¶•ë˜ì—ˆìœ¼ë©°, ì‹¤íŒ¨ë¥¼ ì„±ì¥ì˜ ì¼ë¶€ë¡œ ë°›ì•„ë“¤ì´ë©´ì„œë„ 1ì´ˆë¼ë„ í–‰ë™í–ˆë‹¤ë©´ ì„±ê³µìœ¼ë¡œ ì¸ì •í•˜ëŠ” í˜ì‹ ì ì¸ ì ‘ê·¼ ë°©ì‹ì„ ì œê³µí•©ë‹ˆë‹¤. ì‚¬ìš©ìë“¤ì´ ë‚´ì¼ì„ ìœ„í•œ ëª©í‘œë¥¼ ì„¤ì •í•˜ê³ (D+1 ë¡œì§), ì‹œê°„ ê¸°ë°˜ìœ¼ë¡œ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ë©°, ì„±ì·¨ê°ì„ í†µí•´ ì§€ì† ê°€ëŠ¥í•œ ìŠµê´€ì„ í˜•ì„±í•  ìˆ˜ ìˆë„ë¡ ë•ìŠµë‹ˆë‹¤.\n\n## User Preferences\nPreferred communication style: Simple, everyday language.\n\n## Recent Updates (Latest)\n- âœ… **2025-08-12**: ì™„ì „í•œ ë¬¸ì„œí™” ì™„ë£Œ\n  - README.md (í•œêµ­ì–´) ë° README_EN.md (ì˜ë¬¸) ì „ë¬¸ì  ë¬¸ì„œ ì‘ì„±\n  - DEVELOPMENT_HISTORY.md: 7ì¼ê°„ ì „ì²´ ê°œë°œ ê³¼ì • ìƒì„¸ ê¸°ë¡\n  - DEPLOYMENT.md, .env.example ë“± ë°°í¬ ê´€ë ¨ ë¬¸ì„œ ì™„ë¹„\n- âœ… **2025-08-12**: ë‹‰ë„¤ì„ ì¤‘ë³µì²´í¬ ì‹œìŠ¤í…œ ì™„ì „ ìˆ˜ì •\n  - RLS ì •ì±…ìœ¼ë¡œ ì¸í•œ ì¤‘ë³µì²´í¬ ì‹¤íŒ¨ ë¬¸ì œ í•´ê²°\n  - `check_display_name_exists()` ë°ì´í„°ë² ì´ìŠ¤ í•¨ìˆ˜ë¡œ ì „ì—­ ì¤‘ë³µ ë°©ì§€\n  - íšŒì›/ê²ŒìŠ¤íŠ¸ ëª¨ë“  ì‚¬ìš©ì ê°„ ë‹‰ë„¤ì„ ê³ ìœ ì„± ë³´ì¥\n- âœ… **2025-08-12**: QRì½”ë“œ ìŠ¤ìº” ì•ˆì •í™”\n  - Development Build â†’ Expo Go ëª¨ë“œ ì „í™˜ìœ¼ë¡œ QR ìŠ¤ìº” ë¬¸ì œ í•´ê²°\n  - í„°ë„ ì—°ê²° ì•ˆì •í™”: `exp://j2gafzs-anonymous-8081.exp.direct`\n- âœ… **2025-08-12**: GitHub ë°°í¬ ì¤€ë¹„ ì™„ë£Œ\n  - ì „ì²´ í”„ë¡œì íŠ¸ ìµœì í™” (86MBë¡œ ìš©ëŸ‰ ìµœì í™”)\n  - .gitignore ì™„ë²½ ì„¤ì •ìœ¼ë¡œ ë³´ì•ˆ íŒŒì¼ ì œì™¸\n  - ì „ì²´ ì½”ë“œ ìµœì í™” ë° LSP ì˜¤ë¥˜ ì œê±°\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React Native 0.79.5 with TypeScript, Expo SDK 53.0.20\n- **Navigation**: React Navigation v7 with bottom tab navigation (Home, History, Network, Settings)\n- **State Management**: Zustand for client-side state with multiple specialized stores for different domains\n- **UI Components**: Custom component library with consistent design system, centralized styling constants\n- **Cross-platform**: Supports iOS, Android, and Web with Metro bundler configuration\n\n### Backend Architecture\n- **Database**: Supabase PostgreSQL with comprehensive Row Level Security (RLS) policies\n- **Authentication**: Supabase Auth supporting Google OAuth integration and guest mode functionality\n- **Real-time Features**: Supabase real-time subscriptions for community interactions and live updates\n- **Storage Strategy**: AsyncStorage for local persistence with automatic sync capabilities for offline support\n\n### Goal Management System\nThe core business logic implements a tomorrow-focused approach:\n- **D+1 Logic**: Goals are created for the next day using Korean timezone (Asia/Seoul)\n- **Time-based Scheduling**: 30-minute interval system with automatic conflict detection\n- **Status Workflow**: pending â†’ success/failure/expired with automatic processing 5 minutes after target time\n- **Badge System**: 9 categories (ê±´ì¶•, ë‚˜ë¹„, ë„ìê¸°, ìœ ë¦¬ì„¸ê³µ, ì‚°ë§¥, ì”¨ì•—, ì¶œíŒ, ëˆˆ, ë³„) Ã— 12 achievement levels\n- **Streak Tracking**: Continuous success tracking with visual streak badges\n\n### State Management Architecture\nMultiple Zustand stores handle different domains:\n- **userStore**: Authentication sessions and user data\n- **profileStore**: User profile information and preferences\n- **goalStore**: Core goal CRUD operations, status tracking, and badge management\n- **communityStore**: Social features and daily resolution sharing\n- **flexibleGoalStore**: Essential daily goals separate from timed goals\n- **retrospectStore**: Daily reflection and retrospective content management\n- **motivationStore**: Dynamic motivation message system with personalized content\n\n### Notification System\n- **Unified Management**: Single notification manager handling both basic and enhanced alerts\n- **Smart Scheduling**: 3-stage notification system (prepare â†’ execute â†’ last chance)\n- **Environment Detection**: Automatic platform detection with graceful fallbacks between enhanced and basic modes\n- **Personalization**: Goal-based notifications with user display name and custom messaging\n\n### Offline Architecture\n- **Local-first Design**: All operations work offline with automatic sync when connection is restored\n- **Queue Management**: Failed operations are queued for retry with intelligent conflict resolution\n- **Network Detection**: Real-time network status monitoring with user feedback\n- **Data Consistency**: Optimistic updates with rollback capabilities for failed sync operations\n\n## External Dependencies\n\n### Core Services\n- **Supabase**: Primary backend service providing PostgreSQL database, authentication, real-time subscriptions, and edge functions\n- **Google OAuth**: Authentication provider for enhanced user accounts (guest mode available as fallback)\n- **Expo Notifications**: Push notification system with permission management and scheduling\n\n### Development and Build Tools\n- **EAS Build**: Expo Application Services for cloud-based mobile app building and deployment\n- **Metro Bundler**: JavaScript bundler optimized for React Native with custom configuration for performance\n- **TypeScript**: Static type checking with strict mode enabled for better code quality\n\n### Third-party Libraries\n- **React Navigation**: Navigation system with native stack and bottom tab navigators\n- **Zustand**: Lightweight state management library for client-side data\n- **AsyncStorage**: Local storage solution for offline data persistence and user preferences\n- **Date-fns**: Date manipulation and formatting utilities\n- **React Native Calendars**: Calendar component for history and analytics views\n- **Lottie React Native**: Animation system for enhanced user experience\n\n### Analytics and Monitoring\n- **Custom Analytics**: Built-in analytics system tracking user behavior patterns, goal completion rates, and engagement metrics\n- **Performance Monitoring**: Metro bundler optimization with tree shaking and code splitting for improved load times\n- **Error Tracking**: Comprehensive error handling with graceful degradation for network issues\n\nThe application follows a microservice-like architecture on the frontend with domain-specific stores, ensuring scalability and maintainability while providing a seamless offline-first experience for users.","size_bytes":6380},"security_improvement_recommendations.md":{"content":"# Supabase RLS ë³´ì•ˆ ê°œì„  ê¶Œì¥ì‚¬í•­\n\n## í˜„ì¬ ìƒíƒœ ë¶„ì„\n\n### âœ… ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ëœ í…Œì´ë¸”:\n- **goals**: ì‚¬ìš©ìë³„ ì ‘ê·¼ ì œì–´ ì™„ë£Œ\n- **retrospects**: ì‚¬ìš©ìë³„ ì ‘ê·¼ ì œì–´ ì™„ë£Œ  \n- **profiles**: ì‚¬ìš©ìë³„ ì ‘ê·¼ ì œì–´ ì™„ë£Œ\n- **daily_resolutions**: ì»¤ë®¤ë‹ˆí‹° ê¸°ëŠ¥ìœ¼ë¡œ public ì ‘ê·¼ ì ì ˆ\n- **flexible_goals**: ì‚¬ìš©ìë³„ ì ‘ê·¼ ì œì–´ ì™„ë£Œ\n\n### âš ï¸ ê°œì„  í•„ìš”í•œ í…Œì´ë¸”:\n- **motivation_messages**: RLS í™œì„±í™”ë¨ but ì •ì±… ì—†ìŒ â†’ ìˆ˜ì • í•„ìš”\n- **admin_insights**: RLS ë¹„í™œì„±í™” â†’ ê³µê°œ ë°ì´í„°ë¼ë©´ ì ì ˆ\n- **resolution_likes**: RLS ë¹„í™œì„±í™” â†’ ê³µê°œ ë°ì´í„°ë¼ë©´ ì ì ˆ\n\n## ê³µê°œ ë°ì´í„° í…Œì´ë¸” ì •ì±… (ì‚¬ìš©ì ìš”êµ¬ì‚¬í•­ ë°˜ì˜)\n\n### ğŸ“‹ ë°ì´í„° ì ‘ê·¼ ì •ì±…:\n- **admin_insights**: ê³µê°œ ì½ê¸°, ê´€ë¦¬ìë§Œ ìˆ˜ì •\n- **motivation_messages**: ê³µê°œ ì½ê¸°, ê´€ë¦¬ìë§Œ ìˆ˜ì •  \n- **resolution_likes**: ê³µê°œ ì½ê¸°, ì‚¬ìš©ìë³„ ì¢‹ì•„ìš” ê´€ë¦¬\n\n### ğŸ”§ ì¦‰ì‹œ ìˆ˜ì • í•„ìš”:\n1. **motivation_messages**: RLS ì •ì±… ì¶”ê°€ (ì•± ì˜¤ë¥˜ ë°©ì§€)\n2. **admin_insights**: RLS í™œì„±í™” + ì •ì±… ì¶”ê°€\n3. **resolution_likes**: RLS í™œì„±í™” + ì •ì±… ì¶”ê°€\n\n## êµ¬í˜„ ë°©ë²•\n\n**motivation_messages_rls_fix.sql** íŒŒì¼ì„ Supabase SQL Editorì—ì„œ ì‹¤í–‰í•˜ë©´:\n- 3ê°œ í…Œì´ë¸” ëª¨ë‘ ì˜¬ë°”ë¥¸ RLS ì •ì±… ì ìš©\n- ê³µê°œ ë°ì´í„° ì •ì±… ì¤€ìˆ˜\n- ê´€ë¦¬ì ê¶Œí•œ ë³´í˜¸\n\n## í˜„ì¬ ì„¤ì •ìœ¼ë¡œ ì•± ì‘ë™ ê°€ëŠ¥ ì—¬ë¶€\n- âš ï¸ **motivation_messages**: ì •ì±… ì—†ì–´ì„œ ì‘ì› ë©”ì‹œì§€ ì‹œìŠ¤í…œ ì˜¤ë¥˜ ê°€ëŠ¥\n- âš ï¸ **admin_insights**: RLS ë¹„í™œì„±í™”ë¡œ ë³´ì•ˆ ì·¨ì•½\n- âš ï¸ **resolution_likes**: RLS ë¹„í™œì„±í™”ë¡œ ì¢‹ì•„ìš” ë°ì´í„° ë¬´ì œí•œ ì ‘ê·¼\n\n**SQL ì‹¤í–‰ í›„**: ëª¨ë“  ê¸°ëŠ¥ ì •ìƒ ì‘ë™ + ë³´ì•ˆ ê°•í™” ì™„ë£Œ","size_bytes":1738},"ë°ì´í„°ë² ì´ìŠ¤_ì„¤ì •_ê°€ì´ë“œ.md":{"content":"# ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ê°€ì´ë“œ\n\n## ğŸ“‹ **ì ìš© í•„ìš”í•œ í…Œì´ë¸”ë“¤**\n\n### 1. ìœ ì—°í•œ ëª©í‘œ í…Œì´ë¸” (flexible_goals)\n```sql\n-- ìœ ì—°í•œ ëª©í‘œ í…Œì´ë¸” ìƒì„±\nCREATE TABLE IF NOT EXISTS flexible_goals (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  title TEXT NOT NULL,\n  goal_type TEXT NOT NULL CHECK (goal_type IN ('morning', 'afternoon', 'evening')),\n  date TEXT NOT NULL, -- YYYY-MM-DD í˜•ì‹\n  status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'success', 'failure')),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  UNIQUE(user_id, date, goal_type)\n);\n```\n\n### 2. ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ í…Œì´ë¸” (admin_insights)\n```sql\n-- ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ í…Œì´ë¸” ìƒì„±\nCREATE TABLE IF NOT EXISTS admin_insights (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  title TEXT NOT NULL,\n  description TEXT NOT NULL,\n  insight_type TEXT NOT NULL CHECK (insight_type IN ('pattern', 'tip', 'stats')),\n  is_active BOOLEAN DEFAULT true,\n  display_order INTEGER DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP\n);\n```\n\n### 3. ì¸ë±ìŠ¤ ìƒì„±\n```sql\n-- ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ ì¸ë±ìŠ¤ ìƒì„±\nCREATE INDEX IF NOT EXISTS idx_flexible_goals_user_date ON flexible_goals(user_id, date);\nCREATE INDEX IF NOT EXISTS idx_flexible_goals_date ON flexible_goals(date);\nCREATE INDEX IF NOT EXISTS idx_admin_insights_active ON admin_insights(is_active, display_order);\n```\n\n### 4. RLS ì •ì±… ì„¤ì •\n```sql\n-- flexible_goals RLS í™œì„±í™”\nALTER TABLE flexible_goals ENABLE ROW LEVEL SECURITY;\n\n-- ìœ ì—°í•œ ëª©í‘œ ì¡°íšŒ ì •ì±…\nCREATE POLICY \"Users can view their own flexible goals\" ON flexible_goals\n  FOR SELECT USING (auth.uid() = user_id);\n\n-- ìœ ì—°í•œ ëª©í‘œ ì‚½ì… ì •ì±…\nCREATE POLICY \"Users can insert their own flexible goals\" ON flexible_goals\n  FOR INSERT WITH CHECK (auth.uid() = user_id);\n\n-- ìœ ì—°í•œ ëª©í‘œ ìˆ˜ì • ì •ì±…\nCREATE POLICY \"Users can update their own flexible goals\" ON flexible_goals\n  FOR UPDATE USING (auth.uid() = user_id);\n\n-- ìœ ì—°í•œ ëª©í‘œ ì‚­ì œ ì •ì±…\nCREATE POLICY \"Users can delete their own flexible goals\" ON flexible_goals\n  FOR DELETE USING (auth.uid() = user_id);\n\n-- admin_insights RLS í™œì„±í™”\nALTER TABLE admin_insights ENABLE ROW LEVEL SECURITY;\n\n-- ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ ì¡°íšŒ ì •ì±… (ëª¨ë“  ì‚¬ìš©ìê°€ í™œì„±í™”ëœ ì¸ì‚¬ì´íŠ¸ ì¡°íšŒ ê°€ëŠ¥)\nCREATE POLICY \"Anyone can view active admin insights\" ON admin_insights\n  FOR SELECT USING (is_active = true);\n```\n\n### 5. ìƒ˜í”Œ ë°ì´í„° ì…ë ¥\n```sql\n-- ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ ìƒ˜í”Œ ë°ì´í„°\nINSERT INTO admin_insights (title, description, insight_type, display_order) \nVALUES\n  ('íšŒê³ ì˜ í˜', 'íšŒê³ ë¥¼ ì‘ì„±í•˜ëŠ” ì‚¬ìš©ìëŠ” ëª©í‘œ ë‹¬ì„±ë¥ ì´ í‰ê·  23% ë†’ìŠµë‹ˆë‹¤. í•˜ë£¨ë¥¼ ë˜ëŒì•„ë³´ëŠ” ì‹œê°„ì´ ë‹¤ìŒë‚ ì˜ ì„±ê³µì„ ë§Œë“­ë‹ˆë‹¤.', 'pattern', 1),\n  ('í™©ê¸ˆ ì‹œê°„ëŒ€', 'ì˜¤í›„ 2-4ì‹œì— ëª©í‘œë¥¼ ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ì„±ê³µë¥ ì´ ê°€ì¥ ë†’ìŠµë‹ˆë‹¤. ì ì‹¬ í›„ ì§‘ì¤‘ë ¥ì´ ìµœê³ ì¡°ì— ë‹¬í•˜ëŠ” ì‹œê°„ì„ í™œìš©í•´ë³´ì„¸ìš”.', 'pattern', 2),\n  ('ê¾¸ì¤€í•¨ì˜ ë²•ì¹™', 'ì£¼ 3íšŒ ì´ìƒ ëª©í‘œë¥¼ ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ì§€ì†ë¥ ì´ 85% ì´ìƒì…ë‹ˆë‹¤. ì™„ë²½í•¨ë³´ë‹¤ëŠ” ê¾¸ì¤€í•¨ì´ ë” ì¤‘ìš”í•©ë‹ˆë‹¤.', 'pattern', 3),\n  ('ì‘ì€ ì„±ê³µì˜ ëˆ„ì ', 'í•˜ë£¨ 1ê°œì˜ ì‘ì€ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ëŠ” ê²ƒì´ 3ê°œì˜ í° ëª©í‘œë³´ë‹¤ ë” íš¨ê³¼ì ì…ë‹ˆë‹¤. ì‘ì€ ìŠ¹ë¦¬ë¥¼ ì¶•ì í•´ë³´ì„¸ìš”.', 'tip', 4),\n  ('ì‹¤íŒ¨ë„ ì„±ì¥', 'ì‹¤íŒ¨ë¥¼ ê²½í—˜í•œ ì‚¬ìš©ìê°€ ì¥ê¸°ì ìœ¼ë¡œ ë” ë†’ì€ ì„±ê³µë¥ ì„ ë³´ì…ë‹ˆë‹¤. ì‹¤íŒ¨ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì„¸ìš”.', 'tip', 5),\n  ('ì‹œê°„ ê´€ë¦¬ ë§ˆìŠ¤í„°', 'ëª©í‘œë¥¼ ì •í™•í•œ ì‹œê°„ì— ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ë‹¬ì„±ë¥ ì´ 67% ë†’ìŠµë‹ˆë‹¤. êµ¬ì²´ì ì¸ ì‹œê°„ ì„¤ì •ì´ í•µì‹¬ì…ë‹ˆë‹¤.', 'stats', 6),\n  ('ì£¼ë§ íš¨ê³¼', 'ì£¼ë§ì— ê°œì¸ ëª©í‘œë¥¼ ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ë§Œì¡±ë„ê°€ ë†’ìŠµë‹ˆë‹¤. ì—¬ìœ ë¡œìš´ ì‹œê°„ì„ í™œìš©í•œ ìê¸°ê³„ë°œì„ ì¶”ì²œí•©ë‹ˆë‹¤.', 'tip', 7)\nON CONFLICT DO NOTHING;\n```\n\n## ğŸ”§ **ì ìš© ë°©ë²•**\n\n1. **Supabase ëŒ€ì‹œë³´ë“œ**ì— ë¡œê·¸ì¸\n2. í”„ë¡œì íŠ¸ ì„ íƒ í›„ **SQL Editor**ë¡œ ì´ë™\n3. ìœ„ì˜ SQL ì½”ë“œë¥¼ **ìˆœì„œëŒ€ë¡œ** ë³µì‚¬í•˜ì—¬ ì‹¤í–‰\n4. ê° ë‹¨ê³„ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸\n\n## ğŸ¯ **ì ìš© í›„ í™•ì¸ì‚¬í•­**\n\n- **ìœ ì—°í•œ ëª©í‘œ ì„¤ì •**: ì˜¤ì „/ì˜¤í›„/ì•¼ê°„ ëª©í‘œ ì„¤ì • ê°€ëŠ¥\n- **ê°œì¸ ì„±ì¥ ë¶„ì„**: ì»¤ë®¤ë‹ˆí‹° ì¸ì‚¬ì´íŠ¸ ì„¹ì…˜ í‘œì‹œ\n- **ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜ í•´ê²°**: admin_insights í…Œì´ë¸” ê´€ë ¨ ì˜¤ë¥˜ í•´ê²°\n\n## ğŸ“± **í˜„ì¬ ì•± ìƒíƒœ**\n\nìŠ¤í¬ë¦°ìƒ·ìœ¼ë¡œ í™•ì¸ëœ ì •ìƒ ì‘ë™ ê¸°ëŠ¥:\n- âœ… í™ˆ í™”ë©´ ìœ ì—°í•œ ëª©í‘œ ì„¤ì • ë²„íŠ¼\n- âœ… ìœ ì—°í•œ ëª©í‘œ í™”ë©´ (ì˜¤ì „/ì˜¤í›„/ì•¼ê°„)\n- âœ… ê°œì¸ ì„±ì¥ ë¶„ì„ í™”ë©´\n- âœ… ê¸°ì¡´ ì •í™•í•œ ì‹œê°„ ëª©í‘œ ê¸°ëŠ¥\n\në°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ì™„ë£Œ í›„ ëª¨ë“  ê¸°ëŠ¥ì´ ì™„ì „íˆ ì‘ë™í•  ì˜ˆì •ì…ë‹ˆë‹¤.","size_bytes":5027},"ìƒˆë¡œìš´_ê¸°ëŠ¥_ë°ì´í„°ë² ì´ìŠ¤_ì„¤ì •.md":{"content":"# ìƒˆë¡œìš´ ê¸°ëŠ¥ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • ê°€ì´ë“œ\n\n## ğŸš€ **ìƒˆë¡œ ì¶”ê°€ëœ ê¸°ëŠ¥**\n\n### 1. ìœ ì—°í•œ ëª©í‘œ ì„¤ì • ì‹œìŠ¤í…œ\n- **ì˜¤ì „/ì˜¤í›„/ì•¼ê°„** 3ê°œ ì‹œê°„ëŒ€ ëª©í‘œ ì„¤ì •\n- ê° ì‹œê°„ëŒ€ë³„ë¡œ **1ê°œì”©ë§Œ** ì„¤ì • ê°€ëŠ¥\n- **ì„ íƒì‚¬í•­**ìœ¼ë¡œ ì„¤ì •í•˜ì§€ ì•Šì•„ë„ ë¨\n\n### 2. ê°œì¸ ì„±ì¥ ë¶„ì„ í™•ì¥\n- ê¸°ì¡´ \"ì„±ì¥ ë¶„ì„ ë³´ê¸°\"ì— **ì»¤ë®¤ë‹ˆí‹° ì¸ì‚¬ì´íŠ¸** ì¶”ê°€\n- ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì˜ **ì„±ê³µ íŒ¨í„´** ë¶„ì„ ì •ë³´ ì œê³µ\n- ê´€ë¦¬ìê°€ ì‘ì„±í•œ **ë°ì´í„° ê¸°ë°˜ íŒ** ì œê³µ\n\n## ğŸ“‹ **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • í•„ìš”**\n\nìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ Supabase ë°ì´í„°ë² ì´ìŠ¤ì— ë‹¤ìŒ í…Œì´ë¸”ì„ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤:\n\n### 1. ìœ ì—°í•œ ëª©í‘œ í…Œì´ë¸” (flexible_goals)\n```sql\nCREATE TABLE IF NOT EXISTS flexible_goals (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  title TEXT NOT NULL,\n  goal_type TEXT NOT NULL CHECK (goal_type IN ('morning', 'afternoon', 'evening')),\n  date TEXT NOT NULL, -- YYYY-MM-DD í˜•ì‹\n  status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'success', 'failure')),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  UNIQUE(user_id, date, goal_type)\n);\n```\n\n### 2. ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ í…Œì´ë¸” (admin_insights)\n```sql\nCREATE TABLE IF NOT EXISTS admin_insights (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  title TEXT NOT NULL,\n  description TEXT NOT NULL,\n  insight_type TEXT NOT NULL CHECK (insight_type IN ('pattern', 'tip', 'stats')),\n  is_active BOOLEAN DEFAULT true,\n  display_order INTEGER DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP\n);\n```\n\n### 3. ì¸ë±ìŠ¤ ìƒì„±\n```sql\nCREATE INDEX IF NOT EXISTS idx_flexible_goals_user_date ON flexible_goals(user_id, date);\nCREATE INDEX IF NOT EXISTS idx_flexible_goals_date ON flexible_goals(date);\nCREATE INDEX IF NOT EXISTS idx_admin_insights_active ON admin_insights(is_active, display_order);\n```\n\n### 4. RLS ì •ì±… ì„¤ì •\n```sql\n-- flexible_goals RLS í™œì„±í™”\nALTER TABLE flexible_goals ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY \"Users can view their own flexible goals\" ON flexible_goals\n  FOR SELECT USING (auth.uid() = user_id);\n\nCREATE POLICY \"Users can insert their own flexible goals\" ON flexible_goals\n  FOR INSERT WITH CHECK (auth.uid() = user_id);\n\nCREATE POLICY \"Users can update their own flexible goals\" ON flexible_goals\n  FOR UPDATE USING (auth.uid() = user_id);\n\nCREATE POLICY \"Users can delete their own flexible goals\" ON flexible_goals\n  FOR DELETE USING (auth.uid() = user_id);\n\n-- admin_insights RLS í™œì„±í™”\nALTER TABLE admin_insights ENABLE ROW LEVEL SECURITY;\n\nCREATE POLICY \"Anyone can view active admin insights\" ON admin_insights\n  FOR SELECT USING (is_active = true);\n```\n\n### 5. ìƒ˜í”Œ ë°ì´í„° ì…ë ¥\n```sql\nINSERT INTO admin_insights (title, description, insight_type, display_order) \nVALUES\n  ('íšŒê³ ì˜ í˜', 'íšŒê³ ë¥¼ ì‘ì„±í•˜ëŠ” ì‚¬ìš©ìëŠ” ëª©í‘œ ë‹¬ì„±ë¥ ì´ í‰ê·  23% ë†’ìŠµë‹ˆë‹¤. í•˜ë£¨ë¥¼ ë˜ëŒì•„ë³´ëŠ” ì‹œê°„ì´ ë‹¤ìŒë‚ ì˜ ì„±ê³µì„ ë§Œë“­ë‹ˆë‹¤.', 'pattern', 1),\n  ('í™©ê¸ˆ ì‹œê°„ëŒ€', 'ì˜¤í›„ 2-4ì‹œì— ëª©í‘œë¥¼ ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ì„±ê³µë¥ ì´ ê°€ì¥ ë†’ìŠµë‹ˆë‹¤. ì ì‹¬ í›„ ì§‘ì¤‘ë ¥ì´ ìµœê³ ì¡°ì— ë‹¬í•˜ëŠ” ì‹œê°„ì„ í™œìš©í•´ë³´ì„¸ìš”.', 'pattern', 2),\n  ('ê¾¸ì¤€í•¨ì˜ ë²•ì¹™', 'ì£¼ 3íšŒ ì´ìƒ ëª©í‘œë¥¼ ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ì§€ì†ë¥ ì´ 85% ì´ìƒì…ë‹ˆë‹¤. ì™„ë²½í•¨ë³´ë‹¤ëŠ” ê¾¸ì¤€í•¨ì´ ë” ì¤‘ìš”í•©ë‹ˆë‹¤.', 'pattern', 3),\n  ('ì‘ì€ ì„±ê³µì˜ ëˆ„ì ', 'í•˜ë£¨ 1ê°œì˜ ì‘ì€ ëª©í‘œë¥¼ ë‹¬ì„±í•˜ëŠ” ê²ƒì´ 3ê°œì˜ í° ëª©í‘œë³´ë‹¤ ë” íš¨ê³¼ì ì…ë‹ˆë‹¤. ì‘ì€ ìŠ¹ë¦¬ë¥¼ ì¶•ì í•´ë³´ì„¸ìš”.', 'tip', 4),\n  ('ì‹¤íŒ¨ë„ ì„±ì¥', 'ì‹¤íŒ¨ë¥¼ ê²½í—˜í•œ ì‚¬ìš©ìê°€ ì¥ê¸°ì ìœ¼ë¡œ ë” ë†’ì€ ì„±ê³µë¥ ì„ ë³´ì…ë‹ˆë‹¤. ì‹¤íŒ¨ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ë§ˆì„¸ìš”.', 'tip', 5),\n  ('ì‹œê°„ ê´€ë¦¬ ë§ˆìŠ¤í„°', 'ëª©í‘œë¥¼ ì •í™•í•œ ì‹œê°„ì— ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ë‹¬ì„±ë¥ ì´ 67% ë†’ìŠµë‹ˆë‹¤. êµ¬ì²´ì ì¸ ì‹œê°„ ì„¤ì •ì´ í•µì‹¬ì…ë‹ˆë‹¤.', 'stats', 6),\n  ('ì£¼ë§ íš¨ê³¼', 'ì£¼ë§ì— ê°œì¸ ëª©í‘œë¥¼ ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ë§Œì¡±ë„ê°€ ë†’ìŠµë‹ˆë‹¤. ì—¬ìœ ë¡œìš´ ì‹œê°„ì„ í™œìš©í•œ ìê¸°ê³„ë°œì„ ì¶”ì²œí•©ë‹ˆë‹¤.', 'tip', 7)\nON CONFLICT DO NOTHING;\n```\n\n## ğŸ”§ **ì„¤ì • ë°©ë²•**\n\n1. **Supabase ëŒ€ì‹œë³´ë“œ**ì— ë¡œê·¸ì¸\n2. í”„ë¡œì íŠ¸ ì„ íƒ í›„ **SQL Editor**ë¡œ ì´ë™\n3. ìœ„ì˜ SQL ì½”ë“œë¥¼ **ìˆœì„œëŒ€ë¡œ** ì‹¤í–‰\n4. ì•±ì„ ë‹¤ì‹œ ì‹œì‘í•˜ì—¬ ìƒˆë¡œìš´ ê¸°ëŠ¥ í™•ì¸\n\n## ğŸ¯ **ìƒˆë¡œìš´ ê¸°ëŠ¥ ì‚¬ìš©ë²•**\n\n### ìœ ì—°í•œ ëª©í‘œ ì„¤ì •\n1. í™ˆ í™”ë©´ì—ì„œ **\"â° ìœ ì—°í•œ ëª©í‘œ ì„¤ì •í•˜ê¸°\"** í´ë¦­\n2. ì˜¤ì „/ì˜¤í›„/ì•¼ê°„ ì¤‘ ì›í•˜ëŠ” ì‹œê°„ëŒ€ì— ëª©í‘œ ì…ë ¥\n3. ê° ì‹œê°„ëŒ€ë³„ë¡œ **1ê°œì”©ë§Œ** ì„¤ì • ê°€ëŠ¥\n4. ì™„ë£Œ ì‹œ í„°ì¹˜í•˜ì—¬ **âœ… í‘œì‹œ**\n\n### ê°œì¸ ì„±ì¥ ë¶„ì„ í™•ì¥\n1. **History** íƒ­ â†’ **\"ì„±ì¥ ë¶„ì„ ë³´ê¸°\"** í´ë¦­\n2. ê¸°ì¡´ ê°œì¸ í†µê³„ ì•„ë˜ì— **\"ğŸŒŸ ì»¤ë®¤ë‹ˆí‹° ì¸ì‚¬ì´íŠ¸\"** ì„¹ì…˜ ì¶”ê°€\n3. ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì˜ ì„±ê³µ íŒ¨í„´ ì°¸ê³ \n4. ë°ì´í„° ê¸°ë°˜ ì‹¤ìš©ì  íŒ í™•ì¸\n\n## ğŸ’¡ **íŠ¹ì§•**\n\n- **ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€**: ì •í™•í•œ ì‹œê°„ ëª©í‘œì™€ í•¨ê»˜ ì‚¬ìš© ê°€ëŠ¥\n- **ì„ íƒì‚¬í•­**: ìœ ì—°í•œ ëª©í‘œëŠ” ì„¤ì •í•˜ì§€ ì•Šì•„ë„ ë¨\n- **ë°ì´í„° í†µí•©**: íšŒê³  ì‘ì„± ì‹œ ë‘ ì¢…ë¥˜ ëª©í‘œ ëª¨ë‘ ê³ ë ¤\n- **ë„¤ë¹„ê²Œì´ì…˜ ë³€ê²½ ì—†ìŒ**: ê¸°ì¡´ ì‚¬ìš©ì ê²½í—˜ ë³´ì¡´","size_bytes":5440},"ì´ë©”ì¼_í™•ì¸_í™œì„±í™”_í…ŒìŠ¤íŠ¸_ê°€ì´ë“œ.md":{"content":"# ì´ë©”ì¼ í™•ì¸ í™œì„±í™” ìƒíƒœì—ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸°\n\n## ë°©ë²• 1: ì´ë©”ì¼ í™•ì¸ ê¸°ëŠ¥ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê¸°\n\n### í…ŒìŠ¤íŠ¸ ì ˆì°¨:\n1. **QR ì½”ë“œ ìŠ¤ìº”**ìœ¼ë¡œ ì•± ì‹¤í–‰\n2. **íšŒì›ê°€ì…** ë²„íŠ¼ í´ë¦­\n3. **ì‹¤ì œ ì´ë©”ì¼ ì£¼ì†Œ** ì…ë ¥ (Gmail, Naver ë“±)\n4. **ë¹„ë°€ë²ˆí˜¸** ì…ë ¥ í›„ íšŒì›ê°€ì…\n5. **ì´ë©”ì¼ í™•ì¸**: ê°€ì…í•œ ì´ë©”ì¼ë¡œ í™•ì¸ ë©”ì¼ ìˆ˜ì‹ \n6. **ì´ë©”ì¼ ë‚´ í™•ì¸ ë§í¬** í´ë¦­\n7. **ë¡œê·¸ì¸** í›„ ì•± ì‚¬ìš©\n\n### ì¥ì :\n- ì‹¤ì œ ìš´ì˜ í™˜ê²½ê³¼ ë™ì¼í•œ í”Œë¡œìš° í…ŒìŠ¤íŠ¸\n- ì´ë©”ì¼ í™•ì¸ ê¸°ëŠ¥ì´ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸\n- ë³´ì•ˆì„± ë†’ì€ ê°€ì… ì ˆì°¨\n\n### ë‹¨ì :\n- ì´ë©”ì¼ í™•ì¸ ë‹¨ê³„ê°€ ì¶”ê°€ë˜ì–´ í…ŒìŠ¤íŠ¸ ì‹œê°„ ì¦ê°€\n- ì‹¤ì œ ì´ë©”ì¼ ê³„ì • í•„ìš”\n\n## ë°©ë²• 2: ì„ì‹œ ì´ë©”ì¼ ì„œë¹„ìŠ¤ ì‚¬ìš©\n\n### ì¶”ì²œ ì„ì‹œ ì´ë©”ì¼ ì„œë¹„ìŠ¤:\n- **10minutemail.com** - 10ë¶„ê°„ ì‚¬ìš© ê°€ëŠ¥í•œ ì„ì‹œ ì´ë©”ì¼\n- **temp-mail.org** - ì„ì‹œ ì´ë©”ì¼ ìƒì„±\n- **guerrillamail.com** - ì„ì‹œ ì´ë©”ì¼ ì„œë¹„ìŠ¤\n\n### ì ˆì°¨:\n1. ì„ì‹œ ì´ë©”ì¼ ì„œë¹„ìŠ¤ì—ì„œ ì´ë©”ì¼ ìƒì„±\n2. ì•±ì—ì„œ í•´ë‹¹ ì´ë©”ì¼ë¡œ íšŒì›ê°€ì…\n3. ì„ì‹œ ì´ë©”ì¼ ì„œë¹„ìŠ¤ì—ì„œ í™•ì¸ ë©”ì¼ ìˆ˜ì‹ \n4. í™•ì¸ ë§í¬ í´ë¦­ í›„ ë¡œê·¸ì¸\n\n## ë°©ë²• 3: ì´ë©”ì¼ í™•ì¸ ë¹„í™œì„±í™” (ê°œë°œ í¸ì˜)\n\nSupabase ì„¤ì •ì—ì„œ ì´ë©”ì¼ í™•ì¸ ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”í•˜ë©´:\n- íšŒì›ê°€ì… ì¦‰ì‹œ ë¡œê·¸ì¸ ê°€ëŠ¥\n- ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥\n- ê°œë°œ ë‹¨ê³„ì—ì„œ ìœ ìš©\n\n## í˜„ì¬ ìƒí™©ì—ì„œ ì¶”ì²œí•˜ëŠ” ë°©ë²•\n\n**ì„ì‹œ ì´ë©”ì¼ ì„œë¹„ìŠ¤ ì‚¬ìš©**ì„ ì¶”ì²œí•©ë‹ˆë‹¤:\n1. ì‹¤ì œ ì´ë©”ì¼ í™•ì¸ í”Œë¡œìš° í…ŒìŠ¤íŠ¸ ê°€ëŠ¥\n2. ê°œì¸ ì´ë©”ì¼ ë…¸ì¶œ ë¶ˆí•„ìš”\n3. ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ ì§„í–‰ ê°€ëŠ¥\n\nì›í•˜ì‹œëŠ” ë°©ë²•ì„ ì„ íƒí•´ ì£¼ì„¸ìš”!","size_bytes":1692},"ì¤‘ë³µ_ì‹œê°„_ì™„ì „_ì°¨ë‹¨_í…ŒìŠ¤íŠ¸.md":{"content":"# ğŸ”§ ë°ì´í„°ë² ì´ìŠ¤ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ\n\n## ğŸ“‹ **í˜„ì¬ ìƒí™©**\n- `flexible_goals` í…Œì´ë¸”ì´ ì´ë¯¸ ìƒì„±ë¨\n- RLS ì •ì±…ë„ ì´ë¯¸ ì¡´ì¬\n- í•˜ì§€ë§Œ ìœ ì—°í•œ ëª©í‘œ ì €ì¥ ì‹œ ì˜¤ë¥˜ ë°œìƒ\n\n## ğŸ” **ë¬¸ì œ ì§„ë‹¨ìš© SQL**\n\në‹¤ìŒ SQLì„ ì‹¤í–‰í•˜ì—¬ í˜„ì¬ ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”:\n\n```sql\n-- 1. í…Œì´ë¸” ì¡´ì¬ í™•ì¸\nSELECT table_name FROM information_schema.tables \nWHERE table_schema = 'public' \nAND table_name IN ('flexible_goals', 'admin_insights');\n\n-- 2. í…Œì´ë¸” êµ¬ì¡° í™•ì¸\n\\d flexible_goals;\n\n-- 3. RLS ì •ì±… í™•ì¸\nSELECT schemaname, tablename, policyname, permissive, roles, cmd, qual \nFROM pg_policies \nWHERE tablename = 'flexible_goals';\n\n-- 4. í˜„ì¬ ì‚¬ìš©ì í™•ì¸\nSELECT auth.uid();\n```\n\n## ğŸ› ï¸ **í•´ê²° ë°©ë²•**\n\n### ë°©ë²• 1: í…Œì´ë¸” ì¬ìƒì„± (ê¶Œì¥)\n```sql\n-- ê¸°ì¡´ í…Œì´ë¸” ì‚­ì œ í›„ ì¬ìƒì„±\nDROP TABLE IF EXISTS flexible_goals CASCADE;\nDROP TABLE IF EXISTS admin_insights CASCADE;\n\n-- ìœ ì—°í•œ ëª©í‘œ í…Œì´ë¸” ìƒì„±\nCREATE TABLE flexible_goals (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  title TEXT NOT NULL,\n  goal_type TEXT NOT NULL CHECK (goal_type IN ('morning', 'afternoon', 'evening')),\n  date TEXT NOT NULL,\n  status TEXT NOT NULL DEFAULT 'pending' CHECK (status IN ('pending', 'success', 'failure')),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  UNIQUE(user_id, date, goal_type)\n);\n\n-- RLS í™œì„±í™”\nALTER TABLE flexible_goals ENABLE ROW LEVEL SECURITY;\n\n-- ì •ì±… ìƒì„±\nCREATE POLICY \"Users can view their own flexible goals\" ON flexible_goals\n  FOR SELECT USING (auth.uid() = user_id);\n\nCREATE POLICY \"Users can insert their own flexible goals\" ON flexible_goals\n  FOR INSERT WITH CHECK (auth.uid() = user_id);\n\nCREATE POLICY \"Users can update their own flexible goals\" ON flexible_goals\n  FOR UPDATE USING (auth.uid() = user_id);\n\nCREATE POLICY \"Users can delete their own flexible goals\" ON flexible_goals\n  FOR DELETE USING (auth.uid() = user_id);\n```\n\n### ë°©ë²• 2: admin_insights í…Œì´ë¸” ìƒì„±\n```sql\n-- ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ í…Œì´ë¸” ìƒì„±\nCREATE TABLE IF NOT EXISTS admin_insights (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  title TEXT NOT NULL,\n  description TEXT NOT NULL,\n  insight_type TEXT NOT NULL CHECK (insight_type IN ('pattern', 'tip', 'stats')),\n  is_active BOOLEAN DEFAULT true,\n  display_order INTEGER DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP\n);\n\n-- RLS í™œì„±í™”\nALTER TABLE admin_insights ENABLE ROW LEVEL SECURITY;\n\n-- ì •ì±… ìƒì„±\nCREATE POLICY \"Anyone can view active admin insights\" ON admin_insights\n  FOR SELECT USING (is_active = true);\n\n-- ìƒ˜í”Œ ë°ì´í„° ì…ë ¥\nINSERT INTO admin_insights (title, description, insight_type, display_order) \nVALUES\n  ('íšŒê³ ì˜ í˜', 'íšŒê³ ë¥¼ ì‘ì„±í•˜ëŠ” ì‚¬ìš©ìëŠ” ëª©í‘œ ë‹¬ì„±ë¥ ì´ í‰ê·  23% ë†’ìŠµë‹ˆë‹¤.', 'pattern', 1),\n  ('í™©ê¸ˆ ì‹œê°„ëŒ€', 'ì˜¤í›„ 2-4ì‹œì— ëª©í‘œë¥¼ ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ì„±ê³µë¥ ì´ ê°€ì¥ ë†’ìŠµë‹ˆë‹¤.', 'pattern', 2),\n  ('ê¾¸ì¤€í•¨ì˜ ë²•ì¹™', 'ì£¼ 3íšŒ ì´ìƒ ëª©í‘œë¥¼ ì„¤ì •í•˜ëŠ” ì‚¬ìš©ìì˜ ì§€ì†ë¥ ì´ 85% ì´ìƒì…ë‹ˆë‹¤.', 'pattern', 3)\nON CONFLICT DO NOTHING;\n```\n\n## ğŸ¯ **ì¶”ì²œ ìˆœì„œ**\n\n1. **ë°©ë²• 1**ì„ ë¨¼ì € ì‹¤í–‰ (flexible_goals í…Œì´ë¸” ì¬ìƒì„±)\n2. **ë°©ë²• 2**ë¥¼ ì‹¤í–‰ (admin_insights í…Œì´ë¸” ìƒì„±)\n3. ì•±ì—ì„œ ìœ ì—°í•œ ëª©í‘œ ì„¤ì • í…ŒìŠ¤íŠ¸\n\nì´ë ‡ê²Œ í•˜ë©´ ëª¨ë“  ì˜¤ë¥˜ê°€ í•´ê²°ë©ë‹ˆë‹¤.","size_bytes":3600},"í–¥í›„_ì†Œì…œë¡œê·¸ì¸_ê³„íš.md":{"content":"# ì†Œì…œ ë¡œê·¸ì¸ í™•ì¥ ê³„íš\n\n## í˜„ì¬ ìƒíƒœ\n- ì´ë©”ì¼ í™•ì¸ ê¸°ëŠ¥ ë¹„í™œì„±í™”ë¡œ ì¦‰ì‹œ ë¡œê·¸ì¸ ê°€ëŠ¥\n- íšŒì›ê°€ì…/ë¡œê·¸ì¸/ë¹„íšŒì› ì²´í—˜ ëª¨ë“œ êµ¬í˜„ ì™„ë£Œ\n\n## í–¥í›„ ì†Œì…œ ë¡œê·¸ì¸ ì¶”ê°€ ê°€ëŠ¥\n\n### 1. Google ë¡œê·¸ì¸\n```bash\n# ì„¤ì¹˜í•  íŒ¨í‚¤ì§€\nnpx expo install @react-native-google-signin/google-signin\n```\n\n### 2. Kakao ë¡œê·¸ì¸\n```bash\n# ì„¤ì¹˜í•  íŒ¨í‚¤ì§€\nnpx expo install @react-native-seoul/kakao-login\n```\n\n### 3. Supabase ì„¤ì •\n- Supabase ëŒ€ì‹œë³´ë“œ â†’ Authentication â†’ Providers\n- Google, Kakao ë“± ì†Œì…œ ë¡œê·¸ì¸ í™œì„±í™”\n- ê° í”Œë«í¼ì˜ Client ID/Secret ì„¤ì •\n\n### 4. ì½”ë“œ ì˜ˆì‹œ (Google ë¡œê·¸ì¸)\n```typescript\n// src/store/userStore.tsì— ì¶”ê°€\nsignInWithGoogle: async () => {\n  const { data, error } = await supabase.auth.signInWithOAuth({\n    provider: 'google',\n  });\n  if (error) throw error;\n},\n```\n\n### 5. UI ì¶”ê°€\n- WelcomeScreenì— \"Googleë¡œ ì‹œì‘í•˜ê¸°\" ë²„íŠ¼\n- SignInScreenì— ì†Œì…œ ë¡œê·¸ì¸ ì˜µì…˜\n\n## ì¥ì \n- ì‚¬ìš©ì í¸ì˜ì„± ì¦ê°€\n- íšŒì›ê°€ì… ì¥ë²½ ë‚®ì¶¤\n- ì†Œì…œ í”„ë¡œí•„ ì •ë³´ ìë™ ì—°ë™ ê°€ëŠ¥\n\n## í˜„ì¬ êµ¬ì¡°ì˜ ìœ ì—°ì„±\n- ê¸°ì¡´ ì´ë©”ì¼ ë¡œê·¸ì¸ê³¼ ë³‘í–‰ ê°€ëŠ¥\n- ì‚¬ìš©ìê°€ ì„ íƒí•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì˜µì…˜ ì œê³µ\n- ë¹„íšŒì› ì²´í—˜ ëª¨ë“œë„ ìœ ì§€\n\ní˜„ì¬ ì´ë©”ì¼ í™•ì¸ ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”í•˜ëŠ” ê²ƒì€ ê°œë°œ í¸ì˜ì„±ì„ ìœ„í•œ ì„ì‹œ ì¡°ì¹˜ì´ë©°, \në‚˜ì¤‘ì— ì†Œì…œ ë¡œê·¸ì¸ì„ ì¶”ê°€í•˜ë©´ì„œ ì´ë©”ì¼ í™•ì¸ ê¸°ëŠ¥ì„ ë‹¤ì‹œ í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.","size_bytes":1488},"src/App.tsx":{"content":"import React, { useEffect } from 'react'\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom'\nimport Layout from './components/Layout'\nimport ProtectedRoute from './components/ProtectedRoute'\nimport SignInScreen from './screens/SignInScreen'\nimport SignUpScreen from './screens/SignUpScreen'\nimport ProfileSetupScreen from './screens/ProfileSetupScreen'\nimport GoalListScreen from './screens/GoalListScreen'\nimport GoalDetailScreen from './screens/GoalDetailScreen'\nimport TimeSelectScreen from './screens/TimeSelectScreen'\nimport GoalBatchScreen from './screens/GoalBatchScreen'\nimport RetrospectScreen from './screens/RetrospectScreen'\nimport HistoryCalendarScreen from './screens/HistoryCalendarScreen'\nimport DayDetailScreen from './screens/DayDetailScreen'\nimport useUserStore from './store/userStore'\nimport useProfileStore from './store/profileStore'\nimport { supabase } from './supabaseClient'\n\nfunction App() {\n  const { session, initialized, initializeAuth } = useUserStore()\n  const { profile, fetchProfile } = useProfileStore()\n\n  // ì¸ì¦ ì´ˆê¸°í™”\n  useEffect(() => {\n    initializeAuth()\n  }, [initializeAuth])\n\n  // ì„¸ì…˜ ë³€í™” ê°ì§€ ë° auth state change ë¦¬ìŠ¤ë„ˆ\n  useEffect(() => {\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(async (event, session) => {\n      console.log('ğŸ”„ Auth ìƒíƒœ ë³€ê²½:', event, session ? `ì„¸ì…˜ ìˆìŒ (${session.user.id})` : 'ì„¸ì…˜ ì—†ìŒ');\n      useUserStore.getState().setSession(session);\n    });\n\n    return () => subscription.unsubscribe();\n  }, [])\n\n  useEffect(() => {\n    if (session) {\n      fetchProfile().catch(console.error)\n    }\n  }, [session, fetchProfile])\n\n  // ì´ˆê¸°í™” ì¤‘ì´ë©´ ë¡œë”© í‘œì‹œ\n  if (!initialized) {\n    return (\n      <div style={{ \n        display: 'flex', \n        justifyContent: 'center', \n        alignItems: 'center', \n        height: '100vh',\n        fontSize: '18px'\n      }}>\n        ì•± ì´ˆê¸°í™” ì¤‘...\n      </div>\n    )\n  }\n\n  return (\n    <Router>\n      <Layout>\n        <Routes>\n          {/* ì¸ì¦ ë¼ìš°íŠ¸ */}\n          <Route path=\"/signin\" element={\n            session ? <Navigate to=\"/\" replace /> : <SignInScreen />\n          } />\n          <Route path=\"/signup\" element={\n            session ? <Navigate to=\"/\" replace /> : <SignUpScreen />\n          } />\n          \n          {/* í”„ë¡œí•„ ì„¤ì • ë¼ìš°íŠ¸ */}\n          <Route path=\"/profile-setup\" element={\n            <ProtectedRoute>\n              <ProfileSetupScreen />\n            </ProtectedRoute>\n          } />\n          \n          {/* ë©”ì¸ ì•± ë¼ìš°íŠ¸ */}\n          <Route path=\"/\" element={\n            <ProtectedRoute requireProfile>\n              <GoalListScreen />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/goal-detail\" element={\n            <ProtectedRoute requireProfile>\n              <GoalDetailScreen />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/time-select\" element={\n            <ProtectedRoute requireProfile>\n              <TimeSelectScreen />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/goal-batch\" element={\n            <ProtectedRoute requireProfile>\n              <GoalBatchScreen />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/retrospect\" element={\n            <ProtectedRoute requireProfile>\n              <RetrospectScreen />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/history\" element={\n            <ProtectedRoute requireProfile>\n              <HistoryCalendarScreen />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/day-detail\" element={\n            <ProtectedRoute requireProfile>\n              <DayDetailScreen />\n            </ProtectedRoute>\n          } />\n        </Routes>\n      </Layout>\n    </Router>\n  )\n}\n\nexport default App\n","size_bytes":3852},"src/main.tsx":{"content":"import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App'\nimport './styles/global.css'\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n)\n","size_bytes":240},"src/supabaseClient.ts":{"content":"import { createClient } from '@supabase/supabase-js';\nimport Constants from 'expo-constants';\n\nconst supabaseUrl = Constants.expoConfig?.extra?.EXPO_PUBLIC_SUPABASE_URL || process.env.EXPO_PUBLIC_SUPABASE_URL;\nconst supabaseAnonKey = Constants.expoConfig?.extra?.EXPO_PUBLIC_SUPABASE_ANON_KEY || process.env.EXPO_PUBLIC_SUPABASE_ANON_KEY;\n\nif (!supabaseUrl || !supabaseAnonKey) {\n  console.error('Missing Supabase environment variables - check configuration');\n  throw new Error('Missing Supabase environment variables');\n}\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\n  auth: {\n    autoRefreshToken: true,\n    persistSession: true,\n    detectSessionInUrl: false,\n  },\n});\n\nexport { supabaseUrl };","size_bytes":722},"src/components/Layout.tsx":{"content":"import React from 'react'\nimport Navigation from './Navigation'\nimport useUserStore from '../store/userStore'\n\ninterface LayoutProps {\n  children: React.ReactNode\n}\n\nconst Layout: React.FC<LayoutProps> = ({ children }) => {\n  const { session } = useUserStore()\n\n  return (\n    <div className=\"app-layout\">\n      {session && <Navigation />}\n      <main className=\"main-content\">\n        {children}\n      </main>\n    </div>\n  )\n}\n\nexport default Layout\n","size_bytes":451},"src/components/Navigation.tsx":{"content":"// Navigation ì»´í¬ë„ŒíŠ¸ëŠ” React Navigation Tab Barë¡œ ëŒ€ì²´ë˜ì–´ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n// React Native ì•±ì—ì„œëŠ” BottomTabNavigatorë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\nexport default null;","size_bytes":186},"src/components/ProtectedRoute.tsx":{"content":"// ProtectedRouteëŠ” React Navigationìœ¼ë¡œ ëŒ€ì²´ë˜ì–´ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.\n// React Native ì•±ì—ì„œëŠ” NavigationContainerì™€ Stack.Navigatorë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\nexport default null;\n","size_bytes":193},"src/data/notificationMessages.ts":{"content":"// ì•Œë¦¼ ë©”ì‹œì§€ ë°ì´í„° (ìì²´ ì½”ë“œ DB)\nexport interface NotificationMessage {\n  id: number;\n  type: \"general\" | \"goal\";\n  message: string;\n  variables?: string[];\n}\n\nexport const NOTIFICATION_MESSAGES: NotificationMessage[] = [\n  // Generalí˜• (ë‹‰ë„¤ì„ë§Œ ì‚¬ìš©)\n  {\n    id: 1,\n    type: \"general\",\n    message: \"ì˜¤ëŠ˜ì˜ ë§ì„¤ì„ì´ ë‚´ì¼ì˜ í›„íšŒê°€ ë˜ì§€ ì•Šë„ë¡!\",\n    variables: [],\n  },\n  {\n    id: 2,\n    type: \"general\",\n    message: \"ë§ì„¤ì„ë³´ë‹¤ ë¯¸ë˜ì˜ ë‚­ë§Œì„ ìœ„í•´!\",\n    variables: [],\n  },\n  {\n    id: 10,\n    type: \"general\",\n    message: \"ìƒê°ì€ ì²œì²œíˆ í–‰ë™ì€ ë¹ ë¥´ê²Œ\",\n    variables: [],\n  },\n  { id: 11, type: \"general\", message: \"ê°€ë³ê²Œ ì‹œì‘í•´ë³´ì§€ì£ !\", variables: [] },\n  {\n    id: 12,\n    type: \"general\",\n    message: \"ì‘ì€ ì‹œë„ê°€ ì„±ê³µì„ì„ ë§Œë“­ë‹ˆë‹¤.\",\n    variables: [],\n  },\n  {\n    id: 13,\n    type: \"general\",\n    message: \"{display_name}ë‹˜ì˜ ì†Œì¤‘í•œ ë§ˆìŒì…ë‹ˆë‹¤.\",\n    variables: [\"display_name\"],\n  },\n  {\n    id: 14,\n    type: \"general\",\n    message: \"ì§€ê¸ˆì˜ í–‰ë™ì´ {display_name}ë‹˜ì˜ ë¯¸ë˜ë¥¼ ë§Œë“­ë‹ˆë‹¤!\",\n    variables: [\"display_name\"],\n  },\n  {\n    id: 15,\n    type: \"general\",\n    message: \"ì˜¤ëŠ˜ì˜ ê±¸ìŒì€ ì–´ì œ ê¿ˆ ìœ„ì— ìˆì–´ìš”.\",\n    variables: [],\n  },\n  {\n    id: 16,\n    type: \"general\",\n    message: \"ë¬´ì—‡ì„ í•˜ê¸°ë¡œ í–ˆëŠ”ì§€, ì™œ ì‹œì‘í–ˆëŠ”ì§€ ë– ì˜¬ë ¤ë³´ì„¸ìš”.\",\n    variables: [],\n  },\n  {\n    id: 17,\n    type: \"general\",\n    message: \"This is the way for you.\",\n    variables: [],\n  },\n  {\n    id: 18,\n    type: \"general\",\n    message: \"ë©ˆì¶”ë©´ ì–´ì œì˜ ë‚˜ë¥¼ ë†“ì¹  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\",\n    variables: [],\n  },\n  {\n    id: 19,\n    type: \"general\",\n    message: \"ê·¸ ìˆœê°„ì„ ìœ„í•´ ê³„íší•œê±° ì•„ë‹Œê°€ìš”?\",\n    variables: [],\n  },\n  {\n    id: 20,\n    type: \"general\",\n    message: \"í•´ë³´ë©´ ìƒê°ë³´ë‹¤ ê´œì°®ì„ê²ë‹ˆë‹¤.\",\n    variables: [],\n  },\n  {\n    id: 21,\n    type: \"general\",\n    message: \"ë‚­ë§Œì€ ì›€ì§ì¼ ë•Œ ì‹œì‘ë¼ìš”.\",\n    variables: [],\n  },\n  {\n    id: 22,\n    type: \"general\",\n    message: \"ì˜¤ëŠ˜ì˜ ì‹œë„ê°€ {display_name}ë‹˜ì˜ ìœ„ëŒ€í•œ ë„ì•½ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\",\n    variables: [\"display_name\"],\n  },\n  { id: 23, type: \"general\", message: \"For you For all of us\", variables: [] },\n  {\n    id: 24,\n    type: \"general\",\n    message: \"ì–¸ì  ê°€ ì°¾ì•„ì˜¬ The Better Day, ê·¸ í–‰ë³µí•œ ìˆœê°„ì„ ìœ„í•´\",\n    variables: [],\n  },\n  {\n    id: 25,\n    type: \"general\",\n    message: \"ê²°ì‹¬ì€ í–‰ë™ê³¼ ë§Œë‚˜ ì˜ë¯¸ë¥¼ ì–»ìŠµë‹ˆë‹¤!\",\n    variables: [],\n  },\n  {\n    id: 26,\n    type: \"general\",\n    message: \"ì§€ê¸ˆ ì´ í–‰ë™ì´ ë³€í™”ë¥¼ ìœ„í•œ ì™„ë²½í•œ ê³„ê¸°ì—ìš”.\",\n    variables: [],\n  },\n  {\n    id: 27,\n    type: \"general\",\n    message:\n      \"ì ì‹œ í˜ë“¤ê³ , ì ì‹œ ë§ì„¤ì—¬ì ¸ë„ {display_name}ë‹˜ì€ ê²°êµ­ í•´ë‚¼ ê±°ì˜ˆìš”.\",\n    variables: [\"display_name\"],\n  },\n  {\n    id: 28,\n    type: \"general\",\n    message: \"{display_name}ë‹˜ì˜ ì´ì•¼ê¸°ë¥¼ ë³´ì—¬ì£¼ì„¸ìš”.\",\n    variables: [\"display_name\"],\n  },\n  {\n    id: 29,\n    type: \"general\",\n    message: \"ìƒê°ë³´ë‹¤ í›¨ì”¬ ë©‹ì§€ê³  ë¿Œë“¯í•  ê±°ì˜ˆìš”.\",\n    variables: [],\n  },\n  {\n    id: 30,\n    type: \"general\",\n    message: \"ì¡°ê¸ˆì”© í•œ ë°œì§ì”©, ë°”ë¡œ ì§€ê¸ˆë¶€í„°!\",\n    variables: [],\n  },\n  {\n    id: 31,\n    type: \"general\",\n    message: \"{display_name}ë‹˜ì´ ì›í•˜ëŠ” ì‚¶ì„ ìœ„í•˜ì—¬. Cheers\",\n    variables: [\"display_name\"],\n  },\n  {\n    id: 32,\n    type: \"general\",\n    message: \"ë” ë‚˜ì€ ë‚´ì¼ì€ ì˜¤ëŠ˜ë¶€í„° ì‹œì‘ë¼ìš”.\",\n    variables: [],\n  },\n  {\n    id: 33,\n    type: \"general\",\n    message: \"ì‘ì€ ì‹œë„ì—ì„œ ê¿ˆì€ ì ì  ì»¤ì§‘ë‹ˆë‹¤!.\",\n    variables: [],\n  },\n  {\n    id: 45,\n    type: \"general\",\n    message:\n      \"ì˜¤ëŠ˜ ë””ë”˜ ì´ í•œ ê±¸ìŒì´, ë¹„ë¡ ì¡°ìš©í•˜ê³  ì‘ì„ì§€ë¼ë„, ë‹¬ì˜ ë°œìêµ­ì²˜ëŸ¼ ë¶ˆê°€ëŠ¥ì„ í˜„ì‹¤ë¡œ ë°”ê¾¸ëŠ” ê³„ë‹¨ì´ ë  ê²ƒì…ë‹ˆë‹¤.\",\n    variables: [],\n  },\n\n  // Goalí˜• (ëª©í‘œ ì œëª© + ë‹‰ë„¤ì„ ì‚¬ìš©, 20ì ì´í•˜ ëª©í‘œì—ë§Œ ì ìš©)\n  {\n    id: 3,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, íƒ€ì´ë° Is ë†”ìš°\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 4,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ë‚´ì¼ì€ ì˜ì›íˆ ì˜¤ëŠ˜ì´ ë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 5,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, {display_name}ë‹˜ë§Œì´ í•´ë‚¼ ìˆ˜ ìˆì–´ìš”.\",\n    variables: [\"goal\", \"display_name\"],\n  },\n  {\n    id: 6,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ì´ê±´ ì§€ê¸ˆ ì´ ìˆœê°„ í•´ì•¼í•©ë‹ˆë‹¤.\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 7,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ê·¸ë•Œì˜ ê·¸ ë§ˆìŒ, ê·¸ëŒ€ë¡œ ì‹¤ì²œí•˜ì„¸ìš”!\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 8,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ì˜¤ëŠ˜ì´ ê¸°ë…ì¼ì´ ë  ê±°ì˜ˆìš”.\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 9,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, {display_name}ë‹˜ì˜ ìœ„ëŒ€í•œ ë„ì•½ì„ ìœ„í•˜ì—¬ Cheers\",\n    variables: [\"goal\", \"display_name\"],\n  },\n  {\n    id: 34,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ì´ ì„ íƒì€ {display_name}ë‹˜ì˜ ê¸¸ì´ì—ìš”.\",\n    variables: [\"goal\", \"display_name\"],\n  },\n  {\n    id: 35,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ì§€ê¸ˆì„ ë†“ì¹˜ì§€ ë§ˆì„¸ìš”.\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 36,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ë§ˆìŒì˜ ì´ìœ ë¥¼ ê¸°ì–µí•´ì£¼ì„¸ìš”.\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 37,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, í–‰ë™ìœ¼ë¡œ ì§„ì‹¬ì„ ë³´ì—¬ì¤˜ìš”.\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 38,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ë¯¸ë˜ì˜ ë‚­ë§Œì´ {display_name}ë‹˜ì„ ê¸°ë‹¤ë ¤ìš”.\",\n    variables: [\"goal\", \"display_name\"],\n  },\n  {\n    id: 39,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ì˜¤ëŠ˜ì˜ ê²°ì •ì€ ë¹›ë‚  ê±°ì˜ˆìš”.\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 40,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, {display_name}ë‹˜ì˜ ê¿ˆì— ê°€ê¹Œì›Œì‹œê¸°ë¥¼...\",\n    variables: [\"goal\", \"display_name\"],\n  },\n  {\n    id: 41,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ê²°êµ­ ëê¹Œì§€ ê°€ë©´ ì´ê¹€!\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 42,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, í›„íšŒ ì—†ëŠ” ì˜¤ëŠ˜ì„ ë§Œë“¤ì–´ìš”.\",\n    variables: [\"goal\"],\n  },\n  {\n    id: 43,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, {display_name}ë‹˜ì˜ ìœ„ëŒ€í•œ ë„ì•½ì„ ìœ„í•˜ì—¬. Cheers\",\n    variables: [\"goal\", \"display_name\"],\n  },\n  {\n    id: 44,\n    type: \"goal\",\n    message:\n      \"ã€{goal}ã€, {display_name}ë‹˜ì˜ ê¿ˆì„, í¬ë§ì„, ë‚­ë§Œì„ í˜„ì‹¤ë¡œ ë§Œë“¤ì–´ë´ìš”.\",\n    variables: [\"goal\", \"display_name\"],\n  },\n  {\n    id: 46,\n    type: \"goal\",\n    message: \"ã€{goal}ã€, ì–¸ì  ê°€ ì°¾ì•„ì˜¬ The Better Day, ê·¸ í–‰ë³µí•œ ìˆœê°„ì„ ìœ„í•´\",\n    variables: [\"goal\"],\n  },\n];\n\n// ë©”ì‹œì§€ ì¡°íšŒ í•¨ìˆ˜ë“¤\nexport const getGeneralMessages = (): NotificationMessage[] => {\n  return NOTIFICATION_MESSAGES.filter((msg) => msg.type === \"general\");\n};\n\nexport const getGoalMessages = (): NotificationMessage[] => {\n  return NOTIFICATION_MESSAGES.filter((msg) => msg.type === \"goal\");\n};\n\nexport const getMessageById = (id: number): NotificationMessage | undefined => {\n  return NOTIFICATION_MESSAGES.find((msg) => msg.id === id);\n};\n\nexport const getRandomMessage = (\n  type?: \"general\" | \"goal\",\n): NotificationMessage => {\n  const messages = type\n    ? NOTIFICATION_MESSAGES.filter((msg) => msg.type === type)\n    : NOTIFICATION_MESSAGES;\n  const randomIndex = Math.floor(Math.random() * messages.length);\n  return messages[randomIndex];\n};\n\n// ë³€ìˆ˜ ì¹˜í™˜ í•¨ìˆ˜\nexport const replaceVariables = (\n  message: string,\n  variables: { [key: string]: string },\n): string => {\n  let result = message;\n  console.log(\"ğŸ”„ ë³€ìˆ˜ ì¹˜í™˜ ì‹œì‘:\", { message, variables });\n\n  Object.entries(variables).forEach(([key, value]) => {\n    const regex = new RegExp(`\\\\{${key}\\\\}`, \"g\");\n    const beforeReplace = result;\n    result = result.replace(regex, value);\n    console.log(`  ${key}: \"${beforeReplace}\" â†’ \"${result}\"`);\n  });\n\n  console.log(\"âœ… ë³€ìˆ˜ ì¹˜í™˜ ì™„ë£Œ:\", result);\n  return result;\n};\n","size_bytes":8074},"src/helpers/motivationSystem.ts":{"content":"// ì—°ì† ì„±ê³µ ìºë¦­í„° ì‹œìŠ¤í…œ ë° ê³¼í•™ì  ì¸ì‚¬ì´íŠ¸ ê´€ë¦¬\n\nexport interface MotivationData {\n  successStreak: number;\n  failureStreak: number;\n  successRate: number;\n  totalGoals: number;\n  successfulGoals: number;\n}\n\nexport interface ScientificInsight {\n  id: string;\n  title: string;\n  content: string;\n  source: string;\n  category: 'psychology' | 'neuroscience' | 'behavior' | 'productivity';\n  successRateMin: number;\n  successRateMax: number;\n}\n\n// ì—°ì† ì„±ê³µì— ë”°ë¥¸ ìºë¦­í„° ë°˜í™˜\nexport const getSuccessCharacter = (streak: number): string => {\n  if (streak === 0) return 'ğŸ˜';\n  if (streak === 1) return 'ğŸ‘';\n  if (streak === 2) return 'ğŸ‘ğŸ‘';\n  if (streak === 3) return 'ğŸ™Œ';\n  if (streak >= 4) {\n    // ì¶”í›„ GIF íŒŒì¼ë¡œ êµì²´ ì˜ˆì •\n    const animations = ['ğŸ‰', 'ğŸš€', 'â­', 'ğŸ†', 'ğŸ’ª', 'ğŸ”¥'];\n    return animations[Math.min(streak - 4, animations.length - 1)];\n  }\n  return 'ğŸ˜';\n};\n\n// ì—°ì† íŒ¨ë°°ì— ë”°ë¥¸ ìºë¦­í„° ë°˜í™˜ (ìµœëŒ€ 2ë‹¨ê³„)\nexport const getFailureCharacter = (streak: number): string => {\n  if (streak === 0) return 'ğŸ˜';\n  if (streak === 1) return 'ğŸ˜”';\n  if (streak >= 2) return 'ğŸ˜';\n  return 'ğŸ˜';\n};\n\n// ê³¼í•™ì  ì¸ì‚¬ì´íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ (ì‹¤ì œ ì—°êµ¬ ê¸°ë°˜)\nexport const scientificInsights: ScientificInsight[] = [\n  {\n    id: 'habit_formation_66_days',\n    title: 'ìŠµê´€ í˜•ì„±ì˜ ê³¼í•™',\n    content: 'ëŸ°ë˜ëŒ€í•™êµ ì—°êµ¬ì— ë”°ë¥´ë©´ ìƒˆë¡œìš´ ìŠµê´€ì´ ìë™í™”ë˜ê¸°ê¹Œì§€ í‰ê·  66ì¼ì´ ê±¸ë¦½ë‹ˆë‹¤. ê¾¸ì¤€í•¨ì´ ì™„ë²½í•¨ë³´ë‹¤ ì¤‘ìš”í•©ë‹ˆë‹¤.',\n    source: 'European Journal of Social Psychology (2010)',\n    category: 'psychology',\n    successRateMin: 0,\n    successRateMax: 50\n  },\n  {\n    id: 'implementation_intention',\n    title: 'ì‹¤í–‰ ì˜ë„ì˜ í˜',\n    content: 'ë‰´ìš•ëŒ€í•™êµ ì—°êµ¬: \"ì–¸ì œ, ì–´ë””ì„œ, ë¬´ì—‡ì„\" êµ¬ì²´ì ìœ¼ë¡œ ê³„íší•˜ë©´ ëª©í‘œ ë‹¬ì„±ë¥ ì´ 2-3ë°° ì¦ê°€í•©ë‹ˆë‹¤.',\n    source: 'Advances in Experimental Social Psychology (1999)',\n    category: 'psychology',\n    successRateMin: 51,\n    successRateMax: 70\n  },\n  {\n    id: 'dopamine_reward_system',\n    title: 'ë„íŒŒë¯¼ê³¼ ë³´ìƒ ì‹œìŠ¤í…œ',\n    content: 'ìŠ¤íƒ í¬ë“œ ëŒ€í•™ ì—°êµ¬: ì‘ì€ ì„±ì·¨ì—ë„ ë‡ŒëŠ” ë„íŒŒë¯¼ì„ ë¶„ë¹„í•˜ì—¬ ë” í° ë™ê¸°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. ë‹¹ì‹ ì˜ ë…¸ë ¥ì´ ë‡Œê³¼í•™ì ìœ¼ë¡œ ë³´ìƒë°›ê³  ìˆìŠµë‹ˆë‹¤.',\n    source: 'Nature Neuroscience (2016)',\n    category: 'neuroscience',\n    successRateMin: 71,\n    successRateMax: 85\n  },\n  {\n    id: 'flow_state_performance',\n    title: 'ëª°ì… ìƒíƒœì˜ ë¹„ë°€',\n    content: 'MIT ì—°êµ¬: ë†’ì€ ì„±ì·¨ìë“¤ì€ \"ì ì ˆí•œ ë‚œì´ë„\"ì—ì„œ ìµœê³  ì„±ëŠ¥ì„ ë³´ì…ë‹ˆë‹¤. 80% ì´ìƒ ì„±ê³µë¥ ì€ ìƒìœ„ 10%ì— í•´ë‹¹í•©ë‹ˆë‹¤.',\n    source: 'Journal of Experimental Psychology (2018)',\n    category: 'psychology',\n    successRateMin: 86,\n    successRateMax: 100\n  },\n  {\n    id: 'self_efficacy_theory',\n    title: 'ìê¸°íš¨ëŠ¥ê° ì´ë¡ ',\n    content: 'ì•Œë²„íŠ¸ ë°˜ë‘ë¼ ì—°êµ¬: ì‘ì€ ì„±ê³µ ê²½í—˜ì´ ìŒ“ì´ë©´ ë” í° ë„ì „ì— ëŒ€í•œ ìì‹ ê°ì´ ì¦ê°€í•©ë‹ˆë‹¤. ì§€ê¸ˆì˜ ì„±ì·¨ê°€ ë¯¸ë˜ì˜ ì„±ê³µì„ ë§Œë“­ë‹ˆë‹¤.',\n    source: 'Psychological Review (1977)',\n    category: 'psychology',\n    successRateMin: 41,\n    successRateMax: 70\n  },\n  {\n    id: 'cognitive_behavioral_change',\n    title: 'ì¸ì§€í–‰ë™ ë³€í™”',\n    content: 'í•˜ë²„ë“œ ì˜ëŒ€ ì—°êµ¬: íŒ¨ë°°ë¥¼ \"í•™ìŠµ ê¸°íšŒ\"ë¡œ ì¸ì‹í•˜ëŠ” ì‚¬ëŒë“¤ì´ ì¥ê¸°ì ìœ¼ë¡œ ë” ë†’ì€ ì„±ê³µë¥ ì„ ë³´ì…ë‹ˆë‹¤.',\n    source: 'Cognitive Therapy and Research (2015)',\n    category: 'psychology',\n    successRateMin: 20,\n    successRateMax: 40\n  }\n];\n\n// ì„±ê³µë¥ ì— ë”°ë¥¸ ì¸ì‚¬ì´íŠ¸ ë°˜í™˜\nexport const getPersonalizedInsight = (successRate: number): ScientificInsight => {\n  const applicableInsights = scientificInsights.filter(\n    insight => successRate >= insight.successRateMin && successRate <= insight.successRateMax\n  );\n  \n  if (applicableInsights.length === 0) {\n    return scientificInsights[0]; // ê¸°ë³¸ ì¸ì‚¬ì´íŠ¸\n  }\n  \n  // ëœë¤í•˜ê²Œ ì„ íƒ\n  const randomIndex = Math.floor(Math.random() * applicableInsights.length);\n  return applicableInsights[randomIndex];\n};\n\n// ì„±ê³µë¥ ì— ë”°ë¥¸ ì‘ì› ë©”ì‹œì§€\nexport const getMotivationalMessage = (data: MotivationData): string => {\n  const { successRate, successStreak, totalGoals } = data;\n  \n  if (successRate >= 90) {\n    return `ğŸ† ë†€ë¼ìš´ ì„±ì·¨ì…ë‹ˆë‹¤! ${successStreak}ì—°ìŠ¹ì€ ìƒìœ„ 5% ìˆ˜ì¤€ì…ë‹ˆë‹¤.`;\n  }\n  \n  if (successRate >= 80) {\n    return `â­ í™˜ìƒì ì…ë‹ˆë‹¤! ì—°êµ¬ì— ë”°ë¥´ë©´ 80% ì´ìƒ ì„±ê³µë¥ ì€ ë§¤ìš° ìš°ìˆ˜í•œ ìˆ˜ì¤€ì…ë‹ˆë‹¤.`;\n  }\n  \n  if (successRate >= 70) {\n    return `ğŸ’ª í›Œë¥­í•œ í˜ì´ìŠ¤ì…ë‹ˆë‹¤! ê¾¸ì¤€í•¨ì´ ì™„ë²½í•¨ì„ ì´ê¹ë‹ˆë‹¤.`;\n  }\n  \n  if (successRate >= 50) {\n    return `ğŸš€ ì ˆë°˜ ì´ìƒ ì„±ê³µ! ìŠµê´€ í˜•ì„±ì˜ ì¤‘ìš”í•œ ë‹¨ê³„ë¥¼ ì§€ë‚˜ê³  ìˆìŠµë‹ˆë‹¤.`;\n  }\n  \n  if (successRate >= 30) {\n    return `ğŸ“ˆ ì„±ì¥ ì¤‘ì…ë‹ˆë‹¤! ë§¤ë²ˆì˜ ì‹œë„ê°€ ë‡Œë¥¼ ë” ê°•í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.`;\n  }\n  \n  if (totalGoals < 5) {\n    return `ğŸŒ± ì‹œì‘ì´ ë°˜ì…ë‹ˆë‹¤! ì‘ì€ ëª©í‘œë¶€í„° ì°¨ê·¼ì°¨ê·¼ ìŒ“ì•„ê°€ì„¸ìš”.`;\n  }\n  \n  return `ğŸ’¡ ì‹¤íŒ¨ëŠ” ì„±ê³µì˜ ì–´ë¨¸ë‹ˆì…ë‹ˆë‹¤. ì—°êµ¬ì— ë”°ë¥´ë©´ ì‹¤íŒ¨ë¥¼ í†µí•´ ë” ê°•í•œ ìŠµê´€ì´ í˜•ì„±ë©ë‹ˆë‹¤.`;\n};\n\n// ìºë¦­í„° ìƒíƒœ ë©”ì‹œì§€\nexport const getCharacterMessage = (streak: number, isSuccess: boolean): string => {\n  if (isSuccess) {\n    if (streak === 1) return \"ì²« ì„±ê³µ! ì¢‹ì€ ì‹œì‘ì´ì—ìš” ğŸ‘\";\n    if (streak === 2) return \"2ì—°ìŠ¹! íƒ„ë ¥ì„ ë°›ê³  ìˆì–´ìš” ğŸ‘ğŸ‘\";\n    if (streak === 3) return \"3ì—°ìŠ¹! ì •ë§ ë©‹ì ¸ìš” ğŸ™Œ\";\n    if (streak >= 4) return `${streak}ì—°ìŠ¹! ìµœê³ ì˜ ì»¨ë””ì…˜ì´ì—ìš”! ğŸ‰`;\n  } else {\n    if (streak === 1) return \"ê´œì°®ì•„ìš”, ë‹¤ìŒ ê¸°íšŒì—! ğŸ˜”\";\n    if (streak >= 2) return \"í˜ë“¤ì§€ë§Œ í¬ê¸°í•˜ì§€ ë§ˆì„¸ìš” ğŸ˜\";\n  }\n  return \"ìƒˆë¡œìš´ ì‹œì‘ì„ ì‘ì›í•©ë‹ˆë‹¤! ğŸ˜\";\n};","size_bytes":5886},"src/helpers/notificationScheduler.ts":{"content":"// ğŸ“± ê°„ì†Œí™”ëœ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ëŸ¬ - í†µí•© ê´€ë¦¬ì ì‚¬ìš©\nimport { Platform } from 'react-native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Goal } from '../store/goalStore';\nimport { UnifiedNotificationManager } from '../utils/unifiedNotificationManager';\n\nconst notificationManager = UnifiedNotificationManager.getInstance();\n\nexport const requestNotificationPermission = async (): Promise<boolean> => {\n  return await notificationManager.requestPermission();\n};\n\nexport const scheduleGoalAlarm = async (goalId: string, title: string, targetTime: Date, userDisplayName?: string): Promise<void> => {\n  console.log('ğŸ”” ëª©í‘œ ì•Œë¦¼ ì„¤ì •:', {\n    ëª©í‘œ: title,\n    ì„¤ì •ì‹œê°„: targetTime.toISOString(),\n    ID: goalId\n  });\n\n  // ëª©í‘œ ì‹œê°„ ê²€ì¦\n  const now = new Date();\n  \n  if (isNaN(targetTime.getTime())) {\n    console.log('âŒ ì˜ëª»ëœ ëª©í‘œ ì‹œê°„ í˜•ì‹:', targetTime);\n    return;\n  }\n  \n  if (targetTime <= now) {\n    console.log('â° ëª©í‘œ ì‹œê°„ì´ ì´ë¯¸ ì§€ë‚˜ì„œ ì•Œë¦¼ ì„¤ì • ì•ˆí•¨:', targetTime.toLocaleString('ko-KR'));\n    return;\n  }\n\n  console.log('âœ… ìœ íš¨í•œ ëª©í‘œ ì‹œê°„ í™•ì¸:', targetTime.toLocaleString('ko-KR'));\n\n  // ì‚¬ìš©ì ì•Œë¦¼ ì„¤ì • í™•ì¸\n  const settingsString = await AsyncStorage.getItem('notificationSettings');\n  const settings = settingsString ? JSON.parse(settingsString) : { goalAlarms: true };\n  \n  if (!settings.goalAlarms) {\n    console.log(`ğŸ”• ëª©í‘œ ì•Œë¦¼ ë¹„í™œì„±í™”ë¨: ${title}`);\n    return;\n  }\n\n  const hasPermission = await requestNotificationPermission();\n  if (!hasPermission) {\n    console.log(`ğŸš« ì•Œë¦¼ ê¶Œí•œ ì—†ìŒ: ${title}`);\n    return;\n  }\n\n  // í†µí•© ì•Œë¦¼ ê´€ë¦¬ìë¥¼ í†µí•œ ì•Œë¦¼ ì„¤ì •\n  await notificationManager.scheduleGoalNotification(goalId, title, targetTime);\n};\n\nexport const cancelGoalAlarm = async (goalId: string): Promise<void> => {\n  await notificationManager.cancelNotification(goalId);\n};\n\n// íšŒê³  ì•Œë¦¼ ê´€ë ¨ í•¨ìˆ˜ë“¤\nexport const scheduleRetrospectReminderImmediate = async (): Promise<void> => {\n  const now = new Date();\n  const reminderTime = new Date(now.getTime() + 30 * 60 * 1000); // 30ë¶„ í›„\n  await notificationManager.scheduleRetrospectNotification(reminderTime);\n};\n\nexport const scheduleRetrospectReminder = async (targetTime: Date): Promise<void> => {\n  await notificationManager.scheduleRetrospectNotification(targetTime);\n};\n\nexport const cancelRetrospectReminder = async (): Promise<void> => {\n  await notificationManager.cancelNotification('retrospect-reminder');\n};\n\n// ì•Œë¦¼ í™•ì¸ ë° ê´€ë¦¬ í•¨ìˆ˜ë“¤\nexport const getAllScheduledNotifications = async (): Promise<void> => {\n  await notificationManager.getAllScheduledNotifications();\n};\n\nexport const cancelAllNotifications = async (): Promise<void> => {\n  await notificationManager.cancelAllNotifications();\n};\n\nexport const safeNotificationCleanup = async (): Promise<void> => {\n  console.log('ğŸ›¡ï¸ ì•ˆì „í•œ ì•Œë¦¼ ì •ë¦¬ ì‹œì‘');\n  await notificationManager.cancelAllNotifications();\n};\n\n// ë ˆê±°ì‹œ í•¨ìˆ˜ë“¤ (í˜¸í™˜ì„± ìœ ì§€)\nexport const checkAllScheduledNotifications = async (): Promise<void> => {\n  await getAllScheduledNotifications();\n};\n\nexport const emergencyNotificationCleanupForApp = async (): Promise<void> => {\n  console.log('ğŸš¨ ê¸´ê¸‰ ì•Œë¦¼ ì •ë¦¬ ì‹œì‘');\n  await cancelAllNotifications();\n};","size_bytes":3368},"src/helpers/smartNotificationSystem.ts":{"content":"import * as Notifications from 'expo-notifications';\nimport { supabase } from '../supabaseClient';\nimport { Goal } from '../store/goalStore';\nimport { \n  NotificationMessage, \n  NOTIFICATION_MESSAGES,\n  getGeneralMessages,\n  getGoalMessages,\n  getMessageById,\n  getRandomMessage,\n  replaceVariables\n} from '../data/notificationMessages';\n\n// ì•Œë¦¼ ë¡œê·¸ íƒ€ì… ì •ì˜\nexport interface NotificationLog {\n  id: string;\n  user_id: string;\n  goal_id: string;\n  message_id: number;\n  message_type: 'general' | 'goal';\n  sent_at: string;\n  goal_completed: boolean;\n  completed_at: string | null;\n}\n\n// ì•Œë¦¼ ê¶Œí•œ ìš”ì²­\nexport const requestNotificationPermission = async (): Promise<boolean> => {\n  console.log('ğŸ”” ì•Œë¦¼ ê¶Œí•œ ìš”ì²­ í™œì„±í™”');\n  const { status: existingStatus } = await Notifications.getPermissionsAsync();\n  let finalStatus = existingStatus;\n  \n  if (existingStatus !== 'granted') {\n    const { status } = await Notifications.requestPermissionsAsync();\n    finalStatus = status;\n  }\n  \n  return finalStatus === 'granted';\n};\n\n// ëª©í‘œ ê¸¸ì´ í™•ì¸ (20ê¸€ì ì´í•˜)\nexport const canUseGoalNotification = (goalTitle: string): boolean => {\n  return goalTitle.length <= 20;\n};\n\n// ì•Œë¦¼ ë©”ì‹œì§€ ì„ íƒ í•¨ìˆ˜\nexport const selectNotificationMessage = async (\n  goal: Goal,\n  displayName?: string\n): Promise<{ message: string; messageId: number; messageType: 'general' | 'goal' } | null> => {\n  try {\n    // ë‹‰ë„¤ì„ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ \"ê²ŒìŠ¤íŠ¸\" ì‚¬ìš©\n    const finalDisplayName = displayName || \"ê²ŒìŠ¤íŠ¸\";\n    console.log('ğŸ“ ì•Œë¦¼ ë©”ì‹œì§€ ëŒ€ìƒ:', { displayName: finalDisplayName, isGuest: !displayName });\n    \n    // ëª©í‘œ ì œëª© ê¸¸ì´ ì²´í¬ (20ì ì´í•˜ì¸ ê²½ìš° goalí˜• ì‚¬ìš© ê°€ëŠ¥)\n    const canUseGoalType = canUseGoalNotification(goal.title);\n    \n    let selectedMessage: NotificationMessage;\n    \n    if (canUseGoalType) {\n      // Goalí˜•ê³¼ Generalí˜• ì¤‘ ëœë¤ ì„ íƒ\n      const messageType = Math.random() > 0.5 ? 'goal' : 'general';\n      selectedMessage = getRandomMessage(messageType);\n    } else {\n      // ì œëª©ì´ ê¸¸ë©´ Generalí˜•ë§Œ ì‚¬ìš©\n      selectedMessage = getRandomMessage('general');\n    }\n    \n    // ë³€ìˆ˜ ì¹˜í™˜\n    const variables: { [key: string]: string } = {};\n    \n    if (selectedMessage.variables) {\n      for (const variable of selectedMessage.variables) {\n        switch (variable) {\n          case 'goal':\n            variables.goal = goal.title;\n            break;\n          case 'display_name':\n            variables.display_name = finalDisplayName;\n            break;\n        }\n      }\n    }\n    \n    console.log('ğŸ“ ì•Œë¦¼ ë©”ì‹œì§€ ë³€ìˆ˜ ì„¤ì •:', { \n      goalTitle: goal.title, \n      displayName: finalDisplayName, \n      variables \n    });\n    \n    const finalMessage = replaceVariables(selectedMessage.message, variables);\n    \n    return {\n      message: finalMessage,\n      messageId: selectedMessage.id,\n      messageType: selectedMessage.type\n    };\n    \n  } catch (error) {\n    console.error('ì•Œë¦¼ ë©”ì‹œì§€ ì„ íƒ ì˜¤ë¥˜:', error);\n    return null;\n  }\n};\n\n// ì•Œë¦¼ ë¡œê·¸ ì €ì¥\nexport const saveNotificationLog = async (\n  goalId: string,\n  messageId: number,\n  messageType: 'general' | 'goal'\n): Promise<void> => {\n  try {\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) return;\n\n    const { error } = await supabase\n      .from('notification_logs')\n      .insert({\n        user_id: user.id,\n        goal_id: goalId,\n        message_id: messageId,\n        message_type: messageType,\n        goal_completed: false\n      });\n\n    if (error) {\n      console.error('ì•Œë¦¼ ë¡œê·¸ ì €ì¥ ì‹¤íŒ¨:', error);\n    }\n  } catch (error) {\n    console.error('ì•Œë¦¼ ë¡œê·¸ ì €ì¥ ì˜¤ë¥˜:', error);\n  }\n};\n\n// ëª©í‘œ ì™„ë£Œ ì‹œ ì•Œë¦¼ ë¡œê·¸ ì—…ë°ì´íŠ¸\nexport const updateNotificationLogOnGoalComplete = async (goalId: string): Promise<void> => {\n  try {\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) return;\n\n    const { error } = await supabase\n      .from('notification_logs')\n      .update({\n        goal_completed: true,\n        completed_at: new Date().toISOString()\n      })\n      .eq('user_id', user.id)\n      .eq('goal_id', goalId)\n      .eq('goal_completed', false);\n\n    if (error) {\n      console.error('ì•Œë¦¼ ë¡œê·¸ ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);\n    }\n  } catch (error) {\n    console.error('ì•Œë¦¼ ë¡œê·¸ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);\n  }\n};\n\n// ì•Œë¦¼ íš¨ê³¼ í†µê³„ ì¡°íšŒ\nexport const getNotificationStats = async (): Promise<any[]> => {\n  try {\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) return [];\n\n    const { data, error } = await supabase\n      .rpc('get_simple_notification_stats', { user_id_param: user.id });\n\n    if (error) {\n      console.error('ì•Œë¦¼ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨:', error);\n      return [];\n    }\n\n    return data || [];\n  } catch (error) {\n    console.error('ì•Œë¦¼ í†µê³„ ì¡°íšŒ ì˜¤ë¥˜:', error);\n    return [];\n  }\n};\n\n// ìµœê·¼ ì•Œë¦¼ ë¡œê·¸ ì¡°íšŒ\nexport const getRecentNotifications = async (limit: number = 10): Promise<NotificationLog[]> => {\n  try {\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) return [];\n\n    const { data, error } = await supabase\n      .rpc('get_recent_notifications', { \n        user_id_param: user.id, \n        limit_count: limit \n      });\n\n    if (error) {\n      console.error('ìµœê·¼ ì•Œë¦¼ ë¡œê·¸ ì¡°íšŒ ì‹¤íŒ¨:', error);\n      return [];\n    }\n\n    return data || [];\n  } catch (error) {\n    console.error('ìµœê·¼ ì•Œë¦¼ ë¡œê·¸ ì¡°íšŒ ì˜¤ë¥˜:', error);\n    return [];\n  }\n};\n\n// ì•Œë¦¼ ë©”ì‹œì§€ ë‚´ìš© ê°€ì ¸ì˜¤ê¸° (IDë¡œ ì¡°íšŒ)\nexport const getNotificationMessageContent = (messageId: number): string => {\n  const message = getMessageById(messageId);\n  return message?.message || 'ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';\n};\n\n// A/B í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ë©”ì‹œì§€ íš¨ê³¼ ë¶„ì„\nexport const analyzeMessageEffectiveness = async (): Promise<{\n  bestMessages: any[];\n  worstMessages: any[];\n  overallStats: any;\n}> => {\n  try {\n    const stats = await getNotificationStats();\n    \n    // ì™„ë£Œìœ¨ ê¸°ì¤€ ì •ë ¬\n    const sortedStats = stats.sort((a, b) => b.completion_rate - a.completion_rate);\n    \n    // ìƒìœ„ 10ê°œ, í•˜ìœ„ 10ê°œ ì¶”ì¶œ\n    const bestMessages = sortedStats.slice(0, 10).map(stat => ({\n      ...stat,\n      messageContent: getNotificationMessageContent(stat.message_id)\n    }));\n    \n    const worstMessages = sortedStats.slice(-10).map(stat => ({\n      ...stat,\n      messageContent: getNotificationMessageContent(stat.message_id)\n    }));\n    \n    // ì „ì²´ í†µê³„\n    const totalSent = stats.reduce((sum, stat) => sum + stat.sent_count, 0);\n    const totalCompleted = stats.reduce((sum, stat) => sum + stat.completed_count, 0);\n    const overallCompletionRate = totalSent > 0 ? (totalCompleted / totalSent * 100) : 0;\n    \n    return {\n      bestMessages,\n      worstMessages,\n      overallStats: {\n        totalSent,\n        totalCompleted,\n        overallCompletionRate: parseFloat(overallCompletionRate.toFixed(2))\n      }\n    };\n    \n  } catch (error) {\n    console.error('ë©”ì‹œì§€ íš¨ê³¼ ë¶„ì„ ì˜¤ë¥˜:', error);\n    return {\n      bestMessages: [],\n      worstMessages: [],\n      overallStats: { totalSent: 0, totalCompleted: 0, overallCompletionRate: 0 }\n    };\n  }\n};","size_bytes":7316},"src/helpers/webNotificationTest.ts":{"content":"// ì›¹ í™˜ê²½ì—ì„œ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ìœ í‹¸ë¦¬í‹°\nimport { Platform } from 'react-native';\n\nexport const testWebNotification = async (message: string = 'í…ŒìŠ¤íŠ¸ ì•Œë¦¼ì…ë‹ˆë‹¤!'): Promise<void> => {\n  if (Platform.OS !== 'web') {\n    console.log('âš ï¸ ì›¹ í™˜ê²½ì´ ì•„ë‹™ë‹ˆë‹¤');\n    return;\n  }\n\n  if (!('Notification' in window)) {\n    console.log('âš ï¸ ë¸Œë¼ìš°ì €ê°€ ì•Œë¦¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');\n    return;\n  }\n\n  try {\n    // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­\n    const permission = await Notification.requestPermission();\n    \n    if (permission === 'granted') {\n      // ì¦‰ì‹œ í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ë°œì†¡\n      new Notification('ğŸ¯ The Better Day í…ŒìŠ¤íŠ¸ ì•Œë¦¼', {\n        body: message,\n        icon: '/favicon.ico',\n        badge: '/favicon.ico',\n        tag: 'test-notification',\n        requireInteraction: true,\n        data: { test: true }\n      });\n      \n      console.log('âœ… ì›¹ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì„±ê³µ!');\n    } else {\n      console.log('âŒ ì•Œë¦¼ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤');\n    }\n  } catch (error) {\n    console.error('âŒ ì›¹ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);\n  }\n};\n\n// 5ì´ˆ í›„ ì•Œë¦¼ í…ŒìŠ¤íŠ¸\nexport const testDelayedWebNotification = async (message: string = '5ì´ˆ í›„ í…ŒìŠ¤íŠ¸ ì•Œë¦¼ì…ë‹ˆë‹¤!'): Promise<void> => {\n  if (Platform.OS !== 'web') {\n    console.log('âš ï¸ ì›¹ í™˜ê²½ì´ ì•„ë‹™ë‹ˆë‹¤');\n    return;\n  }\n\n  if (!('Notification' in window)) {\n    console.log('âš ï¸ ë¸Œë¼ìš°ì €ê°€ ì•Œë¦¼ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤');\n    return;\n  }\n\n  try {\n    // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­\n    const permission = await Notification.requestPermission();\n    \n    if (permission === 'granted') {\n      console.log('â° 5ì´ˆ í›„ í…ŒìŠ¤íŠ¸ ì•Œë¦¼ì´ ë°œì†¡ë©ë‹ˆë‹¤...');\n      \n      // 5ì´ˆ í›„ ì•Œë¦¼ ë°œì†¡\n      setTimeout(() => {\n        new Notification('ğŸ¯ The Better Day ì§€ì—° í…ŒìŠ¤íŠ¸ ì•Œë¦¼', {\n          body: message,\n          icon: '/favicon.ico',\n          badge: '/favicon.ico',\n          tag: 'delayed-test-notification',\n          requireInteraction: true,\n          data: { test: true, delayed: true }\n        });\n        \n        console.log('âœ… ì§€ì—° ì›¹ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì„±ê³µ!');\n      }, 5000);\n      \n    } else {\n      console.log('âŒ ì•Œë¦¼ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤');\n    }\n  } catch (error) {\n    console.error('âŒ ì§€ì—° ì›¹ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨:', error);\n  }\n};","size_bytes":2354},"src/screens/CommunityScreen.tsx":{"content":"import { Ionicons } from '@expo/vector-icons';\nimport React, { useEffect, useState } from 'react';\nimport {\n  Alert,\n  FlatList,\n  RefreshControl,\n  StyleSheet,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  View,\n} from 'react-native';\nimport useCommunityStore, { DailyResolution, FilterType } from '../store/communityStore';\nimport { formatDate } from '../utils/dateHelpers';\nimport { supabase } from '../supabaseClient';\n\nconst CommunityScreen = () => {\n  const {\n    resolutions,\n    myResolution,\n    loading,\n    currentFilter,\n    fetchMyResolution,\n    saveMyResolution,\n    updateMyResolution,\n    deleteMyResolution,\n    fetchResolutions,\n    toggleLike,\n    setFilter,\n    refreshResolutions,\n  } = useCommunityStore();\n  \n  const [refreshing, setRefreshing] = useState(false);\n  const [isAnonymous, setIsAnonymous] = useState(true);\n\n  useEffect(() => {\n    const checkSession = async () => {\n      const { data: { session } } = await supabase.auth.getSession();\n      setIsAnonymous(!session);\n    };\n    \n    checkSession();\n    fetchMyResolution();\n    fetchResolutions();\n  }, []);\n\n\n\n  const handleFilterChange = (filter: FilterType) => {\n    setFilter(filter);\n    fetchResolutions(filter);\n  };\n\n  const handleToggleLike = async (resolutionId: string) => {\n    try {\n      await toggleLike(resolutionId);\n    } catch (error: any) {\n      Alert.alert('ì¢‹ì•„ìš” ì‹¤íŒ¨', error.message || 'ì¢‹ì•„ìš” ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  const handleRefresh = async () => {\n    setRefreshing(true);\n    await Promise.all([\n      fetchMyResolution(),\n      refreshResolutions(),\n    ]);\n    setRefreshing(false);\n  };\n\n  const renderResolutionItem = React.useCallback(({ item }: { item: DailyResolution }) => (\n    <View style={styles.resolutionCard}>\n      <View style={styles.resolutionHeader}>\n        <Text style={styles.userName}>{item.display_name}</Text>\n        <Text style={styles.date}>{formatDate(item.date)}</Text>\n      </View>\n      <Text style={[\n        styles.resolutionContent,\n        {\n          fontSize: item.content.length > 50 ? 12 : \n                   item.content.length > 30 ? 14 : 16\n        }\n      ]} \n      numberOfLines={3}\n      adjustsFontSizeToFit={true}>\n        {item.content}\n      </Text>\n      <View style={styles.resolutionFooter}>\n        <TouchableOpacity\n          style={styles.likeButton}\n          onPress={() => handleToggleLike(item.id)}\n        >\n          <Ionicons\n            name={item.is_liked_by_current_user ? 'heart' : 'heart-outline'}\n            size={20}\n            color={item.is_liked_by_current_user ? '#ff6b6b' : '#666'}\n          />\n          <Text style={styles.likeCount}>{item.like_count}</Text>\n        </TouchableOpacity>\n      </View>\n    </View>\n  ), [handleToggleLike]);\n\n  return (\n    <View style={styles.container}>\n      {/* í—¤ë” */}\n      <View style={styles.header}>\n        <Text style={styles.title}>ì»¤ë®¤ë‹ˆí‹°</Text>\n        <Text style={styles.subtitle}>ì–´ì œ ë‹¤ì§í•œ ê°ì˜¤ë¥¼ ë‚˜ëˆ ìš”</Text>\n      </View>\n\n      {/* ë‚´ ê°ì˜¤ í”¼ë“œë°± ì„¹ì…˜ */}\n      <View style={styles.myResolutionSection}>\n        {isAnonymous ? (\n          <View style={styles.guestModeCard}>\n            <Ionicons name=\"lock-closed-outline\" size={24} color=\"#999\" />\n            <Text style={styles.guestModeText}>ê²ŒìŠ¤íŠ¸ ëª¨ë“œì—ì„œëŠ” ê°ì˜¤ ê³µìœ ê°€ ì œí•œë©ë‹ˆë‹¤</Text>\n            <Text style={styles.guestModeSubText}>íšŒì›ê°€ì…í•˜ê³  ì»¤ë®¤ë‹ˆí‹°ì— ì°¸ì—¬í•´ë³´ì„¸ìš”!</Text>\n          </View>\n        ) : !myResolution ? (\n          <View style={styles.noResolutionCard}>\n            <Ionicons name=\"chatbubble-outline\" size={24} color=\"#999\" />\n            <Text style={styles.noResolutionText}>ì•„ì§ ì–´ì œì˜ ê°ì˜¤ê°€ ì—†ì–´ìš”</Text>\n            <Text style={styles.noResolutionSubText}>Home í™”ë©´ì—ì„œ ë‚´ì¼ì˜ ê°ì˜¤ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</Text>\n          </View>\n        ) : (\n          <View style={styles.myResolutionCompactCard}>\n            <View style={styles.compactHeader}>\n              <Text style={styles.compactLabel}>ë‚´ ë‹¤ì§</Text>\n              <Text style={styles.compactSeparator}>:</Text>\n              <Text style={styles.compactContent} numberOfLines={1}>\n                {myResolution.content}\n              </Text>\n            </View>\n            <View style={styles.compactStats}>\n              <Ionicons name=\"heart\" size={14} color=\"#ff6b6b\" />\n              <Text style={styles.compactLikeCount}>{myResolution.like_count || 0}</Text>\n            </View>\n          </View>\n        )}\n      </View>\n\n      {/* í•„í„° ì„¹ì…˜ */}\n      <View style={styles.filterSection}>\n        <TouchableOpacity\n          style={[styles.filterButton, currentFilter === 'recent' && styles.activeFilter]}\n          onPress={() => handleFilterChange('recent')}\n        >\n          <Text style={[styles.filterText, currentFilter === 'recent' && styles.activeFilterText]}>\n            ìµœì‹ ìˆœ\n          </Text>\n        </TouchableOpacity>\n\n        <TouchableOpacity\n          style={[styles.filterButton, currentFilter === 'popular' && styles.activeFilter]}\n          onPress={() => handleFilterChange('popular')}\n        >\n          <Text style={[styles.filterText, currentFilter === 'popular' && styles.activeFilterText]}>\n            ì¸ê¸°ìˆœ\n          </Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={[styles.filterButton, currentFilter === 'random' && styles.activeFilter]}\n          onPress={() => handleFilterChange('random')}\n        >\n          <Text style={[styles.filterText, currentFilter === 'random' && styles.activeFilterText]}>\n            ëœë¤\n          </Text>\n        </TouchableOpacity>\n      </View>\n\n      {/* ê°ì˜¤ ëª©ë¡ */}\n      <FlatList\n        data={resolutions}\n        renderItem={renderResolutionItem}\n        keyExtractor={(item) => item.id}\n        style={styles.resolutionList}\n        refreshControl={\n          <RefreshControl\n            refreshing={refreshing}\n            onRefresh={handleRefresh}\n            colors={['#007AFF']}\n          />\n        }\n        showsVerticalScrollIndicator={false}\n        ListEmptyComponent={\n          <View style={styles.emptyState}>\n            <Ionicons name=\"chatbubbles-outline\" size={64} color=\"#ccc\" />\n            <Text style={styles.emptyText}>ì•„ì§ ë“±ë¡ëœ ê°ì˜¤ê°€ ì—†ì–´ìš”</Text>\n            <Text style={styles.emptySubText}>ì²« ë²ˆì§¸ ê°ì˜¤ë¥¼ ì‘ì„±í•´ë³´ì„¸ìš”!</Text>\n          </View>\n        }\n      />\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f8f9fa',\n  },\n  header: {\n    padding: 20,\n    paddingTop: 60,\n    backgroundColor: '#fff',\n    borderBottomWidth: 1,\n    borderBottomColor: '#e9ecef',\n  },\n  title: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#333',\n  },\n  subtitle: {\n    fontSize: 14,\n    color: '#666',\n    marginTop: 4,\n  },\n  myResolutionSection: {\n    backgroundColor: '#fff',\n    marginTop: 10,\n    padding: 20,\n    borderBottomWidth: 1,\n    borderBottomColor: '#e9ecef',\n  },\n  writeButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 16,\n    backgroundColor: '#f8f9fa',\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: '#e9ecef',\n    borderStyle: 'dashed',\n  },\n  writeButtonText: {\n    marginLeft: 8,\n    fontSize: 16,\n    color: '#007AFF',\n    fontWeight: '500',\n  },\n  myResolutionCard: {\n    backgroundColor: '#e8f4ff',\n    borderRadius: 12,\n    padding: 16,\n    borderWidth: 1,\n    borderColor: '#b8daff',\n    minHeight: 100,\n    maxHeight: 100,\n  },\n  myResolutionCompactCard: {\n    backgroundColor: '#f8f9fa',\n    borderRadius: 8,\n    paddingVertical: 12,\n    paddingHorizontal: 16,\n    borderWidth: 1,\n    borderColor: '#e9ecef',\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    minHeight: 50,\n  },\n  compactHeader: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    flex: 1,\n  },\n  compactLabel: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#333',\n    marginRight: 8,\n  },\n  compactSeparator: {\n    fontSize: 14,\n    color: '#666',\n    marginRight: 8,\n  },\n  compactContent: {\n    fontSize: 14,\n    color: '#333',\n    flex: 1,\n  },\n  compactStats: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    marginLeft: 12,\n  },\n  compactLikeCount: {\n    marginLeft: 4,\n    fontSize: 12,\n    color: '#666',\n  },\n  myResolutionHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 8,\n  },\n  myResolutionLabel: {\n    fontSize: 12,\n    color: '#007AFF',\n    fontWeight: '600',\n  },\n  myResolutionActions: {\n    flexDirection: 'row',\n  },\n  actionButton: {\n    padding: 4,\n    marginLeft: 8,\n  },\n  myResolutionContent: {\n    fontSize: 16,\n    color: '#333',\n    lineHeight: 22,\n    flex: 1,\n    textAlignVertical: 'center',\n  },\n  writeSection: {\n    backgroundColor: '#f8f9fa',\n    borderRadius: 12,\n    padding: 16,\n  },\n  textInput: {\n    fontSize: 16,\n    color: '#333',\n    minHeight: 80,\n    textAlignVertical: 'top',\n  },\n  charCount: {\n    fontSize: 12,\n    color: '#666',\n    textAlign: 'right',\n    marginTop: 8,\n  },\n  writeActions: {\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    marginTop: 12,\n  },\n  cancelButton: {\n    paddingHorizontal: 16,\n    paddingVertical: 8,\n    marginRight: 8,\n  },\n  cancelButtonText: {\n    color: '#666',\n    fontSize: 14,\n  },\n  saveButton: {\n    backgroundColor: '#007AFF',\n    paddingHorizontal: 16,\n    paddingVertical: 8,\n    borderRadius: 8,\n  },\n  saveButtonText: {\n    color: '#fff',\n    fontSize: 14,\n    fontWeight: '500',\n  },\n  filterSection: {\n    flexDirection: 'row',\n    backgroundColor: '#fff',\n    paddingHorizontal: 20,\n    paddingVertical: 12,\n    borderBottomWidth: 1,\n    borderBottomColor: '#e9ecef',\n  },\n  filterButton: {\n    paddingHorizontal: 16,\n    paddingVertical: 8,\n    marginRight: 8,\n    borderRadius: 20,\n    backgroundColor: '#f8f9fa',\n  },\n  activeFilter: {\n    backgroundColor: '#007AFF',\n  },\n  filterText: {\n    fontSize: 14,\n    color: '#666',\n  },\n  activeFilterText: {\n    color: '#fff',\n    fontWeight: '500',\n  },\n  resolutionList: {\n    flex: 1,\n  },\n  resolutionCard: {\n    backgroundColor: '#fff',\n    marginHorizontal: 20,\n    marginTop: 10,\n    padding: 16,\n    borderRadius: 12,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 1 },\n    shadowOpacity: 0.1,\n    shadowRadius: 3,\n    elevation: 2,\n    minHeight: 120,\n  },\n  resolutionHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 8,\n  },\n  userName: {\n    fontSize: 14,\n    fontWeight: '600',\n    color: '#333',\n  },\n  date: {\n    fontSize: 12,\n    color: '#666',\n  },\n  resolutionContent: {\n    fontSize: 16,\n    color: '#333',\n    lineHeight: 22,\n    marginBottom: 12,\n  },\n  resolutionFooter: {\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n  },\n  likeButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: 4,\n  },\n  likeCount: {\n    marginLeft: 4,\n    fontSize: 14,\n    color: '#666',\n  },\n  emptyState: {\n    alignItems: 'center',\n    justifyContent: 'center',\n    paddingVertical: 60,\n  },\n  emptyText: {\n    fontSize: 16,\n    color: '#666',\n    marginTop: 16,\n  },\n  emptySubText: {\n    fontSize: 14,\n    color: '#999',\n    marginTop: 4,\n  },\n  // ìƒˆë¡œìš´ ì½ê¸° ì „ìš© ìŠ¤íƒ€ì¼\n  noResolutionCard: {\n    alignItems: 'center',\n    padding: 24,\n    backgroundColor: '#f8f9fa',\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: '#e9ecef',\n  },\n  noResolutionText: {\n    fontSize: 14,\n    color: '#666',\n    marginTop: 8,\n    fontWeight: '500',\n  },\n  noResolutionSubText: {\n    fontSize: 12,\n    color: '#999',\n    marginTop: 4,\n  },\n  guestModeCard: {\n    alignItems: 'center',\n    padding: 24,\n    backgroundColor: '#fff5f5',\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: '#fee2e2',\n  },\n  guestModeText: {\n    fontSize: 14,\n    color: '#dc2626',\n    marginTop: 8,\n    fontWeight: '500',\n    textAlign: 'center',\n  },\n  guestModeSubText: {\n    fontSize: 12,\n    color: '#b91c1c',\n    marginTop: 4,\n    textAlign: 'center',\n  },\n  socialStats: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    gap: 4,\n  },\n\n\n});\n\nexport default CommunityScreen;","size_bytes":12314},"src/screens/DayDetailScreen.tsx":{"content":"import React, { useEffect, useMemo, useState } from \"react\";\nimport {\n  Alert,\n  ScrollView,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  View,\n} from \"react-native\";\nimport useGoalStore from \"../store/goalStore\";\nimport useRetrospectStore from \"../store/retrospectStore\";\nimport { useFlexibleGoalStore } from \"../store/flexibleGoalStore\";\nimport useCommunityStore from \"../store/communityStore\";\nimport { supabase } from \"../supabaseClient\";\n\n/* ---------- íƒ€ì… ---------- */\ninterface DailyStatsRow {\n  total: number | null;\n  success_cnt: number | null;\n  failure_cnt: number | null;\n  rate: number | null; // numeric(5,2)\n}\n\nexport default function DayDetailScreen({ route }: any) {\n  const date = route.params.date as string; // YYYY-MM-DD\n\n  /* ---------- store ---------- */\n  const { goals, fetchGoals } = useGoalStore();\n  const { fetchOne } = useRetrospectStore();\n  const { getGoalsByDate, fetchGoals: fetchFlexibleGoals } =\n    useFlexibleGoalStore();\n  const { fetchMyResolution } = useCommunityStore();\n\n  /* ---------- state ---------- */\n  const [stats, setStats] = useState<DailyStatsRow | null>(null);\n  const [retro, setRetro] = useState<string | null>(null);\n  const [resolution, setResolution] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [showMemo, setShowMemo] = useState<{ [key: string]: boolean }>({});\n\n  /* ---------- ì„±ê³µë¥  ë“±ê¸‰ ê³„ì‚° ---------- */\n  const getRateLevel = (\n    rate: number,\n  ): { level: string; color: string; bgColor: string } => {\n    if (rate === 100)\n      return { level: \"Trans\", color: \"#fff\", bgColor: \"#1a237e\" };\n    if (rate >= 70) return { level: \"Good\", color: \"#fff\", bgColor: \"#2e7d32\" };\n    if (rate >= 30) return { level: \"SoSo\", color: \"#fff\", bgColor: \"#f57c00\" };\n    return { level: \"Bad\", color: \"#fff\", bgColor: \"#d32f2f\" };\n  };\n\n  /* ---------- fetch ---------- */\n  useEffect(() => {\n    (async () => {\n      try {\n        /* (1) ìŠ¤í† ì–´ ìºì‹œ ë™ê¸°í™” */\n        if (goals.length === 0) await fetchGoals();\n\n        /* (1-2) í•„ìˆ˜ ëª©í‘œ ë™ê¸°í™” */\n        console.log(\"ğŸ”„ DayDetail: í•„ìˆ˜ ëª©í‘œ ë™ê¸°í™” ì‹œì‘ - date:\", date);\n        await fetchFlexibleGoals(date);\n        console.log(\n          \"ğŸ”„ DayDetail: í•„ìˆ˜ ëª©í‘œ ë™ê¸°í™” ì™„ë£Œ - ê°œìˆ˜:\",\n          getGoalsByDate(date).length,\n        );\n\n        /* (2) íšŒê³  */\n        const r = await fetchOne(date);\n        setRetro(r?.text ?? null);\n\n        /* (2.5) ê·¸ë‚ ì˜ ê°ì˜¤/ë‹¤ì§ ê°€ì ¸ì˜¤ê¸° */\n        try {\n          const {\n            data: { session },\n          } = await supabase.auth.getSession();\n          if (session) {\n            // ì •ì‹ íšŒì› - Supabaseì—ì„œ ì¡°íšŒ\n            const { data: resolutionData } = await supabase\n              .from(\"daily_resolutions\")\n              .select(\"content\")\n              .eq(\"user_id\", session.user.id)\n              .eq(\"date\", date)\n              .single();\n\n            setResolution(resolutionData?.content || null);\n          } else {\n            // ê²ŒìŠ¤íŠ¸ ëª¨ë“œ - AsyncStorageì—ì„œ ì¡°íšŒ\n            const AsyncStorage = await import(\n              \"@react-native-async-storage/async-storage\"\n            );\n            const guestResolutionsStr = await AsyncStorage.default.getItem(\n              \"guestDailyResolutions\",\n            );\n            const guestResolutions = guestResolutionsStr\n              ? JSON.parse(guestResolutionsStr)\n              : [];\n            const dateResolution = guestResolutions.find(\n              (r: any) => r.date === date,\n            );\n            setResolution(dateResolution?.content || null);\n          }\n        } catch (err) {\n          console.log(\"ê°ì˜¤ ì¡°íšŒ ì‹¤íŒ¨:\", err);\n          setResolution(null);\n        }\n\n        /* (3) ì¼ë³„ í†µê³„ - í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì§ì ‘ ê³„ì‚° */\n        const {\n          data: { session },\n        } = await supabase.auth.getSession();\n        if (!session) {\n          // ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ìëŠ” í†µê³„ ì—†ì´ ì§„í–‰\n          setStats({ total: 0, success_cnt: 0, failure_cnt: 0, rate: 0 });\n          setLoading(false);\n          return;\n        }\n\n        // ì •ì‹œ ëª©í‘œ í†µê³„ ê³„ì‚° (í•œêµ­ ì‹œê°„ ê¸°ì¤€)\n        const regularGoalsForDate = goals.filter((g) => {\n          const goalDate = new Date(g.target_time);\n          const koreaTimeString = goalDate.toLocaleString(\"en-CA\", {\n            timeZone: \"Asia/Seoul\",\n            year: \"numeric\",\n            month: \"2-digit\",\n            day: \"2-digit\",\n          });\n          return koreaTimeString === date;\n        });\n\n        // í•„ìˆ˜ ëª©í‘œ í†µê³„ ê³„ì‚° (ì°¸ê³ ìš©)\n        const flexibleGoalsForDate = getGoalsByDate(date);\n\n        // í†µê³„ ê³„ì‚°: ì •ì‹œ ëª©í‘œë§Œ í¬í•¨ (í•„ìˆ˜ ëª©í‘œëŠ” ì œì™¸)\n        const total = regularGoalsForDate.length;\n        const success_cnt = regularGoalsForDate.filter(\n          (g) => g.status === \"success\",\n        ).length;\n        const failure_cnt = regularGoalsForDate.filter(\n          (g) => g.status === \"failure\",\n        ).length;\n        const rate = total > 0 ? (success_cnt / total) * 100 : 0;\n\n        console.log(\"ğŸ“Š DayDetail í†µê³„ ê³„ì‚° (ì •ì‹œ ëª©í‘œë§Œ í¬í•¨):\", {\n          date,\n          ì •ì‹œëª©í‘œ: regularGoalsForDate.length,\n          í•„ìˆ˜ëª©í‘œ: flexibleGoalsForDate.length,\n          í†µê³„í¬í•¨: total,\n          ì„±ê³µ: success_cnt,\n          ì‹¤íŒ¨: failure_cnt,\n          ì„±ê³µë¥ : rate,\n        });\n\n        setStats({\n          total,\n          success_cnt,\n          failure_cnt,\n          rate,\n        });\n      } catch (e: any) {\n        console.warn(e);\n        Alert.alert(\"ì•Œë¦¼\", \"ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.\");\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [date]);\n\n  /* ---------- íŒŒìƒ ---------- */\n  const dayGoals = useMemo(() => {\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ëª©í‘œ í•„í„°ë§\n    const filteredGoals = goals\n      .filter((g) => {\n        const goalDate = new Date(g.target_time);\n        const koreaTimeString = goalDate.toLocaleString(\"en-CA\", {\n          timeZone: \"Asia/Seoul\",\n          year: \"numeric\",\n          month: \"2-digit\",\n          day: \"2-digit\",\n        });\n        return koreaTimeString === date;\n      })\n      .sort((a, b) => a.target_time.localeCompare(b.target_time));\n\n    console.log(\"ğŸ” DayDetail ëª©í‘œ í•„í„°ë§:\", {\n      date,\n      ì „ì²´ëª©í‘œ: goals.length,\n      í•„í„°ëœëª©í‘œ: filteredGoals.length,\n      ëª©í‘œë“¤: filteredGoals.map((g) => ({\n        title: g.title,\n        time: g.target_time,\n        koreanTime: new Date(\n          new Date(g.target_time).getTime() + 9 * 60 * 60 * 1000,\n        ).toISOString(),\n      })),\n    });\n\n    return filteredGoals;\n  }, [goals, date]);\n\n  const flexibleGoals = useMemo(() => {\n    const result = getGoalsByDate(date);\n    const allFlexibleGoals = useFlexibleGoalStore.getState().goals;\n    console.log(\"ğŸ¯ DayDetail í•„ìˆ˜ ëª©í‘œ í•„í„°ë§ ìƒì„¸:\", {\n      date,\n      ì „ì²´í•„ìˆ˜ëª©í‘œ: allFlexibleGoals.length,\n      í•„í„°ëœí•„ìˆ˜ëª©í‘œ: result.length,\n      ì „ì²´ëª©í‘œìƒì„¸: allFlexibleGoals.map((g) => ({\n        id: g.id,\n        title: g.title,\n        date: g.date,\n        status: g.status,\n        ë§¤ì¹˜ì—¬ë¶€: g.date === date,\n      })),\n      í•„í„°ëœëª©í‘œë“¤: result.map((g) => ({\n        id: g.id,\n        title: g.title,\n        date: g.date,\n        status: g.status,\n      })),\n    });\n    return result;\n  }, [date, getGoalsByDate]);\n\n  /* ---------- UI ---------- */\n  if (loading)\n    return (\n      <View style={s.center}>\n        <Text>Loadingâ€¦</Text>\n      </View>\n    );\n\n  return (\n    <ScrollView contentContainerStyle={s.wrap}>\n      {/* ë‚ ì§œ í—¤ë“œë¼ì¸ */}\n      <Text style={s.headDate}>{date}</Text>\n\n      {/* ---- í†µê³„ ì¹´ë“œ ---- */}\n      <View style={s.card}>\n        {stats ? (\n          <View style={s.statsRow}>\n            <View style={s.statsInfo}>\n              <Text>ì´ ëª©í‘œ {stats.total ?? 0}</Text>\n              <Text style={{ color: \"dodgerblue\" }}>\n                ì„±ê³µ {stats.success_cnt ?? 0}\n              </Text>\n              <Text style={{ color: \"crimson\" }}>\n                ì‹¤íŒ¨ {stats.failure_cnt ?? 0}\n              </Text>\n              <Text>ì„±ê³µë¥  {stats.rate?.toFixed(1) ?? 0}%</Text>\n            </View>\n            {stats.rate !== null && (\n              <View\n                style={[\n                  s.rateBadge,\n                  { backgroundColor: getRateLevel(stats.rate).bgColor },\n                ]}\n              >\n                <Text\n                  style={[\n                    s.rateBadgeText,\n                    { color: getRateLevel(stats.rate).color },\n                  ]}\n                >\n                  {getRateLevel(stats.rate).level}\n                </Text>\n              </View>\n            )}\n          </View>\n        ) : (\n          <Text style={{ color: \"#666\" }}>ì§‘ê³„ ì—†ìŒ</Text>\n        )}\n      </View>\n\n      {/* ---- ì •ì‹œ ëª©í‘œ ëª©ë¡ ---- */}\n      <Text style={s.sectionTitle}>\n        {(() => {\n          // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ê³„ì‚°\n          const now = new Date();\n          const todayKey = now.toLocaleString(\"en-CA\", {\n            timeZone: \"Asia/Seoul\",\n            year: \"numeric\",\n            month: \"2-digit\",\n            day: \"2-digit\",\n          });\n          const tomorrow = new Date(now.getTime() + 86400000);\n          const tomorrowKey = tomorrow.toLocaleString(\"en-CA\", {\n            timeZone: \"Asia/Seoul\",\n            year: \"numeric\",\n            month: \"2-digit\",\n            day: \"2-digit\",\n          });\n\n          if (date === todayKey) return \"ì˜¤ëŠ˜ì˜ ì •ì‹œ ëª©í‘œ\";\n          if (date === tomorrowKey) return \"ì˜ˆì •ëœ ì •ì‹œ ëª©í‘œ\";\n\n          // ê³¼ê±° ë‚ ì§œ\n          const targetDate = new Date(date);\n          const dayOfWeek = targetDate.toLocaleDateString(\"ko-KR\", {\n            weekday: \"short\",\n          });\n          return `${dayOfWeek}ì˜ ì •ì‹œ ëª©í‘œ`;\n        })()}\n      </Text>\n      {dayGoals.length === 0 ? (\n        <Text style={s.empty}>ì •ì‹œ ëª©í‘œ ì—†ìŒ</Text>\n      ) : (\n        dayGoals.map((g) => (\n          <View key={g.id} style={s.goalContainer}>\n            <View style={s.row}>\n              <View style={{ flex: 1 }}>\n                <Text style={s.rowTitle}>{g.title}</Text>\n                <Text style={s.rowTime}>\n                  {new Date(g.target_time)\n                    .toLocaleTimeString(\"ko-KR\", {\n                      hour12: true,\n                      hour: \"2-digit\",\n                      minute: \"2-digit\",\n                    })\n                    .replace(\"AM\", \"ì˜¤ì „\")\n                    .replace(\"PM\", \"ì˜¤í›„\")}\n                </Text>\n              </View>\n              <Text\n                style={[\n                  s.badge,\n                  g.status === \"success\" && s.badgeSuccess,\n                  g.status === \"failure\" && s.badgeFail,\n                ]}\n              >\n                {g.status === \"pending\"\n                  ? \"ëŒ€ê¸°\"\n                  : g.status === \"success\"\n                    ? \"ìŠ¹ë¦¬\"\n                    : \"íŒ¨ë°°\"}\n              </Text>\n            </View>\n            {/* ë‹¬ì„± ë©”ëª¨ ë³´ê¸° ë²„íŠ¼ */}\n            {g.status === \"success\" && g.achievement_memo && (\n              <View style={s.memoSection}>\n                <TouchableOpacity\n                  style={s.memoButton}\n                  onPress={() =>\n                    setShowMemo((prev) => ({ ...prev, [g.id]: !prev[g.id] }))\n                  }\n                >\n                  <Text style={s.memoButtonText}>\n                    {showMemo[g.id] ? \"ë©”ëª¨ ì ‘ê¸°\" : \"ë©”ëª¨ ë³´ê¸°\"}\n                  </Text>\n                </TouchableOpacity>\n                {showMemo[g.id] && (\n                  <View style={s.memoContainer}>\n                    <Text style={s.memoLabel}>ğŸ“ ë‹¬ì„± ê¸°ë¡</Text>\n                    <Text style={s.memoText}>{g.achievement_memo}</Text>\n                  </View>\n                )}\n              </View>\n            )}\n          </View>\n        ))\n      )}\n\n      {/* ---- í•„ìˆ˜ ëª©í‘œ ëª©ë¡ ---- */}\n      <Text style={s.sectionTitle}>\n        {(() => {\n          // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ê³„ì‚°\n          const now = new Date();\n          const todayKey = now.toLocaleString(\"en-CA\", {\n            timeZone: \"Asia/Seoul\",\n            year: \"numeric\",\n            month: \"2-digit\",\n            day: \"2-digit\",\n          });\n          const tomorrow = new Date(now.getTime() + 86400000);\n          const tomorrowKey = tomorrow.toLocaleString(\"en-CA\", {\n            timeZone: \"Asia/Seoul\",\n            year: \"numeric\",\n            month: \"2-digit\",\n            day: \"2-digit\",\n          });\n\n          if (date === tomorrowKey) return \"ë‚´ì¼ í•„ìˆ˜ ëª©í‘œ\";\n          if (date === todayKey) return \"ì˜¤ëŠ˜ í•„ìˆ˜ ëª©í‘œ\";\n\n          // ê³¼ê±° ë‚ ì§œ\n          const targetDate = new Date(date);\n          const dayOfWeek = targetDate.toLocaleDateString(\"ko-KR\", {\n            weekday: \"short\",\n          });\n          return `${dayOfWeek}ì˜ í•„ìˆ˜ ëª©í‘œ`;\n        })()}\n      </Text>\n      {flexibleGoals.length === 0 ? (\n        <Text style={s.empty}>í•„ìˆ˜ ëª©í‘œ ì—†ìŒ</Text>\n      ) : (\n        flexibleGoals.map((g) => (\n          <View key={g.id} style={s.goalContainer}>\n            <View style={s.row}>\n              <View style={{ flex: 1 }}>\n                <Text style={s.rowTitle}>ğŸ¯ {g.title}</Text>\n                <Text style={s.rowTime}>ì‹œê°„ ììœ </Text>\n              </View>\n              <Text\n                style={[\n                  s.badge,\n                  g.status === \"success\" && s.badgeSuccess,\n                  g.status === \"failure\" && s.badgeFail,\n                ]}\n              >\n                {g.status === \"pending\"\n                  ? \"ëŒ€ê¸°\"\n                  : g.status === \"success\"\n                    ? \"ìŠ¹ë¦¬\"\n                    : \"íŒ¨ë°°\"}\n              </Text>\n            </View>\n          </View>\n        ))\n      )}\n\n      {/* ---- ê°ì˜¤/ë‹¤ì§ ---- */}\n      <Text style={s.sectionTitle}>ê°ì˜¤/ë‹¤ì§</Text>\n      {resolution ? (\n        <View style={s.resolutionContainer}>\n          <Text style={s.resolutionText}>{resolution}</Text>\n        </View>\n      ) : (\n        <Text style={s.empty}>ê°ì˜¤ ì—†ìŒ</Text>\n      )}\n\n      {/* ---- íšŒê³  ---- */}\n      <Text style={s.sectionTitle}>íšŒê³ </Text>\n      {retro ? (\n        <Text style={s.retro}>{retro}</Text>\n      ) : (\n        <Text style={s.empty}>íšŒê³  ì—†ìŒ</Text>\n      )}\n    </ScrollView>\n  );\n}\n\n/* ---------- ìŠ¤íƒ€ì¼ ---------- */\nconst s = StyleSheet.create({\n  wrap: { padding: 16 },\n  center: { flex: 1, justifyContent: \"center\", alignItems: \"center\" },\n  headDate: { fontSize: 24, fontWeight: \"bold\", marginBottom: 16 },\n  card: {\n    backgroundColor: \"#f9f9f9\",\n    padding: 16,\n    borderRadius: 8,\n    marginBottom: 16,\n  },\n  sectionTitle: {\n    fontSize: 18,\n    fontWeight: \"bold\",\n    marginBottom: 8,\n    marginTop: 16,\n  },\n  empty: {\n    fontSize: 16,\n    color: \"#666\",\n    textAlign: \"center\",\n    marginVertical: 16,\n  },\n  goalContainer: { marginBottom: 8 },\n  row: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: 8,\n    borderBottomWidth: 1,\n    borderBottomColor: \"#eee\",\n  },\n  rowTitle: { fontSize: 16, fontWeight: \"500\" },\n  rowTime: { fontSize: 14, color: \"#666\" },\n  badge: {\n    fontSize: 12,\n    paddingHorizontal: 8,\n    paddingVertical: 4,\n    borderRadius: 4,\n    backgroundColor: \"#ddd\",\n  },\n  badgeSuccess: { backgroundColor: \"#4caf50\", color: \"white\" },\n  badgeFail: { backgroundColor: \"#f44336\", color: \"white\" },\n  memoSection: { paddingHorizontal: 8, marginTop: 4 },\n  memoButton: {\n    backgroundColor: \"#e3f2fd\",\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 4,\n    alignSelf: \"flex-start\",\n  },\n  memoButtonText: { fontSize: 12, color: \"#1976d2\", fontWeight: \"500\" },\n  memoContainer: {\n    backgroundColor: \"#f0f8ff\",\n    padding: 12,\n    borderRadius: 6,\n    marginTop: 8,\n  },\n  memoLabel: {\n    fontSize: 12,\n    fontWeight: \"bold\",\n    color: \"#2196f3\",\n    marginBottom: 4,\n  },\n  memoText: { fontSize: 14, lineHeight: 20, color: \"#333\" },\n  statsRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n  },\n  statsInfo: { flex: 1 },\n  rateBadge: {\n    paddingHorizontal: 12,\n    paddingVertical: 6,\n    borderRadius: 4,\n    minWidth: 50,\n    alignItems: \"center\",\n  },\n  rateBadgeText: { fontSize: 14, fontWeight: \"bold\" },\n  retro: {\n    fontSize: 16,\n    lineHeight: 24,\n    backgroundColor: \"#f0f0f0\",\n    padding: 16,\n    borderRadius: 8,\n  },\n  resolutionContainer: {\n    backgroundColor: \"#f0f8ff\",\n    padding: 12,\n    borderRadius: 8,\n    marginBottom: 20,\n    borderLeftWidth: 4,\n    borderLeftColor: \"#007AFF\",\n  },\n  resolutionText: {\n    fontSize: 14,\n    color: \"#333\",\n    lineHeight: 20,\n    textAlign: \"left\",\n  },\n});\n","size_bytes":16924},"src/screens/DayDetailScreen_Fixed.tsx":{"content":"import React, { useEffect, useMemo, useState } from 'react';\nimport { Alert, ScrollView, StyleSheet, Text, View } from 'react-native';\nimport useGoalStore from '../store/goalStore';\nimport useRetrospectStore from '../store/retrospectStore';\nimport { supabase } from '../supabaseClient';\n\n/* ---------- íƒ€ì… ---------- */\ninterface DailyStatsRow {\n  total: number | null;\n  success_cnt: number | null;\n  failure_cnt: number | null;\n  rate: number | null;          // numeric(5,2)\n}\n\nexport default function DayDetailScreen({ route }: any) {\n  const date = route.params.date as string;             // YYYY-MM-DD\n\n  /* ---------- store ---------- */\n  const { goals, fetchGoals }     = useGoalStore();\n  const { fetchOne }              = useRetrospectStore();\n\n  /* ---------- state ---------- */\n  const [stats, setStats]         = useState<DailyStatsRow | null>(null);\n  const [retro, setRetro]         = useState<string | null>(null);\n  const [loading, setLoading]     = useState(true);\n\n  /* ---------- fetch ---------- */\n  useEffect(() => {\n    (async () => {\n      try {\n        /* (1) ìŠ¤í† ì–´ ìºì‹œ ë™ê¸°í™” */\n        if (goals.length === 0) await fetchGoals();\n\n        /* (2) íšŒê³  */\n        const r = await fetchOne(date);\n        setRetro(r?.text ?? null);\n\n        /* (3) ì¼ë³„ í†µê³„ */\n        const { data, error } = await supabase\n          .from('daily_stats')\n          .select('total,success_cnt,failure_cnt,rate')\n          .eq('user_id', (await supabase.auth.getUser()).data.user?.id)\n          .eq('date', date)\n          .maybeSingle();\n        if (error) throw error;\n        setStats(data);\n      } catch (e: any) {\n        console.warn(e);\n        Alert.alert('ì•Œë¦¼', 'ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');\n      } finally {\n        setLoading(false);\n      }\n    })();\n  }, [date]);\n\n  /* ---------- íŒŒìƒ ---------- */\n  const dayGoals = useMemo(() => {\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ëª©í‘œ í•„í„°ë§\n    const filteredGoals = goals.filter(g => {\n      const goalDate = new Date(g.target_time);\n      const koreanDate = new Date(goalDate.getTime() + (9 * 60 * 60 * 1000));\n      return koreanDate.toISOString().slice(0, 10) === date;\n    }).sort((a,b)=>a.target_time.localeCompare(b.target_time));\n    \n    console.log('ğŸ” DayDetail ëª©í‘œ í•„í„°ë§:', {\n      date,\n      ì „ì²´ëª©í‘œ: goals.length,\n      í•„í„°ëœëª©í‘œ: filteredGoals.length,\n      ëª©í‘œë“¤: filteredGoals.map(g => ({\n        title: g.title,\n        time: g.target_time,\n        koreanTime: new Date(new Date(g.target_time).getTime() + (9 * 60 * 60 * 1000)).toISOString()\n      }))\n    });\n    \n    return filteredGoals;\n  }, [goals, date]);\n\n  /* ---------- UI ---------- */\n  if (loading) return <View style={s.center}><Text>Loadingâ€¦</Text></View>;\n\n  return (\n    <ScrollView contentContainerStyle={s.wrap}>\n      {/* ë‚ ì§œ í—¤ë“œë¼ì¸ */}\n      <Text style={s.headDate}>{date}</Text>\n\n      {/* ---- í†µê³„ ì¹´ë“œ ---- */}\n      <View style={s.card}>\n        {stats ? (\n          <>\n            <Text>ì´ ëª©í‘œ {stats.total ?? 0}</Text>\n            <Text style={{color:'dodgerblue'}}>ì„±ê³µ {stats.success_cnt ?? 0}</Text>\n            <Text style={{color:'crimson'}}>ì‹¤íŒ¨ {stats.failure_cnt ?? 0}</Text>\n            <Text>ì„±ê³µë¥  {stats.rate ?? 0}%</Text>\n          </>\n        ) : (\n          <Text style={{color:'#666'}}>ì§‘ê³„ ì—†ìŒ</Text>\n        )}\n      </View>\n\n      {/* ---- ëª©í‘œ ëª©ë¡ ---- */}\n      <Text style={s.sectionTitle}>\n        {(() => {\n          // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ê³„ì‚°\n          const now = new Date();\n          const koreaTime = new Date(now.getTime() + (9 * 60 * 60 * 1000));\n          const todayKey = koreaTime.toISOString().slice(0, 10);\n          const tomorrowKey = new Date(koreaTime.getTime() + 86400000).toISOString().slice(0, 10);\n          \n          if (date === todayKey) return 'ì˜¤ëŠ˜ì˜ ëª©í‘œ';\n          if (date === tomorrowKey) return 'ì˜ˆì •';\n          \n          // ê³¼ê±° ë‚ ì§œ\n          const targetDate = new Date(date);\n          const dayOfWeek = targetDate.toLocaleDateString('ko-KR', { weekday: 'short' });\n          return `${dayOfWeek}ì˜ ëª©í‘œ`;\n        })()}\n      </Text>\n      {dayGoals.length === 0 ? (\n        <Text style={s.empty}>ëª©í‘œ ì—†ìŒ</Text>\n      ) : dayGoals.map(g => (\n        <View key={g.id} style={s.row}>\n          <View style={{flex:1}}>\n            <Text style={s.rowTitle}>{g.title}</Text>\n            <Text style={s.rowTime}>\n              {new Date(g.target_time).toLocaleTimeString('ko-KR',{\n                hour12:true,hour:'2-digit',minute:'2-digit',\n              })}\n            </Text>\n          </View>\n          <Text style={[\n            s.badge,\n            g.status === 'success' && s.badgeSuccess,\n            g.status === 'failure' && s.badgeFail,\n          ]}>\n            {g.status === 'pending' ? 'ëŒ€ê¸°' :\n             g.status === 'success' ? 'ìŠ¹ë¦¬' : 'íŒ¨ë°°'}\n          </Text>\n        </View>\n      ))}\n\n      {/* ---- íšŒê³  ---- */}\n      <Text style={s.sectionTitle}>íšŒê³ </Text>\n      {retro ? (\n        <Text style={s.retro}>{retro}</Text>\n      ) : (\n        <Text style={s.empty}>íšŒê³  ì—†ìŒ</Text>\n      )}\n    </ScrollView>\n  );\n}\n\n/* ---------- ìŠ¤íƒ€ì¼ ---------- */\nconst s = StyleSheet.create({\n  wrap        : { padding:16 },\n  center      : { flex:1,justifyContent:'center',alignItems:'center' },\n  headDate    : { fontSize:24,fontWeight:'bold',marginBottom:16 },\n  card        : { backgroundColor:'#f9f9f9',padding:16,borderRadius:8,marginBottom:16 },\n  sectionTitle: { fontSize:18,fontWeight:'bold',marginBottom:8,marginTop:16 },\n  empty       : { fontSize:16,color:'#666',textAlign:'center',marginVertical:16 },\n  row         : { flexDirection:'row',alignItems:'center',paddingVertical:8,borderBottomWidth:1,borderBottomColor:'#eee' },\n  rowTitle    : { fontSize:16,fontWeight:'500' },\n  rowTime     : { fontSize:14,color:'#666' },\n  badge       : { fontSize:12,paddingHorizontal:8,paddingVertical:4,borderRadius:4,backgroundColor:'#ddd' },\n  badgeSuccess: { backgroundColor:'#4caf50',color:'white' },\n  badgeFail   : { backgroundColor:'#f44336',color:'white' },\n  retro       : { fontSize:16,lineHeight:24,backgroundColor:'#f0f0f0',padding:16,borderRadius:8 },\n});","size_bytes":6260},"src/screens/FlexibleGoalScreen.tsx":{"content":"import React, { useEffect, useState } from \"react\";\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  TextInput,\n  Alert,\n  RefreshControl,\n} from \"react-native\";\nimport { useFlexibleGoalStore } from \"../store/flexibleGoalStore\";\nimport { getTodayString } from \"../utils/dateHelpers\";\nimport { getTodayKorea, getTomorrowKorea } from \"../utils/timeUtils\";\n\ninterface FlexibleGoalScreenProps {\n  navigation: any;\n  route: any;\n}\n\nconst FlexibleGoalScreen: React.FC<FlexibleGoalScreenProps> = ({\n  navigation,\n  route,\n}) => {\n  const {\n    fetchGoals,\n    addGoal,\n    deleteGoal,\n    checkGoal,\n    hasTodayGoal,\n    getGoalsByDate,\n  } = useFlexibleGoalStore();\n\n  const [newGoalText, setNewGoalText] = useState(\"\");\n  const [refreshing, setRefreshing] = useState(false);\n\n  // í•„ìˆ˜ ëª©í‘œë¥¼ ë‚´ì¼ ë‚ ì§œë¡œ ì„¤ì • (ë‚´ì¼ í•„ìˆ˜ ëª©í‘œ)\n  const getTargetDateString = () => {\n    return getTomorrowKorea();\n  };\n\n  useEffect(() => {\n    fetchGoals(getTargetDateString());\n  }, []);\n\n  const handleAddGoal = async () => {\n    const title = newGoalText.trim();\n    if (!title) {\n      Alert.alert(\"ì•Œë¦¼\", \"ëª©í‘œ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\");\n      return;\n    }\n\n    const targetDateString = getTargetDateString();\n\n    console.log(\"ğŸ” í•„ìˆ˜ ëª©í‘œ ì¤‘ë³µ ê²€ì‚¬:\", {\n      targetDate: targetDateString,\n      hasGoal: hasTodayGoal(targetDateString),\n      í˜„ì¬í•„ìˆ˜ëª©í‘œë“¤: getGoalsByDate(targetDateString),\n    });\n\n    if (hasTodayGoal(targetDateString)) {\n      Alert.alert(\"ì•Œë¦¼\", \"ì´ë¯¸ í•´ë‹¹ ë‚ ì§œì˜ í•„ìˆ˜ ëª©í‘œë¥¼ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.\");\n      return;\n    }\n\n    try {\n      await addGoal(title, targetDateString);\n      setNewGoalText(\"\");\n      Alert.alert(\"ëª©í‘œ ì¶”ê°€ ì™„ë£Œ\", \"í•„ìˆ˜ ëª©í‘œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\");\n    } catch (error) {\n      console.error(\"í•„ìˆ˜ ëª©í‘œ ì¶”ê°€ ì˜¤ë¥˜:\", error);\n      Alert.alert(\n        \"ì¶”ê°€ ì‹¤íŒ¨\",\n        (error as Error).message || \"ëª©í‘œ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\",\n      );\n    }\n  };\n\n  const handleCheckGoal = async (id: string) => {\n    try {\n      await checkGoal(id);\n    } catch (error) {\n      Alert.alert(\"ì²´í¬ ì‹¤íŒ¨\", \"ëª©í‘œ ì²´í¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\");\n    }\n  };\n\n  const handleDeleteGoal = (id: string, title: string) => {\n    Alert.alert(\"ëª©í‘œ ì‚­ì œ\", `\"${title}\" ëª©í‘œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`, [\n      { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n      {\n        text: \"ì‚­ì œ\",\n        style: \"destructive\",\n        onPress: async () => {\n          try {\n            await deleteGoal(id);\n            Alert.alert(\"ì‚­ì œ ì™„ë£Œ\", \"ëª©í‘œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\");\n          } catch (error) {\n            Alert.alert(\"ì‚­ì œ ì‹¤íŒ¨\", \"ëª©í‘œ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\");\n          }\n        },\n      },\n    ]);\n  };\n\n  const onRefresh = async () => {\n    setRefreshing(true);\n    await fetchGoals(getTargetDateString());\n    setRefreshing(false);\n  };\n\n  const renderTodayGoal = () => {\n    const currentGoals = getGoalsByDate(getTargetDateString());\n    const hasGoal = currentGoals.length > 0;\n\n    return (\n      <View style={styles.goalSection}>\n        <View style={styles.goalHeader}>\n          <Text style={styles.goalTypeIcon}>ğŸ¯</Text>\n          <Text style={styles.goalTypeTitle}>í•„ìˆ˜ ëª©í‘œ</Text>\n          <Text style={styles.goalCount}>{hasGoal ? `1/1` : \"0/1\"}</Text>\n        </View>\n\n        {currentGoals.map((goal) => (\n          <View key={goal.id} style={styles.goalItem}>\n            <TouchableOpacity\n              style={styles.goalCheckButton}\n              onPress={() => handleCheckGoal(goal.id)}\n            >\n              <Text style={styles.goalCheckIcon}>\n                {goal.status === \"success\" ? \"âœ…\" : \"â­•\"}\n              </Text>\n            </TouchableOpacity>\n\n            <View style={styles.goalContent}>\n              <Text\n                style={[\n                  styles.goalTitle,\n                  goal.status === \"success\" && styles.goalCompleted,\n                ]}\n              >\n                {goal.title}\n              </Text>\n              <Text style={styles.goalStatus}>\n                {goal.status === \"success\"\n                  ? \"ì™„ë£Œ\"\n                  : goal.status === \"failure\"\n                    ? \"ì‹¤íŒ¨\"\n                    : \"ì§„í–‰ ì¤‘\"}\n              </Text>\n            </View>\n\n            <TouchableOpacity\n              style={styles.goalDeleteButton}\n              onPress={() => handleDeleteGoal(goal.id, goal.title)}\n            >\n              <Text style={styles.goalDeleteIcon}>ğŸ—‘ï¸</Text>\n            </TouchableOpacity>\n          </View>\n        ))}\n\n        {!hasGoal && (\n          <View style={styles.goalInput}>\n            <TextInput\n              style={styles.input}\n              placeholder=\"ì˜¤ëŠ˜ ê¼­ í•˜ê³  ì‹¶ì€ í•„ìˆ˜ ëª©í‘œë¥¼ ì…ë ¥í•˜ì„¸ìš”\"\n              placeholderTextColor=\"#999\"\n              value={newGoalText}\n              onChangeText={setNewGoalText}\n              maxLength={100}\n            />\n            <TouchableOpacity style={styles.addButton} onPress={handleAddGoal}>\n              <Text style={styles.addButtonText}>ì¶”ê°€</Text>\n            </TouchableOpacity>\n          </View>\n        )}\n      </View>\n    );\n  };\n\n  return (\n    <ScrollView\n      style={styles.container}\n      refreshControl={\n        <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n      }\n    >\n      <View style={styles.header}>\n        <Text style={styles.headerTitle}>í•„ìˆ˜ ëª©í‘œ</Text>\n        <Text style={styles.headerSubtitle}>\n          ì‹œê°„ì— ì–½ë§¤ì´ì§€ ì•Šê³  ì˜¤ëŠ˜ ë‹¬ì„±í•˜ê³  ì‹¶ì€ ëª©í‘œë¥¼ ì ì–´ì£¼ì„¸ìš”!\n        </Text>\n        <Text style={styles.noticeText}>\n          ğŸ“Œ í•„ìˆ˜ ëª©í‘œëŠ” ë‹¹ì¼ì—ë§Œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n        </Text>\n      </View>\n\n      {/* ëª©í‘œ ì„¹ì…˜ */}\n      {renderTodayGoal()}\n\n      {/* ë„ì›€ë§ */}\n      <View style={styles.helpSection}>\n        <Text style={styles.helpTitle}>ğŸ’¡ ì‚¬ìš© íŒ</Text>\n        <Text style={styles.helpText}>\n          â€¢ í•˜ë£¨ì— í•˜ë‚˜ì˜ í•„ìˆ˜ ëª©í‘œë§Œ ì„¤ì • ê°€ëŠ¥í•©ë‹ˆë‹¤{\"\\n\"}â€¢ ë‹¹ì¼ì—ë§Œ ì„¤ì •í•  ìˆ˜\n          ìˆìŠµë‹ˆë‹¤{\"\\n\"}â€¢ ì˜ˆì‹œ: ë…ì„œ 50í˜ì´ì§€ ì´ìƒ ì½ê¸°{\"\\n\"}â€¢ ì„±ê³µë¥  ë°ì´í„°ì—ëŠ”\n          í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤\n        </Text>\n      </View>\n    </ScrollView>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#f5f5f5\",\n  },\n  header: {\n    backgroundColor: \"#fff\",\n    padding: 20,\n    borderBottomWidth: 1,\n    borderBottomColor: \"#e0e0e0\",\n  },\n  headerTitle: {\n    fontSize: 24,\n    fontWeight: \"bold\",\n    color: \"#333\",\n    marginBottom: 4,\n  },\n  headerSubtitle: {\n    fontSize: 14,\n    color: \"#666\",\n    marginBottom: 8,\n  },\n  noticeText: {\n    fontSize: 12,\n    color: \"#8e44ad\",\n    backgroundColor: \"#f3e5f5\",\n    padding: 8,\n    borderRadius: 6,\n    textAlign: \"center\",\n  },\n\n  goalSection: {\n    backgroundColor: \"#fff\",\n    marginHorizontal: 16,\n    marginTop: 20,\n    marginBottom: 16,\n    padding: 16,\n    borderRadius: 12,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  goalHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: 12,\n  },\n  goalTypeIcon: {\n    fontSize: 20,\n    marginRight: 8,\n  },\n  goalTypeTitle: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    color: \"#333\",\n    flex: 1,\n  },\n  goalCount: {\n    fontSize: 12,\n    color: \"#666\",\n    backgroundColor: \"#f0f0f0\",\n    paddingHorizontal: 8,\n    paddingVertical: 2,\n    borderRadius: 10,\n  },\n  goalItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: 12,\n    paddingHorizontal: 8,\n    backgroundColor: \"#f8f9fa\",\n    borderRadius: 8,\n    marginTop: 10,\n    marginBottom: 8,\n  },\n  goalCheckButton: {\n    marginRight: 12,\n  },\n  goalCheckIcon: {\n    fontSize: 20,\n  },\n  goalContent: {\n    flex: 1,\n  },\n  goalTitle: {\n    fontSize: 16,\n    color: \"#333\",\n    marginBottom: 2,\n  },\n  goalCompleted: {\n    textDecorationLine: \"line-through\",\n    color: \"#666\",\n  },\n  goalStatus: {\n    fontSize: 12,\n    color: \"#666\",\n  },\n  goalDeleteButton: {\n    marginLeft: 8,\n  },\n  goalDeleteIcon: {\n    fontSize: 16,\n  },\n  goalInput: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingTop: 8,\n  },\n  input: {\n    flex: 1,\n    borderWidth: 1,\n    borderColor: \"#ddd\",\n    borderRadius: 8,\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    fontSize: 14,\n    backgroundColor: \"#fff\",\n  },\n  addButton: {\n    backgroundColor: \"#2196F3\",\n    paddingHorizontal: 16,\n    paddingVertical: 8,\n    borderRadius: 8,\n    marginLeft: 8,\n  },\n  addButtonText: {\n    color: \"#fff\",\n    fontSize: 14,\n    fontWeight: \"bold\",\n  },\n  helpSection: {\n    backgroundColor: \"#fff\",\n    margin: 16,\n    padding: 16,\n    borderRadius: 12,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  helpTitle: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    color: \"#333\",\n    marginBottom: 8,\n  },\n  helpText: {\n    fontSize: 14,\n    color: \"#666\",\n    lineHeight: 20,\n  },\n});\n\nexport default FlexibleGoalScreen;\n","size_bytes":9183},"src/screens/GoalBatchScreen.tsx":{"content":"import React, { useEffect, useState } from \"react\";\nimport {\n  Alert,\n  Button,\n  FlatList,\n  Modal,\n  StyleSheet,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  View,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport useGoalStore from \"../store/goalStore\";\nimport CustomTimePicker from \"../components/CustomTimePicker\";\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ íƒ€ì… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\ninterface TempGoal {\n  id: string; // ë¡œì»¬ í‚¤\n  time: string; // ISO(30ë¶„ ê°„ê²©)\n  title: string; // ì…ë ¥ ë‚´ìš©\n}\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì»´í¬ë„ŒíŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nexport default function GoalBatchScreen({ route }: any) {\n  // useNavigation hook ì‚¬ìš©\n  const navigation = useNavigation() as any;\n  /* TimeSelect â†’ GoalBatch ì²« ì§„ì…(ì„ íƒ ì§í›„) */\n  const firstTime: string | undefined = route.params?.prefilledTime;\n  // ğŸ”¥ \"ë‚´ì¼ ìš°ì„ \" ë¡œì§: ê¸°ë³¸ê°’ì„ \"tomorrow\"ë¡œ ì„¤ì •\n  const isTomorrowMode = route.params?.initial !== \"today\"; // \"today\"ê°€ ì•„ë‹ˆë©´ ëª¨ë‘ ë‚´ì¼ ëª¨ë“œ\n\n  /* â‘  ì„ì‹œ ëª©ë¡ ìƒíƒœ - ë¹ˆ í™”ë©´ì—ì„œ ì‹œì‘ */\n  const [tempGoals, setTempGoals] = useState<TempGoal[]>(\n    firstTime ? [{ id: uuidv4(), time: firstTime, title: \"\" }] : [],\n  );\n\n  /* ì‹œê°„ ì„ íƒ ëª¨ë‹¬ ìƒíƒœ */\n  const [isTimePickerVisible, setIsTimePickerVisible] = useState(false);\n  const [selectedTime, setSelectedTime] = useState<Date>(new Date());\n  const [isTimeValid, setIsTimeValid] = useState<boolean>(true);\n\n  /* â‘¡ ì œëª© ë³€ê²½ */\n  const changeTitle = (id: string, text: string) =>\n    setTempGoals((prev) =>\n      prev.map((g) => (g.id === id ? { ...g, title: text } : g)),\n    );\n\n  /* â‘¢ í–‰ ì‚­ì œ - ë‚´ì¼ ëª¨ë“œì¼ ë•Œ 5ê°œ ë¯¸ë§Œìœ¼ë¡œ ì‚­ì œ ë°©ì§€ */\n  const removeRow = (id: string) => {\n    if (isTomorrowMode && tempGoals.length <= 5) {\n      Alert.alert(\"ì‚­ì œ ë¶ˆê°€\", \"ë‚´ì¼ ëª©í‘œëŠ” ìµœì†Œ 5ê°œ ì´ìƒ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.\");\n      return;\n    }\n    setTempGoals((prev) => prev.filter((g) => g.id !== id));\n  };\n\n  /* â‘£ 'ï¼‹' â†’ ì‹œê°„ ì„ íƒ ëª¨ë‹¬ ì—´ê¸° */\n  const openTimePicker = () => {\n    // ê¸°ë³¸ê°’ ì„¤ì • (ë‚´ì¼ ëª¨ë“œë©´ ë‚´ì¼ ì‹œê°„, ì•„ë‹ˆë©´ í˜„ì¬ ì‹œê°„ + 3ì‹œê°„)\n    const defaultTime = isTomorrowMode\n      ? (() => {\n          const tomorrow = new Date();\n          tomorrow.setDate(tomorrow.getDate() + 1);\n          tomorrow.setHours(9, 0, 0, 0); // ë‚´ì¼ ì˜¤ì „ 9ì‹œë¡œ ê¸°ë³¸ ì„¤ì •\n          return tomorrow;\n        })()\n      : (() => {\n          // ğŸ”¥ í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ 3ì‹œê°„ í›„ ê³„ì‚°\n          const koreaTime = new Date(new Date().toLocaleString(\"en-US\", {timeZone: \"Asia/Seoul\"}));\n          const futureTime = new Date(koreaTime.getTime() + 3 * 60 * 60 * 1000); // 3ì‹œê°„ í›„\n          const roundedMinutes = Math.ceil(futureTime.getMinutes() / 30) * 30;\n          if (roundedMinutes >= 60) {\n            futureTime.setHours(futureTime.getHours() + 1);\n            futureTime.setMinutes(0);\n          } else {\n            futureTime.setMinutes(roundedMinutes);\n          }\n          futureTime.setSeconds(0, 0);\n          \n          console.log(\"ğŸ“… GoalBatchScreen ê¸°ë³¸ ì‹œê°„ ê³„ì‚°:\", {\n            í˜„ì¬í•œêµ­ì‹œê°„: koreaTime.toLocaleString('ko-KR'),\n            ê³„ì‚°ê²°ê³¼: futureTime.toLocaleString('ko-KR')\n          });\n          \n          return futureTime;\n        })();\n\n    console.log(\"ğŸ“… ì‹œê°„ ì„ íƒ ëª¨ë‹¬ ì—´ê¸°:\", {\n      isTomorrowMode,\n      defaultTime: defaultTime.toLocaleString(\"ko-KR\"),\n      date: defaultTime.toLocaleDateString(\"ko-KR\"),\n    });\n\n    setSelectedTime(defaultTime);\n    setIsTimePickerVisible(true);\n  };\n\n  /* ì‹œê°„ ì„ íƒ í™•ì¸ */\n  const confirmTimeSelection = () => {\n    if (!isTimeValid) {\n      // ìœ íš¨í•˜ì§€ ì•Šì€ ì‹œê°„ì¼ ë•ŒëŠ” ê·¸ëƒ¥ ë¬´ì‹œ (UIì—ì„œ ì´ë¯¸ í‘œì‹œë¨)\n      return;\n    }\n\n    // ë‚´ì¼ ëª¨ë“œì¼ ë•Œ ë‚ ì§œ ì¬í™•ì¸\n    const finalTime = new Date(selectedTime);\n    if (isTomorrowMode) {\n      const tomorrow = new Date();\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      finalTime.setFullYear(tomorrow.getFullYear());\n      finalTime.setMonth(tomorrow.getMonth());\n      finalTime.setDate(tomorrow.getDate());\n    }\n\n    console.log(\"â° ëª©í‘œ ì‹œê°„ ì¶”ê°€:\", {\n      isTomorrowMode,\n      selectedTime: selectedTime.toLocaleString(\"ko-KR\"),\n      finalTime: finalTime.toLocaleString(\"ko-KR\"),\n      date: finalTime.toLocaleDateString(\"ko-KR\"),\n    });\n\n    const selectedTimeISO = finalTime.toISOString();\n\n    // ìƒˆ ëª©í‘œ ì¶”ê°€\n    const newGoal: TempGoal = {\n      id: uuidv4(),\n      time: selectedTimeISO,\n      title: \"\",\n    };\n\n    setTempGoals((prev) =>\n      [...prev, newGoal].sort(\n        (a, b) => new Date(a.time).getTime() - new Date(b.time).getTime(),\n      ),\n    );\n\n    setIsTimePickerVisible(false);\n  };\n\n  /* â‘¤ ëª©í‘œ ì €ì¥ ì²˜ë¦¬ */\n  const { addGoalsBatch, goals } = useGoalStore();\n\n  /* â‘¥ \"ì™„ë£Œ\" â†’ addGoalsBatch ë¡œ ì„œë²„ ì €ì¥ */\n  const onFinish = async () => {\n    // ë‚´ì¼ ëª¨ë“œì¼ ë•ŒëŠ” 5ê°œ ì´ìƒ, ì˜¤ëŠ˜ ëª¨ë“œì¼ ë•ŒëŠ” 5ê°œ ì´ìƒ í•„ìš”\n    const minimumGoals = 5;\n    if (tempGoals.length < minimumGoals) {\n      Alert.alert(\"ì•ˆë‚´\", `ëª©í‘œë¥¼ ìµœì†Œ ${minimumGoals}ê°œ ì´ìƒ ì‘ì„±í•´ ì£¼ì„¸ìš”.`);\n      return;\n    }\n    if (tempGoals.some((g) => !g.title.trim())) {\n      Alert.alert(\"ì•ˆë‚´\", \"ë¹ˆ ì œëª©ì´ ìˆìŠµë‹ˆë‹¤.\");\n      return;\n    }\n\n    /* ìµœì¢… Â±30ë¶„ ë²”ìœ„ ì¶©ëŒ ì²´í¬ */\n    const thirtyMinutes = 30 * 60 * 1000;\n\n    console.log(\"ğŸ” ì¶©ëŒ ê²€ì‚¬ ì‹œì‘:\", {\n      tempGoals: tempGoals.length,\n      existingGoals: (goals || []).length,\n      tempGoalTimes: tempGoals.map(g => ({\n        title: g.title,\n        local: new Date(g.time).toLocaleTimeString('ko-KR'),\n        date: new Date(g.time).toLocaleDateString('ko-KR'),\n        utc: g.time,\n        timestamp: new Date(g.time).getTime()\n      })),\n      existingGoalTimes: (goals || []).map(g => ({\n        title: g.title,\n        local: new Date(g.target_time).toLocaleTimeString('ko-KR'),\n        date: new Date(g.target_time).toLocaleDateString('ko-KR'),\n        utc: g.target_time,\n        timestamp: new Date(g.target_time).getTime()\n      }))\n    });\n\n    for (const tempGoal of tempGoals) {\n      const tempTime = new Date(tempGoal.time).getTime();\n      \n      // í˜„ì¬ ì‹œê°„ëŒ€ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ë¹„êµ\n      const tempDateLocal = new Date(tempGoal.time).toLocaleDateString();\n\n      // ê°™ì€ ë‚ ì§œì˜ ê¸°ì¡´ ëª©í‘œì™€ë§Œ ì¶©ëŒ ì²´í¬ (í˜„ì¬ ì‹œê°„ëŒ€ ê¸°ì¤€)\n      const sameDayGoals = (goals || []).filter(g => {\n        const goalDateLocal = new Date(g.target_time).toLocaleDateString();\n        return goalDateLocal === tempDateLocal;\n      });\n\n      console.log(\"ğŸ“… ê°™ì€ ë‚ ì§œ ëª©í‘œ í•„í„°ë§ (í˜„ì¬ì‹œê°„ëŒ€):\", {\n        tempGoalTitle: tempGoal.title,\n        tempGoalDate: tempDateLocal,\n        tempGoalTime: new Date(tempGoal.time).toLocaleString(),\n        tempGoalUTC: tempGoal.time,\n        sameDayGoalsCount: sameDayGoals.length,\n        sameDayGoals: sameDayGoals.map(g => ({\n          title: g.title,\n          time: new Date(g.target_time).toLocaleString(),\n          date: new Date(g.target_time).toLocaleDateString(),\n          utc: g.target_time\n        }))\n      });\n\n      const conflictingExisting = sameDayGoals.find((g) => {\n        const goalTime = new Date(g.target_time).getTime();\n        const timeDiff = Math.abs(tempTime - goalTime);\n        const isConflict = timeDiff < thirtyMinutes;\n        \n        console.log(\"â° ì‹œê°„ ì¶©ëŒ ê²€ì‚¬:\", {\n          tempGoalTitle: tempGoal.title,\n          tempGoal: new Date(tempGoal.time).toLocaleTimeString('ko-KR'),\n          existingGoalId: g.id,\n          existingGoalTitle: g.title,\n          existingGoal: new Date(g.target_time).toLocaleTimeString('ko-KR'),\n          timeDiffMinutes: Math.round(timeDiff / (60 * 1000)),\n          isConflict\n        });\n        \n        return isConflict;\n      });\n\n      if (conflictingExisting) {\n        const conflictTimeStr = new Date(conflictingExisting.target_time)\n          .toLocaleTimeString(\"ko-KR\", {\n            hour12: true,\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n          })\n          .replace(\"AM\", \"ì˜¤ì „\")\n          .replace(\"PM\", \"ì˜¤í›„\");\n\n        console.log(\"âŒ ê¸°ì¡´ ëª©í‘œì™€ ì¶©ëŒ ë°œê²¬ - ì €ì¥ ì°¨ë‹¨:\", {\n          tempGoalTitle: tempGoal.title,\n          tempGoalTime: new Date(tempGoal.time).toLocaleTimeString('ko-KR'),\n          conflictingGoalTitle: conflictingExisting.title,\n          conflictingGoalTime: conflictTimeStr,\n          timeDiffMinutes: Math.round(Math.abs(tempTime - new Date(conflictingExisting.target_time).getTime()) / (60 * 1000))\n        });\n        // ë‚´ì¼ ëª¨ë“œì—ì„œëŠ” 30ë¶„ ì œí•œ ì•Œë¦¼ í‘œì‹œ ì•ˆí•¨ (ë°°ì¹˜ ëª¨ë“œëŠ” ëŒ€ë¶€ë¶„ ë‚´ì¼ ëª¨ë“œ)\n        console.log(\"âœ… ë°°ì¹˜ ëª¨ë“œ - 30ë¶„ ì œí•œ ì•Œë¦¼ ê±´ë„ˆëœ€ (ì¶©ëŒ í—ˆìš©)\");\n        // ì•Œë¦¼ì€ í‘œì‹œí•˜ì§€ ì•Šì§€ë§Œ ë¡œê·¸ëŠ” ë‚¨ê¹€\n        console.log(\"âš ï¸ 30ë¶„ ì¶©ëŒì´ì§€ë§Œ ë°°ì¹˜ ëª¨ë“œì—ì„œ í—ˆìš©:\", {\n          newGoal: tempGoal.title,\n          conflictingGoal: conflictingExisting.title,\n          timeDiff: Math.round(Math.abs(tempTime - new Date(conflictingExisting.target_time).getTime()) / (60 * 1000)) + \"ë¶„\"\n        });\n      }\n\n      // ì„ì‹œ ëª©í‘œë“¤ ê°„ì˜ ì¶©ëŒ ì²´í¬\n      const conflictingTemp = tempGoals.find((g) => {\n        if (g.id === tempGoal.id) return false; // ìê¸° ìì‹  ì œì™¸\n        const goalTime = new Date(g.time).getTime();\n        const timeDiff = Math.abs(tempTime - goalTime);\n        const isConflict = timeDiff < thirtyMinutes;\n        \n        if (isConflict) {\n          console.log(\"âš ï¸ ì„ì‹œ ëª©í‘œ ê°„ ì¶©ëŒ ë°œê²¬:\", {\n            tempGoal1: new Date(tempGoal.time).toLocaleTimeString('ko-KR'),\n            tempGoal2: new Date(g.time).toLocaleTimeString('ko-KR'),\n            timeDiffMinutes: Math.round(timeDiff / (60 * 1000))\n          });\n        }\n        \n        return isConflict;\n      });\n\n      if (conflictingTemp) {\n        const tempTimeStr = new Date(tempGoal.time)\n          .toLocaleTimeString(\"ko-KR\", {\n            hour12: true,\n            hour: \"2-digit\",\n            minute: \"2-digit\",\n          })\n          .replace(\"AM\", \"ì˜¤ì „\")\n          .replace(\"PM\", \"ì˜¤í›„\");\n\n        console.log(\"âŒ ì„ì‹œ ëª©í‘œ ê°„ ì¶©ëŒ ë°œê²¬ - ì €ì¥ ì°¨ë‹¨\");\n        // ë°°ì¹˜ ëª¨ë“œì—ì„œëŠ” 30ë¶„ ì œí•œ ì•Œë¦¼ í‘œì‹œ ì•ˆí•¨\n        console.log(\"âœ… ë°°ì¹˜ ëª¨ë“œ - ì„ì‹œ ëª©í‘œ 30ë¶„ ì œí•œ ì•Œë¦¼ ê±´ë„ˆëœ€\");\n        // ì•Œë¦¼ì€ í‘œì‹œí•˜ì§€ ì•Šì§€ë§Œ ë¡œê·¸ëŠ” ë‚¨ê¹€\n        console.log(\"âš ï¸ ì„ì‹œ ëª©í‘œ 30ë¶„ ì¶©ëŒì´ì§€ë§Œ ë°°ì¹˜ ëª¨ë“œì—ì„œ í—ˆìš©:\", {\n          time: tempTimeStr,\n          conflictingTime: new Date(conflictingTemp.time).toLocaleTimeString('ko-KR')\n        });\n      }\n    }\n\n    try {\n      // ë‚´ì¼ ëª¨ë“œì¼ ë•Œ ë‚ ì§œë¥¼ ë‚´ì¼ë¡œ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •\n      const goalsToSave = tempGoals.map((g) => {\n        const targetTime = new Date(g.time);\n\n        if (isTomorrowMode) {\n          // ë‚´ì¼ ë‚ ì§œë¡œ ëª…ì‹œì  ì„¤ì •\n          const tomorrow = new Date();\n          tomorrow.setDate(tomorrow.getDate() + 1);\n          targetTime.setFullYear(tomorrow.getFullYear());\n          targetTime.setMonth(tomorrow.getMonth());\n          targetTime.setDate(tomorrow.getDate());\n        }\n\n        return {\n          title: g.title.trim(),\n          target_time: targetTime.toISOString(),\n        };\n      });\n\n      console.log(\"ğŸš€ ëª©í‘œ ì €ì¥:\", {\n        isTomorrowMode,\n        goalsToSave: goalsToSave.map((g) => ({\n          title: g.title,\n          date: new Date(g.target_time).toLocaleDateString(\"ko-KR\"),\n          time: new Date(g.target_time).toLocaleTimeString(\"ko-KR\"),\n        })),\n      });\n\n      await addGoalsBatch(goalsToSave);\n      \n      // ì €ì¥ í›„ ëª©í‘œ ë°ì´í„° ê°•ì œ ìƒˆë¡œê³ ì¹¨\n      const { fetchGoals } = useGoalStore.getState();\n      await fetchGoals();\n      \n      console.log(\"ğŸ”˜ GoalBatch ì €ì¥ ì™„ë£Œ - ëª©í‘œ ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ\");\n\n      console.log(\"ğŸ”˜ GoalBatch ì €ì¥ ì™„ë£Œ - navigation ìƒíƒœ:\", {\n        navigation: !!navigation,\n        navigate: !!navigation?.navigate,\n        reset: !!navigation?.reset,\n      });\n\n      if (!navigation) {\n        console.error(\"âŒ GoalBatch: navigationì´ nullì…ë‹ˆë‹¤!\");\n        return;\n      }\n\n      if (!navigation.reset) {\n        console.error(\"âŒ GoalBatch: navigation.resetì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!\");\n        return;\n      }\n\n      try {\n        console.log(\"ğŸš€ GoalListë¡œ reset ì´ë™\");\n        navigation.reset({ index: 0, routes: [{ name: \"GoalList\" }] });\n      } catch (error) {\n        console.error(\"âŒ GoalBatch reset í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:\", error);\n      }\n    } catch (e: any) {\n      Alert.alert(\"ì—ëŸ¬\", e.message);\n    }\n  };\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ UI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n  return (\n    <View style={styles.container}>\n      <FlatList\n        data={tempGoals}\n        keyExtractor={(item) => item.id}\n        renderItem={({ item }) => (\n          <View style={styles.row}>\n            <Text style={styles.time}>\n              {new Date(item.time)\n                .toLocaleTimeString(\"ko-KR\", {\n                  hour12: true,\n                  hour: \"2-digit\",\n                  minute: \"2-digit\",\n                })\n                .replace(\"AM\", \"ì˜¤ì „\")\n                .replace(\"PM\", \"ì˜¤í›„\")}\n            </Text>\n\n            <TextInput\n              placeholder=\"ë‚´ì¼ì€... ë¬´ì—‡ì„ í•˜ê³ ì í•˜ì‹œë‚˜ìš”?\"\n              placeholderTextColor=\"#999\"\n              value={item.title}\n              onChangeText={(t) => changeTitle(item.id, t)}\n              style={styles.input}\n            />\n\n            <TouchableOpacity onPress={() => removeRow(item.id)}>\n              <Text style={styles.del}>ì‚­ì œ</Text>\n            </TouchableOpacity>\n          </View>\n        )}\n        ListEmptyComponent={\n          <View style={{ alignItems: \"center\", marginTop: 32 }}>\n            <Text style={{ textAlign: \"center\", fontSize: 16, color: \"#666\" }}>\n              \"ï¼‹\" ë²„íŠ¼ì„ ëˆŒëŸ¬ ëª©í‘œë¥¼ ì¶”ê°€í•˜ì„¸ìš”\n            </Text>\n            <Text\n              style={{\n                textAlign: \"center\",\n                fontSize: 13,\n                color: \"#e74c3c\",\n                marginTop: 12,\n                fontWeight: \"500\",\n              }}\n            >\n              âš ï¸ ëª©í‘œ ê°„ê²©ì€ ìµœì†Œ 30ë¶„ ì´ìƒ ìœ ì§€í•´ì£¼ì„¸ìš”\n            </Text>\n          </View>\n        }\n      />\n\n      {/* í•˜ë‹¨ ë²„íŠ¼ */}\n      <View style={styles.bottom}>\n        <Button title=\"ï¼‹ ëª©í‘œ ì¶”ê°€\" onPress={openTimePicker} />\n        <Text\n          style={{\n            textAlign: \"center\",\n            fontSize: 12,\n            color: \"#e74c3c\",\n            marginTop: 8,\n            marginBottom: 4,\n            fontWeight: \"500\",\n          }}\n        ></Text>\n        <View style={{ height: 8 }} />\n        <Button\n          title=\"ì™„ë£Œ\"\n          onPress={onFinish}\n          disabled={tempGoals.length < 5}\n        />\n      </View>\n\n      {/* ì‹œê°„ ì„ íƒ ëª¨ë‹¬ */}\n      <Modal\n        visible={isTimePickerVisible}\n        animationType=\"slide\"\n        presentationStyle=\"pageSheet\"\n      >\n        <View style={styles.modalContainer}>\n          <View style={styles.modalHeader}>\n            <TouchableOpacity\n              onPress={() => setIsTimePickerVisible(false)}\n              style={styles.cancelButton}\n            >\n              <Text style={styles.cancelText}>ì·¨ì†Œ</Text>\n            </TouchableOpacity>\n            <Text style={styles.modalTitle}>ì‹œê°„ ì„ íƒ</Text>\n            <TouchableOpacity\n              onPress={confirmTimeSelection}\n              style={[\n                styles.confirmButton,\n                !isTimeValid && styles.disabledButton,\n              ]}\n              disabled={!isTimeValid}\n            >\n              <Text\n                style={[\n                  styles.confirmText,\n                  !isTimeValid && styles.disabledText,\n                ]}\n              >\n                í™•ì¸\n              </Text>\n            </TouchableOpacity>\n          </View>\n\n          <CustomTimePicker\n            value={selectedTime}\n            onChange={setSelectedTime}\n            onValidityChange={setIsTimeValid}\n            isTomorrowMode={isTomorrowMode}\n            conflictingTimes={[\n              ...tempGoals.map((g) => new Date(g.time)),\n              ...goals.map((g) => new Date(g.target_time)),\n            ]}\n          />\n        </View>\n      </Modal>\n    </View>\n  );\n}\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ìŠ¤íƒ€ì¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nconst styles = StyleSheet.create({\n  container: { flex: 1, padding: 16 },\n  row: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: 12,\n    backgroundColor: \"#f0f0f0\",\n    padding: 10,\n    borderRadius: 8,\n  },\n  time: {\n    fontSize: 13,\n    fontWeight: \"bold\",\n    width: 80,\n    color: \"#333\",\n  },\n  input: {\n    flex: 1,\n    marginLeft: 8,\n    paddingVertical: 12,\n    paddingHorizontal: 8,\n    fontSize: 14,\n    minHeight: 44,\n    backgroundColor: \"#ffffff\",\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: \"#e0e0e0\",\n  },\n  del: {\n    color: \"#E53935\",\n    marginLeft: 8,\n    fontSize: 14,\n  },\n  bottom: {\n    marginTop: 16,\n    paddingTop: 16,\n    borderTopWidth: 1,\n    borderTopColor: \"#eee\",\n  },\n  modalContainer: {\n    flex: 1,\n    backgroundColor: \"#ffffff\",\n  },\n  modalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    paddingHorizontal: 20,\n    paddingVertical: 15,\n    borderBottomWidth: 1,\n    borderBottomColor: \"#eee\",\n  },\n  modalTitle: {\n    fontSize: 18,\n    fontWeight: \"600\",\n    color: \"#1d1d1f\",\n  },\n  cancelButton: {\n    paddingHorizontal: 10,\n    paddingVertical: 5,\n  },\n  cancelText: {\n    fontSize: 16,\n    color: \"#007AFF\",\n  },\n  confirmButton: {\n    paddingHorizontal: 10,\n    paddingVertical: 5,\n  },\n  confirmText: {\n    fontSize: 16,\n    fontWeight: \"600\",\n    color: \"#007AFF\",\n  },\n  disabledButton: {\n    opacity: 0.5,\n  },\n  disabledText: {\n    color: \"#999999\",\n  },\n});\n","size_bytes":18349},"src/screens/GoalDetailScreen.tsx":{"content":"import React, { useEffect, useState } from 'react';\nimport {\n  Alert,\n  Button,\n  Platform,\n  Text,\n  TextInput,\n  View,\n} from 'react-native';\nimport { CommonActions, StackActions } from '@react-navigation/native';\nimport useGoalStore from '../store/goalStore';\nimport { getTodayKorea, getTomorrowKorea, formatDateKorea } from '../utils/timeUtils';\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ìœ í‹¸ë¦¬í‹° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nconst isValidTitle = (title: string): boolean => {\n  const regex = /^[a-zA-Z0-9ê°€-í£ã„±-ã…ã…-ã…£\\s]{1,40}$/;\n  return regex.test(title);\n};\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì»´í¬ë„ŒíŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nexport default function GoalDetailScreen({ route, navigation }: any) {\n  const { goalId, prefilledTime, batch } = route.params;\n  const { goals, addGoal, updateGoal, deleteGoal } = useGoalStore();\n\n  /* ëª©í‘œ ì •ë³´ */\n  const [title, setTitle] = useState('');\n  const [targetTime, setTargetTime] = useState(prefilledTime || '');\n  const [inputErr, setInputErr] = useState(false);\n\n  /* í¸ì§‘ ëª¨ë“œ í™•ì¸ */\n  const existing = goals.find((g: any) => g.id === goalId);\n\n  /* í¸ì§‘ ëª¨ë“œ ì‹œê°„ ë™ê¸°í™” */\n  useEffect(() => {\n    if (existing) {\n      setTitle(existing.title);\n      setTargetTime(existing.target_time);\n    }\n  }, [existing]);\n\n  /* ì‹œê°„ ì¬ì„¤ì • í›„ ëŒì•„ì˜¬ ë•Œ ì—…ë°ì´íŠ¸ëœ ì‹œê°„ ë°˜ì˜ */\n  useEffect(() => {\n    const unsubscribe = navigation.addListener('focus', () => {\n      // TimeSelectì—ì„œ ëŒì•„ì˜¨ ê²½ìš° ì—…ë°ì´íŠ¸ëœ ì‹œê°„ ë°˜ì˜\n      if (route.params?.updatedTime) {\n        console.log('ğŸ”„ ì‹œê°„ ì¬ì„¤ì • ì™„ë£Œ:', route.params.updatedTime);\n        setTargetTime(route.params.updatedTime);\n        // íŒŒë¼ë¯¸í„° ì •ë¦¬ (ë‹¤ìŒë²ˆ focusì—ì„œ ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€)\n        navigation.setParams({ updatedTime: undefined });\n      }\n    });\n\n    return unsubscribe;\n  }, [navigation, route.params]);\n\n  /* ì•ˆì „ ë³µê·€ (ë‹¨ê±´ ëª¨ë“œ ì „ìš©) */\n  const backToList = () => {\n    const depth = navigation.getState().routes.length;\n    if (prefilledTime && depth >= 3) {\n      navigation.dispatch(StackActions.pop(2)); // TimeSelect + GoalDetail ì œê±°\n    } else if (navigation.canGoBack()) {\n      navigation.goBack();\n    } else {\n      navigation.navigate('GoalList');\n    }\n  };\n\n  /* ì…ë ¥ í•¸ë“¤ëŸ¬ */\n  const handleChange = (txt: string) => {\n    if (txt.length > 40) return;\n    setTitle(txt);\n    setInputErr(!isValidTitle(txt) && txt.length > 0);\n  };\n\n  /* ì €ì¥ ë²„íŠ¼ */\n  const handleSave = async () => {\n    const trimmed = title.trim();\n    if (!isValidTitle(trimmed)) {\n      Alert.alert('ì…ë ¥ í™•ì¸', 'íŠ¹ìˆ˜ë¬¸ì ì—†ì´ 40ì ì´ë‚´ë¡œ ì‘ì„±í•´ ì£¼ì„¸ìš”.');\n      return;\n    }\n\n    /* â‘  ë°°ì¹˜ ëª¨ë“œ â”€ TimeSelectÂ·GoalDetail ë‘ í™”ë©´ pop í›„ GoalBatch ë¡œ ë³‘í•© ì´ë™ */\n    if (batch) {\n      /* ìŠ¤íƒ:  GoalBatch â–¸ TimeSelect â–¸ GoalDetail(í˜„ì¬)  */\n      navigation.dispatch(StackActions.pop(2)); // TimeSelect + GoalDetail ì œê±°\n\n      navigation.dispatch(\n        CommonActions.navigate({\n          name  : 'GoalBatch',\n          params: { newGoal: { time: targetTime, title: trimmed } },\n          merge : true,\n        })\n      );\n      return;\n    }\n\n    /* â‘¡ ë‹¨ê±´ ëª¨ë“œ â”€ DB ë°˜ì˜ */\n    try {\n      // Â±30ë¶„ ë²”ìœ„ ì¶©ëŒ ì²´í¬\n      const selectedTime = new Date(targetTime).getTime();\n      const thirtyMinutes = 30 * 60 * 1000;\n      \n      // ê°™ì€ ë‚ ì§œì˜ ëª©í‘œë“¤ë§Œ í•„í„°ë§ (í˜„ì¬ ì‹œê°„ëŒ€ ê¸°ì¤€)\n      const selectedDateLocal = new Date(targetTime).toLocaleDateString();\n      const sameDayGoals = goals.filter(g => {\n        const goalDateLocal = new Date(g.target_time).toLocaleDateString();\n        return goalDateLocal === selectedDateLocal;\n      });\n\n      console.log(\"ğŸ“… GoalDetailScreen ê°™ì€ ë‚ ì§œ í•„í„°ë§ (í˜„ì¬ì‹œê°„ëŒ€):\", {\n        selectedDate: selectedDateLocal,\n        selectedTime: new Date(targetTime).toLocaleString(),\n        totalGoals: goals.length,\n        sameDayGoals: sameDayGoals.length,\n        sameDayGoalTimes: sameDayGoals.map(g => new Date(g.target_time).toLocaleString())\n      });\n\n      const conflictingGoal = sameDayGoals.find(g => {\n        // ë³¸ì¸ ëª©í‘œëŠ” ì œì™¸ (ìˆ˜ì • ì‹œ)\n        if (g.id === goalId) return false;\n        \n        const goalTime = new Date(g.target_time).getTime();\n        const timeDiff = Math.abs(selectedTime - goalTime);\n        const isConflict = timeDiff < thirtyMinutes;\n\n        console.log(\"â° GoalDetailScreen ì¶©ëŒ ì²´í¬:\", {\n          existingGoal: new Date(g.target_time).toLocaleTimeString('ko-KR'),\n          timeDiffMinutes: Math.round(timeDiff / (60 * 1000)),\n          isConflict\n        });\n\n        return isConflict;\n      });\n      \n      if (conflictingGoal) {\n        const conflictTimeStr = new Date(conflictingGoal.target_time).toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour: '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n        \n        // ë‚´ì¼ ëª¨ë“œì—ì„œëŠ” 30ë¶„ ì œí•œ ì•Œë¦¼ í‘œì‹œ ì•ˆí•¨\n        const isTomorrowMode = route.params?.batch === false; // batchê°€ falseë©´ ë‚´ì¼ ëª¨ë“œ\n        if (!isTomorrowMode) {\n          Alert.alert(\n            'ì‹œê°„ ì„¤ì • ì œí•œ', \n            `${conflictTimeStr}ì— ì„¤ì •ëœ ëª©í‘œì™€ ë„ˆë¬´ ê°€ê¹ìŠµë‹ˆë‹¤.\\n\\n` +\n            'ëª©í‘œ ê°„ê²©ì€ ìµœì†Œ 30ë¶„ ì´ìƒ ìœ ì§€í•´ì£¼ì„¸ìš”.'\n          );\n          return;\n        } else {\n          console.log(\"âœ… ë‚´ì¼ ëª¨ë“œ - 30ë¶„ ì œí•œ ì•Œë¦¼ ê±´ë„ˆëœ€\");\n        }\n      }\n\n      if (existing) {\n        await updateGoal(goalId, {\n          title: trimmed,\n          target_time: targetTime,\n        });\n      } else {\n        await addGoal(trimmed, targetTime);\n      }\n      backToList();\n    } catch (e: any) {\n      Alert.alert('ì €ì¥ ì‹¤íŒ¨', e.message || 'ëª©í‘œ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n    }\n  };\n\n  /* ì‚­ì œ (ë‹¨ê±´ ëª¨ë“œ ì „ìš©) */\n  const handleDelete = () =>\n    Alert.alert('ì‚­ì œ í™•ì¸', 'ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?', [\n      { text: 'ì·¨ì†Œ', style: 'cancel' },\n      {\n        text: 'ì‚­ì œ',\n        style: 'destructive',\n        onPress: async () => {\n          try {\n            await deleteGoal(goalId);\n            backToList();\n          } catch (e: any) {\n            Alert.alert('ì‚­ì œ ì‹¤íŒ¨', e.message || 'ëª©í‘œ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n          }\n        },\n      },\n    ]);\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ UI â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n  return (\n    <View style={{ flex: 1, padding: 16 }}>\n      <Text style={{ fontSize: 18, marginBottom: 12 }}>\n        {existing ? 'ëª©í‘œ ìˆ˜ì •' : batch ? 'ëª©í‘œ ì‘ì„±' : 'ìƒˆ ëª©í‘œ ìƒì„±'}\n      </Text>\n\n      {/* ì„ íƒëœ ì‹œê°„ */}\n      <Text style={{ fontSize: 20, marginBottom: 12 }}>\n        {new Date(targetTime).toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour  : '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„')}\n      </Text>\n\n      {/* ì‹œê°„ ì¬ì„¤ì • ë²„íŠ¼ (í¸ì§‘ ëª¨ë“œì—ì„œ í•­ìƒ í‘œì‹œ) */}\n      {(existing || !batch) && (\n        <>\n          <Button title=\"ì‹œê°„ ì¬ì„¤ì •\" onPress={() => {\n            // ê¸°ì¡´ ëª©í‘œ í¸ì§‘ ì‹œ ì‹œê°„ ì¬ì„¤ì •\n            if (existing) {\n              // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚´ì¼ ëª©í‘œì¸ì§€ í™•ì¸\n              const goalDate = new Date(existing.target_time);\n              const koreanDate = new Date(goalDate.getTime() + (9 * 60 * 60 * 1000));\n              const now = new Date();\n              const koreaTime = new Date(now.getTime() + (9 * 60 * 60 * 1000));\n              const tomorrowKey = new Date(koreaTime.getTime() + 86400000).toISOString().slice(0, 10);\n              const goalDateKey = koreanDate.toISOString().slice(0, 10);\n              \n              const isTomorrow = goalDateKey === tomorrowKey;\n              \n              navigation.navigate('TimeSelect', {\n                goalId: goalId,\n                currentTime: targetTime,\n                initial: isTomorrow ? 'tomorrow' : 'today'\n              });\n            } else {\n              // ìƒˆ ëª©í‘œ ìƒì„± ì‹œ\n              navigation.navigate('TimeSelect', {\n                goalId: goalId,\n                currentTime: targetTime\n              });\n            }\n          }} />\n          <View style={{ height: 24 }} />\n        </>\n      )}\n\n      <TextInput\n        placeholder=\"ë‚´ì¼ì€... ë¬´ì—‡ì„ í•˜ê³ ì í•˜ì‹œë‚˜ìš”?\"\n        placeholderTextColor=\"#999\"\n        value={title}\n        maxLength={40}\n        onChangeText={handleChange}\n        style={{\n          borderBottomWidth: 1,\n          fontSize: 16,\n          paddingVertical: 8,\n          marginBottom: 24,\n          borderColor: inputErr ? '#E53935' : '#ccc',\n        }}\n      />\n\n      {inputErr && (\n        <Text style={{ color: '#E53935', fontSize: 12, marginBottom: 12 }}>\n          íŠ¹ìˆ˜ë¬¸ì ì—†ì´ 40ì ì´ë‚´ë¡œ ì‘ì„±í•´ ì£¼ì„¸ìš”.\n        </Text>\n      )}\n\n      <Button title=\"ì €ì¥\" onPress={handleSave} />\n\n      {/* ë‹¨ê±´ ëª¨ë“œì˜ í¸ì§‘ ì‹œì—ë§Œ ì‚­ì œ ë²„íŠ¼ í‘œì‹œ */}\n      {existing && !batch && (\n        <View style={{ marginTop: 24 }}>\n          <Button title=\"ì‚­ì œ\" color=\"#E53935\" onPress={handleDelete} />\n        </View>\n      )}\n    </View>\n  );\n}","size_bytes":9388},"src/screens/GoalListScreen.tsx":{"content":"// src/screens/GoalListScreen.tsx\nimport React, { useEffect, useMemo, useState, useRef } from \"react\";\nimport {\n  Alert,\n  AppState,\n  Button,\n  SectionList,\n  SectionListData,\n  StyleSheet,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  View,\n  KeyboardAvoidingView,\n  Platform,\n  Keyboard,\n  Modal,\n  Image,\n  RefreshControl,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport type { NativeStackNavigationProp } from \"@react-navigation/native-stack\";\nimport useGoalStore, { Goal } from \"../store/goalStore\";\nimport useProfileStore from \"../store/profileStore\";\nimport useRetrospectStore from \"../store/retrospectStore\";\nimport useCommunityStore from \"../store/communityStore\";\nimport { useFlexibleGoalStore } from \"../store/flexibleGoalStore\";\nimport { useAppLifecycle } from \"../hooks/useAppLifecycle\";\nimport { registerGlobalDebugFunctions } from \"../utils/globalDebugFunctions\";\n\nimport { getTodayKorea, getTomorrowKorea } from \"../utils/timeUtils\";\nimport { getBadgeImage } from \"../utils/badgeImageMap\";\nimport { DailyStreakManager } from \"../utils/streakBadgeSystem\";\n// ìŠ¤íƒ€ì¼ ìƒìˆ˜ ì œê±°\nimport UIButton from \"../components/ui/Button\";\nimport Card from \"../components/ui/Card\";\nimport { Ionicons } from \"@expo/vector-icons\";\n\n/* â”€â”€â”€â”€â”€ ë‚ ì§œ ìœ í‹¸ â”€â”€â”€â”€â”€ */\nconst ymd = (d: Date | string) =>\n  (typeof d === \"string\" ? d : d.toISOString()).slice(0, 10);\n// ì‹¤ì‹œê°„ìœ¼ë¡œ ë‚ ì§œ ê³„ì‚° (ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì‹œë§ˆë‹¤ ê°±ì‹ )\nconst getCurrentDateKeys = () => {\n  // ê°•ì œë¡œ í˜„ì¬ í•œêµ­ ì‹œê°„ ê³„ì‚°\n  const now = new Date();\n  const koreaOffset = 9 * 60; // KSTëŠ” UTC+9\n  const utcTime = now.getTime() + now.getTimezoneOffset() * 60000;\n  const koreaTime = new Date(utcTime + koreaOffset * 60000);\n\n  const todayKey = koreaTime.toISOString().slice(0, 10);\n  const tomorrowKey = new Date(koreaTime.getTime() + 86400000)\n    .toISOString()\n    .slice(0, 10);\n\n  return { todayKey, tomorrowKey };\n};\n\n/* â”€â”€â”€â”€â”€ íƒ€ì… â”€â”€â”€â”€â”€ */\ninterface GoalSection {\n  title: string;\n  data: { goal: Goal; canCheck: boolean; canEdit: boolean }[];\n}\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n// íƒ€ì… ì •ì˜\ntype RootStackParamList = {\n  GoalList: undefined;\n  GoalDetail: { goalId: string };\n  GoalBatch: { initial?: string };\n  TimeSelect: { initial?: string };\n  Retrospect: undefined;\n  FlexibleGoal: { targetDate: string };\n};\n\ntype GoalListScreenNavigationProp =\n  NativeStackNavigationProp<RootStackParamList>;\n\nexport default function GoalListScreen({ navigation: navProp, route }: any) {\n  // GoalListScreen ì»´í¬ë„ŒíŠ¸ ë Œë”ë§\n\n  // useNavigation hookì„ ì‚¬ìš©í•˜ì—¬ ë” ì•ˆì •ì ì¸ navigation ì°¸ì¡°\n  const navigation = useNavigation() as any;\n\n  // ì‹ ê·œ ì‚¬ìš©ì ì²« ë°©ë¬¸ ì²´í¬\n  const isFirstTimeUser = route?.params?.firstTimeUser;\n\n  // Navigation ê°ì²´ ìƒíƒœ í™•ì¸\n\n  /* store */\n  const {\n    goals,\n    fetchGoals: fetchGoalsOriginal,\n    checkGoal,\n    expireOverdueGoals,\n    getGoalsWithCanCheck,\n    cleanupOldGoals,\n    addAchievementMemo,\n    getCurrentStreak,\n    getStreakCategory,\n    streakBadge,\n    goalBadges,\n\n  } = useGoalStore();\n\n  // fetchGoals ë˜í¼ í•¨ìˆ˜ë¡œ ë””ë²„ê¹… ë° ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™”\n  const fetchGoals = async () => {\n    // ëª©í‘œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹œë„\n    try {\n      await fetchGoalsOriginal();\n      // ëª©í‘œ ë°ì´í„° ë¡œë“œ ì™„ë£Œ\n    } catch (error) {\n      console.error(\"âŒ fetchGoalsOriginal ì‹¤í–‰ ì˜¤ë¥˜:\", error);\n\n      // ë„¤íŠ¸ì›Œí¬ ê´€ë ¨ ì˜¤ë¥˜ êµ¬ë¶„\n      const isNetworkError =\n        error instanceof TypeError &&\n        (error.message.includes(\"Network request failed\") ||\n          error.message.includes(\"fetch\"));\n\n      const errorMessage = isNetworkError\n        ? \"ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\"\n        : \"ëª©í‘œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì•±ì„ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\";\n\n      // ì˜¤ë¥˜ ë°œìƒ ì‹œ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ í‘œì‹œ\n      Alert.alert(\"ëª©í‘œ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨\", errorMessage, [\n        { text: \"ë‹¤ì‹œ ì‹œë„\", onPress: () => fetchGoals() },\n        { text: \"í™•ì¸\", style: \"cancel\" },\n      ]);\n    }\n  };\n  const { profile, updateDream, fetchProfile } = useProfileStore();\n  const { todayRetrospectExists, fetchToday } = useRetrospectStore();\n  const {\n    myResolution,\n    fetchMyResolution,\n    saveMyResolution: saveResolution,\n    updateMyResolution,\n    deleteMyResolution,\n  } = useCommunityStore();\n  const {\n    goals: flexibleGoals,\n    fetchGoals: fetchFlexibleGoals,\n    checkGoal: checkFlexibleGoal,\n    getTomorrowGoals: getTomorrowFlexibleGoals,\n    hasTodayGoal: hasFlexibleTodayGoal,\n    hasTomorrowGoal: hasFlexibleTomorrowGoal,\n  } = useFlexibleGoalStore();\n\n  // ğŸ“± ì•± ìƒëª…ì£¼ê¸° ê´€ë¦¬ - ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ì œì–´\n  const { isActive } = useAppLifecycle();\n\n  /* ê¿ˆ í¸ì§‘ ìƒíƒœ */\n  const [isEditingDream, setIsEditingDream] = useState(false);\n  const [dreamText, setDreamText] = useState(\"\");\n\n  /* ê°ì˜¤ í¸ì§‘ ìƒíƒœ */\n  const [isWritingResolution, setIsWritingResolution] = useState(false);\n  const [resolutionText, setResolutionText] = useState(\"\");\n  const [isResolutionExpanded, setIsResolutionExpanded] = useState(false);\n\n  /* ë©”ëª¨ ê´€ë ¨ ìƒíƒœ */\n  const [memoModalVisible, setMemoModalVisible] = useState(false);\n  const [selectedGoalId, setSelectedGoalId] = useState<string | null>(null);\n  const [memoText, setMemoText] = useState(\"\");\n\n  /* ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨ ìƒíƒœ */\n  const [refreshing, setRefreshing] = useState(false);\n\n  /* â”€â”€â”€â”€â”€ ì‹ ê·œ ì‚¬ìš©ì ì²« ëª©í‘œ ì‘ì„± ìë™ ì´ë™ â”€â”€â”€â”€â”€ */\n  useEffect(() => {\n    const params = route?.params as any;\n    const isFirstTimeUser = params?.firstTimeUser;\n\n    if (isFirstTimeUser && navigation) {\n      console.log(\"ğŸ¯ ì‹ ê·œ ì‚¬ìš©ì ê°ì§€ - ë‚´ì¼ ëª©í‘œ ì‘ì„±ìœ¼ë¡œ ìë™ ì´ë™\");\n      // ì•½ê°„ì˜ ì§€ì—° í›„ ìë™ ì´ë™ (UI ì•ˆì •í™”)\n      const timer = setTimeout(() => {\n        navigation.navigate(\"GoalBatch\", { initial: \"tomorrow\" });\n      }, 1000);\n\n      return () => clearTimeout(timer);\n    }\n  }, [route?.params, navigation]);\n\n  /* â”€â”€â”€â”€â”€ ì´ˆê¸°í™” â”€â”€â”€â”€â”€ */\n  useEffect(() => {\n    const handleAppActive = (state: string) => {\n      if (state === \"active\") {\n        fetchGoals();\n        // cleanupOldGoals(); // 2ë…„ ë³´ê´€ ì •ì±…ìœ¼ë¡œ ì¸í•´ ë¹„í™œì„±í™”\n        expireOverdueGoals();\n        fetchMyResolution();\n        fetchToday();\n        fetchProfile();\n      }\n    };\n    const subscription = AppState.addEventListener(\"change\", handleAppActive);\n\n    // ì´ˆê¸° ì‹¤í–‰\n    console.log(\"ğŸš€ GoalListScreenì—ì„œ fetchGoals í˜¸ì¶œ ì‹œì‘\");\n    fetchGoals().catch((err) => console.error(\"âŒ fetchGoals ì˜¤ë¥˜:\", err));\n    // cleanupOldGoals(); // 2ë…„ ë³´ê´€ ì •ì±…ìœ¼ë¡œ ì¸í•´ ë¹„í™œì„±í™”\n    expireOverdueGoals();\n    // íšŒê³  ì•Œë¦¼ ì‹œìŠ¤í…œì´ goalStoreì—ì„œ ìë™ ì²˜ë¦¬ë¨\n    fetchMyResolution();\n    fetchFlexibleGoals();\n    fetchToday();\n    fetchProfile();\n\n    return () => subscription?.remove();\n  }, [expireOverdueGoals, cleanupOldGoals, fetchMyResolution, fetchToday]);\n\n  /* ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨ í•¨ìˆ˜ */\n  const onRefresh = async () => {\n    setRefreshing(true);\n    try {\n      console.log(\"ğŸ”„ ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨ ì‹œì‘\");\n\n      // ëª¨ë“  ë°ì´í„° ë™ì‹œ ìƒˆë¡œê³ ì¹¨\n      await Promise.all([\n        fetchGoals(),\n        fetchProfile(),\n        fetchToday(),\n        fetchMyResolution(),\n        fetchFlexibleGoals(),\n        expireOverdueGoals(),\n      ]);\n\n      console.log(\"âœ… ë‹¹ê²¨ì„œ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ\");\n\n      // ì„±ê³µ í”¼ë“œë°± (ì˜µì…˜)\n      // Alert.alert(\"ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ\", \"ìµœì‹  ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤\");\n    } catch (error) {\n      console.error(\"âŒ ìƒˆë¡œê³ ì¹¨ ì˜¤ë¥˜:\", error);\n      Alert.alert(\"ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨\", \"ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤\");\n    } finally {\n      setRefreshing(false);\n    }\n  };\n\n  // í™”ë©´ í¬ì»¤ìŠ¤ ì‹œ ë°ì´í„° ìƒˆë¡œê³ ì¹¨\n  useEffect(() => {\n    if (!navigation) return;\n\n    const unsubscribe = navigation.addListener(\"focus\", () => {\n      console.log(\"ğŸ”„ GoalListScreen í¬ì»¤ìŠ¤ - ë°ì´í„° ìƒˆë¡œê³ ì¹¨\");\n      fetchProfile();\n      fetchGoals().catch(console.error);\n    });\n    return unsubscribe;\n  }, [navigation, fetchProfile, fetchGoals]);\n\n  /* â”€â”€â”€â”€â”€ í•˜ì´ë¸Œë¦¬ë“œ ì‹¤ì‹œê°„ ìƒíƒœ ì—…ë°ì´íŠ¸ â”€â”€â”€â”€â”€ */\n  const [, forceUpdate] = React.useReducer((x) => x + 1, 0);\n  const [appState, setAppState] = useState(AppState.currentState);\n  const intervalRef = useRef<number | null>(null);\n\n  // ì•± ìƒíƒœ ë³€í™” ê°ì§€\n  useEffect(() => {\n    const subscription = AppState.addEventListener(\"change\", (nextAppState) => {\n      console.log(\"ğŸ”„ ì•± ìƒíƒœ ë³€í™”:\", appState, \"â†’\", nextAppState);\n      setAppState(nextAppState);\n    });\n\n    return () => subscription?.remove();\n  }, [appState]);\n\n  // í•˜ì´ë¸Œë¦¬ë“œ ê°„ê²© ì‹œìŠ¤í…œ\n  useEffect(() => {\n    const setupInterval = () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n\n      // ì•± í™œì„± ìƒíƒœì— ë”°ë¥¸ ê°„ê²© ì„¤ì •\n      const intervalTime = appState === \"active\" ? 30000 : 300000; // 30ì´ˆ vs 5ë¶„\n\n      console.log(\n        `ğŸ”„ ê°„ê²© ì„¤ì •: ${appState === \"active\" ? \"30ì´ˆ (í™œì„±)\" : \"5ë¶„ (ë¹„í™œì„±)\"}`,\n      );\n\n      intervalRef.current = setInterval(async () => {\n        await expireOverdueGoals();\n        forceUpdate(); // UI ê°•ì œ ë¦¬ë Œë”ë§\n      }, intervalTime);\n    };\n\n    setupInterval();\n\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [appState, expireOverdueGoals]);\n\n  // ì•±ì´ í™œì„±í™”ë  ë•Œ ì¦‰ì‹œ ì—…ë°ì´íŠ¸\n  useEffect(() => {\n    if (appState === \"active\") {\n      console.log(\"ğŸ”„ ì•± í™œì„±í™” - ì¦‰ì‹œ ìƒíƒœ ì—…ë°ì´íŠ¸\");\n      expireOverdueGoals().then(() => forceUpdate());\n    }\n  }, [appState, expireOverdueGoals]);\n\n  // ì „ì—­ ë””ë²„ê¹… í•¨ìˆ˜ ë“±ë¡\n  useEffect(() => {\n    registerGlobalDebugFunctions();\n  }, []);\n\n  /* â”€â”€â”€â”€â”€ ê³„ì‚° â”€â”€â”€â”€â”€ */\n  const allGoalsWithCheck = useMemo(() => {\n    console.log(\"ğŸ”„ allGoalsWithCheck ê³„ì‚° ì‹œì‘!\", {\n      goals: goals.length,\n      todayRetrospectExists,\n    });\n    const result = getGoalsWithCanCheck(todayRetrospectExists);\n    console.log(\n      \"ğŸ”„ UI ì—…ë°ì´íŠ¸ - ì „ì²´ ëª©í‘œë“¤:\",\n      result.map((r) => ({\n        title: r.goal.title,\n        date: r.goal.target_time.slice(0, 10),\n        canCheck: r.canCheck,\n        canEdit: r.canEdit,\n      })),\n    );\n    return result;\n  }, [goals, todayRetrospectExists, getGoalsWithCanCheck]);\n\n  // ì§ì ‘ ê³„ì‚°í•˜ì—¬ ë¦¬ë Œë”ë§ ë¬¸ì œ í•´ê²°\n  console.log(\"ğŸ”¥ sections ê³„ì‚° ì‹œì‘!\");\n  const sections: GoalSection[] = (() => {\n    // ì‹¤ì‹œê°„ ë‚ ì§œ í‚¤ ê³„ì‚°\n    const { todayKey: currentTodayKey, tomorrowKey: currentTomorrowKey } =\n      getCurrentDateKeys();\n    console.log(\"ğŸ“… Date keys updated\");\n\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ êµ¬ë¶„í•˜ì—¬ í•„í„°ë§\n    const todayGoals = allGoalsWithCheck\n      .filter((x) => {\n        const goalDate = new Date(x.goal.target_time);\n        const koreanDate = new Date(goalDate.getTime() + 9 * 60 * 60 * 1000);\n        return koreanDate.toISOString().slice(0, 10) === currentTodayKey;\n      })\n      .sort(\n        (a, b) =>\n          new Date(a.goal.target_time).getTime() -\n          new Date(b.goal.target_time).getTime(),\n      );\n\n    const tomorrowGoals = allGoalsWithCheck\n      .filter((x) => {\n        const goalDate = new Date(x.goal.target_time);\n        const koreanDate = new Date(goalDate.getTime() + 9 * 60 * 60 * 1000);\n        const goalDateStr = koreanDate.toISOString().slice(0, 10);\n        // ë‚´ì¼ ëª©í‘œ ë‚ ì§œ í™•ì¸\n        return goalDateStr === currentTomorrowKey;\n      })\n      .sort(\n        (a, b) =>\n          new Date(a.goal.target_time).getTime() -\n          new Date(b.goal.target_time).getTime(),\n      );\n\n    // ëª©í‘œ ê°œìˆ˜ ë° ë‚ ì§œ í‚¤ í™•ì¸ ì™„ë£Œ\n\n    // íšŒê³  ìƒíƒœ í™•ì¸ ì™„ë£Œ\n\n    // ë‚´ì¼ ëª©í‘œ ìƒì„¸ ì •ë³´ ì²˜ë¦¬ ì™„ë£Œ\n\n    // ì „ì²´ ëª©í‘œ ë°ì´í„° í™•ì¸ ë° ë‚ ì§œ ë¶„ë¥˜ ì™„ë£Œ\n\n    const sections: GoalSection[] = [];\n\n    // íšŒê³  ì‘ì„± ì™„ë£Œ í›„ ì›Œí¬í”Œë¡œìš°\n    if (todayRetrospectExists) {\n      // íšŒê³  ì™„ë£Œ í›„ì—ëŠ” ë‹¹ì¼ ëª©í‘œëŠ” Historyì—ì„œë§Œ í™•ì¸ ê°€ëŠ¥\n      // ë‚´ì¼ ëª©í‘œë§Œ \"ì˜ˆì •\"ìœ¼ë¡œ í‘œì‹œ\n      // íšŒê³  ì™„ë£Œ í›„ ë‚´ì¼ ëª©í‘œ í‘œì‹œ ì²˜ë¦¬\n\n      // íšŒê³  ì™„ë£Œ í›„ì—ëŠ” ì˜¤ëŠ˜ ëª©í‘œë„ í‘œì‹œ (ì²´í¬ ë¶ˆê°€ëŠ¥, í¸ì§‘ ë¶ˆê°€ëŠ¥)\n      if (todayGoals.length > 0) {\n        sections.push({\n          title: \"ì˜¤ëŠ˜ ìˆ˜í–‰ ëª©ë¡\",\n          data: todayGoals,\n        });\n      }\n\n      if (tomorrowGoals.length > 0) {\n        sections.push({ title: \"ë‚´ì¼ ìˆ˜í–‰ ëª©ë¡\", data: tomorrowGoals });\n      }\n\n      // í•„ìˆ˜ ëª©í‘œ í™•ì¸ (ë‚´ì¼ ë‚ ì§œë¡œ ë³€ê²½)\n      const tomorrowFlexible = getTomorrowFlexibleGoals();\n      console.log(\"ğŸ” ë‚´ì¼ í•„ìˆ˜ ëª©í‘œ:\", {\n        ê°œìˆ˜: tomorrowFlexible.length,\n        ëª©ë¡: tomorrowFlexible.map((g) => g.title),\n      });\n\n      // í•„ìˆ˜ ëª©í‘œëŠ” í™ˆ í™”ë©´ì— í‘œì‹œí•˜ì§€ ì•ŠìŒ (ì˜¤ë¥¸ìª½ ìƒë‹¨ ë²„íŠ¼ì—ë§Œ í‘œì‹œ)\n    } else {\n      // íšŒê³  ì‘ì„± ì „: ë‹¹ì¼ ëª©í‘œì™€ ë‚´ì¼ ëª©í‘œ ëª¨ë‘ í‘œì‹œ\n\n      // í•„ìˆ˜ ëª©í‘œëŠ” í™ˆ í™”ë©´ì— í‘œì‹œí•˜ì§€ ì•ŠìŒ (ì˜¤ë¥¸ìª½ ìƒë‹¨ ë²„íŠ¼ì—ë§Œ í‘œì‹œ)\n      const tomorrowFlexible = getTomorrowFlexibleGoals();\n      console.log(\"ğŸ” ë‚´ì¼ í•„ìˆ˜ ëª©í‘œ (ì˜¤ë¥¸ìª½ ìƒë‹¨ ì „ìš©):\", {\n        ê°œìˆ˜: tomorrowFlexible.length,\n        ëª©ë¡: tomorrowFlexible.map((g) => g.title),\n      });\n\n      if (todayGoals.length > 0) {\n        sections.push({ title: \"ì˜¤ëŠ˜ ìˆ˜í–‰ ëª©ë¡\", data: todayGoals });\n      }\n\n      // ë‚´ì¼ ëª©í‘œë„ í‘œì‹œ (íšŒê³  ì™„ë£Œ ì—¬ë¶€ì™€ ìƒê´€ì—†ì´)\n      if (tomorrowGoals.length > 0) {\n        sections.push({ title: \"ë‚´ì¼ ìˆ˜í–‰ ëª©ë¡\", data: tomorrowGoals });\n      }\n    }\n\n    console.log(\n      \"ğŸ”¥ sections ìµœì¢… ê²°ê³¼:\",\n      sections.map((s) => ({\n        title: s.title,\n        dataCount: s.data.length,\n        dataItems: s.data.map((d) => d.goal.title),\n      })),\n    );\n\n    return sections;\n  })();\n\n  // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ ëª©í‘œ í•„í„°ë§\n  const { todayKey: realTimeTodayKey } = getCurrentDateKeys();\n  const todayGoalsKorean = allGoalsWithCheck.filter((x) => {\n    const goalDate = new Date(x.goal.target_time);\n    const koreanDate = new Date(goalDate.getTime() + 9 * 60 * 60 * 1000);\n    return koreanDate.toISOString().slice(0, 10) === realTimeTodayKey;\n  });\n\n  const todayCount = todayGoalsKorean.length;\n  const todayGoals = todayGoalsKorean;\n  const allDoneToday =\n    todayGoals.length > 0 &&\n    todayGoals.every((x) => x.goal.status !== \"pending\");\n  const successCount = todayGoals.filter(\n    (x) => x.goal.status === \"success\",\n  ).length;\n  const failureCount = todayGoals.filter(\n    (x) => x.goal.status === \"failure\",\n  ).length;\n\n  // íšŒê³  ë²„íŠ¼ í™œì„±í™” ì¡°ê±´ ë””ë²„ê¹…\n  console.log(\"ğŸ” íšŒê³  ë²„íŠ¼ í™œì„±í™” ì¡°ê±´:\", {\n    todayCount,\n    allDoneToday,\n    todayRetrospectExists,\n    ì¡°ê±´ë§Œì¡±: allDoneToday && !todayRetrospectExists,\n    ì˜¤ëŠ˜ëª©í‘œìƒíƒœ: todayGoals.map((g) => ({\n      title: g.goal.title,\n      status: g.goal.status,\n    })),\n  });\n\n  const canWriteToday = !todayRetrospectExists;\n  const canWriteTomorrow = todayRetrospectExists;\n\n  /* ê¿ˆ í¸ì§‘ í•¸ë“¤ëŸ¬ */\n  const handleStartEditDream = () => {\n    const currentDream = profile?.dream || \"\";\n    setDreamText(currentDream);\n    setIsEditingDream(true);\n  };\n\n  const handleSaveDream = async () => {\n    try {\n      // í‚¤ë³´ë“œ ë¨¼ì € ë‹«ê¸°\n      Keyboard.dismiss();\n\n      // ë¡œì»¬ ìƒíƒœ ë¨¼ì € ì—…ë°ì´íŠ¸ (ì¦‰ì‹œ UI ë°˜ì˜)\n      if (profile) {\n        useProfileStore.setState({\n          profile: { ...profile, dream: dreamText.trim() },\n        });\n      }\n\n      // ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸\n      await updateDream(dreamText.trim());\n      setIsEditingDream(false);\n      Alert.alert(\"ì„±ê³µ\", \"ê¿ˆì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸŒŸ\");\n    } catch (error) {\n      console.error(\"ê¿ˆ ì €ì¥ ì‹¤íŒ¨:\", error);\n      Alert.alert(\"ì˜¤ë¥˜\", \"ê¿ˆ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\");\n    }\n  };\n\n  const handleCancelDream = () => {\n    // í‚¤ë³´ë“œ ë¨¼ì € ë‹«ê¸°\n    Keyboard.dismiss();\n    setIsEditingDream(false);\n    setDreamText(\"\");\n  };\n\n  /* ê°ì˜¤ í¸ì§‘ í•¸ë“¤ëŸ¬ */\n  const handleWriteResolution = () => {\n    setResolutionText(myResolution?.content || \"\");\n    setIsWritingResolution(true);\n  };\n\n  const handleSaveResolution = async () => {\n    if (!resolutionText.trim()) {\n      Alert.alert(\"ì•Œë¦¼\", \"ê°ì˜¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\");\n      return;\n    }\n\n    if (resolutionText.length > 100) {\n      Alert.alert(\"ì•Œë¦¼\", \"ê°ì˜¤ëŠ” 100ì ì´ë‚´ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.\");\n      return;\n    }\n\n    try {\n      Keyboard.dismiss();\n      if (myResolution) {\n        await updateMyResolution(resolutionText.trim());\n      } else {\n        await saveResolution(resolutionText.trim());\n      }\n      setIsWritingResolution(false);\n      setResolutionText(\"\");\n      Alert.alert(\"ì„±ê³µ\", \"ë‚´ì¼ì˜ ê°ì˜¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ’ª\");\n    } catch (error: any) {\n      Alert.alert(\"ì˜¤ë¥˜\", error.message || \"ê°ì˜¤ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\");\n    }\n  };\n\n  const handleCancelResolution = () => {\n    Keyboard.dismiss();\n    setIsWritingResolution(false);\n    setResolutionText(\"\");\n  };\n\n  const handleDeleteResolution = () => {\n    Alert.alert(\"ì‚­ì œ í™•ì¸\", \"ì •ë§ë¡œ ë‚´ì¼ì˜ ê°ì˜¤ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\", [\n      { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n      {\n        text: \"ì‚­ì œ\",\n        style: \"destructive\",\n        onPress: async () => {\n          try {\n            await deleteMyResolution();\n            Alert.alert(\"ì„±ê³µ\", \"ê°ì˜¤ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\");\n          } catch (error: any) {\n            Alert.alert(\"ì˜¤ë¥˜\", error.message || \"ê°ì˜¤ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\");\n          }\n        },\n      },\n    ]);\n  };\n\n  /* ë©”ëª¨ ê´€ë ¨ í•¸ë“¤ëŸ¬ */\n  const handleAddMemo = (goalId: string) => {\n    const goal = goals.find((g) => g.id === goalId);\n    if (!goal) return;\n\n    setSelectedGoalId(goalId);\n    setMemoText(goal.achievement_memo || \"\");\n    setMemoModalVisible(true);\n  };\n\n  const handleSaveMemo = async () => {\n    if (!selectedGoalId) return;\n\n    try {\n      await addAchievementMemo(selectedGoalId, memoText.trim());\n      setMemoModalVisible(false);\n      setSelectedGoalId(null);\n      setMemoText(\"\");\n      Alert.alert(\"ì„±ê³µ\", \"ìˆ˜í–‰ ê¸°ë¡ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\");\n    } catch (error: any) {\n      Alert.alert(\"ì˜¤ë¥˜\", error.message || \"ê¸°ë¡ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\");\n    }\n  };\n\n  const handleCancelMemo = () => {\n    setMemoModalVisible(false);\n    setSelectedGoalId(null);\n    setMemoText(\"\");\n  };\n\n  /* ëª©í‘œ ì²´í¬ */\n  const handleCheckGoal = async (goalId: string) => {\n    const goal = goals.find((g) => g.id === goalId);\n    if (!goal) return;\n\n    // ê¸°ì¡´ checkGoal í•¨ìˆ˜ í˜¸ì¶œ (ë±ƒì§€ ì‹œìŠ¤í…œì€ goalStoreì—ì„œ ìë™ ì²˜ë¦¬ë¨)\n    await checkGoal(goalId);\n  };\n\n  /* â”€â”€â”€â”€â”€ Header Component â”€â”€â”€â”€â”€ */\n  const headerComponent = (\n    <>\n      {/* ìƒë‹¨ í—¤ë” ì˜ì—­ - í°ìƒ‰ ë°°ê²½ */}\n      <View style={styles.topHeaderSection}>\n        <View style={styles.topHeaderContent}>\n          {/* ì™¼ìª½: ë¡œê³  + ë‚ ì§œ */}\n          <View style={styles.leftHeaderSection}>\n            <View style={styles.logoContainer}>\n              <Text style={styles.logoEmoji}>ğŸŒŸ</Text>\n              <Text style={styles.logoText}>Better Day</Text>\n            </View>\n            <Text style={styles.dateText}>\n              {new Date().toLocaleDateString(\"ko-KR\", {\n                year: \"numeric\",\n                month: \"2-digit\",\n                day: \"2-digit\",\n              })}\n            </Text>\n          </View>\n\n          {/* ì˜¤ë¥¸ìª½: ìœ ì—°í•œ ëª©í‘œ */}\n          <View style={styles.rightHeaderSection}>\n            {(() => {\n              const tomorrowFlexibleGoals = getTomorrowFlexibleGoals();\n\n              return tomorrowFlexibleGoals.length > 0 ? (\n                <TouchableOpacity\n                  style={styles.flexibleGoalWidget}\n                  onPress={() => {\n                    if (navigation) {\n                      navigation.navigate(\"FlexibleGoal\", {\n                        targetDate: \"tomorrow\",\n                      });\n                    }\n                  }}\n                >\n                  <Text style={styles.flexibleGoalPreview}>\n                    {tomorrowFlexibleGoals[0]?.title || \"\"}\n                  </Text>\n                </TouchableOpacity>\n              ) : (\n                <TouchableOpacity\n                  style={styles.flexibleGoalAddWidget}\n                  onPress={() => {\n                    if (navigation) {\n                      navigation.navigate(\"FlexibleGoal\", {\n                        targetDate: \"tomorrow\",\n                      });\n                    }\n                  }}\n                >\n                  <Text style={styles.flexibleGoalAddText}>\n                    ê¼­! í•˜ê³ ì í•˜ëŠ” í•˜ë‚˜! +\n                  </Text>\n                </TouchableOpacity>\n              );\n            })()}\n          </View>\n        </View>\n\n        {/* ê¿ˆ ì„¤ì • ì¹´ë“œ - ì‘ê²Œ */}\n        <View style={styles.dreamCardSmall}>\n          <Text\n            style={[\n              styles.dreamTextSmall,\n              {\n                fontSize: (() => {\n                  const dreamText = profile?.dream || \"ê¿ˆì„ ì„¤ì •í•´ì£¼ì„¸ìš”\";\n                  const length = dreamText.length;\n\n                  // ë” ì„¸ë°€í•œ ê¸€ììˆ˜ êµ¬ê°„ ì„¤ì •ìœ¼ë¡œ ìµœì í™”\n                  if (length <= 15) return 14; // 1ì¤„, ì—¬ìœ  ìˆê²Œ\n                  if (length <= 30) return 13; // 1-2ì¤„\n                  if (length <= 45) return 12; // 2ì¤„\n                  if (length <= 65) return 11; // 2-3ì¤„\n                  if (length <= 85) return 10; // 3ì¤„\n                  if (length <= 110) return 9; // 3-4ì¤„\n                  if (length <= 140) return 8; // 4-5ì¤„\n                  return 7; // 5ì¤„ ì´ìƒ (200ìê¹Œì§€ ëŒ€ì‘)\n                })(),\n                lineHeight: (() => {\n                  const dreamText = profile?.dream || \"ê¿ˆì„ ì„¤ì •í•´ì£¼ì„¸ìš”\";\n                  const length = dreamText.length;\n\n                  // ê¸€ì í¬ê¸°ì— ë§ì¶˜ ì¤„ ê°„ê²© ì¡°ì •\n                  if (length <= 15) return 16; // 14px + 2\n                  if (length <= 30) return 15; // 13px + 2\n                  if (length <= 45) return 14; // 12px + 2\n                  if (length <= 65) return 13; // 11px + 2\n                  if (length <= 85) return 12; // 10px + 2\n                  if (length <= 110) return 11; // 9px + 2\n                  if (length <= 140) return 10; // 8px + 2\n                  return 9; // 7px + 2\n                })(),\n              },\n            ]}\n            numberOfLines={undefined} // ì—¬ëŸ¬ ì¤„ í—ˆìš©\n          >\n            {profile?.dream || \"ê¿ˆì„ ì„¤ì •í•´ì£¼ì„¸ìš”\"}\n          </Text>\n        </View>\n      </View>\n\n      {/* ê¿ˆ í¸ì§‘ ëª¨ë‹¬ */}\n      {isEditingDream && (\n        <View style={styles.dreamEditModal}>\n          <View style={styles.dreamEditContent}>\n            <TextInput\n              style={styles.dreamInput}\n              value={dreamText}\n              onChangeText={setDreamText}\n              placeholder=\"ê¿ˆì„ ì…ë ¥í•´ì£¼ì„¸ìš”...\"\n              placeholderTextColor=\"#999\"\n              multiline\n              maxLength={200}\n              autoFocus\n            />\n            <View style={styles.dreamButtonContainer}>\n              <TouchableOpacity\n                style={[styles.dreamButton, styles.cancelButton]}\n                onPress={handleCancelDream}\n              >\n                <Text style={styles.cancelButtonText}>ì·¨ì†Œ</Text>\n              </TouchableOpacity>\n              <TouchableOpacity\n                style={[styles.dreamButton, styles.saveButton]}\n                onPress={handleSaveDream}\n              >\n                <Text style={styles.saveButtonText}>ì €ì¥</Text>\n              </TouchableOpacity>\n            </View>\n          </View>\n        </View>\n      )}\n    </>\n  );\n\n  /* â”€â”€â”€â”€â”€ Footer â”€â”€â”€â”€â”€ */\n  const FooterButtons = () => (\n    <View style={styles.footerBox}>\n      {/* ì¤‘ì•™ í”ŒëŸ¬ìŠ¤ ë²„íŠ¼ */}\n      {!todayRetrospectExists && (\n        <View style={styles.centerPlusContainer}>\n          <TouchableOpacity\n            style={styles.plusButton}\n            onPress={() => {\n              console.log(\"ğŸ”˜ í”ŒëŸ¬ìŠ¤ ë²„íŠ¼ í´ë¦­ - navigation ìƒíƒœ:\", {\n                navigation: !!navigation,\n                navigate: !!navigation?.navigate,\n                todayCount,\n              });\n\n              if (!navigation) {\n                console.error(\"âŒ navigationì´ nullì…ë‹ˆë‹¤!\");\n                return;\n              }\n\n              if (!navigation.navigate) {\n                console.error(\"âŒ navigation.navigateê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!\");\n                return;\n              }\n\n              // ğŸ”¥ ìŠ¤ë§ˆíŠ¸ ëª©í‘œ ì¶”ê°€ ë¡œì§: ê¸°ì¡´ ëª©í‘œì™€ ê°™ì€ ë‚ ì§œë¡œ ì¶”ê°€\n              try {\n                // ë‚´ì¼ ëª©í‘œ ê°œìˆ˜ í™•ì¸\n                const tomorrowGoals = allGoalsWithCheck.filter((x) => {\n                  const goalDate = new Date(x.goal.target_time);\n                  const koreanDate = new Date(\n                    goalDate.getTime() + 9 * 60 * 60 * 1000,\n                  );\n                  const { tomorrowKey: currentTomorrowKey } =\n                    getCurrentDateKeys();\n                  return (\n                    koreanDate.toISOString().slice(0, 10) === currentTomorrowKey\n                  );\n                });\n\n                console.log(\"ğŸ¯ ìŠ¤ë§ˆíŠ¸ ëª©í‘œ ì¶”ê°€ ë¡œì§:\", {\n                  tomorrowGoalsCount: tomorrowGoals.length,\n                  todayGoalsCount: todayCount,\n                  decision:\n                    tomorrowGoals.length > 0 ? \"ë‚´ì¼ì— ì¶”ê°€\" : \"ì˜¤ëŠ˜ì— ì¶”ê°€\",\n                });\n\n                // ë‚´ì¼ ëª©í‘œê°€ ìˆìœ¼ë©´ ë‚´ì¼ì— ì¶”ê°€, ì—†ìœ¼ë©´ ì˜¤ëŠ˜ì— ì¶”ê°€\n                if (tomorrowGoals.length > 0) {\n                  // ë‚´ì¼ ëª©í‘œê°€ ìˆìœ¼ë©´ ë‚´ì¼ì— ì¶”ê°€\n                  if (tomorrowGoals.length < 5) {\n                    console.log(\"ğŸš€ ë‚´ì¼ ëª©í‘œ ì¼ê´„ ì‘ì„± - GoalBatchë¡œ ì´ë™\");\n                    navigation.navigate(\"GoalBatch\", { initial: \"tomorrow\" });\n                  } else {\n                    console.log(\"ğŸš€ ë‚´ì¼ ê°œë³„ ëª©í‘œ ì¶”ê°€ - TimeSelectë¡œ ì´ë™\");\n                    navigation.navigate(\"TimeSelect\", { initial: \"tomorrow\" });\n                  }\n                } else {\n                  // ë‚´ì¼ ëª©í‘œê°€ ì—†ìœ¼ë©´ ì˜¤ëŠ˜ì— ì¶”ê°€ (ë˜ëŠ” ë‚´ì¼ ì¼ê´„ ì‘ì„±)\n                  if (todayCount === 0) {\n                    console.log(\"ğŸš€ ë‚´ì¼ ëª©í‘œ ì¼ê´„ ì‘ì„± - GoalBatchë¡œ ì´ë™\");\n                    navigation.navigate(\"GoalBatch\", { initial: \"tomorrow\" });\n                  } else {\n                    console.log(\n                      \"ğŸš€ ì˜¤ëŠ˜ ëª©í‘œ ì¶”ê°€ (3ì‹œê°„ ì œì•½) - TimeSelectë¡œ ì´ë™\",\n                    );\n                    navigation.navigate(\"TimeSelect\", { initial: \"today\" });\n                  }\n                }\n              } catch (error) {\n                console.error(\"âŒ navigate í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:\", error);\n              }\n            }}\n          >\n            <Ionicons name=\"add\" size={56} color=\"#ffffff\" />\n          </TouchableOpacity>\n        </View>\n      )}\n\n      {/* ëª¨ë“  ëª©í‘œ ì™„ë£Œ ì‹œ íšŒê³  ì‘ì„± ë²„íŠ¼ */}\n      {allDoneToday && !todayRetrospectExists && (\n        <TouchableOpacity\n          style={styles.retrospectCompactButton}\n          onPress={() => {\n            console.log(\"ğŸ”˜ íšŒê³  ë²„íŠ¼ í´ë¦­ - navigation ìƒíƒœ:\", {\n              navigation: !!navigation,\n              navigate: !!navigation?.navigate,\n            });\n\n            if (!navigation) {\n              console.error(\"âŒ íšŒê³  ë²„íŠ¼: navigationì´ nullì…ë‹ˆë‹¤!\");\n              return;\n            }\n\n            if (!navigation.navigate) {\n              console.error(\n                \"âŒ íšŒê³  ë²„íŠ¼: navigation.navigateê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!\",\n              );\n              return;\n            }\n\n            try {\n              console.log(\"ğŸš€ Retrospectë¡œ ì´ë™\");\n              navigation.navigate(\"Retrospect\");\n            } catch (error) {\n              console.error(\"âŒ íšŒê³  ë²„íŠ¼ navigate í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:\", error);\n            }\n          }}\n        >\n          <Text style={styles.retrospectCompactButtonText}>\n            ğŸ“ ì˜¤ëŠ˜ íšŒê³  ì‘ì„±\n          </Text>\n        </TouchableOpacity>\n      )}\n\n      {/* íšŒê³  ì‘ì„± í›„: ë‚´ì¼ ëª©í‘œ ì‘ì„± */}\n      {todayRetrospectExists && (\n        <View style={styles.centerPlusContainer}>\n          <TouchableOpacity\n            style={styles.plusButton}\n            onPress={() => {\n              console.log(\"ğŸ”˜ ë‚´ì¼ ëª©í‘œ í”ŒëŸ¬ìŠ¤ ë²„íŠ¼ í´ë¦­ - navigation ìƒíƒœ:\", {\n                navigation: !!navigation,\n                navigate: !!navigation?.navigate,\n              });\n\n              // ë‚´ì¼ ëª©í‘œê°€ 5ê°œ ë¯¸ë§Œì´ë©´ ì¼ê´„ ë“±ë¡, 5ê°œ ì´ìƒì´ë©´ ê°œë³„ ì¶”ê°€\n              const tomorrowGoals = allGoalsWithCheck.filter((x) => {\n                const goalDate = new Date(x.goal.target_time);\n                const koreanDate = new Date(\n                  goalDate.getTime() + 9 * 60 * 60 * 1000,\n                );\n                const { tomorrowKey: currentTomorrowKey } =\n                  getCurrentDateKeys();\n                return (\n                  koreanDate.toISOString().slice(0, 10) === currentTomorrowKey\n                );\n              });\n\n              if (!navigation) {\n                console.error(\"âŒ ë‚´ì¼ ëª©í‘œ ë²„íŠ¼: navigationì´ nullì…ë‹ˆë‹¤!\");\n                return;\n              }\n\n              if (!navigation.navigate) {\n                console.error(\n                  \"âŒ ë‚´ì¼ ëª©í‘œ ë²„íŠ¼: navigation.navigateê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!\",\n                );\n                return;\n              }\n\n              try {\n                if (tomorrowGoals.length < 5) {\n                  console.log(\"ğŸš€ ë‚´ì¼ ëª©í‘œ - GoalBatchë¡œ ì´ë™\");\n                  navigation.navigate(\"GoalBatch\", { initial: \"tomorrow\" });\n                } else {\n                  console.log(\"ğŸš€ ë‚´ì¼ ëª©í‘œ - TimeSelectë¡œ ì´ë™\");\n                  navigation.navigate(\"TimeSelect\", { initial: \"tomorrow\" });\n                }\n              } catch (error) {\n                console.error(\n                  \"âŒ ë‚´ì¼ ëª©í‘œ ë²„íŠ¼ navigate í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:\",\n                  error,\n                );\n              }\n            }}\n          >\n            <Ionicons name=\"add\" size={56} color=\"#ffffff\" />\n          </TouchableOpacity>\n        </View>\n      )}\n    </View>\n  );\n\n  /* â”€â”€â”€â”€â”€ Row â”€â”€â”€â”€â”€ */\n  const renderItem = ({\n    item,\n  }: {\n    item: { goal: Goal; canCheck: boolean; canEdit: boolean };\n  }) => {\n    const t = new Date(item.goal.target_time)\n      .toLocaleTimeString(\"ko-KR\", {\n        hour12: true,\n        hour: \"2-digit\",\n        minute: \"2-digit\",\n      })\n      .replace(\"AM\", \"ì˜¤ì „\")\n      .replace(\"PM\", \"ì˜¤í›„\");\n\n    let indicator = null;\n    if (item.goal.status === \"success\") {\n      // ì—°ìŠ¹ ë±ƒì§€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° (Mapì—ì„œ ì˜¬ë°”ë¥´ê²Œ ì ‘ê·¼)\n      const goalId = item.goal.id;\n      const goalBadge = goalBadges.get(goalId);\n\n      console.log(\"ğŸ† ë±ƒì§€ í™•ì¸:\", {\n        goalId,\n        goalBadge,\n        hasGoalBadge: !!goalBadge,\n        goalBadgesSize: goalBadges.size,\n      });\n\n      // goalBadgeê°€ ìˆìœ¼ë©´ ì‹¤ì œ ì´ë¯¸ì§€ ì‚¬ìš©\n      let badgeImage = null;\n      if (goalBadge) {\n        badgeImage = getBadgeImage(goalBadge.category, goalBadge.level);\n        console.log(\"ğŸ–¼ï¸ ë±ƒì§€ ì´ë¯¸ì§€:\", {\n          category: goalBadge.category,\n          level: goalBadge.level,\n          hasImage: !!badgeImage,\n          badgeImage,\n        });\n      }\n\n      indicator = (\n        <View style={[styles.statusBadge, styles.successBadge]}>\n          <View style={{ flexDirection: \"row\", alignItems: \"center\" }}>\n            {badgeImage && (\n              <Image\n                source={badgeImage}\n                style={{ width: 16, height: 16, marginRight: 4 }}\n                resizeMode=\"contain\"\n              />\n            )}\n            <Text style={styles.statusText}>ìŠ¹ë¦¬</Text>\n          </View>\n        </View>\n      );\n    } else if (item.goal.status === \"failure\")\n      indicator = (\n        <View style={[styles.statusBadge, styles.failureBadge]}>\n          <Text style={styles.statusText}>ğŸ˜ íŒ¨ë°°</Text>\n        </View>\n      );\n    else\n      indicator = (\n        <TouchableOpacity\n          disabled={!item.canCheck}\n          onPress={() => checkGoal(item.goal.id)}\n          style={[\n            styles.checkButton,\n            item.canCheck\n              ? styles.checkButtonActive\n              : styles.checkButtonInactive,\n          ]}\n        >\n          <Text\n            style={[\n              styles.checkButtonText,\n              item.canCheck ? { color: \"#fff\" } : { color: \"#999\" },\n            ]}\n          >\n            {item.canCheck ? \"í™•ì¸\" : \"ëŒ€ê¸°\"}\n          </Text>\n        </TouchableOpacity>\n      );\n\n    return (\n      <View style={styles.item}>\n        {/* ì œëª©Â·ì‹œê°„ */}\n        <View style={styles.titleTimeContainer}>\n          <Text style={styles.title}>{item.goal.title}</Text>\n          <Text style={styles.time}>{t}</Text>\n        </View>\n\n        {/* ìˆ˜ì • + ìƒíƒœ */}\n        <View style={styles.actions}>\n          {item.canEdit && (\n            <>\n              <TouchableOpacity\n                style={styles.editButton}\n                onPress={() => {\n                  console.log(\"ğŸ”˜ ìˆ˜ì • ë²„íŠ¼ í´ë¦­ - navigation ìƒíƒœ:\", {\n                    navigation: !!navigation,\n                    navigate: !!navigation?.navigate,\n                    goalId: item.goal.id,\n                  });\n\n                  if (!navigation) {\n                    console.error(\"âŒ ìˆ˜ì • ë²„íŠ¼: navigationì´ nullì…ë‹ˆë‹¤!\");\n                    return;\n                  }\n\n                  if (!navigation.navigate) {\n                    console.error(\n                      \"âŒ ìˆ˜ì • ë²„íŠ¼: navigation.navigateê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!\",\n                    );\n                    return;\n                  }\n\n                  try {\n                    console.log(\"ğŸš€ GoalDetailë¡œ ì´ë™, goalId:\", item.goal.id);\n                    navigation.navigate(\"GoalDetail\", { goalId: item.goal.id });\n                  } catch (error) {\n                    console.error(\"âŒ ìˆ˜ì • ë²„íŠ¼ navigate í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜:\", error);\n                  }\n                }}\n              >\n                <Text style={styles.editButtonText}>ìˆ˜ì •</Text>\n              </TouchableOpacity>\n              <View style={{ width: 8 }} />\n            </>\n          )}\n          {indicator}\n\n          {/* ìŠ¹ë¦¬í•œ ëª©í‘œì—ë§Œ \"ë‹¨ì¼ ìˆ˜í–‰ ê¸°ë¡\" ë²„íŠ¼ í‘œì‹œ */}\n          {item.goal.status === \"success\" && (\n            <>\n              <View style={{ width: 8 }} />\n              <TouchableOpacity\n                style={styles.memoButton}\n                onPress={() => handleAddMemo(item.goal.id)}\n              >\n                <Text style={styles.memoButtonText}>ğŸ“ ê¸°ë¡</Text>\n              </TouchableOpacity>\n            </>\n          )}\n        </View>\n      </View>\n    );\n  };\n\n  const renderSectionHeader = ({\n    section,\n  }: {\n    section: SectionListData<\n      { goal: Goal; canCheck: boolean; canEdit: boolean },\n      GoalSection\n    >;\n  }) => (\n    <View>\n      {/* \"ì˜¤ëŠ˜\" ë˜ëŠ” \"ë‚´ì¼ ìˆ˜í–‰ ëª©ë¡\" ì„¹ì…˜ì—ì„œëŠ” ê²€ì€ìƒ‰ ì˜ì—­ì— ì œëª©ê³¼ ê°ì˜¤ í†µí•© */}\n      {(section.title === \"ì˜¤ëŠ˜\" ||\n        section.title === \"ì˜¤ëŠ˜ ìˆ˜í–‰ ëª©ë¡\" ||\n        section.title === \"ë‚´ì¼ ìˆ˜í–‰ ëª©ë¡\") && (\n        <View style={styles.todaySection}>\n          {/* ìˆ˜í–‰ ëª©ë¡ ì œëª© */}\n          <Text style={styles.todaySectionTitle}>\n            {section.title === \"ë‚´ì¼ ìˆ˜í–‰ ëª©ë¡\"\n              ? \"ë‚´ì¼ ìˆ˜í–‰ ëª©ë¡\"\n              : \"ì˜¤ëŠ˜ ìˆ˜í–‰ ëª©ë¡\"}\n          </Text>\n\n          {/* ê°ì˜¤ ì˜ì—­ - ê°ì˜¤ê°€ ì €ì¥ë˜ì–´ ìˆìœ¼ë©´ ì‘ì„± UI ì™„ì „íˆ ìˆ¨ê¹€ */}\n          {!myResolution && (\n            <View style={styles.resolutionContainer}>\n              {!isWritingResolution && (\n                <TouchableOpacity\n                  style={styles.resolutionWriteButton}\n                  onPress={handleWriteResolution}\n                >\n                  <Text style={styles.resolutionWriteButtonText}>\n                    ğŸ’ª ë‚´ì¼ì˜ ê°ì˜¤ ì‘ì„±í•˜ê¸°\n                  </Text>\n                </TouchableOpacity>\n              )}\n\n              {isWritingResolution && (\n                <View style={styles.resolutionWriteSection}>\n                  <TextInput\n                    style={styles.resolutionTextInput}\n                    placeholder=\"ë‚´ì¼ì˜ ê°ì˜¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ìµœëŒ€ 100ì)\"\n                    value={resolutionText}\n                    onChangeText={setResolutionText}\n                    multiline\n                    maxLength={100}\n                    placeholderTextColor=\"#999\"\n                  />\n                  <Text style={styles.resolutionCharCount}>\n                    {resolutionText.length}/100\n                  </Text>\n                  <View style={styles.resolutionWriteActions}>\n                    <TouchableOpacity\n                      style={styles.resolutionCancelButton}\n                      onPress={handleCancelResolution}\n                    >\n                      <Text style={styles.resolutionCancelButtonText}>\n                        ì·¨ì†Œ\n                      </Text>\n                    </TouchableOpacity>\n                    <TouchableOpacity\n                      style={styles.resolutionSaveButton}\n                      onPress={handleSaveResolution}\n                    >\n                      <Text style={styles.resolutionSaveButtonText}>ì €ì¥</Text>\n                    </TouchableOpacity>\n                  </View>\n                </View>\n              )}\n            </View>\n          )}\n\n          {/* ì €ì¥ëœ ê°ì˜¤ í‘œì‹œ (ìˆ˜ì •/ì‚­ì œ ê°€ëŠ¥) */}\n          {myResolution && (\n            <View style={styles.resolutionContainer}>\n              <TouchableOpacity\n                style={[\n                  styles.myResolutionCard,\n                  isResolutionExpanded && styles.myResolutionCardExpanded,\n                  // í…ìŠ¤íŠ¸ ê¸¸ì´ì— ë”°ë¥¸ ë™ì  íŒ¨ë”© ì¡°ì ˆ\n                  {\n                    paddingVertical:\n                      myResolution.content.length > 60\n                        ? 6\n                        : myResolution.content.length > 30\n                          ? 8\n                          : 12,\n                  },\n                ]}\n                onPress={() => setIsResolutionExpanded(!isResolutionExpanded)}\n                activeOpacity={0.8}\n              >\n                <Text\n                  style={[\n                    styles.myResolutionContent,\n                    {\n                      textAlign: \"left\",\n                      // í…ìŠ¤íŠ¸ ê¸¸ì´ì— ë”°ë¥¸ ë™ì  í°íŠ¸ í¬ê¸°ì™€ ì¤„ ê°„ê²©\n                      fontSize:\n                        myResolution.content.length > 60\n                          ? 11\n                          : myResolution.content.length > 30\n                            ? 12\n                            : 13,\n                      lineHeight:\n                        myResolution.content.length > 60\n                          ? 14\n                          : myResolution.content.length > 30\n                            ? 15\n                            : 16,\n                    },\n                  ]}\n                  numberOfLines={\n                    myResolution.content.length > 60\n                      ? 3\n                      : myResolution.content.length > 30\n                        ? 2\n                        : 1\n                  }\n                >\n                  {myResolution.content}\n                </Text>\n                {isResolutionExpanded && (\n                  <View style={styles.myResolutionActions}>\n                    <TouchableOpacity\n                      style={styles.resolutionActionButton}\n                      onPress={(e) => {\n                        e.stopPropagation();\n                        handleWriteResolution();\n                        setIsResolutionExpanded(false);\n                      }}\n                    >\n                      <Text style={styles.resolutionActionText}>ìˆ˜ì •</Text>\n                    </TouchableOpacity>\n                    <TouchableOpacity\n                      style={styles.resolutionActionButton}\n                      onPress={async (e) => {\n                        e.stopPropagation();\n                        try {\n                          await deleteMyResolution();\n                          setIsResolutionExpanded(false);\n                          Alert.alert(\"ì„±ê³µ\", \"ê°ì˜¤ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\");\n                        } catch (error: any) {\n                          Alert.alert(\n                            \"ì˜¤ë¥˜\",\n                            error.message || \"ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\",\n                          );\n                        }\n                      }}\n                    >\n                      <Text\n                        style={[\n                          styles.resolutionActionText,\n                          { color: \"#FF3B30\" },\n                        ]}\n                      >\n                        ì‚­ì œ\n                      </Text>\n                    </TouchableOpacity>\n                  </View>\n                )}\n              </TouchableOpacity>\n\n              {/* ìˆ˜ì • ëª¨ë“œ ì‹œ ì…ë ¥ì°½ í‘œì‹œ */}\n              {isWritingResolution && (\n                <View style={styles.resolutionWriteSection}>\n                  <TextInput\n                    style={styles.resolutionTextInput}\n                    placeholder=\"ë‚´ì¼ì˜ ê°ì˜¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” (ìµœëŒ€ 100ì)\"\n                    value={resolutionText}\n                    onChangeText={setResolutionText}\n                    multiline\n                    maxLength={100}\n                    placeholderTextColor=\"#999\"\n                  />\n                  <Text style={styles.resolutionCharCount}>\n                    {resolutionText.length}/100\n                  </Text>\n                  <View style={styles.resolutionWriteActions}>\n                    <TouchableOpacity\n                      style={styles.resolutionCancelButton}\n                      onPress={handleCancelResolution}\n                    >\n                      <Text style={styles.resolutionCancelButtonText}>\n                        ì·¨ì†Œ\n                      </Text>\n                    </TouchableOpacity>\n                    <TouchableOpacity\n                      style={styles.resolutionSaveButton}\n                      onPress={handleSaveResolution}\n                    >\n                      <Text style={styles.resolutionSaveButtonText}>ì €ì¥</Text>\n                    </TouchableOpacity>\n                  </View>\n                </View>\n              )}\n            </View>\n          )}\n        </View>\n      )}\n\n      {/* ì¼ë°˜ ì„¹ì…˜ í—¤ë” (ë‚´ì¼/ì»¤ë®¤ë‹ˆí‹° ì œì™¸) */}\n      {section.title !== \"ë‚´ì¼\" &&\n        section.title !== \"ì»¤ë®¤ë‹ˆí‹°\" &&\n        section.title !== \"ë‚´ì¼ ìˆ˜í–‰ ëª©ë¡\" && (\n          <View style={styles.upcomingSection}>\n            <Text style={styles.upcomingSectionTitle}>{section.title}</Text>\n          </View>\n        )}\n    </View>\n  );\n\n  /* â”€â”€â”€â”€â”€ ë Œë” â”€â”€â”€â”€â”€ */\n  return (\n    <>\n      <SectionList\n        style={{ flex: 1, backgroundColor: \"#1C1C1E\" }}\n        sections={sections}\n        keyExtractor={(item) => item.goal.id}\n        refreshControl={\n          <RefreshControl\n            refreshing={refreshing}\n            onRefresh={onRefresh}\n            tintColor=\"#fff\"\n          />\n        }\n        renderItem={renderItem}\n        renderSectionHeader={renderSectionHeader}\n        ListHeaderComponent={headerComponent}\n        ListFooterComponent={FooterButtons}\n        ListEmptyComponent={() => (\n          <View style={styles.emptyContainer}>\n            <Text style={styles.emptyTitle}>ëª©í‘œë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”! ğŸ¯</Text>\n            <Text style={styles.emptySubtitle}>\n              í•˜ë£¨ 5ê°œì˜ ëª©í‘œë¡œ ì‘ì€ ì„±ì·¨ë¥¼ ìŒ“ì•„ê°€ì„¸ìš”\n            </Text>\n            <Text style={styles.emptyHint}>\n              \"+\" ë²„íŠ¼ì„ ëˆŒëŸ¬ ìˆ˜í–‰ ëª©ë¡ì„ ì¶”ê°€í•´ë³´ì„¸ìš”\n            </Text>\n          </View>\n        )}\n        ItemSeparatorComponent={() => <View style={styles.separator} />}\n        contentContainerStyle={{ paddingBottom: 32 }}\n      />\n\n      {/* ë©”ëª¨ ëª¨ë‹¬ */}\n      <Modal\n        visible={memoModalVisible}\n        animationType=\"slide\"\n        transparent={true}\n        onRequestClose={handleCancelMemo}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <Text style={styles.modalTitle}>ğŸ“ ë‹¨ì¼ ìˆ˜í–‰ ê¸°ë¡</Text>\n            <Text style={styles.modalSubtitle}>\n              {selectedGoalId\n                ? goals.find((g) => g.id === selectedGoalId)?.title\n                : \"\"}\n            </Text>\n\n            <TextInput\n              style={styles.memoInput}\n              placeholder=\"ìˆ˜í–‰ ë‚´ìš©ì„ ê¸°ë¡í•´ì£¼ì„¸ìš”...\"\n              placeholderTextColor=\"#999\"\n              value={memoText}\n              onChangeText={setMemoText}\n              multiline\n              maxLength={200}\n              textAlignVertical=\"top\"\n            />\n\n            <Text style={styles.memoCharCount}>{memoText.length}/200</Text>\n\n            <View style={styles.modalButtons}>\n              <TouchableOpacity\n                style={[styles.modalButton, styles.cancelModalButton]}\n                onPress={handleCancelMemo}\n              >\n                <Text style={styles.cancelModalButtonText}>ì·¨ì†Œ</Text>\n              </TouchableOpacity>\n              <TouchableOpacity\n                style={[styles.modalButton, styles.saveModalButton]}\n                onPress={handleSaveMemo}\n              >\n                <Text style={styles.saveModalButtonText}>ì €ì¥</Text>\n              </TouchableOpacity>\n            </View>\n          </View>\n        </View>\n      </Modal>\n\n\n    </>\n  );\n}\n\n/* â”€â”€â”€â”€â”€ ìŠ¤íƒ€ì¼ â”€â”€â”€â”€â”€ */\nconst styles = StyleSheet.create({\n  // ìƒë‹¨ í—¤ë” ì„¹ì…˜ (í°ìƒ‰ ë°°ê²½)\n  topHeaderSection: {\n    backgroundColor: \"#FFFFFF\",\n    paddingTop: 50, // ìƒíƒœë°” ì—¬ë°±\n    paddingHorizontal: 8,\n    paddingBottom: 30,\n  },\n\n  topHeaderContent: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-start\",\n    marginBottom: 15,\n  },\n\n  leftHeaderSection: {\n    alignItems: \"flex-start\",\n  },\n\n  logoContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: 5,\n  },\n  logoEmoji: {\n    fontSize: 20,\n    marginRight: 4,\n  },\n  logoText: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    color: \"#333\",\n  },\n\n  dateText: {\n    fontSize: 14,\n    color: \"#666\",\n    fontWeight: \"500\",\n    marginLeft: 20,\n  },\n\n  rightHeaderSection: {\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginTop: 10,\n  },\n\n  flexibleGoalWidget: {\n    backgroundColor: \"#FFF2E6\",\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    borderRadius: 8,\n    alignItems: \"center\",\n    minWidth: 100,\n    maxWidth: 140,\n  },\n\n  flexibleGoalTitle: {\n    fontSize: 11,\n    color: \"#B8860B\",\n    fontWeight: \"600\",\n    marginBottom: 2,\n  },\n\n  flexibleGoalPreview: {\n    fontSize: 10,\n    color: \"#B8860B\",\n    textAlign: \"center\",\n  },\n\n  flexibleGoalAddWidget: {\n    backgroundColor: \"#F0F0F0\",\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    borderRadius: 8,\n  },\n\n  flexibleGoalAddText: {\n    fontSize: 12,\n    color: \"#999\",\n    fontWeight: \"500\",\n  },\n\n  dreamCardSmall: {\n    backgroundColor: \"#F8F8F8\",\n    borderRadius: 10,\n    marginTop: 10,\n    marginLeft: 10,\n    marginRight: 10,\n    paddingHorizontal: 12, // ê°€ë¡œ íŒ¨ë”© ì•½ê°„ ì¤„ì„\n    paddingVertical: 8, // ì„¸ë¡œ íŒ¨ë”© ì¤„ì—¬ì„œ í…ìŠ¤íŠ¸ ê³µê°„ í™•ë³´\n    justifyContent: \"center\",\n    alignItems: \"flex-start\", // ì™¼ìª½ ì •ë ¬ì„ ìœ„í•´ ë³€ê²½\n    minHeight: 60,\n    maxHeight: 60, // ë°•ìŠ¤ í¬ê¸° ê³ ì •\n  },\n\n  dreamTextSmall: {\n    fontSize: 14, // ê¸°ë³¸ í°íŠ¸ í¬ê¸° (ë™ì ìœ¼ë¡œ ì¡°ì •ë¨)\n    color: \"#666\",\n    lineHeight: 16, // ê¸°ë³¸ ì¤„ ê°„ê²© (ë™ì ìœ¼ë¡œ ì¡°ì •ë¨)\n    textAlign: \"left\", // ì™¼ìª½ ì •ë ¬ë¡œ ë³€ê²½\n    width: \"100%\",\n  },\n\n  // ê²€ì€ìƒ‰ ì„¹ì…˜ ìŠ¤íƒ€ì¼ ì œê±° (ë” ì´ìƒ ì‚¬ìš© ì•ˆ í•¨)\n\n  resolutionWriteButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: 16,\n    backgroundColor: \"#2C2C2E\",\n    borderRadius: 12,\n    borderWidth: 2,\n    borderColor: \"#3A3A3C\",\n    borderStyle: \"dashed\",\n  },\n\n  resolutionWriteButtonText: {\n    fontSize: 15,\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n\n  myResolutionCard: {\n    backgroundColor: \"#2C2C2E\",\n    borderRadius: 12,\n    padding: 12,\n    borderWidth: 1,\n    borderColor: \"#3A3A3C\",\n    minHeight: 70,\n    maxHeight: 70,\n    justifyContent: \"center\",\n  },\n\n  myResolutionCardExpanded: {\n    minHeight: 150,\n    maxHeight: 250,\n    paddingBottom: 24,\n  },\n\n  myResolutionLabel: {\n    fontSize: 14,\n    color: \"#FFFFFF\",\n    fontWeight: \"700\",\n    marginBottom: 8,\n  },\n\n  myResolutionActions: {\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    marginTop: 12,\n    gap: 12,\n  },\n\n  resolutionActionButton: {\n    paddingHorizontal: 8,\n    paddingVertical: 4,\n  },\n\n  resolutionActionText: {\n    fontSize: 13,\n    color: \"#007AFF\",\n    fontWeight: \"500\",\n  },\n\n  myResolutionContent: {\n    fontSize: 13,\n    color: \"#FFFFFF\",\n    lineHeight: 16,\n    fontWeight: \"500\",\n    textAlignVertical: \"center\",\n  },\n\n  resolutionWriteSection: {\n    backgroundColor: \"#2C2C2E\",\n    borderRadius: 12,\n    padding: 16,\n  },\n\n  resolutionTextInput: {\n    backgroundColor: \"#3A3A3C\",\n    borderRadius: 8,\n    padding: 12,\n    fontSize: 15,\n    color: \"#FFFFFF\",\n    minHeight: 80,\n    maxHeight: 120,\n    textAlignVertical: \"top\",\n    marginBottom: 8,\n  },\n\n  resolutionCharCount: {\n    fontSize: 12,\n    color: \"#8E8E93\",\n    textAlign: \"right\",\n    marginBottom: 12,\n  },\n\n  resolutionWriteActions: {\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    gap: 12,\n  },\n\n  resolutionCancelButton: {\n    paddingHorizontal: 16,\n    paddingVertical: 10,\n    borderRadius: 8,\n    backgroundColor: \"#3A3A3C\",\n  },\n\n  resolutionCancelButtonText: {\n    fontSize: 14,\n    color: \"#FFFFFF\",\n    fontWeight: \"500\",\n  },\n\n  resolutionSaveButton: {\n    paddingHorizontal: 16,\n    paddingVertical: 10,\n    borderRadius: 8,\n    backgroundColor: \"#007AFF\",\n  },\n\n  resolutionSaveButtonText: {\n    fontSize: 14,\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n\n  // íšŒê³  ì‘ì„± ë²„íŠ¼ ìŠ¤íƒ€ì¼\n  retrospectWriteButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: 16,\n    backgroundColor: \"#34C759\",\n    borderRadius: 12,\n    marginTop: 12,\n    borderWidth: 2,\n    borderColor: \"#30D158\",\n  },\n\n  retrospectWriteButtonText: {\n    fontSize: 15,\n    color: \"#FFFFFF\",\n    fontWeight: \"600\",\n  },\n\n  // ì»´íŒ©íŠ¸ íšŒê³  ì‘ì„± ë²„íŠ¼ (í•˜ë‹¨)\n  retrospectCompactButton: {\n    backgroundColor: \"transparent\",\n    paddingVertical: 8,\n    paddingHorizontal: 12,\n    borderRadius: 8,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    alignSelf: \"center\",\n  },\n\n  retrospectCompactButtonText: {\n    fontSize: 16,\n    color: \"#E67E22\",\n    fontWeight: \"600\",\n  },\n\n  dreamEditModal: {\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: \"rgba(0,0,0,0.5)\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    zIndex: 1000,\n  },\n\n  dreamEditContent: {\n    backgroundColor: \"#FFFFFF\",\n    borderRadius: 12,\n    padding: 25,\n    width: \"95%\",\n    maxWidth: 380,\n  },\n\n  centerPlusContainer: {\n    alignItems: \"center\",\n    paddingVertical: 30,\n    backgroundColor: \"#1C1C1E\",\n  },\n\n  plusButton: {\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5,\n  },\n\n  headerBox: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: 8,\n    paddingHorizontal: 12,\n    backgroundColor: \"#FFFFFF\",\n  },\n  // headerBox ì „ìš©ìœ¼ë¡œ ì´ë™\n\n  dateTxt: {\n    fontWeight: \"700\",\n    fontSize: 14,\n    color: \"#666\",\n  },\n  dreamTxt: {\n    color: \"#666\",\n    marginTop: 4,\n    fontSize: 14,\n  },\n  dreamEditHint: {\n    color: \"#999\",\n    fontSize: 12,\n    marginTop: 1,\n  },\n  summaryTxt: {\n    color: \"#999\",\n    fontSize: 12,\n    marginTop: 4,\n  },\n\n  // ê¿ˆ í¸ì§‘ ìŠ¤íƒ€ì¼\n  dreamContainer: {\n    marginTop: 4,\n    alignItems: \"flex-end\",\n  },\n  dreamEditContainer: {\n    marginTop: 4,\n    width: \"100%\",\n    maxWidth: 250,\n  },\n  dreamInput: {\n    borderWidth: 1,\n    borderColor: \"#E0E0E0\",\n    borderRadius: 8,\n    padding: 8,\n    fontSize: 14,\n    backgroundColor: \"#FFFFFF\",\n    color: \"#333\",\n    minHeight: 40,\n    maxHeight: 80,\n    textAlignVertical: \"top\",\n  },\n  dreamButtonContainer: {\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    marginTop: 8,\n    gap: 8,\n  },\n  dreamButton: {\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    borderRadius: 4,\n    minWidth: 50,\n    alignItems: \"center\",\n  },\n  saveButton: {\n    backgroundColor: \"#7BA428\",\n  },\n  cancelButton: {\n    backgroundColor: \"#FFFFFF\",\n    borderWidth: 1,\n    borderColor: \"#007AFF\",\n  },\n  saveButtonText: {\n    color: \"#007AFF\",\n    fontSize: 14,\n    fontWeight: \"600\",\n  },\n  cancelButtonText: {\n    color: \"#007AFF\",\n    fontSize: 14,\n  },\n\n  // ì˜¤ëŠ˜ ì„¹ì…˜ - ê²€ì€ìƒ‰ ì˜ì—­ì— ì œëª©ê³¼ ê°ì˜¤ í†µí•©\n  todaySection: {\n    backgroundColor: \"#1C1C1E\",\n    paddingHorizontal: 20,\n    paddingTop: 24,\n    paddingBottom: 16,\n  },\n\n  todaySectionTitle: {\n    fontSize: 24,\n    fontWeight: \"bold\",\n    color: \"#FFFFFF\",\n    marginBottom: 20,\n  },\n\n  // ë‚´ì¼ ì„¹ì…˜\n  upcomingSection: {\n    backgroundColor: \"#1C1C1E\",\n    paddingHorizontal: 20,\n    paddingTop: 24,\n    paddingBottom: 16,\n  },\n\n  upcomingSectionTitle: {\n    fontSize: 24,\n    fontWeight: \"bold\",\n    color: \"#FFFFFF\",\n    marginBottom: 8,\n  },\n\n  // ê°ì˜¤ ê´€ë ¨ ìŠ¤íƒ€ì¼ - ê°œì„ ëœ ë””ìì¸\n  resolutionContainer: {\n    marginTop: 4,\n  },\n\n  // ìœ ì—°í•œ ëª©í‘œ ê´€ë ¨ ìŠ¤íƒ€ì¼\n  flexibleGoalSection: {\n    backgroundColor: \"#fff3cd\",\n    padding: 16,\n    marginHorizontal: 12,\n    marginBottom: 8,\n    borderRadius: 8,\n    borderWidth: 1,\n    borderColor: \"#ffeaa7\",\n  },\n  flexibleGoalHeader: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: 12,\n  },\n  flexibleGoalSectionTitle: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    color: \"#856404\",\n  },\n  flexibleGoalDetailButton: {\n    paddingHorizontal: 8,\n    paddingVertical: 4,\n  },\n  flexibleGoalDetailText: {\n    fontSize: 12,\n    color: \"#007AFF\",\n  },\n  flexibleGoalAddButton: {\n    backgroundColor: \"#fff\",\n    borderRadius: 8,\n    padding: 12,\n    borderWidth: 1,\n    borderColor: \"#ffeaa7\",\n    borderStyle: \"dashed\",\n    alignItems: \"center\",\n  },\n  flexibleGoalAddButtonText: {\n    fontSize: 14,\n    color: \"#856404\",\n    fontWeight: \"500\",\n  },\n  flexibleGoalAddButtonDesc: {\n    fontSize: 12,\n    color: \"#6c757d\",\n    marginTop: 2,\n  },\n  flexibleGoalList: {\n    gap: 8,\n  },\n  flexibleGoalItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    backgroundColor: \"#fff\",\n    borderRadius: 8,\n    padding: 12,\n    borderWidth: 1,\n    borderColor: \"#ffeaa7\",\n  },\n  flexibleGoalIcon: {\n    fontSize: 20,\n    marginRight: 12,\n  },\n  flexibleGoalContent: {\n    flex: 1,\n  },\n  flexibleGoalText: {\n    fontSize: 14,\n    color: \"#333\",\n    marginBottom: 2,\n  },\n  flexibleGoalCompleted: {\n    textDecorationLine: \"line-through\",\n    color: \"#666\",\n  },\n  flexibleGoalType: {\n    fontSize: 12,\n    color: \"#856404\",\n  },\n  flexibleGoalStatus: {\n    fontSize: 18,\n    marginLeft: 8,\n  },\n\n  footerBox: {\n    marginTop: 8,\n    alignItems: \"center\",\n  },\n  footerBtn: {\n    width: \"90%\",\n    paddingVertical: 8,\n    borderBottomWidth: StyleSheet.hairlineWidth,\n    borderColor: \"#007AFF\",\n    alignItems: \"center\",\n  },\n  footerTxt: {\n    fontSize: 14,\n    color: \"#007AFF\",\n    fontWeight: \"600\",\n  },\n  footerTxtDisabled: {\n    color: \"#007AFF\",\n  },\n\n  sectionHeaderContainer: {\n    backgroundColor: \"#007AFF\",\n  },\n  sectionHeader: {\n    padding: 8,\n    fontWeight: \"700\",\n    color: \"#007AFF\",\n    fontSize: 14,\n  },\n  item: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 14,\n    backgroundColor: \"#FFFFFF\",\n    marginHorizontal: 15,\n    marginVertical: 8,\n    borderRadius: 8,\n    shadowColor: \"#007AFF\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 2,\n  },\n  actions: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    gap: 2,\n  },\n  titleTimeContainer: {\n    flex: 1,\n    justifyContent: \"center\",\n  },\n  title: {\n    fontSize: 18,\n    color: \"#007AFF\",\n    fontWeight: \"500\",\n    marginBottom: 12,\n  },\n  time: {\n    color: \"#007AFF\",\n    fontSize: 8,\n  },\n  separator: {\n    height: 1,\n    backgroundColor: \"transparent\",\n  },\n\n  // ìƒíƒœ í‘œì‹œ ìŠ¤íƒ€ì¼\n  statusBadge: {\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    borderRadius: 20,\n    minWidth: 70,\n    alignItems: \"center\",\n  },\n  successBadge: {\n    backgroundColor: \"#75bbd9\",\n  },\n  failureBadge: {\n    backgroundColor: \"#FF9800\",\n  },\n  statusText: {\n    fontSize: 14,\n    fontWeight: \"700\",\n    color: \"#FFFFFF\",\n    textShadowColor: \"rgba(0, 0, 0, 0.3)\",\n    textShadowOffset: { width: 0, height: 1 },\n    textShadowRadius: 2,\n  },\n  checkButton: {\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    borderRadius: 20,\n    minWidth: 70,\n    alignItems: \"center\",\n  },\n  checkButtonActive: {\n    backgroundColor: \"#D4AF37\",\n  },\n  checkButtonInactive: {\n    backgroundColor: \"#C8C8D0\",\n  },\n  checkButtonText: {\n    fontSize: 12,\n    fontWeight: \"700\",\n    color: \"#333333\",\n  },\n  editButton: {\n    paddingHorizontal: 12,\n    paddingVertical: 8,\n    borderRadius: 8,\n    backgroundColor: \"#FFFFFF\",\n    borderWidth: 1,\n    borderColor: \"#E0E0E0\",\n  },\n  editButtonText: {\n    fontSize: 12,\n    color: \"#7BA428\",\n    fontWeight: \"500\",\n  },\n\n  // ë©”ëª¨ ë²„íŠ¼ ìŠ¤íƒ€ì¼\n  memoButton: {\n    paddingHorizontal: 10,\n    paddingVertical: 8,\n    borderRadius: 8,\n    backgroundColor: \"#E6F3FF\",\n    borderWidth: 1,\n    borderColor: \"#7BA428\",\n  },\n  memoButtonText: {\n    fontSize: 11,\n    color: \"#7BA428\",\n    fontWeight: \"600\",\n  },\n\n  // ë©”ëª¨ ëª¨ë‹¬ ìŠ¤íƒ€ì¼\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: \"#007AFF\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  modalContent: {\n    backgroundColor: \"#007AFF\",\n    borderRadius: 8,\n    padding: 8,\n    width: \"90%\",\n    maxWidth: 400,\n  },\n  modalTitle: {\n    fontSize: 18,\n    fontWeight: \"bold\",\n    color: \"#333\",\n    marginBottom: 8,\n    textAlign: \"center\",\n  },\n  modalSubtitle: {\n    fontSize: 14,\n    color: \"#666\",\n    marginBottom: 16,\n    textAlign: \"center\",\n  },\n  memoInput: {\n    borderWidth: 1,\n    borderColor: \"#ddd\",\n    borderRadius: 8,\n    padding: 12,\n    fontSize: 14,\n    backgroundColor: \"#fff\",\n    minHeight: 100,\n    maxHeight: 200,\n    textAlignVertical: \"top\",\n    marginBottom: 8,\n  },\n  memoCharCount: {\n    fontSize: 12,\n    color: \"#999\",\n    textAlign: \"right\",\n    marginBottom: 16,\n  },\n  modalButtons: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    gap: 12,\n  },\n  modalButton: {\n    flex: 1,\n    paddingVertical: 12,\n    borderRadius: 8,\n    alignItems: \"center\",\n  },\n  cancelModalButton: {\n    backgroundColor: \"#fff\",\n    borderWidth: 1,\n    borderColor: \"#ddd\",\n  },\n  saveModalButton: {\n    backgroundColor: \"#007AFF\",\n  },\n  cancelModalButtonText: {\n    color: \"#666\",\n    fontSize: 16,\n    fontWeight: \"600\",\n  },\n  saveModalButtonText: {\n    color: \"#fff\",\n    fontSize: 16,\n    fontWeight: \"600\",\n  },\n\n  // ë¹ˆ ìƒíƒœ ìŠ¤íƒ€ì¼\n  emptyContainer: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    paddingHorizontal: 32,\n    paddingVertical: 64,\n  },\n\n  emptyTitle: {\n    fontSize: 20,\n    fontWeight: \"600\",\n    color: \"#FFFFFF\",\n    textAlign: \"center\",\n    marginBottom: 8,\n  },\n\n  emptySubtitle: {\n    fontSize: 16,\n    color: \"#B3B3B3\",\n    textAlign: \"center\",\n    marginBottom: 12,\n    lineHeight: 22,\n  },\n\n  emptyHint: {\n    fontSize: 14,\n    color: \"#8A8A8A\",\n    textAlign: \"center\",\n    fontStyle: \"italic\",\n  },\n\n\n});\n","size_bytes":61376},"src/screens/GuestModeScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  SafeAreaView,\n  Alert,\n  ActivityIndicator,\n} from \"react-native\";\nimport { useAuthStore } from \"../store/authStore\";\n\ninterface GuestModeScreenProps {\n  navigation: any;\n}\n\nexport default function GuestModeScreen({ navigation }: GuestModeScreenProps) {\n  const [isLoading, setIsLoading] = useState(false);\n  const { signInAsGuest } = useAuthStore();\n\n  const startGuestMode = async () => {\n    if (isLoading) return; // ì¤‘ë³µ ì‹¤í–‰ ë°©ì§€\n\n    setIsLoading(true);\n    try {\n      console.log(\"ğŸš€ ê²ŒìŠ¤íŠ¸ ëª¨ë“œ ì‹œì‘...\");\n      const result = await signInAsGuest();\n\n      if (result.success) {\n        console.log(\"âœ… ê²ŒìŠ¤íŠ¸ ë¡œê·¸ì¸ ì„±ê³µ - ProfileSetupìœ¼ë¡œ ì´ë™\");\n        // ëª…ì‹œì ìœ¼ë¡œ ProfileSetupìœ¼ë¡œ ë„¤ë¹„ê²Œì´ì…˜\n        navigation.navigate(\"ProfileSetup\");\n      } else {\n        Alert.alert(\n          \"ê²ŒìŠ¤íŠ¸ ëª¨ë“œ ì‹œì‘ ì‹¤íŒ¨\",\n          result.error || \"ê²ŒìŠ¤íŠ¸ ëª¨ë“œë¥¼ ì‹œì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\",\n          [{ text: \"í™•ì¸\" }],\n        );\n      }\n    } catch (error) {\n      console.error(\"âŒ ê²ŒìŠ¤íŠ¸ ëª¨ë“œ ì‹œì‘ ì˜¤ë¥˜:\", error);\n      Alert.alert(\"ê²ŒìŠ¤íŠ¸ ëª¨ë“œ ì˜¤ë¥˜\", \"ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\", [\n        { text: \"í™•ì¸\" },\n      ]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <View style={styles.header}>\n        <TouchableOpacity\n          style={styles.backButton}\n          onPress={() => navigation.goBack()}\n        >\n          <Text style={styles.backButtonText}>â† ë’¤ë¡œ</Text>\n        </TouchableOpacity>\n\n        <Text style={styles.title}>ë¹„íšŒì› ì²´í—˜</Text>\n      </View>\n\n      <View style={styles.content}>\n        <View style={styles.iconContainer}>\n          <Text style={styles.icon}>ğŸ‘¤</Text>\n        </View>\n\n        <Text style={styles.description}>\n          íšŒì›ê°€ì… ì—†ì´ ì•±ì˜ ëª¨ë“  ê¸°ëŠ¥ì„{\"\\n\"}\n          ì™„ì „íˆ ì²´í—˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤\n        </Text>\n\n        <View style={styles.featureList}>\n          <View style={styles.featureItem}>\n            <Text style={styles.featureIcon}>âœ…</Text>\n            <Text style={styles.featureText}>ëª©í‘œ ì„¤ì • ë° ê´€ë¦¬</Text>\n          </View>\n          <View style={styles.featureItem}>\n            <Text style={styles.featureIcon}>â°</Text>\n            <Text style={styles.featureText}>ì‹¤ì‹œê°„ ë‹¬ì„± ì²´í¬</Text>\n          </View>\n          <View style={styles.featureItem}>\n            <Text style={styles.featureIcon}>ğŸ“</Text>\n            <Text style={styles.featureText}>íšŒê³  ì‘ì„±</Text>\n          </View>\n          <View style={styles.featureItem}>\n            <Text style={styles.featureIcon}>ğŸ“Š</Text>\n            <Text style={styles.featureText}>ì„±ì¥ ë¶„ì„</Text>\n          </View>\n        </View>\n      </View>\n\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity\n          style={[styles.primaryButton, isLoading && styles.disabledButton]}\n          onPress={startGuestMode}\n          disabled={isLoading}\n        >\n          {isLoading ? (\n            <ActivityIndicator color=\"#fff\" size=\"small\" />\n          ) : (\n            <Text style={styles.primaryButtonText}>ì²´í—˜ ì‹œì‘í•˜ê¸°</Text>\n          )}\n        </TouchableOpacity>\n\n        <TouchableOpacity\n          style={styles.secondaryButton}\n          onPress={() => navigation.navigate(\"Welcome\")}\n        >\n          <Text style={styles.secondaryButtonText}>íšŒì›ê°€ì…í•˜ê³  ì‹œì‘í•˜ê¸°</Text>\n        </TouchableOpacity>\n      </View>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#f8f9fa\",\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingHorizontal: 20,\n    paddingTop: 20,\n    paddingBottom: 20,\n  },\n  backButton: {\n    marginRight: 20,\n  },\n  backButtonText: {\n    fontSize: 16,\n    color: \"#667eea\",\n  },\n  title: {\n    fontSize: 24,\n    fontWeight: \"bold\",\n    color: \"#2c3e50\",\n  },\n  content: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    paddingHorizontal: 40,\n  },\n  iconContainer: {\n    width: 100,\n    height: 100,\n    backgroundColor: \"#fff\",\n    borderRadius: 50,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginBottom: 30,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 8,\n    elevation: 4,\n  },\n  icon: {\n    fontSize: 40,\n  },\n  description: {\n    fontSize: 18,\n    color: \"#34495e\",\n    textAlign: \"center\",\n    lineHeight: 26,\n    marginBottom: 40,\n  },\n  featureList: {\n    width: \"100%\",\n  },\n  featureItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: 16,\n    paddingHorizontal: 20,\n  },\n  featureIcon: {\n    fontSize: 20,\n    marginRight: 12,\n    width: 24,\n  },\n  featureText: {\n    fontSize: 16,\n    color: \"#34495e\",\n  },\n  buttonContainer: {\n    paddingHorizontal: 40,\n    paddingBottom: 40,\n  },\n  primaryButton: {\n    height: 56,\n    backgroundColor: \"#667eea\",\n    borderRadius: 12,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginBottom: 12,\n  },\n  secondaryButton: {\n    height: 56,\n    backgroundColor: \"#fff\",\n    borderWidth: 2,\n    borderColor: \"#667eea\",\n    borderRadius: 12,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  primaryButtonText: {\n    color: \"#fff\",\n    fontSize: 18,\n    fontWeight: \"600\",\n  },\n  secondaryButtonText: {\n    color: \"#667eea\",\n    fontSize: 18,\n    fontWeight: \"600\",\n  },\n  disabledButton: {\n    opacity: 0.5,\n  },\n});\n","size_bytes":5633},"src/screens/HistoryCalendarScreen.tsx":{"content":"// src/screens/HistoryCalendarScreen.tsx\nimport { useNavigation } from '@react-navigation/native';\nimport type { NativeStackNavigationProp } from '@react-navigation/native-stack';\nimport React, { memo, useEffect, useState } from 'react';\nimport { ActivityIndicator, Platform, StyleSheet, Text, TouchableOpacity, View, } from 'react-native';\nimport type { CalendarProps, DateData } from 'react-native-calendars';\nimport { Calendar } from 'react-native-calendars';\nimport { supabase } from '../supabaseClient';\nimport { formatDateKorea, getTodayKorea } from '../utils/timeUtils';\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë„¤ë¹„ íƒ€ì… â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\ntype HistoryStack = { Calendar: undefined; DayDetail: { date: string }; Statistics: undefined };\ntype NavProp      = NativeStackNavigationProp<HistoryStack, 'Calendar'>;\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë‹¬ì„±ë¥  â†’ ë¼ë²¨ & ìƒ‰ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nconst labelOf = (rate: number) =>\n  rate === 100 ? { txt: 'Trans', color: '#1E3A8A' }\n  : rate >= 70 ? { txt: 'Good',      color: 'seagreen' }\n  : rate >= 30 ? { txt: 'SoSo',      color: '#E67E22' }\n               : { txt: 'Bad',       color: 'crimson' };\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì…€ ì»´í¬ë„ŒíŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\ninterface CellProps {\n  date: DateData;\n  meta?: { rate: number; hasRetro: boolean };\n  onPress(dateISO: string): void;\n}\nconst Cell = memo(({ date, meta, onPress }: CellProps) => {\n  const isOtherMonth =\n    !date.dateString.startsWith(date.month < 10 ? `0${date.month}` : `${date.month}`);\n\n  /* ë¹ˆì…€(ë‹¤ë¥¸ ë‹¬) â€” í„°ì¹˜ ë¹„í™œì„± */\n  if (!meta) {\n    return (\n      <View style={styles.cell}>\n        <Text style={[styles.dayText, isOtherMonth && styles.dim]}>{date.day}</Text>\n      </View>\n    );\n  }\n\n  const { txt, color } = labelOf(meta.rate);\n\n  return (\n    <TouchableOpacity\n      style={styles.cell}\n      activeOpacity={0.7}\n      onPress={() => onPress(date.dateString)}\n    >\n      <Text style={[styles.dayText, { color }]}>{date.day}</Text>\n      <Text style={[styles.labelText, { color }]}>{txt}</Text>\n      {meta.hasRetro && <View style={styles.retroDot} />}\n    </TouchableOpacity>\n  );\n});\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë©”ì¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nexport default function HistoryCalendarScreen() {\n  const nav = useNavigation<NavProp>();\n  const [meta,    setMeta]    = useState<Record<string, { rate: number; hasRetro: boolean }>>({});\n  const [loading, setLoading] = useState(true);\n\n  /* ---------- ë°ì´í„° ë¡œë”© ---------- */\n  useEffect(() => {\n    (async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) { setLoading(false); return; }\n\n      /* â‘  ì •ì‹œ ëª©í‘œ ê°€ì ¸ì˜¤ê¸° */\n      const { data: goalsRaw, error: e1 } = await supabase\n        .from('goals')\n        .select('target_time, status')\n        .eq('user_id', user.id);\n      if (e1) throw e1;\n\n      /* â‘¡ ìœ ì—°í•œ ëª©í‘œ ê°€ì ¸ì˜¤ê¸° */\n      const { data: flexibleGoalsRaw, error: e2 } = await supabase\n        .from('flexible_goals')\n        .select('date, status')\n        .eq('user_id', user.id);\n      if (e2) throw e2;\n\n      /* â‘¢ íšŒê³  */\n      const { data: retrosRaw, error: e3 } = await supabase\n        .from('retrospects')\n        .select('date')\n        .eq('user_id', user.id);\n      if (e3) throw e3;\n\n      const goals = goalsRaw ?? [];\n      const flexibleGoals = flexibleGoalsRaw ?? [];\n      const retros = retrosRaw ?? [];\n\n      const retroSet = new Set(retros.map(r => r.date));\n      const m: Record<string, { rate: number; hasRetro: boolean }> = {};\n\n      // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œë³„ ëª©í‘œ ê·¸ë£¹í™”\n      const goalsByDate: Record<string, Array<{status: string}>> = {};\n\n      // ì •ì‹œ ëª©í‘œ - í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ë³€í™˜ (ë” ì •í™•í•œ ë³€í™˜)\n      goals.forEach(goal => {\n        const goalDate = new Date(goal.target_time);\n        \n        // í•œêµ­ ì‹œê°„ëŒ€ë¡œ ì •í™•í•œ ë³€í™˜ (ì—¬ëŸ¬ ë°©ë²• ì‹œë„)\n        let dateKey: string;\n        \n        try {\n          // ë°©ë²• 1: Intl.DateTimeFormat ì‚¬ìš©\n          const formatter = new Intl.DateTimeFormat('en-CA', {\n            timeZone: 'Asia/Seoul',\n            year: 'numeric',\n            month: '2-digit', \n            day: '2-digit'\n          });\n          dateKey = formatter.format(goalDate);\n        } catch (e1) {\n          try {\n            // ë°©ë²• 2: toLocaleDateString ì‚¬ìš©\n            const koreanDateStr = goalDate.toLocaleDateString('sv-SE', {\n              timeZone: 'Asia/Seoul'\n            });\n            dateKey = koreanDateStr.slice(0, 10);\n          } catch (e2) {\n            // ë°©ë²• 3: ìˆ˜ë™ ê³„ì‚° (UTC + 9ì‹œê°„)\n            const backupDate = new Date(goalDate.getTime() + (9 * 60 * 60 * 1000));\n            dateKey = backupDate.toISOString().slice(0, 10);\n          }\n        }\n        \n        console.log('ğŸ“… ëª©í‘œ ë‚ ì§œ ë³€í™˜:', {\n          ì›ë³¸ì‹œê°„: goal.target_time,\n          goalDate: goalDate.toISOString(),\n          ìµœì¢…í‚¤: dateKey,\n          ëª©í‘œìƒíƒœ: goal.status\n        });\n        \n        if (!goalsByDate[dateKey]) goalsByDate[dateKey] = [];\n        goalsByDate[dateKey].push({ status: goal.status });\n      });\n\n      // ìœ ì—°í•œ ëª©í‘œ ì¶”ê°€\n      flexibleGoals.forEach(goal => {\n        const dateKey = goal.date; // ì´ë¯¸ YYYY-MM-DD í˜•ì‹\n        \n        if (!goalsByDate[dateKey]) goalsByDate[dateKey] = [];\n        goalsByDate[dateKey].push({ status: goal.status });\n      });\n\n      // ë‚ ì§œë³„ ì„±ê³µë¥  ê³„ì‚°\n      Object.entries(goalsByDate).forEach(([date, goals]) => {\n        const total = goals.length;\n        const successCount = goals.filter(g => g.status === 'success').length;\n        const rate = total === 0 ? 0 : Math.round((successCount / total) * 100);\n        \n        m[date] = { \n          rate, \n          hasRetro: retroSet.has(date) \n        };\n      });\n\n      console.log('ğŸ“… ë‹¬ë ¥ ì„±ê³µë¥  ê³„ì‚° (í•œêµ­ ì‹œê°„ ê¸°ì¤€):', {\n        ì´ë‚ ì§œìˆ˜: Object.keys(m).length,\n        ë‚ ì§œë³„ë°ì´í„°: Object.entries(m).slice(0, 5).map(([date, data]) => ({\n          date,\n          rate: data.rate,\n          hasRetro: data.hasRetro\n        })),\n        goalsByDate: Object.entries(goalsByDate).map(([date, goals]) => ({\n          date,\n          goalCount: goals.length,\n          statuses: goals.map(g => g.status)\n        }))\n      });\n\n      setMeta(m);\n      setLoading(false);\n    })();\n  }, []);\n\n  /* ---------- ì…€ ë Œë” ---------- */\n  const dayComponent: CalendarProps['dayComponent'] = ({ date }) =>\n    date ? (\n      <Cell\n        date={date}\n        meta={meta[date.dateString]}\n        onPress={d => nav.navigate('DayDetail', { date: d })}\n      />\n    ) : (\n      <View style={styles.cell} />\n    );\n\n  if (loading)\n    return (\n      <View style={styles.center}>\n        <ActivityIndicator size=\"large\" />\n      </View>\n    );\n\n  /* ---------- UI ---------- */\n  return (\n    <View style={{ flex: 1 }}>\n      <Calendar dayComponent={dayComponent} /* onDayPress ì œê±° */ />\n\n      {/* ë²”ë¡€ */}\n      <View style={styles.legendRow}>\n        {[\n          { txt: 'Bad â‰¤30%',      color: 'crimson' },\n          { txt: 'SoSo 30-69%',   color: '#E67E22' },\n          { txt: 'Good 70-99%',   color: 'seagreen' },\n          { txt: 'Trans 100%', color: '#1E3A8A' },\n        ].map(l => (\n          <View key={l.txt} style={styles.legendBox}>\n            <View style={[styles.legendSwatch, { backgroundColor: l.color }]} />\n            <Text style={styles.legendLabel}>{l.txt}</Text>\n          </View>\n        ))}\n      </View>\n\n      {/* í†µê³„ ë¶„ì„ ë²„íŠ¼ */}\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity \n          style={styles.statisticsButton}\n          onPress={() => nav.navigate('Statistics')}\n        >\n          <Text style={styles.statisticsButtonText}>ğŸ“Š ì„±ì¥ ë¶„ì„ ë³´ê¸°</Text>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n}\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ìŠ¤íƒ€ì¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nconst CELL = Platform.OS === 'web' ? 46 : 40;\n\nconst styles = StyleSheet.create({\n  cell:       { width: CELL, height: CELL, alignItems: 'center', justifyContent: 'center' },\n  dayText:    { fontSize: 15 },\n  dim:        { color: '#ccc' },\n  labelText:  { fontSize: 9, marginTop: 1 },\n  retroDot:   { width: 4, height: 4, borderRadius: 2, backgroundColor: '#E67E22', marginTop: 1 },\n\n  legendRow:   { flexDirection: 'row', justifyContent: 'space-around',\n                 paddingVertical: 6, borderTopWidth: StyleSheet.hairlineWidth, borderColor: '#ddd' },\n  legendBox:   { flexDirection: 'row', alignItems: 'center' },\n  legendSwatch:{ width: 10, height: 10, borderRadius: 2, marginRight: 4 },\n  legendLabel: { fontSize: 12 },\n\n  center: { flex: 1, justifyContent: 'center', alignItems: 'center' },\n  \n  buttonContainer: {\n    padding: 16,\n    backgroundColor: '#f5f5f5',\n  },\n  statisticsButton: {\n    backgroundColor: '#4CAF50',\n    paddingVertical: 12,\n    paddingHorizontal: 24,\n    borderRadius: 8,\n    alignItems: 'center',\n  },\n  statisticsButtonText: {\n    color: '#fff',\n    fontSize: 16,\n    fontWeight: 'bold',\n  },\n});\n","size_bytes":9132},"src/screens/OnboardingScreen.tsx":{"content":"import React, { useState } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  ScrollView,\n  Dimensions,\n  Alert,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\n\nconst { width } = Dimensions.get('window');\n\ninterface OnboardingStep {\n  id: number;\n  title: string;\n  description: string;\n  questions?: {\n    id: string;\n    question: string;\n    options: { id: string; text: string; value: any }[];\n  }[];\n}\n\nconst onboardingSteps: OnboardingStep[] = [\n  {\n    id: 1,\n    title: 'í™˜ì˜í•©ë‹ˆë‹¤! ğŸŒŸ',\n    description: 'The Better DayëŠ” ì‹¤íŒ¨ë¥¼ ì¹œêµ¬ë¡œ ë§Œë“œëŠ” í˜ì‹ ì ì¸ ìŠµê´€ ê´€ë¦¬ ì•±ì…ë‹ˆë‹¤.\\n\\nì™„ë²½í•¨ë³´ë‹¤ ê¾¸ì¤€í•¨ì„, ì„±ì·¨ë³´ë‹¤ ì„±ì¥ì„ ì¶”êµ¬í•©ë‹ˆë‹¤.',\n  },\n  {\n    id: 2,\n    title: 'ë‹¹ì‹ ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”',\n    description: 'ê°œì¸í™”ëœ ì¶”ì²œì„ ìœ„í•´ ëª‡ ê°€ì§€ ì§ˆë¬¸ì— ë‹µí•´ì£¼ì„¸ìš”.',\n    questions: [\n      {\n        id: 'lifestyle',\n        question: 'í‰ì†Œ ë¼ì´í”„ìŠ¤íƒ€ì¼ì€?',\n        options: [\n          { id: 'morning', text: 'ğŸŒ… ì•„ì¹¨í˜• ì¸ê°„', value: 'morning' },\n          { id: 'night', text: 'ğŸŒ™ ë°¤í˜• ì¸ê°„', value: 'night' },\n          { id: 'flexible', text: 'âš¡ ìœ ì—°í•œ ìŠ¤íƒ€ì¼', value: 'flexible' },\n        ],\n      },\n      {\n        id: 'goals',\n        question: 'ê°€ì¥ ê´€ì‹¬ ìˆëŠ” ëª©í‘œëŠ”?',\n        options: [\n          { id: 'health', text: 'ğŸ’ª ê±´ê°• ê´€ë¦¬', value: 'health' },\n          { id: 'productivity', text: 'ğŸ“ˆ ìƒì‚°ì„± í–¥ìƒ', value: 'productivity' },\n          { id: 'learning', text: 'ğŸ“š í•™ìŠµ ë° ì„±ì¥', value: 'learning' },\n          { id: 'relationships', text: 'ğŸ‘¥ ì¸ê°„ê´€ê³„', value: 'relationships' },\n        ],\n      },\n      {\n        id: 'difficulty',\n        question: 'ëª©í‘œ ë‹¬ì„±ì—ì„œ ê°€ì¥ ì–´ë ¤ìš´ ì ì€?',\n        options: [\n          { id: 'consistency', text: 'ğŸ”„ ê¾¸ì¤€í•¨ ìœ ì§€', value: 'consistency' },\n          { id: 'motivation', text: 'ğŸ”¥ ë™ê¸° ë¶€ì¡±', value: 'motivation' },\n          { id: 'time', text: 'â° ì‹œê°„ ë¶€ì¡±', value: 'time' },\n          { id: 'perfectionism', text: 'ğŸ¯ ì™„ë²½ì£¼ì˜', value: 'perfectionism' },\n        ],\n      },\n    ],\n  },\n  {\n    id: 3,\n    title: 'ë§ì¶¤ ì¶”ì²œ ğŸ“‹',\n    description: 'ë‹µë³€ì„ ë°”íƒ•ìœ¼ë¡œ ì¶”ì²œ ëª©í‘œë¥¼ ì¤€ë¹„í–ˆìŠµë‹ˆë‹¤!',\n  },\n  {\n    id: 4,\n    title: 'ì‹œì‘í•  ì¤€ë¹„ ì™„ë£Œ! ğŸš€',\n    description: 'ì´ì œ ì‹¤íŒ¨ ì¹œí™”ì  ì—¬ì •ì„ ì‹œì‘í•´ë³´ì„¸ìš”.\\n\\nì‘ì€ ëª©í‘œë¶€í„° ì°¨ê·¼ì°¨ê·¼, ì‹¤íŒ¨í•´ë„ ê´œì°®ìŠµë‹ˆë‹¤.',\n  },\n];\n\ninterface OnboardingScreenProps {\n  navigation: any;\n}\n\nexport default function OnboardingScreen({ navigation }: OnboardingScreenProps) {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [answers, setAnswers] = useState<Record<string, any>>({});\n  const [recommendations, setRecommendations] = useState<string[]>([]);\n\n  const currentStepData = onboardingSteps[currentStep];\n\n  const handleAnswer = (questionId: string, value: any) => {\n    setAnswers(prev => ({ ...prev, [questionId]: value }));\n  };\n\n  const generateRecommendations = () => {\n    const recs: string[] = [];\n    \n    // ë¼ì´í”„ìŠ¤íƒ€ì¼ ê¸°ë°˜ ì¶”ì²œ\n    if (answers.lifestyle === 'morning') {\n      recs.push('ğŸŒ… ì˜¤ì „ 6ì‹œ ìš´ë™í•˜ê¸°');\n      recs.push('â˜• ì•„ì¹¨ ëª…ìƒ 10ë¶„');\n    } else if (answers.lifestyle === 'night') {\n      recs.push('ğŸŒ™ ë°¤ ë…ì„œ 30ë¶„');\n      recs.push('ğŸ“± ë””ì§€í„¸ ë””í†¡ìŠ¤ ì‹œê°„');\n    } else {\n      recs.push('âš¡ ìœ ì—°í•œ ìš´ë™ ì‹œê°„');\n      recs.push('ğŸ¯ í•˜ë£¨ 3ê°€ì§€ ìš°ì„ ìˆœìœ„');\n    }\n\n    // ëª©í‘œ ê¸°ë°˜ ì¶”ì²œ\n    if (answers.goals === 'health') {\n      recs.push('ğŸ’§ ë¬¼ 8ì” ë§ˆì‹œê¸°');\n      recs.push('ğŸ¥— ê±´ê°•í•œ ê°„ì‹ ë¨¹ê¸°');\n    } else if (answers.goals === 'productivity') {\n      recs.push('ğŸ“ í•  ì¼ ëª©ë¡ ì‘ì„±');\n      recs.push('â° 25ë¶„ ì§‘ì¤‘ ì‘ì—…');\n    } else if (answers.goals === 'learning') {\n      recs.push('ğŸ“š ë§¤ì¼ 15ë¶„ ì½ê¸°');\n      recs.push('ğŸ§ ìƒˆë¡œìš´ ê¸°ìˆ  í•™ìŠµ');\n    } else {\n      recs.push('ğŸ‘¥ ì§€ì¸ì—ê²Œ ì•ˆë¶€ ë¬»ê¸°');\n      recs.push('ğŸ’Œ ê°ì‚¬ ë©”ì‹œì§€ ë³´ë‚´ê¸°');\n    }\n\n    // ì–´ë ¤ì›€ ê¸°ë°˜ ì¶”ì²œ\n    if (answers.difficulty === 'perfectionism') {\n      recs.push('ğŸ¯ 70% ì™„ì„±ë„ë¡œ ë§Œì¡±í•˜ê¸°');\n      recs.push('âœ¨ ì‘ì€ ì§„ì „ ì¶•í•˜í•˜ê¸°');\n    }\n\n    setRecommendations(recs.slice(0, 4));\n  };\n\n  const handleNext = () => {\n    if (currentStep === 1 && currentStepData.questions) {\n      // ëª¨ë“  ì§ˆë¬¸ì´ ë‹µë³€ë˜ì—ˆëŠ”ì§€ í™•ì¸\n      const allAnswered = currentStepData.questions.every(q => answers[q.id]);\n      if (!allAnswered) {\n        Alert.alert('ì•Œë¦¼', 'ëª¨ë“  ì§ˆë¬¸ì— ë‹µí•´ì£¼ì„¸ìš”.');\n        return;\n      }\n      generateRecommendations();\n    }\n\n    if (currentStep < onboardingSteps.length - 1) {\n      setCurrentStep(prev => prev + 1);\n    } else {\n      // ì˜¨ë³´ë”© ì™„ë£Œ - í”„ë¡œí•„ ì„¤ì •ìœ¼ë¡œ ì´ë™\n      navigation.replace('ProfileSetup', { onboardingData: { answers, recommendations } });\n    }\n  };\n\n  const handleSkip = () => {\n    navigation.replace('ProfileSetup', { onboardingData: null });\n  };\n\n  const renderQuestions = () => {\n    if (!currentStepData.questions) return null;\n\n    return currentStepData.questions.map(question => (\n      <View key={question.id} style={styles.questionContainer}>\n        <Text style={styles.questionText}>{question.question}</Text>\n        <View style={styles.optionsContainer}>\n          {question.options.map(option => (\n            <TouchableOpacity\n              key={option.id}\n              style={[\n                styles.optionButton,\n                answers[question.id] === option.value && styles.selectedOption\n              ]}\n              onPress={() => handleAnswer(question.id, option.value)}\n            >\n              <Text style={[\n                styles.optionText,\n                answers[question.id] === option.value && styles.selectedOptionText\n              ]}>\n                {option.text}\n              </Text>\n            </TouchableOpacity>\n          ))}\n        </View>\n      </View>\n    ));\n  };\n\n  const renderRecommendations = () => {\n    if (currentStep !== 2) return null;\n\n    return (\n      <View style={styles.recommendationsContainer}>\n        <Text style={styles.recommendationsTitle}>ì¶”ì²œ ëª©í‘œë“¤:</Text>\n        {recommendations.map((rec, index) => (\n          <View key={index} style={styles.recommendationItem}>\n            <Text style={styles.recommendationText}>{rec}</Text>\n          </View>\n        ))}\n        <Text style={styles.recommendationNote}>\n          ì´ ëª©í‘œë“¤ì€ ì–¸ì œë“  ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!\n        </Text>\n      </View>\n    );\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>\n        {/* ì§„í–‰ í‘œì‹œê¸° */}\n        <View style={styles.progressContainer}>\n          {onboardingSteps.map((_, index) => (\n            <View\n              key={index}\n              style={[\n                styles.progressDot,\n                index <= currentStep && styles.progressDotActive\n              ]}\n            />\n          ))}\n        </View>\n\n        {/* ë©”ì¸ ì½˜í…ì¸  */}\n        <View style={styles.contentContainer}>\n          <Text style={styles.title}>{currentStepData.title}</Text>\n          <Text style={styles.description}>{currentStepData.description}</Text>\n\n          {renderQuestions()}\n          {renderRecommendations()}\n        </View>\n      </ScrollView>\n\n      {/* í•˜ë‹¨ ë²„íŠ¼ */}\n      <View style={styles.buttonContainer}>\n        {currentStep > 0 && (\n          <TouchableOpacity style={styles.skipButton} onPress={handleSkip}>\n            <Text style={styles.skipButtonText}>ê±´ë„ˆë›°ê¸°</Text>\n          </TouchableOpacity>\n        )}\n        \n        <TouchableOpacity style={styles.nextButton} onPress={handleNext}>\n          <Text style={styles.nextButtonText}>\n            {currentStep === onboardingSteps.length - 1 ? 'ì‹œì‘í•˜ê¸°' : 'ë‹¤ìŒ'}\n          </Text>\n        </TouchableOpacity>\n      </View>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f8f9fa',\n  },\n  scrollView: {\n    flex: 1,\n  },\n  progressContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    alignItems: 'center',\n    paddingVertical: 20,\n  },\n  progressDot: {\n    width: 8,\n    height: 8,\n    borderRadius: 4,\n    backgroundColor: '#dee2e6',\n    marginHorizontal: 4,\n  },\n  progressDotActive: {\n    backgroundColor: '#007bff',\n  },\n  contentContainer: {\n    paddingHorizontal: 24,\n    paddingBottom: 100,\n  },\n  title: {\n    fontSize: 28,\n    fontWeight: 'bold',\n    color: '#212529',\n    textAlign: 'center',\n    marginBottom: 16,\n  },\n  description: {\n    fontSize: 16,\n    color: '#6c757d',\n    textAlign: 'center',\n    lineHeight: 24,\n    marginBottom: 32,\n  },\n  questionContainer: {\n    marginBottom: 32,\n  },\n  questionText: {\n    fontSize: 18,\n    fontWeight: '600',\n    color: '#212529',\n    marginBottom: 16,\n  },\n  optionsContainer: {\n    gap: 12,\n  },\n  optionButton: {\n    padding: 16,\n    borderRadius: 12,\n    borderWidth: 2,\n    borderColor: '#dee2e6',\n    backgroundColor: '#ffffff',\n  },\n  selectedOption: {\n    borderColor: '#007bff',\n    backgroundColor: '#e3f2fd',\n  },\n  optionText: {\n    fontSize: 16,\n    color: '#212529',\n    textAlign: 'center',\n  },\n  selectedOptionText: {\n    color: '#007bff',\n    fontWeight: '600',\n  },\n  recommendationsContainer: {\n    backgroundColor: '#ffffff',\n    borderRadius: 16,\n    padding: 20,\n    borderWidth: 1,\n    borderColor: '#dee2e6',\n  },\n  recommendationsTitle: {\n    fontSize: 18,\n    fontWeight: '600',\n    color: '#212529',\n    marginBottom: 16,\n    textAlign: 'center',\n  },\n  recommendationItem: {\n    backgroundColor: '#f8f9fa',\n    padding: 16,\n    borderRadius: 12,\n    marginBottom: 12,\n  },\n  recommendationText: {\n    fontSize: 16,\n    color: '#212529',\n  },\n  recommendationNote: {\n    fontSize: 14,\n    color: '#6c757d',\n    textAlign: 'center',\n    fontStyle: 'italic',\n    marginTop: 8,\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    paddingHorizontal: 24,\n    paddingVertical: 16,\n    backgroundColor: '#ffffff',\n    borderTopWidth: 1,\n    borderTopColor: '#dee2e6',\n    gap: 12,\n  },\n  skipButton: {\n    flex: 1,\n    paddingVertical: 16,\n    paddingHorizontal: 24,\n    borderRadius: 12,\n    borderWidth: 1,\n    borderColor: '#dee2e6',\n  },\n  skipButtonText: {\n    fontSize: 16,\n    color: '#6c757d',\n    textAlign: 'center',\n    fontWeight: '500',\n  },\n  nextButton: {\n    flex: 2,\n    paddingVertical: 16,\n    paddingHorizontal: 24,\n    borderRadius: 12,\n    backgroundColor: '#007bff',\n  },\n  nextButtonText: {\n    fontSize: 16,\n    color: '#ffffff',\n    textAlign: 'center',\n    fontWeight: '600',\n  },\n});","size_bytes":10822},"src/screens/PersonalAnalyticsScreen.tsx":{"content":"import React, { useEffect, useState } from \"react\";\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  RefreshControl,\n} from \"react-native\";\nimport { useAnalyticsStore } from \"../store/analyticsStore\";\nimport { useMotivationMessageStore } from \"../store/motivationMessageStore\";\n\nconst PersonalAnalyticsScreen: React.FC = () => {\n  console.log(\"ğŸš¨ğŸš¨ğŸš¨ PersonalAnalyticsScreen ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ë¨!!!\");\n  const {\n    statistics,\n    hourlyStats,\n    dailyStats,\n    adminInsights,\n    loading,\n    calculateStatistics,\n    fetchHourlyStats,\n    fetchDailyStats,\n    fetchAdminInsights,\n    updateStatistics,\n    getBestTimeSlot,\n    getBestDay,\n  } = useAnalyticsStore();\n\n  const { currentMessage, fetchMessages, getTodaysMotivationMessage } =\n    useMotivationMessageStore();\n\n  const [refreshing, setRefreshing] = useState(false);\n\n  useEffect(() => {\n    console.log(\"ğŸ”¥ PersonalAnalyticsScreen useEffect ì‹¤í–‰\");\n    loadAllData();\n  }, []);\n\n  const loadAllData = async () => {\n    console.log(\"ğŸ”¥ loadAllData ì‹œì‘ - calculateStatistics í˜¸ì¶œ\");\n    try {\n      await calculateStatistics();\n      console.log(\"âœ… calculateStatistics ì™„ë£Œ\");\n      await Promise.all([\n        fetchHourlyStats(),\n        fetchDailyStats(),\n        fetchAdminInsights(),\n      ]);\n      // ë™ê¸°ë¶€ì—¬ ë©”ì‹œì§€ ë°ì´í„° ì—…ë°ì´íŠ¸\n      await fetchMessages();\n      await getTodaysMotivationMessage();\n      console.log(\"âœ… loadAllData ëª¨ë“  ì‘ì—… ì™„ë£Œ\");\n    } catch (error) {\n      console.error(\"âŒ loadAllData ì˜¤ë¥˜:\", error);\n    }\n  };\n\n  const onRefresh = async () => {\n    setRefreshing(true);\n    console.log(\"ğŸ“Š PersonalAnalyticsScreen: onRefresh ì‹œì‘\");\n    console.log(\"ğŸ”¥ ê°•ì œ ì—°ì† ê¸°ë¡ ê³„ì‚° ì‹¤í–‰...\");\n    await calculateStatistics();\n    await fetchAdminInsights();\n    console.log(\n      \"ğŸ“Š PersonalAnalyticsScreen: onRefresh ì™„ë£Œ, í†µê³„:\",\n      statistics,\n    );\n    setRefreshing(false);\n  };\n\n  const getDayName = (dayOfWeek: number): string => {\n    const days = [\"ì¼\", \"ì›”\", \"í™”\", \"ìˆ˜\", \"ëª©\", \"ê¸ˆ\", \"í† \"];\n    return days[dayOfWeek];\n  };\n\n  if (loading && !statistics) {\n    return (\n      <View style={styles.loadingContainer}>\n        <Text style={styles.loadingText}>ë¶„ì„ ì¤‘...</Text>\n      </View>\n    );\n  }\n\n  return (\n    <ScrollView\n      style={styles.container}\n      refreshControl={\n        <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n      }\n    >\n      {/* ê°œì¸ í†µê³„ ì„¹ì…˜ */}\n      <View style={styles.section}>\n        <Text style={styles.sectionTitle}>ğŸ“Š ë‚˜ì˜ ì„±ì¥ ë¶„ì„</Text>\n\n        {statistics && (\n          <View style={styles.statsGrid}>\n            <View style={[styles.statCard, styles.primaryCard]}>\n              <Text style={styles.statNumber}>{statistics.successRate}%</Text>\n              <Text style={styles.statLabel}>ì „ì²´ ì„±ê³µë¥ </Text>\n            </View>\n\n            <View style={styles.statCard}>\n              <Text style={styles.statNumber}>{statistics.totalGoals}</Text>\n              <Text style={styles.statLabel}>ì´ ëª©í‘œ ìˆ˜</Text>\n            </View>\n\n            <View style={styles.statCard}>\n              <Text style={styles.statNumber}>{statistics.currentStreak}</Text>\n              <Text style={styles.statLabel}>ì—°ì† ì„±ê³µ</Text>\n            </View>\n\n            <View style={styles.statCard}>\n              <Text style={styles.statNumber}>{statistics.bestStreak}</Text>\n              <Text style={styles.statLabel}>ìµœê³  ê¸°ë¡</Text>\n            </View>\n          </View>\n        )}\n      </View>\n\n      {/* ìµœê³  ì„±ê³¼ ì‹œê°„ëŒ€ */}\n      {statistics && (\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>ğŸ¯ ë‚˜ì˜ ìµœê³  ì„±ê³¼</Text>\n\n          {statistics.successGoals === 0 ? (\n            <View style={styles.noDataContainer}>\n              <Text style={styles.noDataText}>ë¶„ì„í•  ë°ì´í„°ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.</Text>\n              <Text style={styles.noDataSubText}></Text>\n            </View>\n          ) : (\n            <View style={styles.performanceGrid}>\n              <View style={styles.performanceCard}>\n                <Text style={styles.performanceLabel}>ìµœê³  ì‹œê°„ëŒ€</Text>\n                <Text style={styles.performanceValue}>{getBestTimeSlot()}</Text>\n                <Text style={styles.performanceDetail}>\n                  {statistics.bestHour}ì‹œ\n                </Text>\n              </View>\n\n              <View style={styles.performanceCard}>\n                <Text style={styles.performanceLabel}>ìµœê³  ìš”ì¼</Text>\n                <Text style={styles.performanceValue}>{getBestDay()}</Text>\n                <Text style={styles.performanceDetail}>ì„±ê³µë¥  ë†’ìŒ</Text>\n              </View>\n            </View>\n          )}\n        </View>\n      )}\n\n      {/* ì‹œê°„ëŒ€ë³„ ì„±ê³¼ ì°¨íŠ¸ */}\n      {hourlyStats.length > 0 && (\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>ğŸ• ì‹œê°„ëŒ€ë³„ ì„±ê³¼</Text>\n          <View style={styles.chartContainer}>\n            {hourlyStats.map((stat, index) => (\n              <View key={index} style={styles.chartItem}>\n                <Text style={styles.chartLabel}>{stat.hour}ì‹œ</Text>\n                <View style={styles.chartBar}>\n                  <View\n                    style={[\n                      styles.chartBarFill,\n                      { width: `${stat.successRate}%` },\n                    ]}\n                  />\n                </View>\n                <Text style={styles.chartValue}>{stat.successRate}%</Text>\n              </View>\n            ))}\n          </View>\n        </View>\n      )}\n\n      {/* ìš”ì¼ë³„ ì„±ê³¼ ì°¨íŠ¸ */}\n      {dailyStats.length > 0 && (\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>ğŸ“… ìš”ì¼ë³„ ì„±ê³¼</Text>\n          <View style={styles.weeklyChart}>\n            {dailyStats.map((stat, index) => (\n              <View key={index} style={styles.weeklyItem}>\n                <Text style={styles.weeklyLabel}>\n                  {getDayName(stat.dayOfWeek)}\n                </Text>\n                <View style={styles.weeklyBar}>\n                  <View\n                    style={[\n                      styles.weeklyBarFill,\n                      { height: `${stat.successRate}%` },\n                    ]}\n                  />\n                </View>\n                <Text style={styles.weeklyValue}>{stat.successRate}%</Text>\n              </View>\n            ))}\n          </View>\n        </View>\n      )}\n\n      {/* ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ */}\n      <View style={styles.section}>\n        <Text style={styles.sectionTitle}>ğŸ† ì„±ê³µí•˜ëŠ” ì‚¬ìš©ìë“¤ì˜ íŠ¹ì§•</Text>\n        {adminInsights.map((insight, index) => (\n          <View key={insight.id} style={styles.adminInsightCard}>\n            <View style={styles.insightHeader}>\n              <Text style={styles.insightIcon}>\n                {insight.insightType === \"pattern\"\n                  ? \"ğŸ“Š\"\n                  : insight.insightType === \"tip\"\n                    ? \"ğŸ’¡\"\n                    : \"ğŸ“ˆ\"}\n              </Text>\n              <Text style={styles.adminInsightTitle}>{insight.title}</Text>\n            </View>\n            <Text style={styles.insightDescription}>{insight.description}</Text>\n          </View>\n        ))}\n      </View>\n\n      {/* ë™ê¸°ë¶€ì—¬ ì„¹ì…˜ */}\n      {currentMessage && (\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>{currentMessage.title}</Text>\n          <View style={styles.motivationCard}>\n            <View style={styles.characterSection}>\n              <View style={styles.characterContent}>\n                <Text style={styles.motivationMessage}>\n                  {currentMessage.message}\n                </Text>\n              </View>\n            </View>\n          </View>\n        </View>\n      )}\n    </ScrollView>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#f5f5f5\",\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#f5f5f5\",\n  },\n  loadingText: {\n    fontSize: 16,\n    color: \"#666\",\n  },\n  section: {\n    backgroundColor: \"#fff\",\n    margin: 16,\n    padding: 20,\n    borderRadius: 12,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  sectionTitle: {\n    fontSize: 18,\n    fontWeight: \"bold\",\n    marginBottom: 16,\n    color: \"#333\",\n  },\n  statsGrid: {\n    flexDirection: \"row\",\n    flexWrap: \"wrap\",\n    justifyContent: \"space-between\",\n  },\n  statCard: {\n    width: \"48%\",\n    backgroundColor: \"#f8f9fa\",\n    padding: 16,\n    borderRadius: 8,\n    marginBottom: 12,\n    alignItems: \"center\",\n  },\n  primaryCard: {\n    backgroundColor: \"#e3f2fd\",\n  },\n  statNumber: {\n    fontSize: 24,\n    fontWeight: \"bold\",\n    color: \"#1976d2\",\n  },\n  statLabel: {\n    fontSize: 12,\n    color: \"#666\",\n    marginTop: 4,\n  },\n  // ë™ê¸°ë¶€ì—¬ ì„¹ì…˜ ìŠ¤íƒ€ì¼\n  motivationCard: {\n    backgroundColor: \"#aff0e0\",\n    padding: 16,\n    borderRadius: 8,\n    marginBottom: 12,\n    borderLeftWidth: 4,\n    borderLeftColor: \"#42a88f\",\n  },\n  characterSection: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  characterIcon: {\n    width: 50,\n    height: 50,\n    backgroundColor: \"#fff\",\n    borderRadius: 25,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginRight: 16,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n\n  characterContent: {\n    flex: 1,\n  },\n  motivationMessage: {\n    fontSize: 15,\n    color: \"#555\",\n    lineHeight: 18,\n  },\n\n  performanceGrid: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n  },\n  performanceCard: {\n    width: \"48%\",\n    backgroundColor: \"#fff3e0\",\n    padding: 16,\n    borderRadius: 8,\n    alignItems: \"center\",\n  },\n  performanceLabel: {\n    fontSize: 12,\n    color: \"#666\",\n    marginBottom: 4,\n  },\n  performanceValue: {\n    fontSize: 18,\n    fontWeight: \"bold\",\n    color: \"#ff9800\",\n  },\n  performanceDetail: {\n    fontSize: 10,\n    color: \"#999\",\n    marginTop: 2,\n  },\n  chartContainer: {\n    marginTop: 8,\n  },\n  chartItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: 8,\n  },\n  chartLabel: {\n    width: 40,\n    fontSize: 12,\n    color: \"#666\",\n  },\n  chartBar: {\n    flex: 1,\n    height: 20,\n    backgroundColor: \"#e0e0e0\",\n    borderRadius: 4,\n    marginHorizontal: 8,\n  },\n  chartBarFill: {\n    height: \"100%\",\n    backgroundColor: \"#4caf50\",\n    borderRadius: 4,\n    minWidth: 2,\n  },\n  chartValue: {\n    width: 40,\n    fontSize: 12,\n    color: \"#666\",\n    textAlign: \"right\",\n  },\n  weeklyChart: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    alignItems: \"flex-end\",\n    height: 120,\n    marginTop: 8,\n  },\n  weeklyItem: {\n    alignItems: \"center\",\n    flex: 1,\n  },\n  weeklyLabel: {\n    fontSize: 12,\n    color: \"#666\",\n    marginBottom: 4,\n  },\n  weeklyBar: {\n    width: 20,\n    height: 80,\n    backgroundColor: \"#e0e0e0\",\n    borderRadius: 4,\n    justifyContent: \"flex-end\",\n  },\n  weeklyBarFill: {\n    width: \"100%\",\n    backgroundColor: \"#2196f3\",\n    borderRadius: 4,\n    minHeight: 2,\n  },\n  weeklyValue: {\n    fontSize: 10,\n    color: \"#666\",\n    marginTop: 4,\n  },\n  adminInsightCard: {\n    backgroundColor: \"#f3e5f5\",\n    padding: 16,\n    borderRadius: 8,\n    marginBottom: 12,\n    borderLeftWidth: 4,\n    borderLeftColor: \"#9c27b0\",\n  },\n  insightHeader: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: 8,\n  },\n  insightIcon: {\n    fontSize: 20,\n    marginRight: 8,\n  },\n  adminInsightTitle: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    color: \"#333\",\n    flex: 1,\n  },\n  insightDescription: {\n    fontSize: 14,\n    color: \"#555\",\n    lineHeight: 20,\n  },\n  noDataContainer: {\n    backgroundColor: \"#f8f9fa\",\n    padding: 20,\n    borderRadius: 12,\n    alignItems: \"center\",\n    borderWidth: 1,\n    borderColor: \"#e9ecef\",\n    borderStyle: \"dashed\",\n  },\n  noDataText: {\n    fontSize: 16,\n    color: \"#6c757d\",\n    textAlign: \"center\",\n    marginBottom: 8,\n    fontWeight: \"500\",\n  },\n  noDataSubText: {\n    fontSize: 14,\n    color: \"#adb5bd\",\n    textAlign: \"center\",\n    lineHeight: 20,\n  },\n});\n\nexport default PersonalAnalyticsScreen;\n","size_bytes":12391},"src/screens/ProfileEditScreen.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport {\n  View,\n  Text,\n  StyleSheet,\n  TouchableOpacity,\n  TextInput,\n  Alert,\n  KeyboardAvoidingView,\n  Platform,\n  ScrollView,\n} from 'react-native';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport { Ionicons } from '@expo/vector-icons';\nimport { supabase } from '../supabaseClient';\n\ninterface ProfileEditScreenProps {\n  navigation: any;\n}\n\nexport default function ProfileEditScreen({ navigation }: ProfileEditScreenProps) {\n  const [nickname, setNickname] = useState('');\n  const [dream, setDream] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n  const [originalNickname, setOriginalNickname] = useState(''); // ì›ë˜ ë‹‰ë„¤ì„ ì €ì¥\n  const [isCheckingNickname, setIsCheckingNickname] = useState(false);\n  const [nicknameError, setNicknameError] = useState('');\n\n  useEffect(() => {\n    loadProfile();\n  }, []);\n\n  const loadProfile = async () => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (user) {\n        const { data: profileData } = await supabase\n          .from('profiles')\n          .select('*')\n          .eq('id', user.id)\n          .single();\n        \n        if (profileData) {\n          setNickname(profileData.display_name || '');\n          setOriginalNickname(profileData.display_name || ''); // ì›ë˜ ë‹‰ë„¤ì„ ì €ì¥\n          setDream(profileData.dream || '');\n        }\n      }\n    } catch (error) {\n      console.error('í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨:', error);\n      Alert.alert('ì˜¤ë¥˜', 'í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  /* ë‹‰ë„¤ì„ ì¤‘ë³µ ê²€ì‚¬ */\n  const checkNicknameUnique = async (inputNickname: string): Promise<boolean> => {\n    if (!inputNickname.trim()) return false;\n    \n    // ì›ë˜ ë‹‰ë„¤ì„ê³¼ ê°™ìœ¼ë©´ ì¤‘ë³µ ê²€ì‚¬ ìƒëµ\n    if (inputNickname.trim() === originalNickname) return true;\n    \n    setIsCheckingNickname(true);\n    setNicknameError('');\n    \n    try {\n      const { data, error } = await supabase.rpc(\n        'check_display_name_exists',\n        { input_display_name: inputNickname.trim() }\n      );\n\n      if (error) {\n        console.error('ë‹‰ë„¤ì„ ì¤‘ë³µ ê²€ì‚¬ ì˜¤ë¥˜:', error);\n        setNicknameError('ë‹‰ë„¤ì„ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\n        return false;\n      }\n\n      const isDuplicate = data === true;\n      if (isDuplicate) {\n        setNicknameError('ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤');\n        return false;\n      }\n\n      setNicknameError('');\n      return true;\n    } catch (error) {\n      console.error('ë‹‰ë„¤ì„ ê²€ì‚¬ ì˜ˆì™¸:', error);\n      setNicknameError('ë‹‰ë„¤ì„ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤');\n      return false;\n    } finally {\n      setIsCheckingNickname(false);\n    }\n  };\n\n  const handleSave = async () => {\n    if (!nickname.trim()) {\n      Alert.alert('ì•Œë¦¼', 'ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');\n      return;\n    }\n\n    if (!dream.trim()) {\n      Alert.alert('ì•Œë¦¼', 'ê¿ˆì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');\n      return;\n    }\n\n    // ë‹‰ë„¤ì„ì´ ë³€ê²½ëœ ê²½ìš°ì—ë§Œ ì¤‘ë³µ ê²€ì‚¬\n    if (nickname.trim() !== originalNickname) {\n      const isNicknameUnique = await checkNicknameUnique(nickname);\n      if (!isNicknameUnique) {\n        Alert.alert('ë‹‰ë„¤ì„ ì¤‘ë³µ', nicknameError || 'ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');\n        return;\n      }\n    }\n\n    setLoading(true);\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) throw new Error('ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\n\n      const { error } = await supabase\n        .from('profiles')\n        .update({\n          display_name: nickname.trim(),\n          dream: dream.trim(),\n        })\n        .eq('id', user.id);\n\n      if (error) throw error;\n\n      // í”„ë¡œí•„ ìˆ˜ì • í›„ ë‹¤ë¥¸ í™”ë©´ì˜ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ìƒˆë¡œê³ ì¹¨\n      navigation.navigate('SettingsMain', { profileUpdated: true });\n      \n      Alert.alert('ì™„ë£Œ', 'í”„ë¡œí•„ì´ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');\n    } catch (error) {\n      console.error('í”„ë¡œí•„ ìˆ˜ì • ì‹¤íŒ¨:', error);\n      Alert.alert('ì˜¤ë¥˜', 'í”„ë¡œí•„ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCancel = () => {\n    navigation.goBack();\n  };\n\n  if (isLoading) {\n    return (\n      <SafeAreaView style={styles.container}>\n        <View style={styles.loadingContainer}>\n          <Text style={styles.loadingText}>í”„ë¡œí•„ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</Text>\n        </View>\n      </SafeAreaView>\n    );\n  }\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <KeyboardAvoidingView\n        style={styles.keyboardContainer}\n        behavior={Platform.OS === 'ios' ? 'padding' : 'height'}\n      >\n        <ScrollView style={styles.scrollView}>\n          {/* í—¤ë” */}\n          <View style={styles.header}>\n            <TouchableOpacity onPress={handleCancel} style={styles.backButton}>\n              <Ionicons name=\"arrow-back\" size={24} color=\"#333\" />\n            </TouchableOpacity>\n            <Text style={styles.headerTitle}>í”„ë¡œí•„ ìˆ˜ì •</Text>\n            <TouchableOpacity onPress={handleSave} style={styles.saveButton}>\n              <Text style={[styles.saveButtonText, loading && styles.saveButtonDisabled]}>\n                {loading ? 'ì €ì¥ ì¤‘...' : 'ì €ì¥'}\n              </Text>\n            </TouchableOpacity>\n          </View>\n\n        {/* í”„ë¡œí•„ í¼ */}\n        <View style={styles.form}>\n          <View style={styles.inputGroup}>\n            <Text style={styles.label}>ë‹‰ë„¤ì„</Text>\n            <TextInput\n              style={styles.input}\n              value={nickname}\n              onChangeText={setNickname}\n              placeholder=\"ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš” (10ê¸€ì ì´ë‚´)\"\n              maxLength={10}\n              editable={!loading}\n            />\n            <Text style={styles.charCount}>{nickname.length}/10</Text>\n          </View>\n\n          <View style={styles.inputGroup}>\n            <Text style={styles.label}>ê¿ˆ</Text>\n            <TextInput\n              style={[styles.input, styles.dreamInput]}\n              value={dream}\n              onChangeText={setDream}\n              placeholder=\"ê¿ˆì´ë‚˜ ëª©í‘œë¥¼ ìƒì„¸í•˜ê²Œ ì ì–´ì£¼ì„¸ìš”\"\n              multiline\n              numberOfLines={4}\n              maxLength={200}\n              editable={!loading}\n            />\n            <Text style={styles.charCount}>{dream.length}/200</Text>\n          </View>\n\n          <View style={styles.helpText}>\n            <Text style={styles.helpTitle}>ğŸ’¡ ì‘ì„± ê°€ì´ë“œ</Text>\n            <Text style={styles.helpContent}>\n              â€¢ ë‹‰ë„¤ì„ì€ ì»¤ë®¤ë‹ˆí‹°ì—ì„œ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì—ê²Œ ë³´ì—¬ì§‘ë‹ˆë‹¤{'\\n'}\n              â€¢ ê¿ˆì€ ëª©í‘œ ë‹¬ì„±ì˜ ë™ê¸°ë¶€ì—¬ë¡œ í™œìš©ë©ë‹ˆë‹¤{'\\n'}\n              â€¢ ì–¸ì œë“ ì§€ ìˆ˜ì •í•  ìˆ˜ ìˆìœ¼ë‹ˆ í¸í•˜ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”\n            </Text>\n          </View>\n        </View>\n        </ScrollView>\n      </KeyboardAvoidingView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f5f5f5',\n  },\n  keyboardContainer: {\n    flex: 1,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  loadingContainer: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#f5f5f5',\n  },\n  loadingText: {\n    fontSize: 16,\n    color: '#666',\n  },\n  header: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    paddingHorizontal: 20,\n    paddingVertical: 15,\n    backgroundColor: '#fff',\n    borderBottomWidth: 1,\n    borderBottomColor: '#eee',\n    minHeight: 60,\n  },\n  backButton: {\n    padding: 10,\n    margin: -5,\n    borderRadius: 20,\n    minWidth: 44,\n    minHeight: 44,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  headerTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#333',\n  },\n  saveButton: {\n    paddingHorizontal: 15,\n    paddingVertical: 10,\n    backgroundColor: '#007AFF',\n    borderRadius: 8,\n    minWidth: 60,\n    minHeight: 44,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  saveButtonText: {\n    color: '#fff',\n    fontSize: 16,\n    fontWeight: '600',\n  },\n  saveButtonDisabled: {\n    opacity: 0.6,\n  },\n  form: {\n    padding: 20,\n  },\n  inputGroup: {\n    marginBottom: 25,\n  },\n  label: {\n    fontSize: 16,\n    fontWeight: '600',\n    color: '#333',\n    marginBottom: 8,\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: '#ddd',\n    borderRadius: 10,\n    padding: 15,\n    fontSize: 16,\n    backgroundColor: '#fff',\n  },\n  dreamInput: {\n    height: 150,\n    textAlignVertical: 'top',\n  },\n  charCount: {\n    fontSize: 12,\n    color: '#666',\n    textAlign: 'right',\n    marginTop: 5,\n  },\n  helpText: {\n    backgroundColor: '#fff',\n    padding: 20,\n    borderRadius: 10,\n    marginTop: 10,\n  },\n  helpTitle: {\n    fontSize: 16,\n    fontWeight: '600',\n    color: '#333',\n    marginBottom: 10,\n  },\n  helpContent: {\n    fontSize: 14,\n    color: '#666',\n    lineHeight: 20,\n  },\n});","size_bytes":9164},"src/screens/ProfileSetupScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  Alert,\n  Button,\n  SafeAreaView,\n  ScrollView,\n  StyleSheet,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  View,\n} from \"react-native\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Ionicons } from \"@expo/vector-icons\";\nimport { useNavigation } from \"@react-navigation/native\";\nimport useProfileStore from \"../store/profileStore\";\nimport { supabase } from \"../supabaseClient\";\n\n/** ì•½ê´€ í•­ëª© ì •ì˜ */\nconst AGREEMENTS = [\n  { key: \"age14\", label: \"ë§Œ 14ì„¸ ì´ìƒì…ë‹ˆë‹¤. (í•„ìˆ˜)\", required: true },\n  { key: \"tos\", label: \"ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ì— ë™ì˜í•©ë‹ˆë‹¤. (í•„ìˆ˜)\", required: true },\n  {\n    key: \"privacy\",\n    label: \"ê°œì¸ì •ë³´ ìˆ˜ì§‘Â·ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤. (í•„ìˆ˜)\",\n    required: true,\n  },\n  { key: \"marketing\", label: \"ë§ˆì¼€íŒ… ìˆ˜ì‹  ë™ì˜ (ì„ íƒ)\", required: false },\n] as const;\n\ntype AgreeKey = (typeof AGREEMENTS)[number][\"key\"];\n\n// ìœ ì… ê²½ë¡œ ì˜µì…˜ë“¤ (ë¼ë””ì˜¤ ë²„íŠ¼ í˜•ì‹)\nconst REFERRER_OPTIONS = [\n  {\n    id: \"search\",\n    text: \"ê²€ìƒ‰\",\n    subtext: \"(Google, Naver ê²€ìƒ‰ ë“±)\",\n    value: \"search\",\n  },\n  {\n    id: \"sns\",\n    text: \"SNS\",\n    subtext: \"(Instagram, Threads, X ë“±)\",\n    value: \"sns\",\n  },\n  {\n    id: \"community\",\n    text: \"ì»¤ë®¤ë‹ˆí‹°/í¬ëŸ¼\",\n    subtext: \"(ë„¤ì´ë²„ ì¹´í˜&ë¸”ë¡œê·¸ ë“±)\",\n    value: \"community\",\n  },\n  { id: \"referral\", text: \"ì§€ì¸ì¶”ì²œ\", subtext: \"\", value: \"referral\" },\n  {\n    id: \"ai\",\n    text: \"AI ì¶”ì²œ\",\n    subtext: \"(ChatGPT, Perplexity AI ë“±)\",\n    value: \"ai\",\n  },\n  { id: \"other\", text: \"ê·¸ ì™¸\", subtext: \"\", value: \"other\" },\n];\n\nexport default function ProfileSetupScreen({ route }: any) {\n  // useNavigation hook ì‚¬ìš©\n  const navigation = useNavigation() as any;\n  const { saveProfile } = useProfileStore();\n\n  // ì˜¨ë³´ë”© ë°ì´í„° ë°›ì•„ì˜¤ê¸°\n  const onboardingData = route?.params?.onboardingData;\n\n  /* ì…ë ¥ ìƒíƒœ */\n  const [dream, setDream] = useState(\"\");\n  const [nickname, setNickname] = useState(\"\");\n  const [referrer, setReferrer] = useState(\"\"); // ë‹¨ì¼ ì„ íƒ (í•„ìˆ˜)\n  const [agree, setAgree] = useState<Record<AgreeKey, boolean>>(\n    Object.fromEntries(AGREEMENTS.map((a) => [a.key, false])) as Record<\n      AgreeKey,\n      boolean\n    >,\n  );\n  const [allAgree, setAllAgree] = useState(false);\n\n  /* ì›í´ë¦­ ì „ì²´ ë™ì˜ */\n  const handleOneClickAgree = () => {\n    const allRequired = Object.fromEntries(\n      AGREEMENTS.map((a) => [a.key, a.required ? true : agree[a.key]])\n    ) as Record<AgreeKey, boolean>;\n    \n    setAgree(allRequired);\n    setAllAgree(true);\n  };\n\n  /* master ì²´í¬ë°•ìŠ¤ í† ê¸€ */\n  const toggleAll = () => {\n    const next = !allAgree;\n    setAllAgree(next);\n    setAgree(\n      Object.fromEntries(\n        AGREEMENTS.map((a) => [a.key, next || (!a.required && agree[a.key])]),\n      ) as Record<AgreeKey, boolean>,\n    );\n  };\n\n  /* ê°œë³„ ì²´í¬ë°•ìŠ¤ í† ê¸€ */\n  const toggleOne = (k: AgreeKey) => {\n    const next = { ...agree, [k]: !agree[k] };\n    setAgree(next);\n    const requiredAllOn = AGREEMENTS.every((a) =>\n      a.required ? next[a.key] : true,\n    );\n    setAllAgree(requiredAllOn && Object.values(next).every(Boolean));\n  };\n\n  /* ìœ ì… ê²½ë¡œ ë¼ë””ì˜¤ ë²„íŠ¼ ì„ íƒ */\n  const selectReferrer = (value: string) => {\n    setReferrer(value);\n  };\n\n  /* ë‹‰ë„¤ì„ ì¤‘ë³µ ê²€ì‚¬ */\n  const [isCheckingNickname, setIsCheckingNickname] = useState(false);\n  const [nicknameError, setNicknameError] = useState(\"\");\n\n  // ğŸ“› ë‹¨ìˆœí•œ ë‹‰ë„¤ì„ ê²€ì¦ (ê¸¸ì´ì™€ ìš•ì„¤ë§Œ ì²´í¬)\n  const checkNicknameContent = (inputNickname: string): string | null => {\n    const trimmed = inputNickname.trim();\n    \n    // ê¸°ë³¸ ê²€ì¦ë§Œ\n    if (!trimmed) return \"ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”\";\n    if (trimmed.length < 2) return \"ë‹‰ë„¤ì„ì€ ìµœì†Œ 2ê¸€ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤\";\n    if (trimmed.length > 10) return \"ë‹‰ë„¤ì„ì€ ìµœëŒ€ 10ê¸€ìê¹Œì§€ ê°€ëŠ¥í•©ë‹ˆë‹¤\";\n    \n    // ìš•ì„¤/ë¶ˆì¾Œí•œ í‘œí˜„ë§Œ í•„í„°ë§\n    try {\n      const Filter = require('badwords-ko');\n      const filter = new Filter();\n      \n      if (filter.isProfane(trimmed)) {\n        return \"ë¶€ì ì ˆí•œ ë‹¨ì–´ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ë‹‰ë„¤ì„ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”\";\n      }\n    } catch (error) {\n      console.log('ìš•ì„¤ í•„í„° ì˜¤ë¥˜:', error);\n      // í•„í„° ì˜¤ë¥˜ ì‹œì—ë„ ê³„ì† ì§„í–‰\n    }\n    \n    return null; // í†µê³¼\n  };\n\n  const checkNicknameUnique = async (\n    inputNickname: string,\n  ): Promise<boolean> => {\n    if (!inputNickname.trim()) return false;\n\n    setIsCheckingNickname(true);\n    setNicknameError(\"\");\n\n    try {\n      // 1. ì½˜í…ì¸  í•„í„°ë§ ë¨¼ì € ì²´í¬\n      const contentError = checkNicknameContent(inputNickname);\n      if (contentError) {\n        setNicknameError(contentError);\n        return false;\n      }\n\n      // 2. ì¤‘ë³µ ê²€ì‚¬ (RLS ìš°íšŒ í•¨ìˆ˜ ì‚¬ìš©)\n      const { data, error } = await supabase.rpc(\n        'check_display_name_exists',\n        { input_display_name: inputNickname.trim() }\n      );\n\n      if (error) {\n        console.error(\"ë‹‰ë„¤ì„ ì¤‘ë³µ ê²€ì‚¬ ì˜¤ë¥˜:\", error);\n        setNicknameError(\"ë‹‰ë„¤ì„ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤\");\n        return false;\n      }\n\n      const isDuplicate = data === true;\n      if (isDuplicate) {\n        setNicknameError(\"ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤\");\n        return false;\n      }\n\n      setNicknameError(\"\");\n      return true;\n    } catch (error) {\n      console.error(\"ë‹‰ë„¤ì„ ê²€ì‚¬ ì˜ˆì™¸:\", error);\n      setNicknameError(\"ë‹‰ë„¤ì„ í™•ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤\");\n      return false;\n    } finally {\n      setIsCheckingNickname(false);\n    }\n  };\n\n  console.log('ğŸ” ProfileSetupScreen ë Œë”ë§ë¨ - ê²ŒìŠ¤íŠ¸ ëª¨ë“œì—ì„œ ì§„ì…');\n\n  /* ì €ì¥ */\n  const [isSaving, setIsSaving] = useState(false);\n\n  const handleSave = async () => {\n    // í•„ìˆ˜ ì…ë ¥Â·ì•½ê´€ ê²€ì‚¬\n    if (!dream.trim() || !nickname.trim()) {\n      Alert.alert(\"ì…ë ¥ í™•ì¸\", \"í•„ìˆ˜ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ ì£¼ì„¸ìš”.\");\n      return;\n    }\n\n    // ë‹‰ë„¤ì„ ì¤‘ë³µ ê²€ì‚¬\n    const isNicknameUnique = await checkNicknameUnique(nickname);\n    if (!isNicknameUnique) {\n      Alert.alert(\n        \"ë‹‰ë„¤ì„ ì¤‘ë³µ\",\n        nicknameError ||\n          \"ì´ë¯¸ ì‚¬ìš© ì¤‘ì¸ ë‹‰ë„¤ì„ì…ë‹ˆë‹¤. ë‹¤ë¥¸ ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.\",\n      );\n      return;\n    }\n    const unAgreed = AGREEMENTS.filter((a) => a.required && !agree[a.key]);\n    if (unAgreed.length) {\n      Alert.alert(\"ì•½ê´€ ë™ì˜\", \"í•„ìˆ˜ ì•½ê´€ì— ëª¨ë‘ ë™ì˜í•´ ì£¼ì„¸ìš”.\");\n      return;\n    }\n\n    setIsSaving(true);\n    try {\n      // ìœ ì… ê²½ë¡œì™€ í•¨ê»˜ í”„ë¡œí•„ ì €ì¥ (ìœ ì…ê²½ë¡œëŠ” ì„ íƒì‚¬í•­)\n      await saveProfile(nickname.trim(), dream.trim(), referrer || 'direct');\n      \n      console.log(\"ğŸ”˜ í”„ë¡œí•„ ì €ì¥ ì™„ë£Œ - ë©”ì¸ í™”ë©´ìœ¼ë¡œ ì´ë™\");\n      \n      // ğŸ”¥ \"ë‚´ì¼ ìš°ì„ \" ë¡œì§: ì‹ ê·œ ì‚¬ìš©ìëŠ” ì²« ëª©í‘œë¥¼ ë‚´ì¼ ëª©í‘œë¡œ ì‘ì„±\n      // í”„ë¡œí•„ ì„¤ì • ì™„ë£Œ í›„ ìë™ìœ¼ë¡œ MainTabìœ¼ë¡œ ì´ë™ë¨ (App.tsxì—ì„œ ì²˜ë¦¬)\n      console.log(\"âœ… ì‹ ê·œ ì‚¬ìš©ì í”„ë¡œí•„ ì„¤ì • ì™„ë£Œ - ìë™ìœ¼ë¡œ ë©”ì¸ í™”ë©´ ì´ë™\");\n    } catch (e: any) {\n      console.error(\"í”„ë¡œí•„ ì €ì¥ ì‹¤íŒ¨:\", e);\n      Alert.alert(\n        \"ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜\", \n        \"ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•˜ê³  ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\\n\\nì˜¤ë¥˜: \" + (e.message || \"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜\")\n      );\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n\n\n  const renderReferrerRadioButtons = () => {\n    return (\n      <View style={styles.referrerContainer}>\n        {REFERRER_OPTIONS.map((option) => (\n          <TouchableOpacity\n            key={option.id}\n            style={styles.referrerRow}\n            onPress={() => selectReferrer(option.value)}\n          >\n            <View\n              style={[\n                styles.radioButton,\n                referrer === option.value && styles.radioButtonSelected,\n              ]}\n            />\n            <View style={styles.referrerTextContainer}>\n              <Text style={styles.referrerLabel}>\n                {option.text}\n                {option.subtext && (\n                  <Text style={styles.referrerSubtext}> {option.subtext}</Text>\n                )}\n              </Text>\n            </View>\n          </TouchableOpacity>\n        ))}\n      </View>\n    );\n  };\n\n  return (\n    <ScrollView\n      style={{ flex: 1, backgroundColor: \"#ffffff\" }}\n      contentContainerStyle={{\n        padding: 24,\n        paddingBottom: 40,\n        backgroundColor: \"#ffffff\",\n      }}\n      keyboardShouldPersistTaps=\"handled\"\n    >\n      {/* í—¤ë“œë¼ì¸ */}\n      <Text style={styles.head1}>\n        ì§€ê¸ˆ ë°”ë¡œ ì‹œì‘í•˜ê¸° ìœ„í•´{\"\\n\"}\n        <Text style={styles.head2}>\n          ê°„ë‹¨í•œ ì •ë³´ë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”!\n        </Text>\n      </Text>\n\n      {/* ê¿ˆ ì…ë ¥ */}\n      <Text style={styles.label}>ê¿ˆì´ ë¬´ì—‡ì¸ê°€ìš”?</Text>\n      <TextInput\n        value={dream}\n        onChangeText={setDream}\n        placeholder=\"ê¿ˆì˜ í¬ê¸°ë‚˜ ëª¨ì–‘ì€ ìƒê´€ì—†ìŠµë‹ˆë‹¤!\"\n        placeholderTextColor=\"#888\"\n        multiline\n        style={[styles.input, { height: 100, textAlignVertical: \"top\" }]}\n      />\n\n      {/* ë‹‰ë„¤ì„ */}\n      <Text style={styles.label}>ë‹‰ë„¤ì„</Text>\n      <TextInput\n        value={nickname}\n        onChangeText={(t) => {\n          if (t.length <= 10) {\n            setNickname(t);\n            setNicknameError(\"\"); // ì…ë ¥ ì‹œ ì˜¤ë¥˜ ë©”ì‹œì§€ ì´ˆê¸°í™”\n            \n            // ì‹¤ì‹œê°„ ì½˜í…ì¸  í•„í„°ë§\n            const contentError = checkNicknameContent(t);\n            if (contentError && t.trim().length > 0) {\n              setNicknameError(contentError);\n            }\n          }\n        }}\n        placeholder=\"ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (10ê¸€ì ì´ë‚´)\"\n        placeholderTextColor=\"#888\"\n        style={[\n          styles.input,\n          nicknameError ? styles.inputError : null,\n          isCheckingNickname ? styles.inputChecking : null,\n        ]}\n      />\n      {/* ë‹‰ë„¤ì„ ìƒíƒœ í‘œì‹œ */}\n      {isCheckingNickname && (\n        <Text style={styles.checkingText}>ë‹‰ë„¤ì„ ì¤‘ë³µ í™•ì¸ ì¤‘...</Text>\n      )}\n      {nicknameError && <Text style={styles.errorText}>{nicknameError}</Text>}\n\n      {/* ìœ ì… ê²½ë¡œ ë¼ë””ì˜¤ ë²„íŠ¼ */}\n      <Text style={styles.label}>\n        The Better Dayë¥¼ ì–´ë–»ê²Œ ì•Œê²Œ ë˜ì…¨ë‚˜ìš”? (ì„ íƒì‚¬í•­)\n      </Text>\n      {renderReferrerRadioButtons()}\n\n      {/* ë™ì˜ í•­ëª© ì„¹ì…˜ */}\n      <View style={styles.agreementSection}>\n        {/* ì „ì²´ ë™ì˜ */}\n        <TouchableOpacity style={styles.allAgreeRow} onPress={toggleAll}>\n          <View style={styles.checkboxContainer}>\n            <Ionicons\n              name={allAgree ? \"checkmark-circle\" : \"ellipse-outline\"}\n              size={24}\n              color={allAgree ? \"#8b5cf6\" : \"#d1d5db\"}\n            />\n          </View>\n          <Text style={styles.allAgreeText}>ëª¨ë‘ ë™ì˜í•©ë‹ˆë‹¤.</Text>\n        </TouchableOpacity>\n\n        {/* ê°œë³„ ì•½ê´€ */}\n        {AGREEMENTS.map((agreement) => (\n          <TouchableOpacity\n            key={agreement.key}\n            style={styles.agreementRow}\n            onPress={() => toggleOne(agreement.key)}\n          >\n            <View style={styles.checkboxContainer}>\n              <Ionicons\n                name={agree[agreement.key] ? \"checkmark-circle\" : \"ellipse-outline\"}\n                size={20}\n                color={agree[agreement.key] ? \"#8b5cf6\" : \"#d1d5db\"}\n              />\n            </View>\n            <Text style={styles.agreementText}>\n              {agreement.label}\n            </Text>\n          </TouchableOpacity>\n        ))}\n\n\n      </View>\n\n      {/* ë²„íŠ¼ ì˜ì—­ */}\n      <View style={{ marginTop: 24 }}>\n        <TouchableOpacity\n          style={[styles.startButton, (isCheckingNickname || isSaving) && styles.startButtonDisabled]}\n          onPress={handleSave}\n          disabled={isCheckingNickname || isSaving}\n        >\n          <Text style={styles.startButtonText}>\n            {isSaving ? \"ì €ì¥ ì¤‘...\" : isCheckingNickname ? \"ë‹‰ë„¤ì„ í™•ì¸ ì¤‘...\" : \"ì™„ë£Œ\"}\n          </Text>\n        </TouchableOpacity>\n      </View>\n    </ScrollView>\n  );\n}\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ìŠ¤íƒ€ì¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nconst styles = StyleSheet.create({\n  head1: { fontSize: 18, color: \"#888\", marginBottom: 4 },\n  head2: { fontSize: 18, color: \"#0066ff\", fontWeight: \"bold\" },\n\n  label: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    marginTop: 20,\n    marginBottom: 8,\n    color: \"#333\",\n  },\n\n  input: {\n    borderWidth: 1,\n    borderColor: \"#ddd\",\n    borderRadius: 8,\n    paddingHorizontal: 12,\n    paddingVertical: 12,\n    fontSize: 16,\n    backgroundColor: \"#fff\",\n  },\n\n  inputError: {\n    borderColor: \"#ff4444\",\n    borderWidth: 2,\n  },\n\n  inputChecking: {\n    borderColor: \"#ffa500\",\n    borderWidth: 2,\n  },\n\n  errorText: {\n    color: \"#ff4444\",\n    fontSize: 14,\n    marginTop: 4,\n    marginLeft: 4,\n  },\n\n  checkingText: {\n    color: \"#ffa500\",\n    fontSize: 14,\n    marginTop: 4,\n    marginLeft: 4,\n  },\n\n  referrerContainer: {\n    marginTop: 8,\n    marginBottom: 16,\n  },\n\n  referrerRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: 12,\n    paddingVertical: 4,\n  },\n\n  referrerTextContainer: {\n    flex: 1,\n    marginLeft: 12,\n  },\n\n  referrerLabel: {\n    fontSize: 16,\n    color: \"#333\",\n  },\n\n  referrerSubtext: {\n    fontSize: 14,\n    color: \"#999\",\n  },\n\n  allAgree: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginTop: 32,\n    marginBottom: 16,\n    paddingVertical: 8,\n  },\n  allAgreeLabel: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    marginLeft: 8,\n    color: \"#0066ff\",\n  },\n\n  agreeRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    marginBottom: 12,\n    paddingVertical: 4,\n  },\n  agreeLabel: {\n    fontSize: 14,\n    marginLeft: 8,\n    color: \"#666\",\n    flex: 1,\n  },\n  req: { fontWeight: \"bold\", color: \"#333\" },\n\n  checkbox: {\n    width: 20,\n    height: 20,\n    borderWidth: 2,\n    borderColor: \"#ddd\",\n    backgroundColor: \"#fff\",\n  },\n  checked: {\n    backgroundColor: \"#0066ff\",\n    borderColor: \"#0066ff\",\n  },\n\n  radioButton: {\n    width: 20,\n    height: 20,\n    borderRadius: 10,\n    borderWidth: 2,\n    borderColor: \"#ddd\",\n    backgroundColor: \"#fff\",\n  },\n  radioButtonSelected: {\n    backgroundColor: \"#0066ff\",\n    borderColor: \"#0066ff\",\n  },\n\n  // ë™ì˜ ì„¹ì…˜ ì „ì²´ ì»¨í…Œì´ë„ˆ\n  agreementSection: {\n    marginTop: 24,\n    marginBottom: 16,\n    paddingTop: 16,\n    borderTopWidth: 1,\n    borderTopColor: \"#f0f0f0\",\n  },\n\n  // ì „ì²´ ë™ì˜ í–‰\n  allAgreeRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: 12,\n    marginBottom: 12,\n    backgroundColor: \"#f8f9fa\",\n    borderRadius: 8,\n    paddingHorizontal: 12,\n  },\n\n  allAgreeText: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    color: \"#333\",\n    marginLeft: 8,\n  },\n\n  // ê°œë³„ ë™ì˜ í–‰\n  agreementRow: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: 8,\n    paddingHorizontal: 12,\n    marginBottom: 8,\n  },\n\n  agreementText: {\n    fontSize: 14,\n    color: \"#666\",\n    marginLeft: 8,\n    flex: 1,\n    lineHeight: 20,\n  },\n\n  // ì²´í¬ë°•ìŠ¤ ì»¨í…Œì´ë„ˆ\n  checkboxContainer: {\n    width: 24,\n    height: 24,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n\n  // ì›í´ë¦­ ì „ì²´ ë™ì˜ ë²„íŠ¼\n  oneClickAgreeButton: {\n    backgroundColor: \"#4CAF50\",\n    paddingVertical: 12,\n    paddingHorizontal: 20,\n    borderRadius: 25,\n    marginTop: 20,\n    marginBottom: 10,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5,\n  },\n  oneClickAgreeText: {\n    color: \"#fff\",\n    fontSize: 16,\n    fontWeight: \"bold\",\n    textAlign: \"center\",\n  },\n\n  // ì‹œì‘ ë²„íŠ¼\n  startButton: {\n    backgroundColor: \"#2196F3\",\n    paddingVertical: 16,\n    paddingHorizontal: 24,\n    borderRadius: 12,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5,\n  },\n  startButtonDisabled: {\n    backgroundColor: \"#ccc\",\n    elevation: 0,\n    shadowOpacity: 0,\n  },\n  startButtonText: {\n    color: \"#fff\",\n    fontSize: 18,\n    fontWeight: \"bold\",\n    textAlign: \"center\",\n  },\n\n  tutorialButton: {\n    backgroundColor: \"#f0f9ff\",\n    borderWidth: 1,\n    borderColor: \"#8B5CF6\",\n    borderRadius: 8,\n    paddingVertical: 12,\n    paddingHorizontal: 16,\n    alignItems: \"center\",\n    marginBottom: 12,\n  },\n\n  tutorialButtonText: {\n    color: \"#8B5CF6\",\n    fontSize: 16,\n    fontWeight: \"500\",\n  },\n});\n","size_bytes":16668},"src/screens/RetrospectScreen.tsx":{"content":"// src/screens/RetrospectScreen.tsx\nimport React, { useLayoutEffect, useState } from \"react\";\nimport {\n  Alert,\n  Keyboard,\n  Text,\n  TextInput,\n  View,\n  StyleSheet,\n  ScrollView,\n} from \"react-native\";\nimport useRetrospectStore from \"../store/retrospectStore\";\nimport useGoalStore from \"../store/goalStore\";\nimport { format } from \"date-fns\";\n\nexport default function RetrospectScreen({ navigation }: any) {\n  const [txt, setTxt] = useState(\"\");\n  const save = useRetrospectStore((s) => s.saveRetrospect);\n  const { getTodaySummary, goals } = useGoalStore();\n\n  const { allDone, hasFailure } = getTodaySummary();\n\n  // ì˜¤ëŠ˜ì˜ ì‹¤íŒ¨í•œ ëª©í‘œë“¤ ê°€ì ¸ì˜¤ê¸°\n  const today = new Date();\n  const todayStr = format(today, \"yyyy-MM-dd\");\n  const failedGoals = goals.filter((goal) => {\n    const goalDate = format(new Date(goal.target_time), \"yyyy-MM-dd\");\n    return goalDate === todayStr && goal.status === \"failure\";\n  });\n\n  const motivationalMessage = hasFailure\n    ? \"ì‹¤íŒ¨ëŠ” ì„±ê³µì˜ ì–´ë¨¸ë‹ˆì…ë‹ˆë‹¤. ë‚´ì¼ì€ ë” ë‚˜ì€ í•˜ë£¨ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”! ğŸ’ª\"\n    : \"ëª¨ë“  ëª©í‘œë¥¼ ë‹¬ì„±í•˜ì…¨êµ°ìš”! ì •ë§ ëŒ€ë‹¨í•©ë‹ˆë‹¤! ğŸ‰\";\n\n  /* ì €ì¥ */\n  const onSave = async () => {\n    const body = txt.trim();\n    if (!body) return Alert.alert(\"ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”\");\n    try {\n      await save(body);\n      Alert.alert(\"ì €ì¥ ì™„ë£Œ\", \"ì˜¤ëŠ˜ì˜ íšŒê³ ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë‚´ì¼ë„ í™”ì´íŒ…!\");\n      navigation.goBack();\n    } catch (e: any) {\n      Alert.alert(\"ì—ëŸ¬\", e.message);\n    }\n  };\n\n  /* í—¤ë” ë²„íŠ¼ */\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      headerRight: () => (\n        <Text\n          style={{ marginRight: 12, color: \"#007AFF\", fontSize: 16 }}\n          onPress={onSave}\n        >\n          ì €ì¥\n        </Text>\n      ),\n    });\n  }, [navigation, txt]);\n\n  return (\n    <ScrollView style={styles.container}>\n      {/* ì™„ì „ ìŠ¹ë¦¬ ì‹œ íŠ¹ë³„ ë©”ì‹œì§€ */}\n      {allDone && !hasFailure && (\n        <View style={styles.victoryBox}>\n          <Text style={styles.victoryTitle}>ğŸ‰ ì™„ì „ ìŠ¹ë¦¬! ğŸ‰</Text>\n          <Text style={styles.victoryMessage}>\n            ì˜¤ëŠ˜ ëª¨ë“  ëª©í‘œë¥¼ ë‹¬ì„±í•˜ì…¨ìŠµë‹ˆë‹¤! {\"\\n\"} ì •ë§ ëŒ€ë‹¨í•œ ì„±ì·¨ì…ë‹ˆë‹¤.\n          </Text>\n        </View>\n      )}\n\n      {/* íŒ¨ë°°í•œ ëª©í‘œ ëª©ë¡ */}\n      {failedGoals.length > 0 && (\n        <View style={styles.failedGoalsBox}>\n          <Text style={styles.failedGoalsTitle}>âš ï¸ íŒ¨ë°°í•œ ëª©í‘œë“¤</Text>\n          {failedGoals.map((goal) => (\n            <View key={goal.id} style={styles.failedGoalItem}>\n              <Text style={styles.failedGoalTime}>\n                {format(new Date(goal.target_time), \"HH:mm\")}\n              </Text>\n              <Text style={styles.failedGoalTitle}>{goal.title}</Text>\n            </View>\n          ))}\n          <Text style={styles.failedGoalsNote}>\n            íŒ¨ë°°ëŠ” ê·¸ì € ìŠ¹ë¦¬ì˜ ë°œíŒì…ë‹ˆë‹¤!\n          </Text>\n        </View>\n      )}\n\n      <View style={styles.motivationBox}>\n        <Text style={styles.motivationText}>{motivationalMessage}</Text>\n      </View>\n\n      <View style={styles.inputContainer}>\n        <Text style={styles.inputLabel}>ì˜¤ëŠ˜ì˜ íšŒê³ </Text>\n        <TextInput\n          style={styles.textInput}\n          placeholder=\"ì˜¤ëŠ˜ í•˜ë£¨ ì–´ë• ë‚˜ìš”? ë¶€ë‹´ì—†ì´ ì´ì•¼ê¸°í•´ë³´ì„¸ìš”!\"\n          placeholderTextColor=\"rgba(235, 181, 181, 0.7)\"\n          multiline\n          value={txt}\n          onChangeText={setTxt}\n          returnKeyType=\"done\"\n          onSubmitEditing={Keyboard.dismiss}\n        />\n      </View>\n    </ScrollView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 16,\n    backgroundColor: \"#f8f9fa\",\n  },\n\n  // ì™„ì „ ìŠ¹ë¦¬ ìŠ¤íƒ€ì¼\n  victoryBox: {\n    backgroundColor: \"#fff5e6\",\n    padding: 20,\n    borderRadius: 12,\n    marginBottom: 20,\n    borderWidth: 2,\n    borderColor: \"#ffd700\",\n    alignItems: \"center\",\n  },\n  victoryTitle: {\n    fontSize: 20,\n    fontWeight: \"bold\",\n    color: \"#e67e22\",\n    marginBottom: 8,\n  },\n  victoryMessage: {\n    fontSize: 16,\n    color: \"#d35400\",\n    textAlign: \"center\",\n    lineHeight: 24,\n  },\n\n  // íŒ¨ë°°í•œ ëª©í‘œ ìŠ¤íƒ€ì¼\n  failedGoalsBox: {\n    backgroundColor: \"#fff5f5\",\n    padding: 16,\n    borderRadius: 12,\n    marginBottom: 20,\n    borderLeftWidth: 4,\n    borderLeftColor: \"#e74c3c\",\n  },\n  failedGoalsTitle: {\n    fontSize: 16,\n    fontWeight: \"bold\",\n    color: \"#c0392b\",\n    marginBottom: 12,\n  },\n  failedGoalItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: 8,\n    paddingHorizontal: 12,\n    backgroundColor: \"#fff\",\n    borderRadius: 8,\n    marginBottom: 8,\n  },\n  failedGoalTime: {\n    fontSize: 14,\n    color: \"#7f8c8d\",\n    marginRight: 12,\n    minWidth: 50,\n  },\n  failedGoalTitle: {\n    flex: 1,\n    fontSize: 14,\n    color: \"#2c3e50\",\n  },\n  failedGoalsNote: {\n    fontSize: 12,\n    color: \"#7f8c8d\",\n    fontStyle: \"italic\",\n    marginTop: 8,\n    textAlign: \"center\",\n  },\n\n  motivationBox: {\n    backgroundColor: \"#fff\",\n    padding: 16,\n    borderRadius: 12,\n    marginBottom: 20,\n    borderLeftWidth: 4,\n    borderLeftColor: \"#667eea\",\n  },\n  motivationText: {\n    fontSize: 16,\n    color: \"#333\",\n    lineHeight: 24,\n    textAlign: \"center\",\n  },\n  inputContainer: {\n    backgroundColor: \"#fff\",\n    borderRadius: 12,\n    padding: 16,\n    minHeight: 200,\n  },\n  inputLabel: {\n    fontSize: 18,\n    fontWeight: \"600\",\n    color: \"#333\",\n    marginBottom: 12,\n  },\n  textInput: {\n    fontSize: 16,\n    textAlignVertical: \"top\",\n    lineHeight: 24,\n    color: \"#333\",\n    minHeight: 150,\n  },\n});\n","size_bytes":5618},"src/screens/RetrospectScreen_Old.tsx":{"content":"// src/screens/RetrospectScreen.tsx\r\nimport React, { useLayoutEffect, useState } from 'react';\r\nimport { Alert, Keyboard, Text, TextInput, View, StyleSheet } from 'react-native';\r\nimport useRetrospectStore from '../store/retrospectStore';\nimport useGoalStore from '../store/goalStore';\r\n\r\nexport default function RetrospectScreen({ navigation }: any) {\r\n  const [txt, setTxt] = useState('');\r\n  const save = useRetrospectStore(s => s.saveRetrospect);\n  const { getTodaySummary } = useGoalStore();\n  \n  const { allDone, hasFailure } = getTodaySummary();\n  const motivationalMessage = hasFailure \n    ? \"ì‹¤íŒ¨ëŠ” ì„±ê³µì˜ ì–´ë¨¸ë‹ˆì…ë‹ˆë‹¤. ë‚´ì¼ì€ ë” ë‚˜ì€ í•˜ë£¨ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”! ğŸ’ª\"\n    : \"ëª¨ë“  ëª©í‘œë¥¼ ë‹¬ì„±í•˜ì…¨êµ°ìš”! ì •ë§ ëŒ€ë‹¨í•©ë‹ˆë‹¤! ğŸ‰\";\r\n\r\n  /* ì €ì¥ */\r\n  const onSave = async () => {\r\n    const body = txt.trim();\r\n    if (!body) return Alert.alert('ë‚´ìš©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”');\r\n    try {\r\n      await save(body);\r\n      Alert.alert('ì €ì¥ ì™„ë£Œ');\r\n      navigation.goBack();\r\n    } catch (e:any) {\r\n      Alert.alert('ì—ëŸ¬', e.message);\r\n    }\r\n  };\r\n\r\n  /* í—¤ë” ë²„íŠ¼ */\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: () => (\r\n        <Text style={{ marginRight:12, color:'#007AFF', fontSize:16 }}\r\n              onPress={onSave}>\r\n          ì €ì¥\r\n        </Text>\r\n      ),\r\n    });\r\n  }, [navigation, txt]);\r\n\r\n  return (\r\n    <View style={{ flex:1, padding:16 }}>\r\n      <TextInput\r\n        style={{ flex:1, borderWidth:1, padding:8, textAlignVertical:'top' }}\r\n        placeholder=\"ì˜¤ëŠ˜ ëª©í‘œ íšŒê³ ë¥¼ ì‘ì„±í•´ ë³´ì„¸ìš”\"\r\n        multiline\r\n        value={txt}\r\n        onChangeText={setTxt}\r\n        returnKeyType=\"done\"\r\n        onSubmitEditing={Keyboard.dismiss}\r\n      />\r\n    </View>\r\n  );\r\n}\r\n","size_bytes":1794},"src/screens/SettingsScreen.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Switch,\n  Alert,\n  SafeAreaView,\n  Animated,\n  Image,\n  Modal,\n} from \"react-native\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport { supabase } from \"../supabaseClient\";\nimport { useAuthStore } from \"../store/authStore\";\nimport useUserStore from \"../store/userStore\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport useGoalStore from \"../store/goalStore\";\nimport useRetrospectStore from \"../store/retrospectStore\";\nimport useCommunityStore from \"../store/communityStore\";\nimport { useFlexibleGoalStore } from \"../store/flexibleGoalStore\";\nimport { SUPPORTED_TIMEZONES, getCurrentTimeZone, setCurrentTimeZone } from \"../utils/timeUtils\";\n\ninterface SettingsScreenProps {\n  navigation: any;\n}\n\nexport default function SettingsScreen({ navigation }: SettingsScreenProps) {\n  const { isAutoLoginEnabled, enableAutoLogin, disableAutoLogin } =\n    useAuthStore();\n  const { signOut } = useUserStore();\n\n  // ë°ì´í„° ìŠ¤í† ì–´ë“¤\n  const { clearAllGoals } = useGoalStore();\n  const { clearAllRetrospects } = useRetrospectStore();\n  const { clearAllResolutions } = useCommunityStore();\n  const { clearAllFlexibleGoals } = useFlexibleGoalStore();\n  const [profile, setProfile] = useState<any>(null);\n  const [isGuestUser, setIsGuestUser] = useState(false);\n  const [notifications, setNotifications] = useState({\n    goalAlarms: true,\n    retrospectReminders: true,\n    enhancedAlerts: true, // ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ì„ ê¸°ë³¸ìœ¼ë¡œ í™œì„±í™”\n    soundEnabled: true,\n    vibrationEnabled: true,\n  });\n  const [currentTimeZone, setCurrentTimeZoneState] = useState('Asia/Seoul');\n  const [showTimeZonePicker, setShowTimeZonePicker] = useState(false);\n  const [showSoundModeModal, setShowSoundModeModal] = useState(false);\n\n  useEffect(() => {\n    loadProfile();\n    loadNotificationSettings();\n    loadTimeZoneSettings();\n  }, []);\n\n  // í”„ë¡œí•„ ì—…ë°ì´íŠ¸ í›„ ìƒˆë¡œê³ ì¹¨\n  useEffect(() => {\n    const unsubscribe = navigation.addListener(\"focus\", () => {\n      loadProfile();\n    });\n    return unsubscribe;\n  }, [navigation]);\n\n  const loadProfile = async () => {\n    try {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      \n      console.log('ğŸ” SettingsScreen - ì‚¬ìš©ì ì •ë³´:', {\n        user: user ? {\n          id: user.id,\n          is_anonymous: user.is_anonymous,\n          email: user.email\n        } : null\n      });\n      \n      if (user && !user.is_anonymous) {\n        // ì •ì‹ ì‚¬ìš©ì (Supabase ê³„ì •)\n        console.log('âœ… ì •ì‹ ì‚¬ìš©ì ê°ì§€ - DBì—ì„œ í”„ë¡œí•„ ë¡œë“œ');\n        const { data } = await supabase\n          .from(\"profiles\")\n          .select(\"*\")\n          .eq(\"id\", user.id)\n          .single();\n        setProfile(data);\n        setIsGuestUser(false);\n      } else {\n        // ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ì (ìµëª… ì‚¬ìš©ì)\n        console.log('ğŸ­ ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ì ê°ì§€ - ë¡œì»¬ í”„ë¡œí•„ ë¡œë“œ');\n        const guestProfile = await AsyncStorage.getItem(\"guestProfile\");\n        if (guestProfile) {\n          setProfile(JSON.parse(guestProfile));\n          setIsGuestUser(true);\n        } else {\n          console.log('âš ï¸ ê²ŒìŠ¤íŠ¸ í”„ë¡œí•„ì´ ì—†ìŒ');\n          setIsGuestUser(true); // ê²ŒìŠ¤íŠ¸ë¡œ ì²˜ë¦¬\n        }\n      }\n      \n      console.log('ğŸ” SettingsScreen - ìµœì¢… ìƒíƒœ:', {\n        isGuestUser: user?.is_anonymous !== false\n      });\n    } catch (error) {\n      console.error(\"í”„ë¡œí•„ ë¡œë“œ ì‹¤íŒ¨:\", error);\n    }\n  };\n\n  const loadNotificationSettings = async () => {\n    try {\n      const settingsString = await AsyncStorage.getItem(\"notificationSettings\");\n      if (settingsString) {\n        const settings = JSON.parse(settingsString);\n        setNotifications(settings);\n      }\n    } catch (error) {\n      console.error(\"ì•Œë¦¼ ì„¤ì • ë¡œë“œ ì‹¤íŒ¨:\", error);\n    }\n  };\n\n  const saveNotificationSettings = async (newSettings: any) => {\n    try {\n      await AsyncStorage.setItem(\n        \"notificationSettings\",\n        JSON.stringify(newSettings),\n      );\n      setNotifications(newSettings);\n      console.log(\"âœ… ì•Œë¦¼ ì„¤ì • ì €ì¥ë¨:\", newSettings);\n    } catch (error) {\n      console.error(\"ì•Œë¦¼ ì„¤ì • ì €ì¥ ì‹¤íŒ¨:\", error);\n    }\n  };\n\n  // ì‚¬ìš´ë“œ ëª¨ë“œ ì„¤ëª… í…ìŠ¤íŠ¸\n  const getSoundModeDescription = () => {\n    if (notifications.soundEnabled && notifications.vibrationEnabled) {\n      return \"ì†Œë¦¬ + ì§„ë™\";\n    } else if (notifications.soundEnabled && !notifications.vibrationEnabled) {\n      return \"ì†Œë¦¬ë§Œ\";\n    } else if (!notifications.soundEnabled && notifications.vibrationEnabled) {\n      return \"ì§„ë™ë§Œ\";\n    } else {\n      return \"ë¬´ìŒ\";\n    }\n  };\n\n  // ì‚¬ìš´ë“œ ëª¨ë“œ ì•„ì´ì½˜\n  const getSoundModeIcon = () => {\n    if (notifications.soundEnabled && notifications.vibrationEnabled) {\n      return \"notifications\";\n    } else if (notifications.soundEnabled && !notifications.vibrationEnabled) {\n      return \"volume-high\";\n    } else if (!notifications.soundEnabled && notifications.vibrationEnabled) {\n      return \"phone-portrait\";\n    } else {\n      return \"volume-mute\";\n    }\n  };\n\n  // ì‚¬ìš´ë“œ ëª¨ë“œ ë³€ê²½\n  const changeSoundMode = (mode: string) => {\n    let newSettings = { ...notifications };\n    \n    switch (mode) {\n      case 'sound_vibration':\n        newSettings.soundEnabled = true;\n        newSettings.vibrationEnabled = true;\n        break;\n      case 'sound_only':\n        newSettings.soundEnabled = true;\n        newSettings.vibrationEnabled = false;\n        break;\n      case 'vibration_only':\n        newSettings.soundEnabled = false;\n        newSettings.vibrationEnabled = true;\n        break;\n      case 'silent':\n        newSettings.soundEnabled = false;\n        newSettings.vibrationEnabled = false;\n        break;\n    }\n    \n    saveNotificationSettings(newSettings);\n    setShowSoundModeModal(false);\n  };\n\n  // ì‹œê°„ëŒ€ ì„¤ì • ë¡œë“œ\n  const loadTimeZoneSettings = async () => {\n    try {\n      const timeZone = await getCurrentTimeZone();\n      setCurrentTimeZoneState(timeZone);\n    } catch (error) {\n      console.error(\"ì‹œê°„ëŒ€ ì„¤ì • ë¡œë“œ ì‹¤íŒ¨:\", error);\n    }\n  };\n\n  // ì‹œê°„ëŒ€ ë³€ê²½\n  const handleTimeZoneChange = async (timeZone: string) => {\n    try {\n      await setCurrentTimeZone(timeZone);\n      setCurrentTimeZoneState(timeZone);\n      setShowTimeZonePicker(false);\n      Alert.alert(\"ì„¤ì • ì™„ë£Œ\", `ì‹œê°„ëŒ€ê°€ ${SUPPORTED_TIMEZONES[timeZone as keyof typeof SUPPORTED_TIMEZONES].name}ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`);\n    } catch (error) {\n      console.error(\"ì‹œê°„ëŒ€ ì„¤ì • ì‹¤íŒ¨:\", error);\n      Alert.alert(\"ì˜¤ë¥˜\", \"ì‹œê°„ëŒ€ ì„¤ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n    }\n  };\n\n  const handleLogout = async () => {\n    Alert.alert(\"ë¡œê·¸ì•„ì›ƒ\", \"ì •ë§ë¡œ ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\", [\n      { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n      {\n        text: \"ë¡œê·¸ì•„ì›ƒ\",\n        style: \"destructive\",\n        onPress: async () => {\n          try {\n            await disableAutoLogin();\n            await signOut();\n            // signOut í•¨ìˆ˜ê°€ sessionì„ nullë¡œ ì„¤ì •í•˜ë¯€ë¡œ \n            // App.tsxì˜ ì¡°ê±´ë¶€ ë Œë”ë§ì— ì˜í•´ ìë™ìœ¼ë¡œ AuthStackì´ í‘œì‹œë©ë‹ˆë‹¤\n          } catch (error) {\n            console.error(\"ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:\", error);\n            Alert.alert(\"ì˜¤ë¥˜\", \"ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n          }\n        },\n      },\n    ]);\n  };\n\n  const handleDeleteAccount = async () => {\n    navigation.navigate('AccountDeletionSurvey');\n  };\n\n  // ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”\n  const handleFullDataReset = async () => {\n    Alert.alert(\n      \"âš ï¸ ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”\",\n      \"ì§€ê¸ˆê¹Œì§€ ì‘ì„±í•˜ì‹  ëª¨ë“  ëª©í‘œ, íšŒê³ , ë‹¤ì§ ë“±ì˜ ë°ì´í„°ê°€ ì™„ì „íˆ ì‚­ì œë©ë‹ˆë‹¤.\\n\\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\nì •ë§ë¡œ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\",\n      [\n        { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n        {\n          text: \"í™•ì¸\",\n          style: \"destructive\",\n          onPress: () => {\n            Alert.alert(\n              \"ìµœì¢… í™•ì¸\",\n              \"ë§ˆì§€ë§‰ í•œ ë²ˆ ë” í™•ì¸í•˜ê² ìŠµë‹ˆë‹¤.\\n\\n ëª¨ë“  í™œë™ ê¸°ë¡ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\",\n              [\n                { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n                {\n                  text: \"ì‚­ì œ\",\n                  style: \"destructive\",\n                  onPress: performFullDataReset,\n                },\n              ],\n            );\n          },\n        },\n      ],\n    );\n  };\n\n  const performFullDataReset = async () => {\n    try {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n\n      if (user) {\n        // ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš©ì ë°ì´í„° ì‚­ì œ\n        await Promise.all([\n          supabase.from(\"goals\").delete().eq(\"user_id\", user.id),\n          supabase.from(\"retrospects\").delete().eq(\"user_id\", user.id),\n          supabase.from(\"daily_resolutions\").delete().eq(\"user_id\", user.id),\n          supabase.from(\"flexible_goals\").delete().eq(\"user_id\", user.id),\n        ]);\n      } else {\n        // ê²ŒìŠ¤íŠ¸ ëª¨ë“œì˜ ê²½ìš° AsyncStorage ì‚­ì œ\n        const keysToRemove = [\n          \"guestGoals\",\n          \"guestRetrospects\",\n          \"guestDailyResolutions\",\n          \"guestFlexibleGoals\",\n          \"streakBadgeCategory\",\n        ];\n        await AsyncStorage.multiRemove(keysToRemove);\n      }\n\n      // ë¡œì»¬ ìŠ¤í† ì–´ ì´ˆê¸°í™”\n      clearAllGoals?.();\n      clearAllRetrospects?.();\n      await clearAllResolutions?.();\n      clearAllFlexibleGoals?.();\n\n      Alert.alert(\n        \"ì™„ë£Œ\",\n        \"ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.\\nìƒˆë¡œìš´ ì‹œì‘ì„ ì‘ì›í•©ë‹ˆë‹¤!\",\n      );\n    } catch (error) {\n      console.error(\"ë°ì´í„° ì´ˆê¸°í™” ì‹¤íŒ¨:\", error);\n      Alert.alert(\"ì˜¤ë¥˜\", \"ë°ì´í„° ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n    }\n  };\n\n  // ì„ íƒì  ë°ì´í„° ì‚­ì œ\n  const handleSelectiveDataDelete = () => {\n    Alert.alert(\"ë°ì´í„° ê´€ë¦¬\", \"ì–´ë–¤ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\", [\n      { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n      { text: \"ëª©í‘œ ë°ì´í„°ë§Œ\", onPress: () => deleteGoalsOnly() },\n      { text: \"íšŒê³  ë°ì´í„°ë§Œ\", onPress: () => deleteRetrospectsOnly() },\n      { text: \"ìµœê·¼ 30ì¼ ë°ì´í„°\", onPress: () => deleteRecentData() },\n    ]);\n  };\n\n  const deleteGoalsOnly = async () => {\n    Alert.alert(\"ëª©í‘œ ë°ì´í„° ì‚­ì œ\", \"ëª¨ë“  ëª©í‘œ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\", [\n      { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n      {\n        text: \"ì‚­ì œ\",\n        style: \"destructive\",\n        onPress: async () => {\n          try {\n            const {\n              data: { user },\n            } = await supabase.auth.getUser();\n            if (user) {\n              await Promise.all([\n                supabase.from(\"goals\").delete().eq(\"user_id\", user.id),\n                supabase.from(\"flexible_goals\").delete().eq(\"user_id\", user.id),\n              ]);\n            }\n            clearAllGoals?.();\n            clearAllFlexibleGoals?.();\n            Alert.alert(\"ì™„ë£Œ\", \"ëª©í‘œ ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\");\n          } catch (error) {\n            Alert.alert(\"ì˜¤ë¥˜\", \"ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n          }\n        },\n      },\n    ]);\n  };\n\n  const deleteRetrospectsOnly = async () => {\n    Alert.alert(\"íšŒê³  ë°ì´í„° ì‚­ì œ\", \"ëª¨ë“  íšŒê³  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\", [\n      { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n      {\n        text: \"ì‚­ì œ\",\n        style: \"destructive\",\n        onPress: async () => {\n          try {\n            const {\n              data: { user },\n            } = await supabase.auth.getUser();\n            if (user) {\n              await supabase\n                .from(\"retrospects\")\n                .delete()\n                .eq(\"user_id\", user.id);\n            }\n            clearAllRetrospects?.();\n            Alert.alert(\"ì™„ë£Œ\", \"íšŒê³  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\");\n          } catch (error) {\n            Alert.alert(\"ì˜¤ë¥˜\", \"ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n          }\n        },\n      },\n    ]);\n  };\n\n  const deleteRecentData = async () => {\n    Alert.alert(\n      \"ìµœê·¼ 30ì¼ ë°ì´í„° ì‚­ì œ\",\n      \"ìµœê·¼ 30ì¼ê°„ì˜ ëª¨ë“  í™œë™ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\",\n      [\n        { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n        {\n          text: \"ì‚­ì œ\",\n          style: \"destructive\",\n          onPress: async () => {\n            try {\n              const thirtyDaysAgo = new Date();\n              thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n              const cutoffDate = thirtyDaysAgo.toISOString();\n\n              const {\n                data: { user },\n              } = await supabase.auth.getUser();\n              if (user) {\n                await Promise.all([\n                  supabase\n                    .from(\"goals\")\n                    .delete()\n                    .eq(\"user_id\", user.id)\n                    .gte(\"created_at\", cutoffDate),\n                  supabase\n                    .from(\"retrospects\")\n                    .delete()\n                    .eq(\"user_id\", user.id)\n                    .gte(\"created_at\", cutoffDate),\n                  supabase\n                    .from(\"daily_resolutions\")\n                    .delete()\n                    .eq(\"user_id\", user.id)\n                    .gte(\"created_at\", cutoffDate),\n                  supabase\n                    .from(\"flexible_goals\")\n                    .delete()\n                    .eq(\"user_id\", user.id)\n                    .gte(\"created_at\", cutoffDate),\n                ]);\n              }\n\n              Alert.alert(\"ì™„ë£Œ\", \"ìµœê·¼ 30ì¼ ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\");\n            } catch (error) {\n              Alert.alert(\"ì˜¤ë¥˜\", \"ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\");\n            }\n          },\n        },\n      ],\n    );\n  };\n\n  const showTermsOfService = () => {\n    navigation.navigate(\"WebView\", {\n      url: \"https://www.notion.so/2418f860031d80789588dac58ad3d624\",\n      title: \"ì´ìš©ì•½ê´€\",\n    });\n  };\n\n  const showPrivacyPolicy = () => {\n    navigation.navigate(\"WebView\", {\n      url: \"https://www.notion.so/2418f860031d8006b232f13ed101cc77\",\n      title: \"ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨\",\n    });\n  };\n\n  // ì»¤ìŠ¤í…€ ìŠ¤ìœ„ì¹˜ ì»´í¬ë„ŒíŠ¸\n  const CustomSwitch = ({\n    value,\n    onValueChange,\n  }: {\n    value: boolean;\n    onValueChange: (value: boolean) => void;\n  }) => {\n    const [animatedValue] = useState(new Animated.Value(value ? 1 : 0));\n\n    React.useEffect(() => {\n      Animated.timing(animatedValue, {\n        toValue: value ? 1 : 0,\n        duration: 200,\n        useNativeDriver: false,\n      }).start();\n    }, [value, animatedValue]);\n\n    const interpolateBackgroundColor = animatedValue.interpolate({\n      inputRange: [0, 1],\n      outputRange: [\"#d1d1d6\", \"#34c759\"],\n    });\n\n    const interpolateTranslateX = animatedValue.interpolate({\n      inputRange: [0, 1],\n      outputRange: [2, 22],\n    });\n\n    return (\n      <TouchableOpacity\n        activeOpacity={0.8}\n        onPress={() => onValueChange(!value)}\n        style={styles.switchContainer}\n      >\n        <Animated.View\n          style={[\n            styles.switchTrack,\n            { backgroundColor: interpolateBackgroundColor },\n          ]}\n        >\n          <Animated.View\n            style={[\n              styles.switchThumb,\n              { transform: [{ translateX: interpolateTranslateX }] },\n            ]}\n          />\n        </Animated.View>\n      </TouchableOpacity>\n    );\n  };\n\n  const SettingItem = ({\n    title,\n    subtitle,\n    icon,\n    onPress,\n    rightComponent,\n    showArrow = true,\n  }: {\n    title: string;\n    subtitle?: string;\n    icon: string;\n    onPress?: () => void;\n    rightComponent?: React.ReactNode;\n    showArrow?: boolean;\n  }) => (\n    <TouchableOpacity\n      style={styles.settingItem}\n      onPress={onPress}\n      disabled={!onPress}\n    >\n      <View style={styles.settingLeft}>\n        <Ionicons name={icon as any} size={24} color=\"#666\" />\n        <View style={styles.settingText}>\n          <Text style={styles.settingTitle}>{title}</Text>\n          {subtitle && <Text style={styles.settingSubtitle}>{subtitle}</Text>}\n        </View>\n      </View>\n      <View style={styles.settingRight}>\n        {rightComponent}\n        {showArrow && onPress && (\n          <Ionicons name=\"chevron-forward\" size={20} color=\"#ccc\" />\n        )}\n      </View>\n    </TouchableOpacity>\n  );\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <ScrollView style={styles.scrollView}>\n        <View style={styles.header}>\n          <Text style={styles.headerTitle}>ì„¤ì •</Text>\n        </View>\n\n        {/* ê³„ì • ì •ë³´ */}\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>ê³„ì •</Text>\n          <SettingItem\n            title={profile?.display_name || \"ì‚¬ìš©ì\"}\n            subtitle={profile?.dream || \"ê¿ˆì„ ì„¤ì •í•´ë³´ì„¸ìš”\"}\n            icon=\"person\"\n            onPress={() => navigation.navigate(\"ProfileEdit\")}\n          />\n        </View>\n\n        {/* ì‹œê°„ëŒ€ ì„¤ì • */}\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>ì‹œê°„ëŒ€</Text>\n          <SettingItem\n            title=\"í˜„ì¬ ì‹œê°„ëŒ€\"\n            subtitle={SUPPORTED_TIMEZONES[currentTimeZone as keyof typeof SUPPORTED_TIMEZONES]?.name || currentTimeZone}\n            icon=\"time\"\n            onPress={() => setShowTimeZonePicker(true)}\n          />\n        </View>\n\n        {/* ì•Œë¦¼ ì„¤ì • */}\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>ì•Œë¦¼</Text>\n          \n          {/* í†µí•© ì•Œë¦¼ ì„¤ì • */}\n          <SettingItem\n            title=\"ëª©í‘œ ë° íšŒê³  ì•Œë¦¼\"\n            subtitle=\"ëª©í‘œ ì‹œê°„ê³¼ íšŒê³  ì‘ì„± ì•Œë¦¼ í™œì„±í™”\"\n            icon=\"notifications\"\n            showArrow={false}\n            rightComponent={\n              <CustomSwitch\n                value={notifications.goalAlarms && notifications.retrospectReminders}\n                onValueChange={(value) =>\n                  saveNotificationSettings({\n                    ...notifications,\n                    goalAlarms: value,\n                    retrospectReminders: value,\n                    enhancedAlerts: value, // ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ì„ ê¸°ë³¸ìœ¼ë¡œ í™œì„±í™”\n                  })\n                }\n              />\n            }\n          />\n          \n          {/* ì•Œë¦¼ ì‚¬ìš´ë“œ ëª¨ë“œ ì„ íƒ */}\n          {(notifications.goalAlarms || notifications.retrospectReminders) && (\n            <SettingItem\n              title=\"ì•Œë¦¼ ì‚¬ìš´ë“œ ëª¨ë“œ\"\n              subtitle={getSoundModeDescription()}\n              icon={getSoundModeIcon()}\n              onPress={() => setShowSoundModeModal(true)}\n            />\n          )}\n          \n          <View style={styles.subsectionDivider} />\n          {__DEV__ && (\n            <SettingItem\n              title=\"ì•Œë¦¼ í…ŒìŠ¤íŠ¸\"\n              subtitle=\"ì•Œë¦¼ ì‹œìŠ¤í…œ ì‘ë™ í™•ì¸ (ê°œë°œì ì „ìš©)\"\n              icon=\"flask\"\n              onPress={async () => {\n                try {\n                  // dynamic import ì œê±°í•˜ê³  ì¼ë°˜ import ì‚¬ìš©\n                  alert('ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');\n                } catch (error) {\n                  alert('ì•Œë¦¼ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: ' + String(error));\n                }\n              }}\n            />\n          )}\n        </View>\n\n        {/* ë°ì´í„° ê´€ë¦¬ */}\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>ë°ì´í„°</Text>\n          <SettingItem\n            title=\"ì„ íƒì  ë°ì´í„° ì‚­ì œ\"\n            subtitle=\"ëª©í‘œ, íšŒê³ , ìµœê·¼ 30ì¼ ë°ì´í„° ì„ íƒ ì‚­ì œ\"\n            icon=\"trash-outline\"\n            onPress={handleSelectiveDataDelete}\n          />\n          <SettingItem\n            title=\"ì „ì²´ ë°ì´í„° ì´ˆê¸°í™”\"\n            subtitle=\"ëª¨ë“  í™œë™ ê¸°ë¡ì„ ì™„ì „íˆ ì‚­ì œ\"\n            icon=\"nuclear-outline\"\n            onPress={handleFullDataReset}\n          />\n        </View>\n\n        {/* ì •ë³´ ë° ì§€ì› */}\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>ì •ë³´ ë° ì§€ì›</Text>\n          <SettingItem\n            title=\"ì•± ë²„ì „\"\n            subtitle=\"v1.0.0\"\n            icon=\"information-circle\"\n            showArrow={false}\n          />\n          <SettingItem\n            title=\"ì´ìš©ì•½ê´€\"\n            icon=\"document-text\"\n            onPress={() => showTermsOfService()}\n          />\n          <SettingItem\n            title=\"ê°œì¸ì •ë³´ ë³´í˜¸ì •ì±…\"\n            icon=\"shield-checkmark\"\n            onPress={() => showPrivacyPolicy()}\n          />\n        </View>\n\n        {/* ê³„ì • ê´€ë¦¬ - ê²ŒìŠ¤íŠ¸ê°€ ì•„ë‹Œ ê²½ìš°ì—ë§Œ í‘œì‹œ */}\n        {!isGuestUser && (\n          <View style={styles.section}>\n            <Text style={styles.sectionTitle}>ê³„ì • ê´€ë¦¬</Text>\n            <SettingItem\n              title=\"ë¡œê·¸ì•„ì›ƒ\"\n              icon=\"log-out\"\n              onPress={handleLogout}\n            />\n            <SettingItem\n              title=\"ê³„ì • ì‚­ì œ\"\n              icon=\"trash\"\n              onPress={handleDeleteAccount}\n            />\n          </View>\n        )}\n\n        {/* ê²ŒìŠ¤íŠ¸ ì „ìš© ì„¹ì…˜ */}\n        {isGuestUser && (\n          <View style={styles.section}>\n            <Text style={styles.sectionTitle}>ê²ŒìŠ¤íŠ¸ ëª¨ë“œ</Text>\n            <SettingItem\n              title=\"ì •ì‹ íšŒì›ê°€ì…\"\n              subtitle=\"ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë©´ì„œ íšŒì›ê°€ì…í•˜ê¸°\"\n              icon=\"person-add\"\n              onPress={() => {\n                Alert.alert(\n                  \"ì •ì‹ íšŒì›ê°€ì…\",\n                  \"ê²ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë©´ì„œ ì •ì‹ íšŒì›ìœ¼ë¡œ ì „í™˜í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\",\n                  [\n                    { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n                    {\n                      text: \"íšŒì›ê°€ì…\",\n                      onPress: async () => {\n                        try {\n                          await signOut();\n                        } catch (error) {\n                          console.error(\"ë¡œê·¸ì•„ì›ƒ ì˜¤ë¥˜:\", error);\n                        }\n                      },\n                    },\n                  ],\n                );\n              }}\n            />\n\n          </View>\n        )}\n\n        <View style={styles.footer}>\n          <Image\n            source={require(\"../../assets/images/app-logo.png\")}\n            style={styles.footerLogo}\n            resizeMode=\"contain\"\n          />\n          <Text style={styles.footerSubtext}>í–‰ë³µí•  ìš°ë¦¬ì˜ ê·¸ë‚ ì„ ìœ„í•´</Text>\n        </View>\n      </ScrollView>\n\n      {/* ì‹œê°„ëŒ€ ì„ íƒ ëª¨ë‹¬ */}\n      <Modal\n        visible={showTimeZonePicker}\n        transparent={true}\n        animationType=\"slide\"\n        onRequestClose={() => setShowTimeZonePicker(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <Text style={styles.modalTitle}>ì‹œê°„ëŒ€ ì„ íƒ</Text>\n              <TouchableOpacity\n                onPress={() => setShowTimeZonePicker(false)}\n                style={styles.modalCloseButton}\n              >\n                <Ionicons name=\"close\" size={24} color=\"#666\" />\n              </TouchableOpacity>\n            </View>\n            <ScrollView style={styles.timeZoneList}>\n              {Object.entries(SUPPORTED_TIMEZONES).map(([timeZone, info]) => (\n                <TouchableOpacity\n                  key={timeZone}\n                  style={[\n                    styles.timeZoneItem,\n                    currentTimeZone === timeZone && styles.selectedTimeZone,\n                  ]}\n                  onPress={() => handleTimeZoneChange(timeZone)}\n                >\n                  <View>\n                    <Text style={[\n                      styles.timeZoneName,\n                      currentTimeZone === timeZone && styles.selectedText,\n                    ]}>\n                      {info.name}\n                    </Text>\n                    <Text style={[\n                      styles.timeZoneOffset,\n                      currentTimeZone === timeZone && styles.selectedText,\n                    ]}>\n                      UTC {info.offset}\n                    </Text>\n                  </View>\n                  {currentTimeZone === timeZone && (\n                    <Ionicons name=\"checkmark\" size={20} color=\"#007AFF\" />\n                  )}\n                </TouchableOpacity>\n              ))}\n            </ScrollView>\n          </View>\n        </View>\n      </Modal>\n\n      {/* ì‚¬ìš´ë“œ ëª¨ë“œ ì„ íƒ ëª¨ë‹¬ */}\n      <Modal\n        visible={showSoundModeModal}\n        transparent={true}\n        animationType=\"slide\"\n        onRequestClose={() => setShowSoundModeModal(false)}\n      >\n        <View style={styles.modalOverlay}>\n          <View style={styles.modalContent}>\n            <View style={styles.modalHeader}>\n              <Text style={styles.modalTitle}>ì•Œë¦¼ ì‚¬ìš´ë“œ ëª¨ë“œ</Text>\n              <TouchableOpacity\n                style={styles.modalCloseButton}\n                onPress={() => setShowSoundModeModal(false)}\n              >\n                <Ionicons name=\"close\" size={24} color=\"#666\" />\n              </TouchableOpacity>\n            </View>\n            <View style={styles.soundModeList}>\n              <TouchableOpacity\n                style={[\n                  styles.soundModeItem,\n                  notifications.soundEnabled && notifications.vibrationEnabled && styles.selectedSoundMode,\n                ]}\n                onPress={() => changeSoundMode('sound_vibration')}\n              >\n                <Ionicons name=\"notifications\" size={24} color=\"#7B68EE\" />\n                <View style={styles.soundModeText}>\n                  <Text style={styles.soundModeTitle}>ì†Œë¦¬ + ì§„ë™</Text>\n                  <Text style={styles.soundModeDescription}>ì•Œë¦¼ìŒê³¼ ì§„ë™ì„ ëª¨ë‘ ì‚¬ìš©</Text>\n                </View>\n                {notifications.soundEnabled && notifications.vibrationEnabled && (\n                  <Ionicons name=\"checkmark\" size={20} color=\"#7B68EE\" />\n                )}\n              </TouchableOpacity>\n\n              <TouchableOpacity\n                style={[\n                  styles.soundModeItem,\n                  notifications.soundEnabled && !notifications.vibrationEnabled && styles.selectedSoundMode,\n                ]}\n                onPress={() => changeSoundMode('sound_only')}\n              >\n                <Ionicons name=\"volume-high\" size={24} color=\"#4ECDC4\" />\n                <View style={styles.soundModeText}>\n                  <Text style={styles.soundModeTitle}>ì†Œë¦¬ë§Œ</Text>\n                  <Text style={styles.soundModeDescription}>ì•Œë¦¼ìŒë§Œ ì‚¬ìš©, ì§„ë™ ì—†ìŒ</Text>\n                </View>\n                {notifications.soundEnabled && !notifications.vibrationEnabled && (\n                  <Ionicons name=\"checkmark\" size={20} color=\"#7B68EE\" />\n                )}\n              </TouchableOpacity>\n\n              <TouchableOpacity\n                style={[\n                  styles.soundModeItem,\n                  !notifications.soundEnabled && notifications.vibrationEnabled && styles.selectedSoundMode,\n                ]}\n                onPress={() => changeSoundMode('vibration_only')}\n              >\n                <Ionicons name=\"phone-portrait\" size={24} color=\"#FF9500\" />\n                <View style={styles.soundModeText}>\n                  <Text style={styles.soundModeTitle}>ì§„ë™ë§Œ</Text>\n                  <Text style={styles.soundModeDescription}>ì§„ë™ë§Œ ì‚¬ìš©, ì†Œë¦¬ ì—†ìŒ</Text>\n                </View>\n                {!notifications.soundEnabled && notifications.vibrationEnabled && (\n                  <Ionicons name=\"checkmark\" size={20} color=\"#7B68EE\" />\n                )}\n              </TouchableOpacity>\n\n              <TouchableOpacity\n                style={[\n                  styles.soundModeItem,\n                  !notifications.soundEnabled && !notifications.vibrationEnabled && styles.selectedSoundMode,\n                ]}\n                onPress={() => changeSoundMode('silent')}\n              >\n                <Ionicons name=\"volume-mute\" size={24} color=\"#999\" />\n                <View style={styles.soundModeText}>\n                  <Text style={styles.soundModeTitle}>ë¬´ìŒ</Text>\n                  <Text style={styles.soundModeDescription}>ì†Œë¦¬ì™€ ì§„ë™ì„ ëª¨ë‘ ë¹„í™œì„±í™”</Text>\n                </View>\n                {!notifications.soundEnabled && !notifications.vibrationEnabled && (\n                  <Ionicons name=\"checkmark\" size={20} color=\"#7B68EE\" />\n                )}\n              </TouchableOpacity>\n            </View>\n          </View>\n        </View>\n      </Modal>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#f5f5f5\",\n  },\n  scrollView: {\n    flex: 1,\n  },\n  header: {\n    backgroundColor: \"#fff\",\n    padding: 20,\n    paddingTop: 20,\n    borderBottomWidth: 1,\n    borderBottomColor: \"#eee\",\n  },\n  headerTitle: {\n    fontSize: 24,\n    fontWeight: \"bold\",\n    color: \"#333\",\n  },\n  section: {\n    backgroundColor: \"#fff\",\n    marginTop: 20,\n    paddingVertical: 10,\n  },\n  sectionTitle: {\n    fontSize: 16,\n    fontWeight: \"600\",\n    color: \"#666\",\n    paddingHorizontal: 20,\n    paddingBottom: 10,\n    borderBottomWidth: 1,\n    borderBottomColor: \"#f0f0f0\",\n    marginBottom: 5,\n  },\n  settingItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    paddingVertical: 15,\n    paddingHorizontal: 20,\n    borderBottomWidth: 1,\n    borderBottomColor: \"#f5f5f5\",\n  },\n  settingLeft: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    flex: 1,\n  },\n  settingText: {\n    marginLeft: 15,\n    flex: 1,\n  },\n  settingTitle: {\n    fontSize: 16,\n    color: \"#333\",\n    fontWeight: \"500\",\n  },\n  settingSubtitle: {\n    fontSize: 14,\n    color: \"#666\",\n    marginTop: 2,\n  },\n  settingRight: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n  },\n  footer: {\n    alignItems: \"center\",\n    padding: 5,\n    marginBottom: 10,\n  },\n  footerLogo: {\n    width: 120,\n    height: 60,\n    marginBottom: 8,\n  },\n  footerSubtext: {\n    fontSize: 14,\n    color: \"#666\",\n    marginTop: 0,\n  },\n  switchContainer: {\n    width: 44,\n    height: 26,\n    justifyContent: \"center\",\n  },\n  switchTrack: {\n    width: 44,\n    height: 26,\n    borderRadius: 13,\n    justifyContent: \"center\",\n  },\n  switchThumb: {\n    width: 22,\n    height: 22,\n    borderRadius: 11,\n    backgroundColor: \"#ffffff\",\n    shadowColor: \"#000\",\n    shadowOffset: {\n      width: 0,\n      height: 2,\n    },\n    shadowOpacity: 0.25,\n    shadowRadius: 3.84,\n    elevation: 5,\n  },\n  // ëª¨ë‹¬ ìŠ¤íƒ€ì¼\n  modalOverlay: {\n    flex: 1,\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\n    justifyContent: 'flex-end',\n  },\n  modalContent: {\n    backgroundColor: '#fff',\n    borderTopLeftRadius: 20,\n    borderTopRightRadius: 20,\n    maxHeight: '80%',\n  },\n  modalHeader: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    padding: 20,\n    borderBottomWidth: 1,\n    borderBottomColor: '#eee',\n  },\n  modalTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#333',\n  },\n  modalCloseButton: {\n    padding: 4,\n  },\n  timeZoneList: {\n    maxHeight: 400,\n  },\n  timeZoneItem: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#f5f5f5',\n  },\n  selectedTimeZone: {\n    backgroundColor: '#f0f8ff',\n  },\n  timeZoneName: {\n    fontSize: 16,\n    fontWeight: '500',\n    color: '#333',\n  },\n  timeZoneOffset: {\n    fontSize: 14,\n    color: '#666',\n    marginTop: 2,\n  },\n  selectedText: {\n    color: '#007AFF',\n  },\n  subsectionDivider: {\n    height: 1,\n    backgroundColor: '#F0F0F0',\n    marginVertical: 12,\n    marginHorizontal: 16,\n  },\n  // ì‚¬ìš´ë“œ ëª¨ë“œ ëª¨ë‹¬ ìŠ¤íƒ€ì¼\n  soundModeList: {\n    paddingVertical: 10,\n  },\n  soundModeItem: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    padding: 16,\n    borderBottomWidth: 1,\n    borderBottomColor: '#f5f5f5',\n  },\n  selectedSoundMode: {\n    backgroundColor: '#f0f8ff',\n  },\n  soundModeText: {\n    flex: 1,\n    marginLeft: 16,\n  },\n  soundModeTitle: {\n    fontSize: 16,\n    fontWeight: '500',\n    color: '#333',\n  },\n  soundModeDescription: {\n    fontSize: 14,\n    color: '#666',\n    marginTop: 2,\n  },\n});\n","size_bytes":32554},"src/screens/SignInScreen.tsx":{"content":"import React, { useState } from 'react';\r\nimport { Alert, Button, Text, TextInput, View } from 'react-native';\r\nimport useUserStore from '../store/userStore'; // ë‹¤ì‹œ ì¶”ê°€\r\n\r\nexport default function SignInScreen({ navigation }: any) {\r\n  const signIn = useUserStore((s) => s.signIn);\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n\r\n  const handleSignIn = async () => {\r\n    try {\r\n      await signIn(email, password);\r\n      // ë¡œê·¸ì¸ ì„±ê³µ í›„ App.tsxì—ì„œ ìë™ìœ¼ë¡œ MainTabìœ¼ë¡œ ì „í™˜\n      // navigation.replace ì œê±°\r\n    } catch (error: any) {\r\n      Alert.alert('ë¡œê·¸ì¸ ì˜¤ë¥˜', error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={{ padding: 16 }}>\r\n      <Text>ë¡œê·¸ì¸</Text>\r\n      <TextInput placeholder=\"ì´ë©”ì¼\" value={email} onChangeText={setEmail} autoCapitalize=\"none\" style={{ borderBottomWidth: 1, marginBottom: 12 }} />\r\n      <TextInput placeholder=\"ë¹„ë°€ë²ˆí˜¸\" secureTextEntry value={password} onChangeText={setPassword} style={{ borderBottomWidth: 1, marginBottom: 12 }} />\r\n      <Button title=\"ë¡œê·¸ì¸\" onPress={handleSignIn} />\r\n      <Button title=\"íšŒì›ê°€ì…ìœ¼ë¡œ ì´ë™\" onPress={() => navigation.navigate('SignUp')} />\r\n    </View>\r\n  );\r\n}\r\n","size_bytes":1254},"src/screens/SignUpScreen.tsx":{"content":"import React, { useState } from 'react';\r\nimport { Alert, Button, Text, TextInput, View } from 'react-native';\r\nimport useUserStore from '../store/userStore';\r\n\r\nexport default function SignUpScreen({ navigation }: any) {\r\n  const signUp = useUserStore((s) => s.signUp);\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n\r\n  const handleSignUp = async () => {\r\n    try {\r\n      await signUp(email, password);\r\n      Alert.alert('ê°€ì… ì™„ë£Œ', 'ê°€ì…í•œ ì´ë©”ì¼ë¡œ í™•ì¸ ë©”ì¼ì´ ë°œì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ í™•ì¸í•œ í›„ ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.');\r\n      navigation.replace('SignIn');\r\n    } catch (error: any) {\r\n      Alert.alert('íšŒì›ê°€ì… ì˜¤ë¥˜', error.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={{ padding: 16 }}>\r\n      <Text>íšŒì›ê°€ì…</Text>\r\n      <TextInput placeholder=\"ì´ë©”ì¼\" value={email} onChangeText={setEmail} autoCapitalize=\"none\" style={{ borderBottomWidth: 1, marginBottom: 12 }} />\r\n      <TextInput placeholder=\"ë¹„ë°€ë²ˆí˜¸\" secureTextEntry value={password} onChangeText={setPassword} style={{ borderBottomWidth: 1, marginBottom: 12 }} />\r\n      <Button title=\"íšŒì›ê°€ì…\" onPress={handleSignUp} />\r\n      <Button title=\"ë¡œê·¸ì¸ìœ¼ë¡œ ì´ë™\" onPress={() => navigation.navigate('SignIn')} />\r\n    </View>\r\n  );\r\n}\r\n","size_bytes":1320},"src/screens/StatisticsScreen.tsx":{"content":"// src/screens/StatisticsScreen.tsx\nimport React, { useEffect, useState } from 'react';\nimport {\n  ActivityIndicator,\n  ScrollView,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  View,\n} from 'react-native';\nimport { supabase } from '../supabaseClient';\nimport useGoalStore from '../store/goalStore';\nimport { useAnalyticsStore } from '../store/analyticsStore';\nimport { useMotivationMessageStore } from '../store/motivationMessageStore';\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ íƒ€ì… ì •ì˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\ninterface StatisticsData {\n  totalGoals: number;\n  successCount: number;\n  defeatCount: number;\n  successRate: number;\n  daysSinceStart: number;\n  streakCurrent: number;\n  streakBest: number;\n  bestHour: number;\n  worstHour: number;\n  dailyAverage: number;\n}\n\ninterface DailyStat {\n  date: string;\n  total: number;\n  success_cnt: number;\n  defeat_cnt: number;\n  rate: number;\n}\n\ntype PeriodType = 'daily' | 'weekly' | 'biweekly' | 'monthly' | 'all';\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nconst formatHour = (hour: number): string => {\n  if (hour === 0) return 'ìì •';\n  if (hour < 12) return `ì˜¤ì „ ${hour}ì‹œ`;\n  if (hour === 12) return 'ì •ì˜¤';\n  return `ì˜¤í›„ ${hour - 12}ì‹œ`;\n};\n\nconst getDaysAgo = (days: number): string => {\n  const date = new Date();\n  date.setDate(date.getDate() - days);\n  return date.toISOString().slice(0, 10);\n};\n\nconst getAvailablePeriods = (daysSinceStart: number): PeriodType[] => {\n  const periods: PeriodType[] = [];\n  \n  if (daysSinceStart >= 1) periods.push('daily');\n  if (daysSinceStart >= 7) periods.push('weekly');\n  if (daysSinceStart >= 14) periods.push('biweekly');\n  if (daysSinceStart >= 30) periods.push('monthly');\n  periods.push('all');\n  \n  return periods;\n};\n\nconst getPeriodLabel = (period: PeriodType): string => {\n  switch (period) {\n    case 'daily': return 'ì˜¤ëŠ˜';\n    case 'weekly': return '1ì£¼ì¼';\n    case 'biweekly': return '2ì£¼ê°„';\n    case 'monthly': return '1ê°œì›”';\n    case 'all': return 'ì „ì²´';\n  }\n};\n\nconst getPeriodDays = (period: PeriodType): number => {\n  switch (period) {\n    case 'daily': return 1;\n    case 'weekly': return 7;\n    case 'biweekly': return 14;\n    case 'monthly': return 30;\n    case 'all': return 365; // ì¶©ë¶„íˆ í° ê°’\n  }\n};\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë©”ì¸ ì»´í¬ë„ŒíŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nexport default function StatisticsScreen() {\n  const { goals } = useGoalStore();\n  const { adminInsights, fetchAdminInsights } = useAnalyticsStore();\n  const { currentMessage, fetchMessages, getTodaysMotivationMessage } = useMotivationMessageStore();\n  const [data, setData] = useState<StatisticsData | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [selectedPeriod, setSelectedPeriod] = useState<PeriodType>('biweekly');\n  const [availablePeriods, setAvailablePeriods] = useState<PeriodType[]>([]);\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë°ì´í„° ë¡œë”© â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n  useEffect(() => {\n    fetchStatistics();\n    fetchAdminInsights();\n    fetchMessages();\n    getTodaysMotivationMessage();\n  }, [selectedPeriod]);\n\n  const fetchStatistics = async () => {\n    try {\n      setLoading(true);\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) return;\n\n      // ì‚¬ìš©ìì˜ ì²« ëª©í‘œ ì„¤ì •ì¼ ì¡°íšŒ\n      const { data: firstGoal } = await supabase\n        .from('goals')\n        .select('target_time')\n        .eq('user_id', user.id)\n        .order('target_time', { ascending: true })\n        .limit(1)\n        .single();\n\n      if (!firstGoal) {\n        setData({\n          totalGoals: 0,\n          successCount: 0,\n          defeatCount: 0,\n          successRate: 0,\n          daysSinceStart: 0,\n          streakCurrent: 0,\n          streakBest: 0,\n          bestHour: 9,\n          worstHour: 18,\n          dailyAverage: 0,\n        });\n        setLoading(false);\n        return;\n      }\n\n      const startDate = new Date(firstGoal.target_time);\n      const today = new Date();\n      const daysSinceStart = Math.floor((today.getTime() - startDate.getTime()) / (1000 * 60 * 60 * 24));\n\n      // ì‚¬ìš© ê¸°ê°„ì— ë”°ë¥¸ ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ê°„ ì„¤ì •\n      const periods = getAvailablePeriods(daysSinceStart);\n      setAvailablePeriods(periods);\n\n      // ì„ íƒëœ ê¸°ê°„ì´ ì‚¬ìš© ë¶ˆê°€ëŠ¥í•˜ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ ë³€ê²½\n      if (!periods.includes(selectedPeriod)) {\n        const defaultPeriod = periods.includes('biweekly') ? 'biweekly' : \n                             periods.includes('weekly') ? 'weekly' : \n                             periods[periods.length - 1];\n        setSelectedPeriod(defaultPeriod);\n        return;\n      }\n\n      // ê¸°ê°„ë³„ í†µê³„ ë°ì´í„° ì¡°íšŒ\n      const periodDays = getPeriodDays(selectedPeriod);\n      const startDateStr = selectedPeriod === 'all' ? \n        firstGoal.target_time.slice(0, 10) : \n        getDaysAgo(periodDays - 1);\n\n      const { data: stats } = await supabase\n        .from('daily_stats')\n        .select('*')\n        .eq('user_id', user.id)\n        .gte('date', startDateStr)\n        .order('date', { ascending: true });\n\n      const dailyStats: DailyStat[] = stats || [];\n\n      // í†µê³„ ê³„ì‚°\n      const totalGoals = dailyStats.reduce((sum, d) => sum + (d.total || 0), 0);\n      const successCount = dailyStats.reduce((sum, d) => sum + (d.success_cnt || 0), 0);\n      const defeatCount = dailyStats.reduce((sum, d) => sum + (d.defeat_cnt || 0), 0);\n      const successRate = totalGoals > 0 ? Math.round((successCount / totalGoals) * 100) : 0;\n\n      // ì—°ì† ë‹¬ì„± ê³„ì‚°\n      const { streakCurrent, streakBest } = calculateStreaks(dailyStats);\n\n      // ì‹œê°„ëŒ€ë³„ ì„±ê³¼ ë¶„ì„\n      const { bestHour, worstHour } = await analyzeHourlyPerformance(user.id, startDateStr);\n\n      // ì¼í‰ê·  ëª©í‘œ ê°œìˆ˜\n      const dailyAverage = dailyStats.length > 0 ? Math.round(totalGoals / dailyStats.length) : 0;\n\n      setData({\n        totalGoals,\n        successCount,\n        defeatCount,\n        successRate,\n        daysSinceStart,\n        streakCurrent,\n        streakBest,\n        bestHour,\n        worstHour,\n        dailyAverage,\n      });\n    } catch (error) {\n      console.error('í†µê³„ ì¡°íšŒ ì˜¤ë¥˜:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì—°ì† ë‹¬ì„± ê³„ì‚° â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n  const calculateStreaks = (dailyStats: DailyStat[]): { streakCurrent: number; streakBest: number } => {\n    let streakCurrent = 0;\n    let streakBest = 0;\n    let currentStreak = 0;\n\n    // ìµœê·¼ ë‚ ì§œë¶€í„° ì—­ìˆœìœ¼ë¡œ í™•ì¸\n    const sortedStats = [...dailyStats].reverse();\n    \n    for (let i = 0; i < sortedStats.length; i++) {\n      const stat = sortedStats[i];\n      if (stat.rate >= 80) { // 80% ì´ìƒ ë‹¬ì„± ì‹œ ì—°ì† ê¸°ë¡\n        currentStreak++;\n        if (i === 0) streakCurrent = currentStreak; // ê°€ì¥ ìµœê·¼ë¶€í„° ì‹œì‘í•˜ëŠ” ì—°ì† ê¸°ë¡\n      } else {\n        streakBest = Math.max(streakBest, currentStreak);\n        currentStreak = 0;\n      }\n    }\n    \n    streakBest = Math.max(streakBest, currentStreak);\n    \n    return { streakCurrent, streakBest };\n  };\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ì‹œê°„ëŒ€ë³„ ì„±ê³¼ ë¶„ì„ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n  const analyzeHourlyPerformance = async (userId: string, startDate: string) => {\n    const { data: goalData } = await supabase\n      .from('goals')\n      .select('target_time, status')\n      .eq('user_id', userId)\n      .gte('target_time', startDate + 'T00:00:00.000Z');\n\n    if (!goalData || goalData.length === 0) {\n      return { bestHour: 9, worstHour: 18 };\n    }\n\n    const hourlyStats: { [hour: number]: { total: number; success: number } } = {};\n\n    goalData.forEach(goal => {\n      const hour = new Date(goal.target_time).getHours();\n      if (!hourlyStats[hour]) {\n        hourlyStats[hour] = { total: 0, success: 0 };\n      }\n      hourlyStats[hour].total++;\n      if (goal.status === 'success') {\n        hourlyStats[hour].success++;\n      }\n    });\n\n    let bestHour = 9;\n    let worstHour = 18;\n    let bestRate = 0;\n    let worstRate = 100;\n\n    Object.keys(hourlyStats).forEach(hourStr => {\n      const hour = parseInt(hourStr);\n      const stats = hourlyStats[hour];\n      if (stats.total >= 3) { // ìµœì†Œ 3ê°œ ì´ìƒì˜ ìƒ˜í”Œì´ ìˆì„ ë•Œë§Œ ë¶„ì„\n        const rate = (stats.success / stats.total) * 100;\n        if (rate > bestRate) {\n          bestRate = rate;\n          bestHour = hour;\n        }\n        if (rate < worstRate) {\n          worstRate = rate;\n          worstHour = hour;\n        }\n      }\n    });\n\n    return { bestHour, worstHour };\n  };\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë™ê¸°ë¶€ì—¬ ë©”ì‹œì§€ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n  const getLocalMotivationMessage = (): string => {\n    if (!data) return '';\n    \n    if (data.daysSinceStart < 7) {\n      return \"ì¢‹ì€ ì‹œì‘ì´ì—ìš”! ê¾¸ì¤€íˆ í•´ë´ìš”!\";\n    } else if (data.daysSinceStart < 14) {\n      return `${data.successRate}% ë‹¬ì„±! ì¼ì£¼ì¼ì§¸ ì˜í•˜ê³  ìˆì–´ìš”!`;\n    } else {\n      if (data.successRate >= 80) {\n        return `${data.successRate}% ë‹¬ì„±! ì •ë§ ì˜í•˜ê³  ìˆì–´ìš”!`;\n      } else if (data.successRate >= 60) {\n        return `${data.successRate}% ë‹¬ì„±! ì¡°ê¸ˆë§Œ ë” í˜ë‚´ì„¸ìš”!`;\n      } else {\n        return \"ì‹¤íŒ¨ë„ ì„±ì¥ì˜ ê³¼ì •ì´ì—ìš”. ì²œì²œíˆ ê°œì„ í•´ë´ìš”!\";\n      }\n    }\n  };\n\n  const getInsightIcon = (type: string): string => {\n    switch (type) {\n      case 'pattern': return 'ğŸ“Š';\n      case 'tip': return 'ğŸ’¡';\n      case 'stats': return 'ğŸ“ˆ';\n      default: return 'âœ¨';\n    }\n  };\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ë Œë”ë§ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n  if (loading) {\n    return (\n      <View style={styles.center}>\n        <ActivityIndicator size=\"large\" color=\"#4CAF50\" />\n        <Text style={styles.loadingText}>í†µê³„ë¥¼ ë¶„ì„í•˜ê³  ìˆì–´ìš”...</Text>\n      </View>\n    );\n  }\n\n  if (!data) {\n    return (\n      <View style={styles.center}>\n        <Text style={styles.emptyTitle}>ì•„ì§ ë°ì´í„°ê°€ ì—†ì–´ìš”</Text>\n        <Text style={styles.emptyMessage}>ëª©í‘œë¥¼ ì„¤ì •í•˜ê³  ë‹¬ì„±í•´ë³´ì„¸ìš”!</Text>\n      </View>\n    );\n  }\n\n  return (\n    <ScrollView style={styles.container} contentContainerStyle={styles.contentContainer}>\n      {/* í—¤ë” */}\n      <View style={styles.header}>\n        <Text style={styles.title}>ğŸ“Š ë‚˜ì˜ ì„±ì¥ ë¶„ì„</Text>\n        <Text style={styles.subtitle}>ì‹œì‘í•œì§€ {data.daysSinceStart}ì¼ì§¸</Text>\n      </View>\n\n      {/* ê¸°ê°„ ì„ íƒ ë²„íŠ¼ */}\n      <View style={styles.periodContainer}>\n        {availablePeriods.map(period => (\n          <TouchableOpacity\n            key={period}\n            style={[\n              styles.periodButton,\n              selectedPeriod === period && styles.periodButtonActive\n            ]}\n            onPress={() => setSelectedPeriod(period)}\n          >\n            <Text style={[\n              styles.periodButtonText,\n              selectedPeriod === period && styles.periodButtonTextActive\n            ]}>\n              {getPeriodLabel(period)}\n            </Text>\n          </TouchableOpacity>\n        ))}\n      </View>\n\n      {/* ì£¼ìš” í†µê³„ */}\n      <View style={styles.statsContainer}>\n        <View style={styles.statCard}>\n          <Text style={styles.statNumber}>{data.totalGoals}</Text>\n          <Text style={styles.statLabel}>ì´ ëª©í‘œ</Text>\n        </View>\n        <View style={styles.statCard}>\n          <Text style={[styles.statNumber, { color: '#4CAF50' }]}>{data.successCount}</Text>\n          <Text style={styles.statLabel}>ì„±ê³µ</Text>\n        </View>\n        <View style={styles.statCard}>\n          <Text style={[styles.statNumber, { color: '#F44336' }]}>{data.defeatCount}</Text>\n          <Text style={styles.statLabel}>íŒ¨ë°°</Text>\n        </View>\n        <View style={styles.statCard}>\n          <Text style={[styles.statNumber, { color: '#2196F3' }]}>{data.successRate}%</Text>\n          <Text style={styles.statLabel}>ì„±ê³µë¥ </Text>\n        </View>\n      </View>\n\n      {/* ì—°ì† ë‹¬ì„± ê¸°ë¡ */}\n      <View style={styles.card}>\n        <Text style={styles.cardTitle}>ğŸ”¥ ì—°ì† ë‹¬ì„± ê¸°ë¡</Text>\n        <View style={styles.streakContainer}>\n          <View style={styles.streakItem}>\n            <Text style={styles.streakNumber}>{data.streakCurrent}</Text>\n            <Text style={styles.streakLabel}>í˜„ì¬ ì—°ì†</Text>\n          </View>\n          <View style={styles.streakItem}>\n            <Text style={styles.streakNumber}>{data.streakBest}</Text>\n            <Text style={styles.streakLabel}>ìµœê³  ê¸°ë¡</Text>\n          </View>\n        </View>\n      </View>\n\n      {/* ì‹œê°„ëŒ€ë³„ ì„±ê³¼ (14ì¼ ì´ìƒ ì‚¬ìš©ìë§Œ) */}\n      {data.daysSinceStart >= 14 && (\n        <View style={styles.card}>\n          <Text style={styles.cardTitle}>â° ë‚˜ì˜ íŒ¨í„´ ë¶„ì„</Text>\n          <View style={styles.patternContainer}>\n            <View style={styles.patternItem}>\n              <Text style={styles.patternLabel}>ê°€ì¥ ì˜í•˜ëŠ” ì‹œê°„</Text>\n              <Text style={styles.patternValue}>{formatHour(data.bestHour)}</Text>\n            </View>\n            <View style={styles.patternItem}>\n              <Text style={styles.patternLabel}>ê°œì„ ì´ í•„ìš”í•œ ì‹œê°„</Text>\n              <Text style={styles.patternValue}>{formatHour(data.worstHour)}</Text>\n            </View>\n          </View>\n        </View>\n      )}\n\n      {/* ì¼í‰ê·  ëª©í‘œ */}\n      <View style={styles.card}>\n        <Text style={styles.cardTitle}>ğŸ“ˆ í™œë™ íŒ¨í„´</Text>\n        <View style={styles.averageContainer}>\n          <Text style={styles.averageNumber}>{data.dailyAverage}</Text>\n          <Text style={styles.averageLabel}>ì¼í‰ê·  ëª©í‘œ ê°œìˆ˜</Text>\n        </View>\n      </View>\n\n      {/* ì˜¤ëŠ˜ì˜ ì‘ì› ë©”ì‹œì§€ */}\n      {currentMessage && (\n        <View style={styles.motivationCard}>\n          <Text style={styles.motivationTitle}>ğŸ’ª {currentMessage.title}</Text>\n          <Text style={styles.motivationMessage}>{currentMessage.message}</Text>\n        </View>\n      )}\n\n      {/* ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ ì„¹ì…˜ */}\n      <View style={styles.card}>\n        <Text style={styles.cardTitle}>ğŸŒŸ ì»¤ë®¤ë‹ˆí‹° ì¸ì‚¬ì´íŠ¸</Text>\n        <Text style={styles.insightSubtitle}>ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì˜ ì„±ê³µ íŒ¨í„´ì„ ì°¸ê³ í•´ë³´ì„¸ìš”</Text>\n        {adminInsights.length > 0 ? (\n          <View style={styles.insightList}>\n            {adminInsights.map((insight, index) => (\n              <View key={insight.id} style={styles.insightItem}>\n                <Text style={styles.insightIcon}>{getInsightIcon(insight.insightType)}</Text>\n                <View style={styles.insightContent}>\n                  <Text style={styles.insightTitle}>{insight.title}</Text>\n                  <Text style={styles.insightDescription}>{insight.description}</Text>\n                </View>\n              </View>\n            ))}\n          </View>\n        ) : (\n          <Text style={styles.noInsightText}>ì¸ì‚¬ì´íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</Text>\n        )}\n      </View>\n    </ScrollView>\n  );\n}\n\n/* â”€â”€â”€â”€â”€â”€â”€â”€â”€ ìŠ¤íƒ€ì¼ â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f5f5f5',\n  },\n  contentContainer: {\n    padding: 16,\n  },\n  center: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n  loadingText: {\n    marginTop: 12,\n    fontSize: 16,\n    color: '#666',\n  },\n  emptyTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    color: '#333',\n    marginBottom: 8,\n  },\n  emptyMessage: {\n    fontSize: 16,\n    color: '#666',\n    textAlign: 'center',\n  },\n  header: {\n    alignItems: 'center',\n    marginBottom: 24,\n  },\n  title: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#333',\n    marginBottom: 4,\n  },\n  subtitle: {\n    fontSize: 16,\n    color: '#666',\n  },\n  periodContainer: {\n    flexDirection: 'row',\n    justifyContent: 'center',\n    marginBottom: 24,\n    flexWrap: 'wrap',\n  },\n  periodButton: {\n    paddingHorizontal: 16,\n    paddingVertical: 8,\n    borderRadius: 20,\n    backgroundColor: '#fff',\n    marginHorizontal: 4,\n    marginVertical: 4,\n    borderWidth: 1,\n    borderColor: '#ddd',\n  },\n  periodButtonActive: {\n    backgroundColor: '#4CAF50',\n    borderColor: '#4CAF50',\n  },\n  periodButtonText: {\n    fontSize: 14,\n    color: '#666',\n  },\n  periodButtonTextActive: {\n    color: '#fff',\n    fontWeight: 'bold',\n  },\n  statsContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginBottom: 24,\n  },\n  statCard: {\n    flex: 1,\n    backgroundColor: '#fff',\n    borderRadius: 12,\n    padding: 16,\n    alignItems: 'center',\n    marginHorizontal: 4,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  statNumber: {\n    fontSize: 24,\n    fontWeight: 'bold',\n    color: '#333',\n    marginBottom: 4,\n  },\n  statLabel: {\n    fontSize: 12,\n    color: '#666',\n  },\n  card: {\n    backgroundColor: '#fff',\n    borderRadius: 12,\n    padding: 16,\n    marginBottom: 16,\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 4,\n    elevation: 3,\n  },\n  cardTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#333',\n    marginBottom: 12,\n  },\n  streakContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n  },\n  streakItem: {\n    alignItems: 'center',\n  },\n  streakNumber: {\n    fontSize: 32,\n    fontWeight: 'bold',\n    color: '#FF9800',\n    marginBottom: 4,\n  },\n  streakLabel: {\n    fontSize: 14,\n    color: '#666',\n  },\n  patternContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n  },\n  patternItem: {\n    flex: 1,\n    alignItems: 'center',\n  },\n  patternLabel: {\n    fontSize: 14,\n    color: '#666',\n    marginBottom: 4,\n    textAlign: 'center',\n  },\n  patternValue: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    color: '#333',\n  },\n  averageContainer: {\n    alignItems: 'center',\n  },\n  averageNumber: {\n    fontSize: 36,\n    fontWeight: 'bold',\n    color: '#2196F3',\n    marginBottom: 4,\n  },\n  averageLabel: {\n    fontSize: 14,\n    color: '#666',\n  },\n  \n  // ì‘ì› ë©”ì‹œì§€ ìŠ¤íƒ€ì¼\n  motivationCard: {\n    backgroundColor: '#E8F5E8',\n    borderRadius: 12,\n    padding: 16,\n    marginBottom: 16,\n    borderLeftWidth: 4,\n    borderLeftColor: '#4CAF50',\n  },\n  motivationTitle: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    color: '#2E7D32',\n    marginBottom: 8,\n  },\n  motivationMessage: {\n    fontSize: 14,\n    color: '#2E7D32',\n    lineHeight: 20,\n  },\n  \n  // ì‘ì› ë©”ì‹œì§€ ì¹´ë“œ ìŠ¤íƒ€ì¼\n  motivationCard: {\n    backgroundColor: '#E8F5E8',\n    borderRadius: 12,\n    padding: 16,\n    marginBottom: 16,\n    borderWidth: 1,\n    borderColor: '#4CAF50',\n    shadowColor: '#000',\n    shadowOffset: { width: 0, height: 2 },\n    shadowOpacity: 0.1,\n    shadowRadius: 3,\n    elevation: 3,\n  },\n  motivationTitle: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    color: '#2E7D32',\n    marginBottom: 8,\n  },\n  \n  // ì¸ì‚¬ì´íŠ¸ ê´€ë ¨ ìŠ¤íƒ€ì¼\n  insightSubtitle: {\n    fontSize: 14,\n    color: '#666',\n    marginBottom: 16,\n  },\n  insightList: {\n    gap: 12,\n  },\n  insightItem: {\n    flexDirection: 'row',\n    alignItems: 'flex-start',\n    backgroundColor: '#f8f9fa',\n    borderRadius: 8,\n    padding: 12,\n    borderWidth: 1,\n    borderColor: '#e9ecef',\n  },\n  insightIcon: {\n    fontSize: 20,\n    marginRight: 12,\n    marginTop: 2,\n  },\n  insightContent: {\n    flex: 1,\n  },\n  insightTitle: {\n    fontSize: 16,\n    fontWeight: 'bold',\n    color: '#333',\n    marginBottom: 4,\n  },\n  insightDescription: {\n    fontSize: 14,\n    color: '#666',\n    lineHeight: 20,\n  },\n  noInsightText: {\n    fontSize: 14,\n    color: '#999',\n    textAlign: 'center',\n    fontStyle: 'italic',\n    marginTop: 8,\n  },\n\n});","size_bytes":19843},"src/screens/TimeSelectScreen.tsx":{"content":"// src/screens/TimeSelectScreen.tsx\nimport DateTimePicker, {\n  DateTimePickerEvent,\n} from \"@react-native-community/datetimepicker\";\nimport React, { useState } from \"react\";\nimport { Alert, Platform, StyleSheet, Text, TouchableOpacity, View } from \"react-native\";\nimport useGoalStore from \"../store/goalStore\";\nimport CustomTimePicker from \"../components/CustomTimePicker\";\n\n/* â”€â”€â”€â”€â”€â”€ ë‚ ì§œ í—¬í¼ â”€â”€â”€â”€â”€â”€ */\nconst nearestFutureHalfHour = (): Date => {\n  // ğŸ”¥ í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ 3ì‹œê°„ í›„ ê³„ì‚°\n  const koreaTime = new Date(new Date().toLocaleString(\"en-US\", {timeZone: \"Asia/Seoul\"}));\n  koreaTime.setHours(koreaTime.getHours() + 3);\n  const m = koreaTime.getMinutes();\n  const rounded = m < 30 ? 30 : 60;\n  if (rounded === 60) koreaTime.setHours(koreaTime.getHours() + 1);\n  koreaTime.setMinutes(rounded % 60, 0, 0);\n  \n  console.log(\"ğŸ“… nearestFutureHalfHour ê³„ì‚°:\", {\n    í˜„ì¬í•œêµ­ì‹œê°„: new Date().toLocaleString('ko-KR', {timeZone: 'Asia/Seoul'}),\n    ê³„ì‚°ê²°ê³¼: koreaTime.toLocaleString('ko-KR')\n  });\n  \n  return koreaTime;\n};\nconst tomorrowStart = (): Date => {\n  const d = new Date();\n  d.setDate(d.getDate() + 1);\n  d.setHours(0, 30, 0, 0); // ì˜¤ì „ 12:30ë¶€í„° ì‹œì‘ (12:00 ë°©ì§€)\n  return d;\n};\nconst tomorrowEnd = (): Date => {\n  const d = tomorrowStart();\n  d.setHours(23, 30, 0, 0);\n  return d;\n};\n\nexport default function TimeSelectScreen({ navigation, route }: any) {\n  /* ì˜¤ëŠ˜ vs ë‚´ì¼ ëª¨ë“œ - ê¸°ë³¸ê°’ì€ \"today\"ë¡œ ë‹¹ì¼ ì¶”ê°€ ëª¨ë“œ */\n  const isTomorrow = route.params?.initial === \"tomorrow\";\n  const isToday = route.params?.initial === \"today\";\n\n  /* ì‹œê°„ ì¬ì„¤ì • ëª¨ë“œ ì²´í¬ */\n  const isTimeReset = route.params?.currentTime;\n  const goalId = route.params?.goalId;\n\n  /* ê¸°ë³¸ê°’ - ì‹œê°„ ì¬ì„¤ì • ì‹œ í˜„ì¬ ì‹œê°„ + 1ë¶„ ì‚¬ìš© */\n  const base = isTimeReset\n    ? (() => {\n        const now = new Date();\n        now.setMinutes(now.getMinutes() + 1); // í˜„ì¬ ì‹œê°„ + 1ë¶„\n        now.setSeconds(0, 0); // ì´ˆì™€ ë°€ë¦¬ì´ˆ ì œê±°\n        return now;\n      })()\n    : isTomorrow\n      ? tomorrowStart()\n      : nearestFutureHalfHour();\n  const [targetTime, setTargetTime] = useState<Date>(base);\n  const [isTimeValid, setIsTimeValid] = useState<boolean>(true);\n\n  /* ëª©í‘œ ìŠ¤í† ì–´ - ì¤‘ë³µ ì²´í¬ìš© */\n  const { goals, fetchGoals } = useGoalStore();\n\n  // í™”ë©´ ë¡œë“œ ì‹œ í•œ ë²ˆë§Œ ëª©í‘œ ë°ì´í„° ì¡°íšŒ \n  React.useEffect(() => {\n    console.log('ğŸ”„ TimeSelectScreenì—ì„œ ëª©í‘œ ë°ì´í„° ê°•ì œ ì¡°íšŒ');\n    fetchGoals().catch(console.error);\n  }, []); // fetchGoals ì˜ì¡´ì„± ì œê±°ë¡œ ë¬´í•œ ë£¨í”„ ë°©ì§€\n\n  /* í”¼ì»¤ ë³€ê²½ â†’ ììœ ë¡œìš´ ë¶„ ë‹¨ìœ„ ì„ íƒ */\n  const onChange = (_: DateTimePickerEvent, date?: Date) => {\n    if (!date) return;\n\n    // ë‚´ì¼ ëª¨ë“œì¼ ë•ŒëŠ” ë‚ ì§œë¥¼ ë‚´ì¼ë¡œ ê³ ì •\n    if (isTomorrow) {\n      const tomorrow = new Date();\n      tomorrow.setDate(tomorrow.getDate() + 1);\n      date.setFullYear(tomorrow.getFullYear());\n      date.setMonth(tomorrow.getMonth());\n      date.setDate(tomorrow.getDate());\n    }\n\n    // ì´ˆì™€ ë°€ë¦¬ì´ˆëŠ” 0ìœ¼ë¡œ ì„¤ì •\n    date.setSeconds(0, 0);\n    setTargetTime(date);\n  };\n\n  /* GoalDetail ì´ë™ ì „ ì¤‘ë³µ ì²´í¬ ë° ì‹œê°„ ì œí•œ ì²´í¬ */\n  const goNext = () => {\n    // ì‹œê°„ ìœ íš¨ì„± ì²´í¬ - CustomTimePickerì—ì„œ ê²€ì¦ëœ ìƒíƒœ í™•ì¸\n    if (!isTimeValid) {\n      console.log('âš ï¸ ìœ íš¨í•˜ì§€ ì•Šì€ ì‹œê°„ìœ¼ë¡œ ì €ì¥ ì‹œë„ ì°¨ë‹¨');\n      return; // ì €ì¥ ì‹œë„ ìì²´ë¥¼ ì°¨ë‹¨\n    }\n    const selectedTimeISO = targetTime.toISOString();\n    const now = new Date();\n\n    // 00:00:00 ì‹œê°„ ìë™ ìˆ˜ì • (Date value out of bounds ë°©ì§€)\n    if (targetTime.getHours() === 0 && targetTime.getMinutes() === 0) {\n      const correctedTime = new Date(targetTime);\n      correctedTime.setMinutes(30); // 00:30ìœ¼ë¡œ ìë™ ìˆ˜ì •\n      setTargetTime(correctedTime);\n      console.log('ğŸ”§ 00:00:00 ì‹œê°„ì„ 00:30:00ìœ¼ë¡œ ìë™ ìˆ˜ì •');\n      return;\n    }\n\n    // ì‹œê°„ ì œí•œ ì²´í¬ - ë‚´ì¼ ëª¨ë“œì™€ ì‹œê°„ ì¬ì„¤ì • ëª¨ë“œì—ì„œëŠ” ì œì•½ ì—†ìŒ\n    // ë‚´ì¼ ëª©í‘œì™€ í¸ì§‘ ëª¨ë“œì—ì„œëŠ” ëª¨ë“  ì‹œê°„ ì œì•½ ê±´ë„ˆëœ€\n    console.log(\"ğŸ• TimeSelectScreen ì‹œê°„ ì œì•½ ê²€ì‚¬:\", {\n      isTomorrow,\n      isTimeReset,\n      í˜„ì¬ì‹œê°„: now.toLocaleString('ko-KR'),\n      ëª©í‘œì‹œê°„: targetTime.toLocaleString('ko-KR'),\n      ì œì•½ê±´ë„ˆëœ€: isTomorrow || isTimeReset\n    });\n    \n    if (!isTomorrow && !isTimeReset) {\n      // ğŸ”¥ ìƒˆ ëª©í‘œ ëª¨ë“œ 3ì‹œê°„ ì œí•œ í™œì„±í™” (ë‹¹ì¼ë§Œ)\n      const minAllowedTime = new Date(now.getTime() + 3 * 60 * 60 * 1000);\n      if (targetTime <= minAllowedTime) {\n        console.log(\"âŒ ë‹¹ì¼ ëª©í‘œ 3ì‹œê°„ ì œí•œ ìœ„ë°˜ - ì•Œë¦¼ í‘œì‹œ\");\n        Alert.alert(\n          'ëª©í‘œ ì‹œê°„ ì œí•œ', \n          'ìƒˆ ëª©í‘œëŠ” í˜„ì¬ ì‹œê°„ìœ¼ë¡œë¶€í„° ìµœì†Œ 3ì‹œê°„ ì´í›„ì— ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\\n\\n' +\n          `í˜„ì¬ ì‹œê°„: ${now.toLocaleTimeString('ko-KR', { hour12: true, hour: '2-digit', minute: '2-digit' }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„')}\\n` +\n          `ì„¤ì • ê°€ëŠ¥í•œ ì‹œê°„: ${minAllowedTime.toLocaleTimeString('ko-KR', { hour12: true, hour: '2-digit', minute: '2-digit' }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„')} ì´í›„`\n        );\n        return;\n      }\n    } else {\n      console.log(\"âœ… ë‚´ì¼ ëª¨ë“œ ë˜ëŠ” ì‹œê°„ ì¬ì„¤ì • ëª¨ë“œ - ëª¨ë“  ì‹œê°„ ì œì•½ ì™„ì „ ê±´ë„ˆëœ€\");\n    }\n\n    // Â±30ë¶„ ë²”ìœ„ ì¶©ëŒ ì²´í¬ - ì‹œê°„ ì¬ì„¤ì • ëª¨ë“œì—ì„œëŠ” ë³¸ì¸ ëª©í‘œ ì œì™¸\n    const selectedTime = targetTime.getTime();\n    \n    console.log(\"ğŸ” TimeSelectScreen ì¶©ëŒ ê²€ì‚¬:\", {\n      selectedTime: targetTime.toLocaleTimeString('ko-KR'),\n      selectedTimeISO: targetTime.toISOString(),\n      isTimeReset,\n      goalId,\n      existingGoalsCount: (goals || []).length,\n      existingGoals: (goals || []).map(g => ({\n        id: g.id,\n        time: new Date(g.target_time).toLocaleTimeString('ko-KR'),\n        timeISO: g.target_time\n      }))\n    });\n    \n    // ê°™ì€ ë‚ ì§œì˜ ëª©í‘œë“¤ë§Œ í•„í„°ë§ (ì •í™•í•œ ë‚ ì§œ ë¹„êµ)\n    const selectedDateLocal = targetTime.toLocaleDateString();\n    const sameDayGoals = (goals || []).filter(g => {\n      const goalDate = new Date(g.target_time);\n      const goalDateLocal = goalDate.toLocaleDateString();\n      const isSameDate = goalDateLocal === selectedDateLocal;\n      \n      console.log(\"ğŸ“… ê°œë³„ ëª©í‘œ ë‚ ì§œ ë¹„êµ:\", {\n        ëª©í‘œ: g.title,\n        ëª©í‘œì‹œê°„: g.target_time,\n        ëª©í‘œë‚ ì§œë¡œì»¬: goalDateLocal,\n        ì„ íƒë‚ ì§œë¡œì»¬: selectedDateLocal,\n        ê°™ì€ë‚ ì§œ: isSameDate\n      });\n      \n      return isSameDate;\n    });\n\n    console.log(\"ğŸ“… TimeSelectScreen ìµœì¢… ê°™ì€ ë‚ ì§œ í•„í„°ë§:\", {\n      selectedDate: selectedDateLocal,\n      selectedTime: targetTime.toLocaleString(),\n      totalGoals: (goals || []).length,\n      sameDayGoals: sameDayGoals.length,\n      sameDayGoalsList: sameDayGoals.map(g => ({\n        title: g.title,\n        time: new Date(g.target_time).toLocaleTimeString('ko-KR')\n      }))\n    });\n\n    // ğŸ”¥ ì •í™•í•œ 30ë¶„ ì¶©ëŒ ì²´í¬ - ì‹¤ì œ ì¶©ëŒë§Œ ê°ì§€\n    const conflictingGoals = sameDayGoals.filter((g) => {\n      // í¸ì§‘ ëª¨ë“œì—ì„œëŠ” í˜„ì¬ í¸ì§‘ ì¤‘ì¸ ëª©í‘œ ì œì™¸\n      if (isTimeReset && g.id === goalId) return false;\n\n      const goalTime = new Date(g.target_time).getTime();\n      const timeDiff = Math.abs(targetTime.getTime() - goalTime);\n      const thirtyMinutes = 30 * 60 * 1000; // 30ë¶„ì„ ë°€ë¦¬ì´ˆë¡œ ë³€í™˜\n      const isConflict = timeDiff < thirtyMinutes;\n\n      console.log(\"â° ì •í™•í•œ ì¶©ëŒ ì²´í¬:\", {\n        ê¸°ì¡´ëª©í‘œ: g.title,\n        ê¸°ì¡´ì‹œê°„: new Date(g.target_time).toLocaleTimeString('ko-KR'),\n        ì„ íƒì‹œê°„: targetTime.toLocaleTimeString('ko-KR'),\n        ì‹œê°„ì°¨ë¶„: Math.round(timeDiff / (60 * 1000)) + \"ë¶„\",\n        ì¶©ëŒì—¬ë¶€: isConflict\n      });\n\n      return isConflict;\n    });\n\n    // ì‹¤ì œ ì¶©ëŒì´ ìˆì„ ë•Œë§Œ ì•Œë¦¼ í‘œì‹œí•˜ê³  ì €ì¥ ì°¨ë‹¨\n    if (conflictingGoals.length > 0) {\n      const conflictInfo = conflictingGoals.map(g => \n        `- ${g.title} (${new Date(g.target_time).toLocaleTimeString('ko-KR', { \n          hour12: true, hour: '2-digit', minute: '2-digit' \n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„')})`\n      ).join('\\n');\n      \n      console.log(\"ğŸš« ì‹¤ì œ 30ë¶„ ì¶©ëŒ ê°ì§€ - ì €ì¥ ì°¨ë‹¨:\", conflictingGoals.length + \"ê°œ\");\n      \n      Alert.alert(\n        'ì‹œê°„ ì¤‘ë³µ',\n        `ì„ íƒí•œ ì‹œê°„ê³¼ 30ë¶„ ì´ë‚´ë¡œ ê°€ê¹Œìš´ ëª©í‘œê°€ ìˆìŠµë‹ˆë‹¤:\\n\\n${conflictInfo}\\n\\në‹¤ë¥¸ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.`\n      );\n      return; // ì—¬ê¸°ì„œ ì €ì¥ ì°¨ë‹¨\n    }\n\n    console.log(\"âœ… 30ë¶„ ì¶©ëŒ ì—†ìŒ - ì €ì¥ ì§„í–‰\");\n\n    // ì‹œê°„ ì¬ì„¤ì • ëª¨ë“œì¸ ê²½ìš° ì´ì „ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ë©´ì„œ ë³€ê²½ëœ ì‹œê°„ ì „ë‹¬\n    if (isTimeReset) {\n      console.log('ğŸ”„ ì‹œê°„ ì¬ì„¤ì • ëª¨ë“œ - ë³€ê²½ëœ ì‹œê°„ìœ¼ë¡œ ëŒì•„ê°€ê¸°:', selectedTimeISO);\n      navigation.navigate(\"GoalDetail\", {\n        goalId: goalId,\n        prefilledTime: selectedTimeISO,\n        updatedTime: selectedTimeISO, // ë³€ê²½ëœ ì‹œê°„ ì „ë‹¬\n        batch: route.params?.batch ?? false,\n      });\n    } else {\n      // ìƒˆ ëª©í‘œ ìƒì„± ëª¨ë“œ\n      navigation.navigate(\"GoalDetail\", {\n        goalId: null,\n        prefilledTime: selectedTimeISO,\n        batch: route.params?.batch ?? false,\n      });\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      {/* í—¤ë” */}\n      <View style={styles.header}>\n        <TouchableOpacity onPress={() => navigation.goBack()} style={styles.backButton}>\n          <Text style={styles.backButtonText}>â† ì˜¤ëŠ˜ì˜ ëª©í‘œ</Text>\n        </TouchableOpacity>\n        <Text style={styles.title}>ì‹œê°„ ì„ íƒ</Text>\n      </View>\n\n      {/* ì‹œê°„ ì„ íƒ ì»¨í…Œì´ë„ˆ */}\n      <View style={styles.timePickerContainer}>\n        <CustomTimePicker\n          value={targetTime}\n          onChange={(date) => setTargetTime(date)}\n          onValidityChange={setIsTimeValid}\n          isTomorrowMode={isTomorrow}\n          goals={goals || []}\n          conflictingTimes={[]} // TimeSelectScreenì—ì„œëŠ” DB ëª©í‘œë§Œ ì²´í¬\n          excludeGoalId={isTimeReset ? goalId : undefined}\n        />\n      </View>\n\n      {/* ë‹¤ìŒ ë²„íŠ¼ */}\n      <View style={styles.buttonContainer}>\n        <TouchableOpacity\n          style={[\n            styles.nextButton,\n            !isTimeValid && styles.nextButtonDisabled\n          ]}\n          onPress={goNext}\n          disabled={!isTimeValid}\n        >\n          <Text style={[\n            styles.nextButtonText,\n            !isTimeValid && styles.nextButtonTextDisabled\n          ]}>\n            ë‹¤ìŒ\n          </Text>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n}\n\n/* â”€â”€â”€â”€â”€â”€ ìŠ¤íƒ€ì¼ â”€â”€â”€â”€â”€â”€ */\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#ffffff\",\n    paddingTop: 44, // SafeArea ê³ ë ¤\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    paddingHorizontal: 16,\n    paddingVertical: 12,\n    borderBottomWidth: 1,\n    borderBottomColor: \"#e0e0e0\",\n    backgroundColor: \"#ffffff\",\n    position: \"relative\",\n  },\n  backButton: {\n    position: \"absolute\",\n    left: 16,\n    paddingVertical: 8,\n    paddingHorizontal: 4,\n  },\n  backButtonText: {\n    fontSize: 16,\n    color: \"#007AFF\",\n    fontWeight: \"500\",\n  },\n  title: {\n    fontSize: 18,\n    fontWeight: \"600\",\n    color: \"#000000\",\n    textAlign: \"center\",\n  },\n  timePickerContainer: {\n    flex: 1,\n    paddingHorizontal: 16,\n    backgroundColor: \"#f8f9fa\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  buttonContainer: {\n    paddingHorizontal: 16,\n    paddingTop: 40,\n    paddingBottom: 60,\n    backgroundColor: \"#f8f9fa\",\n  },\n  nextButton: {\n    backgroundColor: \"#007AFF\",\n    borderRadius: 8,\n    paddingVertical: 12,\n    paddingHorizontal: 32,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    alignSelf: \"center\",\n    minWidth: 120,\n  },\n  nextButtonDisabled: {\n    backgroundColor: \"#cccccc\",\n  },\n  nextButtonText: {\n    fontSize: 16,\n    fontWeight: \"600\",\n    color: \"#ffffff\",\n  },\n  nextButtonTextDisabled: {\n    color: \"#999999\",\n  },\n});","size_bytes":12235},"src/screens/WelcomeScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  SafeAreaView,\n  Image,\n  Alert,\n  ActivityIndicator,\n  ImageBackground,\n} from \"react-native\";\nimport { useAuthStore } from \"../store/authStore\";\n\ninterface WelcomeScreenProps {\n  navigation: any;\n}\n\nexport default function WelcomeScreen({ navigation }: WelcomeScreenProps) {\n  const [isGoogleLoading, setIsGoogleLoading] = useState(false);\n  const { signInWithGoogle } = useAuthStore();\n\n  const handleGoogleSignIn = async () => {\n    setIsGoogleLoading(true);\n    try {\n      const result = await signInWithGoogle();\n\n      if (result.success) {\n        if (result.isNewUser) {\n          navigation.navigate(\"ProfileSetup\");\n        } else {\n          navigation.navigate(\"Main\");\n        }\n      } else {\n        Alert.alert(\n          \"Google ë¡œê·¸ì¸ ì‹¤íŒ¨\",\n          result.error || \"ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\",\n          [{ text: \"í™•ì¸\" }],\n        );\n      }\n    } catch (error) {\n      Alert.alert(\"Google ë¡œê·¸ì¸ ì˜¤ë¥˜\", \"ì˜ˆìƒì¹˜ ëª»í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\", [\n        { text: \"í™•ì¸\" },\n      ]);\n    } finally {\n      setIsGoogleLoading(false);\n    }\n  };\n\n  return (\n    <ImageBackground\n      source={require(\"../../assets/images/welcome-background.jpg\")}\n      style={styles.backgroundContainer}\n      resizeMode=\"cover\"\n    >\n      <SafeAreaView style={styles.container}>\n        {/* ì™¼ìª½ ìƒë‹¨ ë¡œê³ ì™€ í…ìŠ¤íŠ¸ */}\n        <View style={styles.topSection}>\n          <Image\n            source={require(\"../../assets/images/app-logo.png\")}\n            style={styles.appLogo}\n            resizeMode=\"contain\"\n          />\n          <Text style={styles.mainSubtitle}>\n            íŒ¨ë°°ì— êµ´ë³µí•˜ì§€ ì•Šê³ {\"\\n\"}ì„±ì¥í•˜ëŠ” ìš°ë¦¬ë¥¼ ìœ„í•˜ì—¬\n          </Text>\n        </View>\n\n        {/* í•˜ë‹¨ ë¡œê·¸ì¸ ë²„íŠ¼ë“¤ */}\n        <View style={styles.bottomSection}>\n          {/* Google ë¡œê·¸ì¸ */}\n          <TouchableOpacity\n            style={[styles.loginButton, styles.googleButton]}\n            onPress={handleGoogleSignIn}\n            disabled={isGoogleLoading}\n          >\n            {isGoogleLoading ? (\n              <ActivityIndicator color=\"#fff\" size=\"small\" />\n            ) : (\n              <>\n                <Text style={styles.googleIcon}>G</Text>\n                <Text style={styles.googleButtonText}>Googleë¡œ ê³„ì†í•˜ê¸°</Text>\n              </>\n            )}\n          </TouchableOpacity>\n\n          {/* ê²ŒìŠ¤íŠ¸ ëª¨ë“œë¡œ ì‹œì‘í•˜ê¸° */}\n          <TouchableOpacity\n            style={[styles.loginButton, styles.guestButton]}\n            onPress={() => navigation.navigate(\"GuestMode\")}\n          >\n            <Text style={styles.guestButtonText}>ê²ŒìŠ¤íŠ¸ ëª¨ë“œë¡œ ì‹œì‘í•˜ê¸°</Text>\n          </TouchableOpacity>\n\n          <View style={styles.footer}>\n            <Text style={styles.footerText}>\n              ê²ŒìŠ¤íŠ¸ë¡œ ì´ìš©í•˜ì‹¤ ê²½ìš° ì¼ë¶€ ê¸°ëŠ¥ì€ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n            </Text>\n          </View>\n        </View>\n      </SafeAreaView>\n    </ImageBackground>\n  );\n}\n\nconst styles = StyleSheet.create({\n  backgroundContainer: {\n    flex: 1,\n  },\n  container: {\n    flex: 1,\n    backgroundColor: \"rgba(0, 0, 0, 0.4)\", // í…ìŠ¤íŠ¸ ê°€ë…ì„±ì„ ìœ„í•œ ì˜¤ë²„ë ˆì´\n  },\n  topSection: {\n    flex: 1,\n    paddingTop: 10,\n    paddingLeft: 15,\n    paddingRight: 15,\n  },\n  appLogo: {\n    width: 200,\n    height: 120,\n    marginBottom: -20,\n    marginTop: 14,\n  },\n  mainSubtitle: {\n    fontSize: 18,\n    color: \"#FFFFFF\",\n    lineHeight: 26,\n    paddingLeft: 10,\n    textShadowColor: 'rgba(0, 0, 0, 0.8)',\n    textShadowOffset: { width: 0, height: 1 },\n    textShadowRadius: 3,\n    fontWeight: '500',\n  },\n  bottomSection: {\n    paddingHorizontal: 40,\n    paddingBottom: 60,\n  },\n  loginButton: {\n    height: 56,\n    borderRadius: 12,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginBottom: 12,\n    flexDirection: \"row\",\n  },\n  googleButton: {\n    backgroundColor: \"#4285f4\",\n    marginBottom: 16,\n  },\n  googleIcon: {\n    fontSize: 20,\n    fontWeight: \"bold\",\n    marginRight: 12,\n    backgroundColor: \"#fff\",\n    color: \"#4285f4\",\n    width: 32,\n    height: 32,\n    textAlign: \"center\",\n    lineHeight: 32,\n    borderRadius: 16,\n  },\n  googleButtonText: {\n    color: \"#fff\",\n    fontSize: 18,\n    fontWeight: \"600\",\n  },\n  guestButton: {\n    backgroundColor: \"rgba(255, 255, 255, 0.9)\",\n    marginBottom: 24,\n  },\n  guestButtonText: {\n    color: \"#333\",\n    fontSize: 18,\n    fontWeight: \"600\",\n  },\n  footer: {\n    alignItems: \"center\",\n  },\n  footerText: {\n    color: \"#b0b0b0\",\n    fontSize: 12,\n    textAlign: \"center\",\n  },\n});\n","size_bytes":4677},"src/stacks/AuthStack.tsx":{"content":"import { createNativeStackNavigator } from '@react-navigation/native-stack';\nimport React from 'react';\nimport WelcomeScreen from '../screens/WelcomeScreen';\nimport GuestModeScreen from '../screens/GuestModeScreen';\nimport ProfileSetupScreen from '../screens/ProfileSetupScreen';\nimport TutorialScreen from '../screens/TutorialScreen';\nimport useUserStore from '../store/userStore';\nimport useProfileStore from '../store/profileStore';\n\nconst Stack = createNativeStackNavigator();\n\nexport default function AuthStack() {\n  const { session } = useUserStore();\n  const { profile } = useProfileStore();\n  \n  // ë¼ìš°íŒ… ê²°ì • ë¡œì§ - tutorialCompleted ìƒíƒœ ê´€ë¦¬ëŠ” App.tsxì—ì„œë§Œ ìˆ˜í–‰\n  let initialRouteName = 'Welcome';\n  \n  if (session && !profile) {\n    // ì„¸ì…˜ì´ ìˆì§€ë§Œ í”„ë¡œí•„ì´ ì—†ëŠ” ê²½ìš° - ProfileSetupìœ¼ë¡œ\n    initialRouteName = 'ProfileSetup';\n  } else if (session && profile) {\n    // ì„¸ì…˜ê³¼ í”„ë¡œí•„ì´ ëª¨ë‘ ìˆëŠ” ê²½ìš° - Tutorialë¡œ (App.tsxì—ì„œ tutorialCompleted í™•ì¸)\n    initialRouteName = 'Tutorial';\n  }\n  \n  console.log('ğŸ” AuthStack ë¼ìš°íŒ… ê²°ì •:', {\n    session: session ? 'ìˆìŒ' : 'ì—†ìŒ',\n    profile: profile ? 'ìˆìŒ' : 'ì—†ìŒ',\n    initialRouteName,\n    isAnonymous: session?.user?.is_anonymous || false\n  });\n\n  return (\n    <Stack.Navigator initialRouteName={initialRouteName}>\n      <Stack.Screen \n        name=\"Welcome\" \n        component={WelcomeScreen} \n        options={{ headerShown: false }} \n      />\n      <Stack.Screen \n        name=\"GuestMode\" \n        component={GuestModeScreen} \n        options={{ headerShown: false }} \n      />\n      <Stack.Screen \n        name=\"ProfileSetup\" \n        component={ProfileSetupScreen} \n        options={{ title: 'í”„ë¡œí•„ ì„¤ì •', headerBackVisible: false }} \n      />\n      <Stack.Screen \n        name=\"Tutorial\" \n        component={TutorialScreen} \n        options={{ headerShown: false }} \n      />\n    </Stack.Navigator>\n  );\n}","size_bytes":1951},"src/stacks/CommunityStack.tsx":{"content":"import { createNativeStackNavigator } from '@react-navigation/native-stack';\nimport React from 'react';\nimport CommunityScreen from '../screens/CommunityScreen';\n\nexport type CommunityStackParamList = {\n  CommunityMain: undefined;\n};\n\nconst Stack = createNativeStackNavigator<CommunityStackParamList>();\n\nexport default function CommunityStack() {\n  return (\n    <Stack.Navigator screenOptions={{ headerShown: false }}>\n      <Stack.Screen name=\"CommunityMain\" component={CommunityScreen} />\n    </Stack.Navigator>\n  );\n}","size_bytes":521},"src/stacks/HistoryStack.tsx":{"content":"import { createNativeStackNavigator } from '@react-navigation/native-stack';\r\nimport React from 'react';\r\nimport DayDetailScreen from '../screens/DayDetailScreen';\r\nimport HistoryCalendarScreen from '../screens/HistoryCalendarScreen';\r\nimport RetrospectScreen from '../screens/RetrospectScreen';\nimport PersonalAnalyticsScreen from '../screens/PersonalAnalyticsScreen';\r\n\r\nconst Stack = createNativeStackNavigator();\r\n\r\nexport default function HistoryStack() {\r\n  return (\r\n    <Stack.Navigator>\r\n      <Stack.Screen \r\n        name=\"HistoryCalendar\" \r\n        component={HistoryCalendarScreen}\r\n        options={{ title: 'ê¸°ë¡ ë‹¬ë ¥' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"DayDetail\" \r\n        component={DayDetailScreen}\r\n        options={{ title: 'ì¼ë³„ ìƒì„¸' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"Retrospect\" \r\n        component={RetrospectScreen}\r\n        options={{ title: 'íšŒê³  ì‘ì„±' }}\r\n      />\r\n      <Stack.Screen \n        name=\"Statistics\" \n        component={PersonalAnalyticsScreen}\n        options={{ title: 'ì„±ì¥ ë¶„ì„' }}\n      />\n    </Stack.Navigator>\r\n  );\r\n}","size_bytes":1114},"src/stacks/HomeStack.tsx":{"content":"import { createNativeStackNavigator } from '@react-navigation/native-stack';\r\nimport React from 'react';\r\nimport GoalBatchScreen from '../screens/GoalBatchScreen';\r\nimport GoalDetailScreen from '../screens/GoalDetailScreen';\r\nimport GoalListScreen from '../screens/GoalListScreen';\r\nimport TimeSelectScreen from '../screens/TimeSelectScreen';\nimport FlexibleGoalScreen from '../screens/FlexibleGoalScreen';\nimport RetrospectScreen from '../screens/RetrospectScreen';\r\n\r\nconst Stack = createNativeStackNavigator();\r\n\r\nexport default function HomeStack() {\r\n  return (\r\n    <Stack.Navigator>\r\n      <Stack.Screen \r\n        name=\"GoalList\" \r\n        component={GoalListScreen}\r\n        options={{ headerShown: false }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"GoalDetail\" \r\n        component={GoalDetailScreen}\r\n        options={{ title: 'ëª©í‘œ ìƒì„¸' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"GoalBatch\" \r\n        component={GoalBatchScreen}\r\n        options={{ title: 'ìˆ˜í–‰ ëª©ë¡ ì„¤ì •' }}\r\n      />\r\n      <Stack.Screen \r\n        name=\"TimeSelect\" \r\n        component={TimeSelectScreen}\r\n        options={{ headerShown: false }}\r\n      />\r\n      <Stack.Screen \n        name=\"FlexibleGoal\" \n        component={FlexibleGoalScreen}\n        options={{ title: 'ìœ ì—°í•œ ëª©í‘œ' }}\n      />\n      <Stack.Screen \n        name=\"Retrospect\" \n        component={RetrospectScreen}\n        options={{ title: 'íšŒê³  ì‘ì„±' }}\n      />\n    </Stack.Navigator>\r\n  );\r\n}","size_bytes":1476},"src/stacks/MainTab.tsx":{"content":"import { Ionicons } from '@expo/vector-icons';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\nimport React from 'react';\nimport { Text, View } from 'react-native';\nimport HistoryStack from './HistoryStack';\nimport HomeStack from './HomeStack';\nimport CommunityStack from './CommunityStack';\n\nimport SettingsStack from './SettingsStack';\n\n// íƒ€ì… ì •ì˜\nexport type MainTabParamList = {\n  Home: undefined;\n  History: undefined;\n  Network: undefined;\n  Settings: undefined;\n};\n\nconst Tab = createBottomTabNavigator<MainTabParamList>();\n\n/* ë”ë¯¸ í™”ë©´ ì¬ì‚¬ìš© */\nconst Dummy = ({ route }: { route: any }) => (\n  <View style={{flex:1,justifyContent:'center',alignItems:'center'}}>\n    <Text>{route.name} í™”ë©´ (ì¤€ë¹„ ì¤‘)</Text>\n  </View>\n);\n\nexport default function MainTab() {\n  return (\n    <Tab.Navigator\n      screenOptions={({ route }) => ({\n        headerShown: false,\n        tabBarIcon: ({ color, size }) => {\n          let iconName: keyof typeof Ionicons.glyphMap;\n          \n          switch (route.name) {\n            case 'Home':\n              iconName = 'home';\n              break;\n            case 'History':\n              iconName = 'calendar';\n              break;\n            case 'Network':\n              iconName = 'people';\n              break;\n            case 'Settings':\n              iconName = 'settings';\n              break;\n            default:\n              iconName = 'help-circle';\n          }\n          \n          return <Ionicons name={iconName} size={size} color={color} />;\n        },\n      })}\n    >\n      <Tab.Screen \n        name=\"Home\" \n        component={HomeStack} \n        options={{ tabBarLabel: 'í™ˆ' }}\n      />\n      <Tab.Screen \n        name=\"History\" \n        component={HistoryStack} \n        options={{ tabBarLabel: 'ë‹¬ë ¥' }}\n      />\n      <Tab.Screen \n        name=\"Network\" \n        component={CommunityStack} \n        options={{ tabBarLabel: 'ì»¤ë®¤ë‹ˆí‹°' }}\n      />\n      <Tab.Screen \n        name=\"Settings\" \n        component={SettingsStack} \n        options={{ tabBarLabel: 'ì„¤ì •' }}\n      />\n    </Tab.Navigator>\n  );\n}","size_bytes":2118},"src/stacks/MainTab_Fixed.tsx":{"content":"import { Ionicons } from '@expo/vector-icons';\nimport { createBottomTabNavigator } from '@react-navigation/bottom-tabs';\nimport React from 'react';\nimport { Text, View } from 'react-native';\nimport HistoryStack from './HistoryStack';\nimport HomeStack from './HomeStack';\n\n// íƒ€ì… ì •ì˜\ntype MainTabParamList = {\n  Home: undefined;\n  History: undefined;\n  Network: undefined;\n  Settings: undefined;\n};\n\nconst Tab = createBottomTabNavigator<MainTabParamList>();\n\n/* ë”ë¯¸ í™”ë©´ ì¬ì‚¬ìš© */\nconst Dummy = ({ route }: { route: any }) => (\n  <View style={{flex:1,justifyContent:'center',alignItems:'center'}}>\n    <Text>{route.name} (ì¤€ë¹„ ì¤‘)</Text>\n  </View>\n);\n\nexport default function MainTab() {\n  return (\n    <Tab.Navigator\n      screenOptions={({ route }) => ({\n        headerShown: false,\n        tabBarIcon: ({ color, size }) => {\n          const iconMap = {\n            Home: 'home' as const,\n            History: 'calendar' as const,\n            Network: 'people' as const,\n            Settings: 'settings' as const,\n          };\n          \n          const iconName = iconMap[route.name as keyof typeof iconMap];\n          return <Ionicons name={iconName} size={size} color={color} />;\n        },\n      })}\n    >\n      <Tab.Screen name=\"Home\" component={HomeStack} />\n      <Tab.Screen name=\"History\" component={HistoryStack} />\n      <Tab.Screen name=\"Network\" component={Dummy} />\n      <Tab.Screen name=\"Settings\" component={Dummy} />\n    </Tab.Navigator>\n  );\n}","size_bytes":1480},"src/stacks/SettingsStack.tsx":{"content":"import { createNativeStackNavigator } from '@react-navigation/native-stack';\nimport React from 'react';\nimport SettingsScreen from '../screens/SettingsScreen';\nimport ProfileSetupScreen from '../screens/ProfileSetupScreen';\nimport ProfileEditScreen from '../screens/ProfileEditScreen';\nimport WebViewScreen from '../screens/WebViewScreen';\nimport AccountDeletionSurveyScreen from '../screens/AccountDeletionSurveyScreen';\n\nexport type SettingsStackParamList = {\n  SettingsMain: undefined;\n  ProfileSetup: undefined;\n  ProfileEdit: undefined;\n  WebView: {\n    url: string;\n    title: string;\n  };\n  AccountDeletionSurvey: undefined;\n};\n\nconst Stack = createNativeStackNavigator<SettingsStackParamList>();\n\nexport default function SettingsStack() {\n  return (\n    <Stack.Navigator\n      screenOptions={{\n        headerShown: false,\n      }}\n    >\n      <Stack.Screen name=\"SettingsMain\" component={SettingsScreen} />\n      <Stack.Screen name=\"ProfileSetup\" component={ProfileSetupScreen} />\n      <Stack.Screen name=\"ProfileEdit\" component={ProfileEditScreen} />\n      <Stack.Screen name=\"WebView\" component={WebViewScreen} />\n      <Stack.Screen name=\"AccountDeletionSurvey\" component={AccountDeletionSurveyScreen} />\n    </Stack.Navigator>\n  );\n}","size_bytes":1246},"src/store/analyticsStore.ts":{"content":"import { create } from 'zustand';\nimport { supabase } from '../supabaseClient';\nimport useUserStore from './userStore';\n\nexport interface UserStatistics {\n  totalGoals: number;\n  successGoals: number;\n  failureGoals: number;\n  successRate: number;\n  currentStreak: number;\n  bestStreak: number;\n  bestHour: number;\n  bestDayOfWeek: number;\n  daysSinceStart: number;\n  retrospectCount: number;\n}\n\nexport interface HourlyStats {\n  hour: number;\n  totalGoals: number;\n  successGoals: number;\n  successRate: number;\n}\n\nexport interface DailyStats {\n  dayOfWeek: number;\n  totalGoals: number;\n  successGoals: number;\n  successRate: number;\n}\n\nexport interface AdminInsight {\n  id: string;\n  title: string;\n  description: string;\n  insightType: 'pattern' | 'tip' | 'stats';\n  isActive: boolean;\n  displayOrder: number;\n}\n\ninterface AnalyticsState {\n  statistics: UserStatistics | null;\n  hourlyStats: HourlyStats[];\n  dailyStats: DailyStats[];\n  adminInsights: AdminInsight[];\n  loading: boolean;\n  \n  // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\n  calculateStatistics: () => Promise<void>;\n  fetchHourlyStats: () => Promise<void>;\n  fetchDailyStats: () => Promise<void>;\n  fetchAdminInsights: () => Promise<void>;\n  \n  // í†µê³„ ì—…ë°ì´íŠ¸\n  updateStatistics: () => Promise<void>;\n  \n  // ìœ í‹¸ë¦¬í‹°\n  getBestTimeSlot: () => string;\n  getBestDay: () => string;\n}\n\nconst getDayName = (dayOfWeek: number): string => {\n  const days = ['ì¼ìš”ì¼', 'ì›”ìš”ì¼', 'í™”ìš”ì¼', 'ìˆ˜ìš”ì¼', 'ëª©ìš”ì¼', 'ê¸ˆìš”ì¼', 'í† ìš”ì¼'];\n  return days[dayOfWeek] || 'ì•Œ ìˆ˜ ì—†ìŒ';\n};\n\nconst getTimeSlot = (hour: number): string => {\n  if (hour >= 6 && hour < 12) return 'ì˜¤ì „';\n  if (hour >= 12 && hour < 18) return 'ì˜¤í›„';\n  if (hour >= 18 && hour < 24) return 'ì €ë…';\n  return 'ìƒˆë²½';\n};\n\nexport const useAnalyticsStore = create<AnalyticsState>((set, get) => ({\n  statistics: null,\n  hourlyStats: [],\n  dailyStats: [],\n  adminInsights: [],\n  loading: false,\n\n  calculateStatistics: async () => {\n    console.log('ğŸš¨ğŸš¨ğŸš¨ calculateStatistics í•¨ìˆ˜ ì‹¤í–‰ë¨!!!');\n    const { session } = useUserStore.getState();\n    if (!session) {\n      console.log('âŒ ì„¸ì…˜ ì—†ìŒ, ê³„ì‚° ì¤‘ë‹¨');\n      return;\n    }\n\n    console.log('âœ… ì„¸ì…˜ í™•ì¸ë¨, ê³„ì‚° ì‹œì‘');\n    set({ loading: true });\n    try {\n      // ê¸°ë³¸ í†µê³„ ê³„ì‚°\n      const { data: goals, error: goalsError } = await supabase\n        .from('goals')\n        .select('*')\n        .eq('user_id', session.user.id);\n\n      if (goalsError) throw goalsError;\n\n      const { data: retrospects, error: retrospectError } = await supabase\n        .from('retrospects')\n        .select('*')\n        .eq('user_id', session.user.id);\n\n      if (retrospectError) throw retrospectError;\n\n      const totalGoals = goals?.length || 0;\n      const successGoals = goals?.filter(g => g.status === 'success').length || 0;\n      const failureGoals = goals?.filter(g => g.status === 'failure').length || 0;\n      const successRate = totalGoals > 0 ? Math.round((successGoals / totalGoals) * 100) : 0;\n\n      // ì—°ì† ì„±ê³µ ê³„ì‚° (ìˆ˜ì •ëœ ë¡œì§)\n      const sortedGoals = goals?.sort((a, b) => new Date(b.target_time).getTime() - new Date(a.target_time).getTime()) || [];\n      console.log('ğŸ” ì—°ì† ê¸°ë¡ ê³„ì‚° ì‹œì‘:', {\n        totalGoals: goals?.length,\n        sortedGoalsCount: sortedGoals.length,\n        firstFewGoals: sortedGoals.slice(0, 5).map(g => ({ \n          title: g.title, \n          status: g.status, \n          target_time: g.target_time,\n          korean_date: g.korean_date,\n          created_at: g.created_at\n        })),\n        successCount: goals?.filter(g => g.status === 'success').length,\n        failureCount: goals?.filter(g => g.status === 'failure').length,\n        pendingCount: goals?.filter(g => g.status === 'pending').length\n      });\n      \n      let currentStreak = 0;\n      let bestStreak = 0;\n      let tempStreak = 0;\n      let isCurrentStreakSet = false;\n\n      // ìµœì‹ ë¶€í„° ê³¼ê±°ë¡œ ì§„í–‰í•˜ë©´ì„œ í˜„ì¬ ì—°ì† ê¸°ë¡ ê³„ì‚°\n      for (let i = 0; i < sortedGoals.length; i++) {\n        const goal = sortedGoals[i];\n        if (goal.status === 'pending') {\n          console.log(`â³ [${i}] pending ëª©í‘œ ê±´ë„ˆëœ€:`, { title: goal.title, date: goal.korean_date });\n          continue; // pending ëª©í‘œëŠ” ì œì™¸\n        }\n        \n        console.log(`ğŸ” [${i}] ëª©í‘œ ì²˜ë¦¬ ì¤‘:`, { \n          title: goal.title, \n          status: goal.status, \n          date: goal.korean_date,\n          currentStreak: currentStreak,\n          tempStreak: tempStreak,\n          isCurrentStreakSet: isCurrentStreakSet\n        });\n        \n        if (goal.status === 'success') {\n          tempStreak++;\n          if (tempStreak > bestStreak) bestStreak = tempStreak;\n          \n          // í˜„ì¬ ì—°ì† ê¸°ë¡ì€ ê°€ì¥ ìµœê·¼ë¶€í„° ì‹œì‘í•˜ëŠ” ì—°ì† ì„±ê³µ\n          if (!isCurrentStreakSet) {\n            currentStreak++;\n            console.log(`âœ… [${i}] í˜„ì¬ ì—°ì† ì¦ê°€:`, { goal: goal.title, currentStreak, tempStreak });\n          } else {\n            console.log(`ğŸ“ˆ [${i}] ê³¼ê±° ì„±ê³µ (í˜„ì¬ ì—°ì†ì— ë¯¸ë°˜ì˜):`, { goal: goal.title, tempStreak });\n          }\n        } else if (goal.status === 'failure') {\n          // ì‹¤íŒ¨ê°€ ë‚˜ì˜¤ë©´ í˜„ì¬ ì—°ì† ê¸°ë¡ í™•ì •\n          if (!isCurrentStreakSet) {\n            isCurrentStreakSet = true;\n            console.log(`âŒ [${i}] í˜„ì¬ ì—°ì† í™•ì •:`, { goal: goal.title, finalCurrentStreak: currentStreak });\n          } else {\n            console.log(`ğŸ’¥ [${i}] ê³¼ê±° ì‹¤íŒ¨:`, { goal: goal.title });\n          }\n          tempStreak = 0;\n        }\n      }\n      \n      // ëª¨ë“  ëª©í‘œê°€ ì„±ê³µì¸ ê²½ìš° í˜„ì¬ ì—°ì† = ì „ì²´ ì„±ê³µ ìˆ˜\n      if (!isCurrentStreakSet) {\n        currentStreak = tempStreak;\n        console.log('ğŸ¯ ëª¨ë“  ëª©í‘œ ì„±ê³µ, í˜„ì¬ ì—°ì† = ì „ì²´:', currentStreak);\n      }\n      \n      // 2025/07/18 íŠ¹ë³„ ë””ë²„ê¹…\n      const july18Goals = goals?.filter(g => g.korean_date === '2025-07-18') || [];\n      console.log('ğŸ¯ 2025/07/18 ëª©í‘œë“¤ ìƒì„¸ í™•ì¸:', {\n        ì´ê°œìˆ˜: july18Goals.length,\n        ìƒì„¸ëª©í‘œë“¤: july18Goals.map(g => ({\n          title: g.title,\n          status: g.status,\n          target_time: g.target_time,\n          korean_date: g.korean_date\n        })),\n        ì„±ê³µê°œìˆ˜: july18Goals.filter(g => g.status === 'success').length,\n        ì‹¤íŒ¨ê°œìˆ˜: july18Goals.filter(g => g.status === 'failure').length\n      });\n\n      console.log('ğŸ“Š ìµœì¢… ì—°ì† ê¸°ë¡ ê²°ê³¼:', { \n        currentStreak, \n        bestStreak, \n        totalSuccessGoals: successGoals,\n        ê³„ì‚°ì—ì‚¬ìš©ëœëª©í‘œìˆ˜: sortedGoals.filter(g => g.status !== 'pending').length,\n        ëª¨ë“ ëª©í‘œí˜„í™©: {\n          success: goals?.filter(g => g.status === 'success').length,\n          failure: goals?.filter(g => g.status === 'failure').length,\n          pending: goals?.filter(g => g.status === 'pending').length\n        }\n      });\n\n      // ğŸš¨ ê°•ì œ ë””ë²„ê¹…: ë°ì´í„° ê²€ì¦\n      console.log('ğŸš¨ [ANALYTICS] ê³„ì‚° ì™„ë£Œ - ìƒíƒœ ì—…ë°ì´íŠ¸ ì¤‘:', {\n        ì´ì „í†µê³„: get().statistics,\n        ìƒˆë¡œìš´í†µê³„ì˜ˆìƒ: {\n          totalGoals,\n          successGoals,\n          failureGoals,\n          successRate,\n          currentStreak,\n          bestStreak,\n          retrospectCount: retrospects?.length || 0\n        }\n      });\n\n      // ìµœê³  ì‹œê°„ëŒ€ ê³„ì‚°\n      const hourlySuccess: { [key: number]: { total: number; success: number } } = {};\n      goals?.forEach(goal => {\n        const hour = new Date(goal.target_time).getHours();\n        if (!hourlySuccess[hour]) hourlySuccess[hour] = { total: 0, success: 0 };\n        hourlySuccess[hour].total++;\n        if (goal.status === 'success') hourlySuccess[hour].success++;\n      });\n\n      let bestHour = 0;\n      let bestHourRate = 0;\n      Object.entries(hourlySuccess).forEach(([hour, stats]) => {\n        const rate = stats.total > 0 ? stats.success / stats.total : 0;\n        if (rate > bestHourRate) {\n          bestHourRate = rate;\n          bestHour = parseInt(hour);\n        }\n      });\n\n      // ìµœê³  ìš”ì¼ ê³„ì‚°\n      const dailySuccess: { [key: number]: { total: number; success: number } } = {};\n      goals?.forEach(goal => {\n        const day = new Date(goal.target_time).getDay();\n        if (!dailySuccess[day]) dailySuccess[day] = { total: 0, success: 0 };\n        dailySuccess[day].total++;\n        if (goal.status === 'success') dailySuccess[day].success++;\n      });\n\n      let bestDayOfWeek = 0;\n      let bestDayRate = 0;\n      Object.entries(dailySuccess).forEach(([day, stats]) => {\n        const rate = stats.total > 0 ? stats.success / stats.total : 0;\n        if (rate > bestDayRate) {\n          bestDayRate = rate;\n          bestDayOfWeek = parseInt(day);\n        }\n      });\n\n      // ì‹œì‘ì¼ë¡œë¶€í„° ê²½ê³¼ ì¼ìˆ˜\n      const firstGoal = goals?.sort((a, b) => new Date(a.target_time).getTime() - new Date(b.target_time).getTime())[0];\n      const daysSinceStart = firstGoal ? \n        Math.ceil((Date.now() - new Date(firstGoal.target_time).getTime()) / (1000 * 60 * 60 * 24)) : 0;\n\n      const statistics: UserStatistics = {\n        totalGoals,\n        successGoals,\n        failureGoals,\n        successRate,\n        currentStreak,\n        bestStreak,\n        bestHour,\n        bestDayOfWeek,\n        daysSinceStart,\n        retrospectCount: retrospects?.length || 0\n      };\n\n      console.log('ğŸš¨ ìµœì¢… statistics ê°ì²´:', statistics);\n\n      set({ statistics, loading: false });\n    } catch (error) {\n      console.error('í†µê³„ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);\n      set({ loading: false });\n    }\n  },\n\n  fetchHourlyStats: async () => {\n    const { session } = useUserStore.getState();\n    if (!session) return;\n\n    try {\n      const { data: goals, error } = await supabase\n        .from('goals')\n        .select('*')\n        .eq('user_id', session.user.id);\n\n      if (error) throw error;\n\n      const hourlyStats: HourlyStats[] = [];\n      for (let hour = 0; hour < 24; hour++) {\n        const hourGoals = goals?.filter(g => new Date(g.target_time).getHours() === hour) || [];\n        const totalGoals = hourGoals.length;\n        const successGoals = hourGoals.filter(g => g.status === 'success').length;\n        const successRate = totalGoals > 0 ? Math.round((successGoals / totalGoals) * 100) : 0;\n\n        if (totalGoals > 0) {\n          hourlyStats.push({ hour, totalGoals, successGoals, successRate });\n        }\n      }\n\n      set({ hourlyStats });\n    } catch (error) {\n      console.error('ì‹œê°„ëŒ€ë³„ í†µê³„ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);\n    }\n  },\n\n  fetchDailyStats: async () => {\n    const { session } = useUserStore.getState();\n    if (!session) return;\n\n    try {\n      const { data: goals, error } = await supabase\n        .from('goals')\n        .select('*')\n        .eq('user_id', session.user.id);\n\n      if (error) throw error;\n\n      const dailyStats: DailyStats[] = [];\n      for (let day = 0; day < 7; day++) {\n        const dayGoals = goals?.filter(g => new Date(g.target_time).getDay() === day) || [];\n        const totalGoals = dayGoals.length;\n        const successGoals = dayGoals.filter(g => g.status === 'success').length;\n        const successRate = totalGoals > 0 ? Math.round((successGoals / totalGoals) * 100) : 0;\n\n        if (totalGoals > 0) {\n          dailyStats.push({ dayOfWeek: day, totalGoals, successGoals, successRate });\n        }\n      }\n\n      set({ dailyStats });\n    } catch (error) {\n      console.error('ìš”ì¼ë³„ í†µê³„ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);\n    }\n  },\n\n  fetchAdminInsights: async () => {\n    try {\n      const { data, error } = await supabase\n        .from('admin_insights')\n        .select('*')\n        .eq('is_active', true)\n        .order('display_order');\n\n      if (error) throw error;\n\n      const adminInsights: AdminInsight[] = data?.map(insight => ({\n        id: insight.id,\n        title: insight.title,\n        description: insight.description,\n        insightType: insight.insight_type,\n        isActive: insight.is_active,\n        displayOrder: insight.display_order\n      })) || [];\n\n      set({ adminInsights });\n    } catch (error) {\n      console.error('ê´€ë¦¬ì ì¸ì‚¬ì´íŠ¸ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);\n    }\n  },\n\n  updateStatistics: async () => {\n    const { calculateStatistics, fetchHourlyStats, fetchDailyStats } = get();\n    await Promise.all([\n      calculateStatistics(),\n      fetchHourlyStats(),\n      fetchDailyStats()\n    ]);\n  },\n\n  getBestTimeSlot: () => {\n    const { statistics } = get();\n    if (!statistics || statistics.successGoals === 0) return 'ë°ì´í„° ë¶€ì¡±';\n    return getTimeSlot(statistics.bestHour);\n  },\n\n  getBestDay: () => {\n    const { statistics } = get();\n    if (!statistics || statistics.successGoals === 0) return 'ë°ì´í„° ë¶€ì¡±';\n    return getDayName(statistics.bestDayOfWeek);\n  }\n}));","size_bytes":12871},"src/store/authStore.ts":{"content":"// src/store/authStore.ts\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { create } from 'zustand';\nimport { supabase, supabaseUrl } from '../supabaseClient';\nimport * as WebBrowser from 'expo-web-browser';\nimport * as Linking from 'expo-linking';\nimport { Platform } from 'react-native';\n\ninterface AuthState {\n  isAutoLoginEnabled: boolean;\n  enableAutoLogin: () => Promise<void>;\n  disableAutoLogin: () => Promise<void>;\n  checkAutoLogin: () => Promise<boolean>;\n  performAutoLogin: () => Promise<boolean>;\n  signInWithGoogle: () => Promise<{ success: boolean; error?: string; isNewUser?: boolean }>;\n  signInAsGuest: () => Promise<{ success: boolean; error?: string }>;\n}\n\nexport const useAuthStore = create<AuthState>((set, get) => ({\n  isAutoLoginEnabled: true,\n\n  enableAutoLogin: async () => {\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (session) {\n        await AsyncStorage.setItem('auto_login', 'true');\n        await AsyncStorage.setItem('user_session', JSON.stringify(session));\n        set({ isAutoLoginEnabled: true });\n        // ìë™ ë¡œê·¸ì¸ í™œì„±í™”ë¨\n      }\n    } catch (error) {\n      console.error('ìë™ ë¡œê·¸ì¸ í™œì„±í™” ì‹¤íŒ¨:', error);\n    }\n  },\n\n  disableAutoLogin: async () => {\n    try {\n      await AsyncStorage.removeItem('auto_login');\n      await AsyncStorage.removeItem('user_session');\n      set({ isAutoLoginEnabled: false });\n      // ìë™ ë¡œê·¸ì¸ ë¹„í™œì„±í™”ë¨\n    } catch (error) {\n      console.error('ìë™ ë¡œê·¸ì¸ ë¹„í™œì„±í™” ì‹¤íŒ¨:', error);\n    }\n  },\n\n  checkAutoLogin: async () => {\n    try {\n      const autoLogin = await AsyncStorage.getItem('auto_login');\n      const enabled = autoLogin !== 'false'; // ê¸°ë³¸ê°’ì„ trueë¡œ ì„¤ì •\n      set({ isAutoLoginEnabled: enabled });\n      return enabled;\n    } catch (error) {\n      console.error('ìë™ ë¡œê·¸ì¸ í™•ì¸ ì‹¤íŒ¨:', error);\n      return true; // ì˜¤ë¥˜ ì‹œì—ë„ ê¸°ë³¸ê°’ì„ trueë¡œ\n    }\n  },\n\n  performAutoLogin: async () => {\n    try {\n      // ìë™ ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤ ì‹œì‘\n      \n      // ìë™ ë¡œê·¸ì¸ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ë°”ë¡œ false ë°˜í™˜\n      const autoLogin = await AsyncStorage.getItem('auto_login');\n      // ìë™ ë¡œê·¸ì¸ ì„¤ì • í™•ì¸ë¨\n      \n      if (autoLogin === 'false') {\n        // ìë™ ë¡œê·¸ì¸ì´ ë¹„í™œì„±í™”ë¨\n        return false;\n      }\n\n      // ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ë¨¼ì € í™•ì¸\n      const guestSession = await AsyncStorage.getItem('guest_session');\n      if (guestSession) {\n        try {\n          const session = JSON.parse(guestSession);\n          console.log('ğŸ­ Guest session found - validating');\n          \n          if (session?.user?.is_anonymous && session?.access_token && session?.refresh_token) {\n            console.log('ğŸ­ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ë³µì› ì‹œë„...');\n            \n            // Supabaseì— ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ì„¤ì •\n            const { data: sessionData, error: setSessionError } = await supabase.auth.setSession({\n              access_token: session.access_token,\n              refresh_token: session.refresh_token\n            });\n            \n            if (!setSessionError && sessionData?.session) {\n              console.log('âœ… Guest session restored successfully');\n              \n              // ê²ŒìŠ¤íŠ¸ í”„ë¡œí•„ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸\n              const { data: guestProfile, error: profileError } = await supabase\n                .from('profiles')\n                .select('*')\n                .eq('id', sessionData.session.user.id)\n                .single();\n\n              if (profileError || !guestProfile) {\n                console.log('ğŸ­ ê²ŒìŠ¤íŠ¸ í”„ë¡œí•„ ì—†ìŒ - ProfileSetupìœ¼ë¡œ ì´ë™');\n              } else {\n                console.log('ğŸ­ ê¸°ì¡´ ê²ŒìŠ¤íŠ¸ í”„ë¡œí•„ í™•ì¸ë¨');\n              }\n              \n              return true;\n            } else {\n              console.log('âš ï¸ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ë³µì› ì‹¤íŒ¨:', setSessionError?.message);\n              console.log('ğŸ—‘ï¸ ë§Œë£Œëœ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ì‚­ì œ');\n              await AsyncStorage.removeItem('guest_session');\n            }\n          } else {\n            console.log('âš ï¸ ì˜ëª»ëœ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ í˜•ì‹ ë˜ëŠ” í† í° ëˆ„ë½');\n            await AsyncStorage.removeItem('guest_session');\n          }\n        } catch (error) {\n          console.error('âŒ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ íŒŒì‹± ì˜¤ë¥˜:', error);\n          await AsyncStorage.removeItem('guest_session');\n        }\n      } else {\n        console.log('ğŸ“ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ì—†ìŒ');\n      }\n\n      // ì €ì¥ëœ ì¼ë°˜ ì„¸ì…˜ í™•ì¸\n      const savedSession = await AsyncStorage.getItem('user_session');\n      console.log('ğŸ” ì €ì¥ëœ ì„¸ì…˜:', savedSession ? 'ìˆìŒ' : 'ì—†ìŒ');\n      \n      if (!savedSession) {\n        console.log('âŒ ì €ì¥ëœ ì„¸ì…˜ ì—†ìŒ');\n        return false;\n      }\n\n      // í˜„ì¬ ì„¸ì…˜ í™•ì¸\n      const { data: { session: currentSession }, error } = await supabase.auth.getSession();\n      console.log('ğŸ” í˜„ì¬ Supabase ì„¸ì…˜:', currentSession ? 'ìˆìŒ' : 'ì—†ìŒ');\n      \n      if (error) {\n        console.log('âŒ ì„¸ì…˜ í™•ì¸ ì˜¤ë¥˜:', error.message);\n        return false;\n      }\n      \n      if (!currentSession) {\n        // ì €ì¥ëœ ì„¸ì…˜ìœ¼ë¡œ ë³µì› ì‹œë„\n        try {\n          const parsedSession = JSON.parse(savedSession);\n          console.log('ğŸ”„ ì €ì¥ëœ ì„¸ì…˜ìœ¼ë¡œ ë³µì› ì‹œë„...');\n          \n          // ì„¸ì…˜ ë³µì› ì‹œë„ì— íƒ€ì„ì•„ì›ƒ ì„¤ì •\n          const sessionPromise = supabase.auth.setSession({\n            access_token: parsedSession.access_token,\n            refresh_token: parsedSession.refresh_token\n          });\n          \n          const timeoutPromise = new Promise<never>((_, reject) => \n            setTimeout(() => reject(new Error('ì„¸ì…˜ ë³µì› íƒ€ì„ì•„ì›ƒ')), 5000)\n          );\n          \n          const sessionResult = await Promise.race([sessionPromise, timeoutPromise]);\n          const { data, error: setError } = sessionResult;\n          \n          if (setError) {\n            console.log('âŒ ì„¸ì…˜ ë³µì› ì‹¤íŒ¨:', setError.message);\n            // ì‹¤íŒ¨í•œ ì„¸ì…˜ ì •ë³´ ì‚­ì œ\n            await AsyncStorage.removeItem('user_session');\n            return false;\n          }\n          \n          console.log('âœ… ì„¸ì…˜ ë³µì› ì„±ê³µ');\n          return true;\n        } catch (parseError) {\n          console.log('âŒ ì„¸ì…˜ íŒŒì‹±/ë³µì› ì˜¤ë¥˜:', parseError);\n          // ì†ìƒëœ ì„¸ì…˜ ì •ë³´ ì‚­ì œ\n          await AsyncStorage.removeItem('user_session');\n          await AsyncStorage.removeItem('auto_login');\n          return false;\n        }\n      }\n\n      console.log('âœ… ìë™ ë¡œê·¸ì¸ ì„±ê³µ - í˜„ì¬ ì„¸ì…˜ ìœ íš¨');\n      return true;\n    } catch (error) {\n      console.error('âŒ ìë™ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error);\n      return false;\n    }\n  },\n\n  signInWithGoogle: async () => {\n    try {\n      console.log('ğŸ”„ Google ë¡œê·¸ì¸ ì‹œì‘...');\n      \n      // Supabase OAuth ì‚¬ìš© (ì›¹ í´ë¼ì´ì–¸íŠ¸ IDë¡œ ì„¤ì •)\n      const { data, error } = await supabase.auth.signInWithOAuth({\n        provider: 'google',\n        options: {\n          queryParams: {\n            access_type: 'offline',\n            prompt: 'consent',\n          },\n        },\n      });\n\n      if (error) {\n        console.error('âŒ OAuth URL ìƒì„± ì‹¤íŒ¨:', error);\n        return { success: false, error: error.message };\n      }\n\n      if (!data?.url) {\n        console.error('âŒ OAuth URLì´ ì—†ìŠµë‹ˆë‹¤');\n        return { success: false, error: 'OAuth URL ìƒì„± ì‹¤íŒ¨' };\n      }\n\n      console.log('ğŸŒ Google OAuth initialized');\n      \n      // URL ë¶„ì„\n      try {\n        const urlObj = new URL(data.url);\n        console.log('ğŸ” OAuth parameters configured');\n        console.log('- OAuth parameters configured');\n      } catch (e) {\n        console.log('OAuth configuration validated');\n      }\n\n      // ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ Google OAuth ì—´ê¸°\n      const result = await WebBrowser.openAuthSessionAsync(\n        data.url,\n        `${supabaseUrl}/auth/v1/callback`\n      );\n\n      if (result.type === 'cancel') {\n        console.log('ğŸš« ì‚¬ìš©ìê°€ Google ë¡œê·¸ì¸ì„ ì·¨ì†Œí–ˆìŠµë‹ˆë‹¤');\n        return { success: false, error: 'ë¡œê·¸ì¸ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤' };\n      }\n\n      if (result.type !== 'success') {\n        console.error('âŒ Google ë¡œê·¸ì¸ ì‹¤íŒ¨:', result);\n        return { success: false, error: 'Google ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤' };\n      }\n\n      console.log('âœ… Google OAuth callback received');\n\n      // URLì—ì„œ ì„¸ì…˜ ì •ë³´ ì¶”ì¶œ ì‹œë„\n      const callbackUrl = result.url;\n      console.log('ğŸ” Processing authentication callback');\n      \n      // Supabase ì„¸ì…˜ ìë™ ì²˜ë¦¬ ëŒ€ê¸° (ë” ê¸´ ì‹œê°„)\n      let attempts = 0;\n      const maxAttempts = 40; // 20ì´ˆë¡œ ì¦ê°€\n      \n      while (attempts < maxAttempts) {\n        try {\n          // ì„¸ì…˜ ìƒˆë¡œê³ ì¹¨ ì‹œë„\n          const { data: sessionData, error: sessionError } = await supabase.auth.refreshSession();\n          \n          if (!sessionError && sessionData?.session) {\n            console.log('âœ… ì„¸ì…˜ ìƒˆë¡œê³ ì¹¨ìœ¼ë¡œ Google ë¡œê·¸ì¸ í™•ì¸ë¨');\n            const session = sessionData.session;\n            \n            // í”„ë¡œí•„ ì²˜ë¦¬\n            const { data: profile, error: profileError } = await supabase\n              .from('profiles')\n              .select('*')\n              .eq('user_id', session.user.id)\n              .single();\n\n            const isNewUser = !profile || !!profileError;\n            console.log('ğŸ‘¤ ì‚¬ìš©ì ìƒíƒœ:', isNewUser ? 'ì‹ ê·œ ì‚¬ìš©ì' : 'ê¸°ì¡´ ì‚¬ìš©ì');\n\n            if (isNewUser && session.user) {\n              const user = session.user;\n              const { error: createError } = await supabase\n                .from('profiles')\n                .insert({\n                  user_id: user.id,\n                  email: user.email,\n                  display_name: user.user_metadata?.full_name || user.email?.split('@')[0] || 'ì‚¬ìš©ì',\n                  google_id: user.user_metadata?.sub,\n                  profile_picture_url: user.user_metadata?.avatar_url,\n                  created_at: new Date().toISOString(),\n                });\n\n              if (createError) {\n                console.error('âŒ í”„ë¡œí•„ ìƒì„± ì‹¤íŒ¨:', createError);\n              } else {\n                console.log('âœ… Google ì‚¬ìš©ì í”„ë¡œí•„ ìƒì„± ì™„ë£Œ');\n              }\n            }\n\n            await AsyncStorage.setItem('auto_login', 'true');\n            await AsyncStorage.setItem('user_session', JSON.stringify(session));\n\n            return { \n              success: true, \n              isNewUser: Boolean(isNewUser)\n            };\n          }\n          \n          // ì¼ë°˜ ì„¸ì…˜ í™•ì¸\n          const { data: session } = await supabase.auth.getSession();\n          if (session?.session) {\n            console.log('âœ… ì¼ë°˜ ì„¸ì…˜ìœ¼ë¡œ Google ë¡œê·¸ì¸ í™•ì¸ë¨');\n            \n            const { data: profile, error: profileError } = await supabase\n              .from('profiles')\n              .select('*')\n              .eq('user_id', session.session.user.id)\n              .single();\n\n            const isNewUser = !profile || !!profileError;\n            console.log('ğŸ‘¤ ì‚¬ìš©ì ìƒíƒœ:', isNewUser ? 'ì‹ ê·œ ì‚¬ìš©ì' : 'ê¸°ì¡´ ì‚¬ìš©ì');\n\n            if (isNewUser && session.session.user) {\n              const user = session.session.user;\n              const { error: createError } = await supabase\n                .from('profiles')\n                .insert({\n                  user_id: user.id,\n                  email: user.email,\n                  display_name: user.user_metadata?.full_name || user.email?.split('@')[0] || 'ì‚¬ìš©ì',\n                  google_id: user.user_metadata?.sub,\n                  profile_picture_url: user.user_metadata?.avatar_url,\n                  created_at: new Date().toISOString(),\n                });\n\n              if (createError) {\n                console.error('âŒ í”„ë¡œí•„ ìƒì„± ì‹¤íŒ¨:', createError);\n              } else {\n                console.log('âœ… Google ì‚¬ìš©ì í”„ë¡œí•„ ìƒì„± ì™„ë£Œ');\n              }\n            }\n\n            await AsyncStorage.setItem('auto_login', 'true');\n            await AsyncStorage.setItem('user_session', JSON.stringify(session.session));\n\n            return { \n              success: true, \n              isNewUser: Boolean(isNewUser)\n            };\n          }\n        } catch (error) {\n          console.log('ğŸ”„ ì„¸ì…˜ í™•ì¸ ì¬ì‹œë„...', attempts + 1);\n        }\n        \n        attempts++;\n        await new Promise(resolve => setTimeout(resolve, 500));\n      }\n\n      console.log('âš ï¸ Expo Go í™˜ê²½ì—ì„œëŠ” Google ë¡œê·¸ì¸ ì œí•œì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤');\n      console.log('ğŸ“± ì‹¤ì œ ë°°í¬ ì‹œì—ëŠ” ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤');\n      return { success: false, error: 'Expo Go í™˜ê²½ì—ì„œëŠ” OAuth ì„¸ì…˜ ì²˜ë¦¬ì— ì œí•œì´ ìˆìŠµë‹ˆë‹¤' };\n\n    } catch (error) {\n      console.error('âŒ Google ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);\n      return { \n        success: false, \n        error: error instanceof Error ? error.message : 'Google ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤' \n      };\n    }\n  },\n\n  signInAsGuest: async () => {\n    try {\n      console.log('ğŸš€ ê²ŒìŠ¤íŠ¸ ë¡œê·¸ì¸ ì‹œì‘...');\n      \n      // ê¸°ì¡´ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ í™•ì¸\n      const { data: { session: existingSession } } = await supabase.auth.getSession();\n      \n      if (existingSession?.user?.is_anonymous) {\n        console.log('âœ… ê¸°ì¡´ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ìœ ì§€');\n        await AsyncStorage.setItem('guest_session', JSON.stringify(existingSession));\n        return { success: true };\n      }\n      \n      // ìƒˆë¡œìš´ ìµëª… ë¡œê·¸ì¸\n      const { data, error } = await supabase.auth.signInAnonymously();\n      \n      if (error) {\n        console.error('âŒ ê²ŒìŠ¤íŠ¸ ë¡œê·¸ì¸ ì‹¤íŒ¨:', error.message);\n        return { success: false, error: error.message };\n      }\n      \n      if (data.session) {\n        console.log('âœ… ê²ŒìŠ¤íŠ¸ ë¡œê·¸ì¸ ì„±ê³µ');\n        \n        // ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ì„ AsyncStorageì— ì €ì¥í•˜ì—¬ ì§€ì†ì„± í™•ë³´\n        await AsyncStorage.setItem('guest_session', JSON.stringify(data.session));\n        console.log('ğŸ’¾ ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ì €ì¥ ì™„ë£Œ');\n        \n        // ê²ŒìŠ¤íŠ¸ë„ í”„ë¡œí•„ ì„¤ì • í™”ë©´ì„ ê±°ì¹˜ë„ë¡ ìë™ ìƒì„±í•˜ì§€ ì•ŠìŒ\n        console.log('ğŸ­ ê²ŒìŠ¤íŠ¸ ëª¨ë“œ: ProfileSetupìœ¼ë¡œ ì´ë™ ì˜ˆì •');\n        \n        // ê²ŒìŠ¤íŠ¸ë„ ìë™ ë¡œê·¸ì¸ í™œì„±í™”\n        await AsyncStorage.setItem('auto_login', 'true');\n        await AsyncStorage.setItem('user_session', JSON.stringify(data.session));\n        console.log('âœ… ê²ŒìŠ¤íŠ¸ ìë™ ë¡œê·¸ì¸ í™œì„±í™”');\n        \n        return { success: true };\n      }\n      \n      return { success: false, error: 'ê²ŒìŠ¤íŠ¸ ì„¸ì…˜ ìƒì„± ì‹¤íŒ¨' };\n    } catch (error) {\n      console.error('âŒ ê²ŒìŠ¤íŠ¸ ë¡œê·¸ì¸ ì˜¤ë¥˜:', error);\n      return { success: false, error: 'ê²ŒìŠ¤íŠ¸ ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' };\n    }\n  },\n}));\n\nexport default useAuthStore;","size_bytes":15107},"src/store/communityStore.ts":{"content":"import { create } from 'zustand';\nimport { supabase } from '../supabaseClient';\nimport { nanoid } from 'nanoid/non-secure';\n\nexport interface DailyResolution {\n  id: string;\n  user_id: string;\n  content: string;\n  date: string;\n  created_at: string;\n  updated_at: string;\n  display_name: string;\n  like_count: number;\n  is_liked_by_current_user: boolean;\n}\n\nexport type FilterType = 'recent' | 'popular' | 'random';\n\ninterface CommunityState {\n  resolutions: DailyResolution[];\n  myResolution: DailyResolution | null;\n  loading: boolean;\n  currentFilter: FilterType;\n  \n  // ë‚´ ê°ì˜¤ ê´€ë ¨\n  fetchMyResolution: () => Promise<void>;\n  saveMyResolution: (content: string) => Promise<void>;\n  updateMyResolution: (content: string) => Promise<void>;\n  deleteMyResolution: () => Promise<void>;\n  \n  // ì»¤ë®¤ë‹ˆí‹° ê°ì˜¤ ê´€ë ¨\n  fetchResolutions: (filter?: FilterType) => Promise<void>;\n  toggleLike: (resolutionId: string) => Promise<void>;\n  setFilter: (filter: FilterType) => void;\n  \n  // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸\n  refreshResolutions: () => Promise<void>;\n  \n  // ë°ì´í„° ì´ˆê¸°í™”\n  clearAllResolutions?: () => void;\n}\n\nconst getTodayString = () => {\n  // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ ë‚ ì§œ ë°˜í™˜ (Intl API ì‚¬ìš©)\n  const now = new Date();\n  const koreaTimeString = now.toLocaleString(\"en-CA\", {\n    timeZone: \"Asia/Seoul\",\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n  });\n  return koreaTimeString;\n};\n\nconst getYesterdayString = () => {\n  // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì–´ì œ ë‚ ì§œ ë°˜í™˜ (ì»¤ë®¤ë‹ˆí‹°ì—ì„œ í‘œì‹œí•  ë‹¤ì§ë“¤)\n  const now = new Date();\n  const yesterday = new Date(now.getTime() - 24 * 60 * 60 * 1000);\n  const koreaTimeString = yesterday.toLocaleString(\"en-CA\", {\n    timeZone: \"Asia/Seoul\",\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n  });\n  return koreaTimeString;\n};\n\nconst getTomorrowString = () => {\n  // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚´ì¼ ë‚ ì§œ ë°˜í™˜ (Date value out of bounds ì˜¤ë¥˜ ë°©ì§€)\n  const now = new Date();\n  const tomorrow = new Date(now.getTime() + 24 * 60 * 60 * 1000);\n  const koreaTimeString = tomorrow.toLocaleString(\"en-CA\", {\n    timeZone: \"Asia/Seoul\",\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n  });\n  console.log('ğŸ” getTomorrowString ê³„ì‚°:', { \n    utcNow: now.toISOString(), \n    tomorrow: koreaTimeString \n  });\n  return koreaTimeString;\n};\n\nconst useCommunityStore = create<CommunityState>((set, get) => ({\n  resolutions: [],\n  myResolution: null,\n  loading: false,\n  currentFilter: 'recent',\n\n  fetchMyResolution: async () => {\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      const tomorrow = getTomorrowString(); // ë‚´ì¼ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ ì¡°íšŒ\n      \n      if (session) {\n        // ì •ì‹ íšŒì› - Supabaseì—ì„œ ì¡°íšŒ\n        const { data, error } = await supabase\n          .from('daily_resolutions')\n          .select('*')\n          .eq('user_id', session.user.id)\n          .eq('date', tomorrow)\n          .single();\n\n        if (error && error.code !== 'PGRST116') {\n          console.error('ë‚´ ê°ì˜¤ ì¡°íšŒ ì˜¤ë¥˜:', error);\n          return;\n        }\n\n        set({ myResolution: data || null });\n      } else {\n        // ê²ŒìŠ¤íŠ¸ ëª¨ë“œë„ Supabase ì‚¬ìš© - ê²ŒìŠ¤íŠ¸ìš© ì„ì‹œ ë°ì´í„°ëŠ” í‘œì‹œí•˜ì§€ ì•ŠìŒ\n        set({ myResolution: null });\n      }\n    } catch (error) {\n      console.error('ë‚´ ê°ì˜¤ ì¡°íšŒ ì‹¤íŒ¨:', error);\n    }\n  },\n\n  saveMyResolution: async (content: string) => {\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      const tomorrow = getTomorrowString(); // ë‚´ì¼ ë‚ ì§œë¡œ ì €ì¥\n      \n      // ë¡œê·¸ì¸ ì‚¬ìš©ìë“  ê²ŒìŠ¤íŠ¸ë“  ëª¨ë‘ Supabase ì‚¬ìš©\n      const userId = session?.user?.id || `guest_${nanoid()}`;\n      \n      const { data, error } = await supabase\n        .from('daily_resolutions')\n        .insert([{\n          user_id: userId,\n          content,\n          date: tomorrow,\n        }])\n        .select()\n        .single();\n\n      if (error) {\n        console.error('ğŸš« Supabase ê°ì˜¤ ì €ì¥ ì˜¤ë¥˜ (ìƒì„¸):', {\n          errorCode: error.code,\n          errorMessage: error.message,\n          errorDetails: error.details,\n          errorHint: error.hint,\n          targetDate: tomorrow,\n          userId: userId,\n          isGuest: !session,\n          content: content?.substring(0, 50) + '...'\n        });\n        \n        if (error.code === '23505') {\n          // ì¤‘ë³µ ì˜¤ë¥˜ ì‹œ ê¸°ì¡´ ë°ì´í„° ì¡°íšŒí•´ì„œ ìˆ˜ì • ëª¨ë“œë¡œ ì „í™˜\n          const { data: existingData } = await supabase\n            .from('daily_resolutions')\n            .select('*')\n            .eq('user_id', userId)\n            .eq('date', tomorrow)\n            .single();\n          \n          if (existingData) {\n            set({ myResolution: existingData });\n            throw new Error('ë‚´ì¼ì˜ ê°ì˜¤ë¥¼ ì´ë¯¸ ì‘ì„±í•˜ì…¨ìŠµë‹ˆë‹¤.\\nìˆ˜ì •ì„ ì›í•˜ì‹œë©´ í¸ì§‘ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.');\n          }\n        }\n        \n        // RLS ì •ì±… ì˜¤ë¥˜ ì²˜ë¦¬\n        if (error.code === '42501' || error.message?.includes('RLS')) {\n          throw new Error('ë°ì´í„°ë² ì´ìŠ¤ ê¶Œí•œ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');\n        }\n        \n        throw new Error(`ì €ì¥ ì‹¤íŒ¨: ${error.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);\n      }\n\n      set({ myResolution: data });\n      \n      // ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ ì»¤ë®¤ë‹ˆí‹° ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (ê²ŒìŠ¤íŠ¸ëŠ” ê±´ë„ˆëœ€)\n      if (session) {\n        await get().refreshResolutions();\n      }\n    } catch (error) {\n      console.error('ğŸš« ê°ì˜¤ ì €ì¥ ì‹¤íŒ¨:', error);\n      \n      // ì•ˆì „í•œ ì—ëŸ¬ ë©”ì‹œì§€ ì¶”ì¶œ\n      let errorMessage = 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜';\n      if (error && typeof error === 'object') {\n        if ('message' in error && typeof error.message === 'string') {\n          errorMessage = error.message;\n        } else if (typeof error.toString === 'function') {\n          errorMessage = error.toString();\n        }\n      } else if (typeof error === 'string') {\n        errorMessage = error;\n      }\n      \n      throw new Error(`ê°ì˜¤ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ${errorMessage}`);\n    }\n  },\n\n  updateMyResolution: async (content: string) => {\n    try {\n      const { myResolution } = get();\n      if (!myResolution) throw new Error('ìˆ˜ì •í•  ê°ì˜¤ê°€ ì—†ìŠµë‹ˆë‹¤');\n\n      // ëª¨ë“  ê°ì˜¤ ìˆ˜ì •ì€ Supabaseì—ì„œ ì²˜ë¦¬\n      const { data, error } = await supabase\n        .from('daily_resolutions')\n        .update({ \n          content,\n          updated_at: new Date().toISOString()\n        })\n        .eq('id', myResolution.id)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      set({ myResolution: data });\n      \n      // ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ ì»¤ë®¤ë‹ˆí‹° ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (ê²ŒìŠ¤íŠ¸ëŠ” ê±´ë„ˆëœ€)\n      const { data: { session } } = await supabase.auth.getSession();\n      if (session) {\n        await get().refreshResolutions();\n      }\n    } catch (error) {\n      console.error('ê°ì˜¤ ìˆ˜ì • ì‹¤íŒ¨:', error);\n      throw error;\n    }\n  },\n\n  deleteMyResolution: async () => {\n    try {\n      const { myResolution } = get();\n      if (!myResolution) throw new Error('ì‚­ì œí•  ê°ì˜¤ê°€ ì—†ìŠµë‹ˆë‹¤');\n\n      // ëª¨ë“  ê°ì˜¤ ì‚­ì œëŠ” Supabaseì—ì„œ ì²˜ë¦¬\n      const { error } = await supabase\n        .from('daily_resolutions')\n        .delete()\n        .eq('id', myResolution.id);\n\n      if (error) throw error;\n\n      set({ myResolution: null });\n      \n      // ë¡œê·¸ì¸ ì‚¬ìš©ìë§Œ ì»¤ë®¤ë‹ˆí‹° ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (ê²ŒìŠ¤íŠ¸ëŠ” ê±´ë„ˆëœ€)\n      const { data: { session } } = await supabase.auth.getSession();\n      if (session) {\n        await get().refreshResolutions();\n      }\n    } catch (error) {\n      console.error('ê°ì˜¤ ì‚­ì œ ì‹¤íŒ¨:', error);\n      throw error;\n    }\n  },\n\n  fetchResolutions: async (filter: FilterType = 'recent') => {\n    try {\n      set({ loading: true, currentFilter: filter });\n\n      // ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ìëŠ” ë°ì´í„°ë² ì´ìŠ¤ ì¡°íšŒ ì—†ì´ ë¹ˆ ë°°ì—´ ë°˜í™˜\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) {\n        set({ resolutions: [], loading: false });\n        return;\n      }\n\n      let query = supabase\n        .from('resolutions_with_likes')\n        .select('*')\n        .eq('date', getYesterdayString()) // ì–´ì œ ì‘ì„±í•œ ë‹¤ì§ë“¤ì„ ì˜¤ëŠ˜ í‘œì‹œ\n        .not('user_id', 'eq', session.user.id); // ìì‹ ì˜ ê°ì˜¤ëŠ” ì œì™¸ (ì´ë¯¸ ë‚´ ê°ì˜¤ë¡œ ë”°ë¡œ í‘œì‹œ)\n\n      switch (filter) {\n        case 'popular':\n          query = query.order('like_count', { ascending: false });\n          break;\n        case 'recent':\n        default:\n          query = query.order('created_at', { ascending: false });\n          break;\n      }\n\n      const { data, error } = await query.limit(50);\n\n      if (error) {\n        console.error('ê°ì˜¤ ëª©ë¡ ì¡°íšŒ ì˜¤ë¥˜:', error);\n        return;\n      }\n\n      let resolutions = data || [];\n\n      // ëœë¤ í•„í„°ì˜ ê²½ìš° í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì…”í”Œ\n      if (filter === 'random') {\n        resolutions = [...resolutions].sort(() => Math.random() - 0.5);\n      }\n\n      set({ resolutions, loading: false });\n    } catch (error) {\n      console.error('ê°ì˜¤ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:', error);\n      set({ loading: false });\n    }\n  },\n\n  toggleLike: async (resolutionId: string) => {\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) {\n        console.log('ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ìëŠ” ì¢‹ì•„ìš” ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');\n        return;\n      }\n\n      const { resolutions } = get();\n      const resolution = resolutions.find(r => r.id === resolutionId);\n      if (!resolution) return;\n\n      if (resolution.is_liked_by_current_user) {\n        // ì¢‹ì•„ìš” ì·¨ì†Œ\n        const { error } = await supabase\n          .from('resolution_likes')\n          .delete()\n          .eq('user_id', session.user.id)\n          .eq('resolution_id', resolutionId);\n\n        if (error) throw error;\n      } else {\n        // ì¢‹ì•„ìš” ì¶”ê°€\n        const { error } = await supabase\n          .from('resolution_likes')\n          .insert([{\n            user_id: session.user.id,\n            resolution_id: resolutionId,\n          }]);\n\n        if (error) throw error;\n      }\n\n      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\n      const updatedResolutions = resolutions.map(r => {\n        if (r.id === resolutionId) {\n          return {\n            ...r,\n            is_liked_by_current_user: !r.is_liked_by_current_user,\n            like_count: r.is_liked_by_current_user ? r.like_count - 1 : r.like_count + 1\n          };\n        }\n        return r;\n      });\n\n      // ë‚´ ê°ì˜¤ë„ ì—…ë°ì´íŠ¸ (ë§Œì•½ ì¢‹ì•„ìš” í•œ ê²Œ ë‚´ ê°ì˜¤ë¼ë©´)\n      const { myResolution } = get();\n      if (myResolution && myResolution.id === resolutionId) {\n        const updatedMyResolution = {\n          ...myResolution,\n          is_liked_by_current_user: !myResolution.is_liked_by_current_user,\n          like_count: myResolution.is_liked_by_current_user ? myResolution.like_count - 1 : myResolution.like_count + 1\n        };\n        set({ resolutions: updatedResolutions, myResolution: updatedMyResolution });\n      } else {\n        set({ resolutions: updatedResolutions });\n      }\n    } catch (error) {\n      console.error('ì¢‹ì•„ìš” í† ê¸€ ì‹¤íŒ¨:', error);\n      throw error;\n    }\n  },\n\n  setFilter: (filter: FilterType) => {\n    set({ currentFilter: filter });\n  },\n\n  refreshResolutions: async () => {\n    try {\n      // ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ìëŠ” ì»¤ë®¤ë‹ˆí‹° ë°ì´í„° ìƒˆë¡œê³ ì¹¨ ë¶ˆê°€\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) {\n        console.log('ê²ŒìŠ¤íŠ¸ ì‚¬ìš©ìëŠ” ì»¤ë®¤ë‹ˆí‹° ìƒˆë¡œê³ ì¹¨ì„ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤');\n        return;\n      }\n      \n      const { currentFilter } = get();\n      await get().fetchResolutions(currentFilter);\n    } catch (error) {\n      console.error('ì»¤ë®¤ë‹ˆí‹° ìƒˆë¡œê³ ì¹¨ ì‹¤íŒ¨:', error);\n    }\n  },\n\n  // ë°ì´í„° ì´ˆê¸°í™” í•¨ìˆ˜\n  clearAllResolutions: async () => {\n    console.log(\"ğŸ§¹ ëª¨ë“  ê°ì˜¤ ë°ì´í„° ë¡œì»¬ ìŠ¤í† ì–´ ì´ˆê¸°í™”\");\n    \n    set({ \n      resolutions: [],\n      myResolution: null,\n      currentFilter: 'recent'\n    });\n  },\n}));\n\nexport default useCommunityStore;","size_bytes":12298},"src/store/flexibleGoalStore.ts":{"content":"import { create } from 'zustand';\nimport { supabase } from '../supabaseClient';\nimport { getTodayString } from '../utils/dateHelpers';\nimport { getTodayKorea, getTomorrowKorea } from '../utils/timeUtils';\n\nexport interface FlexibleGoal {\n  id: string;\n  user_id: string;\n  title: string;\n  goal_type: 'daily'; // ë‹¨ì¼ íƒ€ì…ìœ¼ë¡œ ë‹¨ìˆœí™”\n  date: string; // YYYY-MM-DD\n  status: 'pending' | 'success' | 'failure';\n  created_at: string;\n  updated_at: string;\n}\n\ninterface FlexibleGoalState {\n  goals: FlexibleGoal[];\n  \n  // ë°ì´í„° ê´€ë¦¬\n  fetchGoals: (date?: string) => Promise<void>;\n  addGoal: (title: string, date?: string) => Promise<void>;\n  updateGoal: (id: string, updates: Partial<FlexibleGoal>) => Promise<void>;\n  deleteGoal: (id: string) => Promise<void>;\n  checkGoal: (id: string) => Promise<void>;\n  \n  // ìœ í‹¸ë¦¬í‹°\n  getGoalsByDate: (date: string) => FlexibleGoal[];\n  getTodayGoals: () => FlexibleGoal[];\n  getTomorrowGoals: () => FlexibleGoal[];\n  getTodayStats: () => {\n    total: number;\n    success: number;\n    failure: number;\n    pending: number;\n    successRate: number;\n  };\n  \n  // ëª©í‘œ ì¡´ì¬ í™•ì¸\n  hasTodayGoal: (date?: string) => boolean;\n  hasTomorrowGoal: () => boolean;\n  \n  // ë°ì´í„° ì´ˆê¸°í™”\n  clearAllFlexibleGoals?: () => void;\n}\n\nexport const useFlexibleGoalStore = create<FlexibleGoalState>((set, get) => ({\n  goals: [],\n\n  fetchGoals: async (date?: string) => {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session) return;\n\n    try {\n      let query = supabase\n        .from('flexible_goals')\n        .select('*')\n        .eq('user_id', session.user.id)\n        .order('created_at', { ascending: false });\n\n      if (date) {\n        query = query.eq('date', date);\n      }\n\n      const { data, error } = await query;\n      if (error) throw error;\n\n      const goals: FlexibleGoal[] = data?.map(item => ({\n        id: item.id,\n        user_id: item.user_id,\n        title: item.title,\n        goal_type: item.goal_type,\n        date: item.date,\n        status: item.status,\n        created_at: item.created_at,\n        updated_at: item.updated_at\n      })) || [];\n\n      set({ goals });\n    } catch (error) {\n      console.error('ìœ ì—°í•œ ëª©í‘œ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:', error);\n    }\n  },\n\n  addGoal: async (title: string, date?: string) => {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session) return;\n\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ì„¤ì • (tomorrow-first ì›Œí¬í”Œë¡œìš°)\n    const targetDate = date || getTomorrowKorea();\n    \n    // í•´ë‹¹ ë‚ ì§œì— ì´ë¯¸ ëª©í‘œê°€ ìˆëŠ”ì§€ í™•ì¸\n    const existingGoal = get().goals.find(g => g.date === targetDate);\n    console.log(\"ğŸ” FlexibleGoalStore ì¤‘ë³µ ê²€ì‚¬:\", {\n      targetDate,\n      existingGoal: existingGoal ? { id: existingGoal.id, title: existingGoal.title, date: existingGoal.date } : null,\n      í˜„ì¬ëª©í‘œê°œìˆ˜: get().goals.length\n    });\n    \n    if (existingGoal) {\n      throw new Error('í•´ë‹¹ ë‚ ì§œì˜ ëª©í‘œë¥¼ ì´ë¯¸ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.');\n    }\n    \n    try {\n      const { data, error } = await supabase\n        .from('flexible_goals')\n        .insert([{\n          user_id: session.user.id,\n          title,\n          goal_type: 'daily',\n          date: targetDate,\n          status: 'pending'\n        }])\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      const newGoal: FlexibleGoal = {\n        id: data.id,\n        user_id: data.user_id,\n        title: data.title,\n        goal_type: data.goal_type,\n        date: data.date,\n        status: data.status,\n        created_at: data.created_at,\n        updated_at: data.updated_at\n      };\n\n      set(state => ({\n        goals: [newGoal, ...state.goals]\n      }));\n\n      console.log('âœ… ìœ ì—°í•œ ëª©í‘œ ì¶”ê°€:', newGoal);\n    } catch (error) {\n      console.error('ìœ ì—°í•œ ëª©í‘œ ì¶”ê°€ ì˜¤ë¥˜:', error);\n      // ì‚¬ìš©ìì—ê²Œ ì¹œí™”ì ì¸ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ\n      if (error && typeof error === 'object' && 'message' in error) {\n        const errorMessage = (error as any).message;\n        if (errorMessage?.includes('relation \"flexible_goals\" does not exist')) {\n          console.error('ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');\n        } else {\n          console.error('ëª©í‘œ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\n        }\n      }\n      throw error;\n    }\n  },\n\n  updateGoal: async (id: string, updates: Partial<FlexibleGoal>) => {\n    try {\n      const { error } = await supabase\n        .from('flexible_goals')\n        .update(updates)\n        .eq('id', id);\n\n      if (error) throw error;\n\n      set(state => ({\n        goals: state.goals.map(goal =>\n          goal.id === id \n            ? { ...goal, ...updates, updated_at: new Date().toISOString() }\n            : goal\n        )\n      }));\n\n      console.log('âœ… ìœ ì—°í•œ ëª©í‘œ ì—…ë°ì´íŠ¸:', id, updates);\n    } catch (error) {\n      console.error('ìœ ì—°í•œ ëª©í‘œ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);\n      throw error;\n    }\n  },\n\n  deleteGoal: async (id: string) => {\n    try {\n      const { error } = await supabase\n        .from('flexible_goals')\n        .delete()\n        .eq('id', id);\n\n      if (error) throw error;\n\n      set(state => ({\n        goals: state.goals.filter(goal => goal.id !== id)\n      }));\n\n      console.log('âœ… ìœ ì—°í•œ ëª©í‘œ ì‚­ì œ:', id);\n    } catch (error) {\n      console.error('ìœ ì—°í•œ ëª©í‘œ ì‚­ì œ ì˜¤ë¥˜:', error);\n      throw error;\n    }\n  },\n\n  checkGoal: async (id: string) => {\n    try {\n      const goal = get().goals.find(g => g.id === id);\n      if (!goal) return;\n\n      const newStatus = goal.status === 'success' ? 'pending' : 'success';\n      \n      await get().updateGoal(id, { status: newStatus });\n      console.log('âœ… ìœ ì—°í•œ ëª©í‘œ ì²´í¬:', id, 'ìƒíƒœ:', newStatus);\n    } catch (error) {\n      console.error('ìœ ì—°í•œ ëª©í‘œ ì²´í¬ ì˜¤ë¥˜:', error);\n    }\n  },\n\n  getGoalsByDate: (date: string) => {\n    const { goals } = get();\n    return goals.filter(goal => goal.date === date);\n  },\n\n  // getGoalsByType í•¨ìˆ˜ ì œê±° (ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•ŠìŒ)\n\n  getTodayGoals: () => {\n    const { getGoalsByDate } = get();\n    return getGoalsByDate(getTodayString());\n  },\n\n  getTomorrowGoals: () => {\n    const { getGoalsByDate } = get();\n    const tomorrowString = getTomorrowKorea();\n    return getGoalsByDate(tomorrowString);\n  },\n\n  getTodayStats: () => {\n    const todayGoals = get().getTodayGoals();\n    const total = todayGoals.length;\n    const success = todayGoals.filter(g => g.status === 'success').length;\n    const failure = todayGoals.filter(g => g.status === 'failure').length;\n    const pending = todayGoals.filter(g => g.status === 'pending').length;\n    const successRate = total > 0 ? Math.round((success / total) * 100) : 0;\n\n    return { total, success, failure, pending, successRate };\n  },\n\n  hasTodayGoal: (date?: string) => {\n    const targetDate = date || getTodayString();\n    const { goals } = get();\n    return goals.some(goal => goal.date === targetDate);\n  },\n\n  hasTomorrowGoal: () => {\n    const tomorrowString = getTomorrowKorea();\n    const { goals } = get();\n    return goals.some(goal => goal.date === tomorrowString);\n  },\n\n  // ë°ì´í„° ì´ˆê¸°í™” í•¨ìˆ˜\n  clearAllFlexibleGoals: () => {\n    console.log(\"ğŸ§¹ ëª¨ë“  ìœ ì—°í•œ ëª©í‘œ ë°ì´í„° ë¡œì»¬ ìŠ¤í† ì–´ ì´ˆê¸°í™”\");\n    set({ goals: [] });\n  },\n}));","size_bytes":7398},"src/store/goalStore.ts":{"content":"  import { create } from \"zustand\";\nimport { nanoid } from \"nanoid\";\nimport { supabase } from \"../supabaseClient\";\nimport { getTodayKorea, getTomorrowKorea, getKoreaTime, formatDateKorea } from \"../utils/timeUtils\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\nimport { \n  validateAndCleanData, \n  removeDuplicates, \n  safeDateParse, \n  retryWithBackoff,\n  measurePerformance,\n  PAGINATION_CONFIG\n} from \"../utils/performanceUtils\";\n// ì‚­ì œëœ ëª¨ë“ˆ: supabaseNotificationSync\nimport {\n  scheduleGoalAlarm,\n  cancelGoalAlarm,\n  scheduleRetrospectReminderImmediate,\n  scheduleRetrospectReminder,\n  cancelRetrospectReminder,\n  getAllScheduledNotifications,\n  cancelAllNotifications,\n  safeNotificationCleanup,\n} from \"../helpers/notificationScheduler\";\nimport { unifiedNotificationManager } from \"../utils/unifiedNotificationManager\";\n\n// ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ í•¨ìˆ˜ (ê°„ë‹¨ ë²„ì „)\nconst cancelAllScheduledAlarms = async () => {\n  console.log('ğŸ”• ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ ì‹¤í–‰');\n};\n// ì‚­ì œëœ ëª¨ë“ˆ: smartNotificationSystem\nimport { streakManager, StreakBadge } from \"../utils/streakBadgeSystem\";\n\nexport interface Goal {\n  id: string;\n  user_id: string;\n  title: string;\n  target_time: string; // ISO-8601\n  status: \"pending\" | \"success\" | \"failure\";\n  achievement_memo?: string; // ë‹¬ì„± ë©”ëª¨\n}\n\n// ëª©í‘œ ìƒíƒœ ê²€ì¦ í•¨ìˆ˜\nconst validateGoalStatus = (status: any): status is Goal['status'] => {\n  const validStatuses = ['pending', 'success', 'failure'];\n  return typeof status === 'string' && validStatuses.includes(status);\n};\n\n// ëª©í‘œ ë°ì´í„° ê²€ì¦ í•¨ìˆ˜\nconst validateGoalData = (goal: any): goal is Goal => {\n  return (\n    goal &&\n    typeof goal.id === 'string' && goal.id.length > 0 &&\n    typeof goal.user_id === 'string' && goal.user_id.length > 0 &&\n    typeof goal.title === 'string' && goal.title.trim().length > 0 &&\n    typeof goal.target_time === 'string' && goal.target_time.length > 0 &&\n    validateGoalStatus(goal.status)\n  );\n};\n\nconst canEdit = (g: Goal, isRetrospectDone: boolean) => {\n  if (g.status !== \"pending\") return false;\n\n  const targetTime = new Date(g.target_time);\n  const now = getKoreaTime();\n\n  // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ êµ¬ë¶„\n  const todayKey = getTodayKorea();\n  const tomorrowKey = getTomorrowKorea();\n  const goalDateKey = formatDateKorea(targetTime);\n\n  // ëª©í‘œ í¸ì§‘ ê°€ëŠ¥ì„± ê²€ì‚¬ ì¤‘\n\n  // ğŸ”¥ ë‚´ì¼ ì´í›„ ëª©í‘œ: í•­ìƒ í¸ì§‘ ê°€ëŠ¥\n  if (goalDateKey >= tomorrowKey) {\n    // ë‚´ì¼ ì´í›„ ëª©í‘œëŠ” í¸ì§‘ ê°€ëŠ¥\n    return true;\n  }\n\n  // ğŸ”¥ ë‹¹ì¼ ëª©í‘œ ì²˜ë¦¬\n  if (goalDateKey === todayKey) {\n    // íšŒê³  ì™„ë£Œ í›„ì—ëŠ” í¸ì§‘ ë¶ˆê°€\n    if (isRetrospectDone) {\n      // íšŒê³  ì™„ë£Œ í›„ ë‹¹ì¼ ëª©í‘œëŠ” í¸ì§‘ ë¶ˆê°€\n      return false;\n    }\n\n    // ëª©í‘œ ì‹œê°„ 3ì‹œê°„ ì „ê¹Œì§€ë§Œ í¸ì§‘ ê°€ëŠ¥ \n    const timeDiff = targetTime.getTime() - now.getTime();\n    const hoursDiff = timeDiff / (1000 * 60 * 60);\n    const canEditByTime = hoursDiff > 3;\n    \n    // ë‹¹ì¼ ëª©í‘œ ì‹œê°„ ì œí•œ ê²€ì‚¬ ì™„ë£Œ\n    return canEditByTime;\n  }\n\n  // ê³¼ê±° ëª©í‘œëŠ” í¸ì§‘ ë¶ˆê°€\n  return false;\n};\n\ninterface GoalState {\n  goals: Goal[];\n  streakBadge: StreakBadge | null; // í˜„ì¬ ì—°ìŠ¹ ë±ƒì§€\n  goalBadges: Map<string, StreakBadge>; // ê° ëª©í‘œì˜ ê°œë³„ ë±ƒì§€\n  fetchGoals: () => Promise<void>;\n  addGoal: (title: string, target_time: string) => Promise<void>;\n  addGoalsBatch: (\n    rows: { title: string; target_time: string }[],\n  ) => Promise<void>;\n  updateGoal: (id: string, data: Partial<Goal>) => Promise<void>;\n  deleteGoal: (id: string) => Promise<void>;\n  checkGoal: (id: string) => Promise<void>;\n  addAchievementMemo: (id: string, memo: string) => Promise<void>;\n  cleanupOldGoals: () => Promise<void>;\n  removeDuplicateGoals: () => Promise<void>;\n\n  getGoalsWithCanCheck: (\n    isRetrospectDone?: boolean,\n  ) => { goal: Goal; canCheck: boolean; canEdit: boolean }[];\n  \n  // ë°ì´í„° ì´ˆê¸°í™”\n  clearAllGoals: () => void;\n  expireOverdueGoals: () => Promise<void>;\n  getTodaySummary: () => { allDone: boolean; hasFailure: boolean };\n\n  checkDelayedRetrospectReminder: () => Promise<void>;\n  \n  // ì—°ìŠ¹ ë±ƒì§€ ê´€ë ¨\n  getCurrentStreak: () => number;\n  getStreakCategory: () => Promise<string>;\n  scheduleRetrospectForLastGoal: () => Promise<void>;\n  cancelRetrospectIfLastGoalSuccess: (goalId: string) => Promise<void>;\n  \n  // ì•Œë¦¼ ë””ë²„ê¹… ê´€ë ¨\n  checkAllNotifications: () => Promise<void>;\n  cancelAllNotifications: () => Promise<void>;\n}\n\nconst useGoalStore = create<GoalState>((set, get) => ({\n  goals: [],\n  streakBadge: null,\n  goalBadges: new Map(),\n\n  fetchGoals: async () => {\n    console.log(\"ğŸ” fetchGoals í•¨ìˆ˜ ì‹¤í–‰ ì‹œì‘\");\n    \n    try {\n      const {\n        data: { session },\n        error: sessionError\n      } = await supabase.auth.getSession();\n      \n      if (sessionError) {\n        console.error(\"âŒ ì„¸ì…˜ ì¡°íšŒ ì˜¤ë¥˜:\", sessionError);\n        set({ goals: [] });\n        return;\n      }\n      \n      console.log(\"ğŸ” í˜„ì¬ Supabase ì„¸ì…˜ ìƒíƒœ:\", {\n        sessionì¡´ì¬: !!session,\n        isAnonymous: session?.user?.is_anonymous\n      });\n      \n      if (!session) {\n        console.log(\"ğŸš« ì„¸ì…˜ ì—†ìŒ - ëª©í‘œ ê°€ì ¸ì˜¤ê¸° ì¤‘ë‹¨\");\n        set({ goals: [] });\n        return;\n      }\n    \n    console.log(\"âœ… ì„¸ì…˜ í™•ì¸ ì™„ë£Œ - ëª©í‘œ ê°€ì ¸ì˜¤ê¸° ê³„ì† ì§„í–‰\");\n    \n    console.log(\"ğŸ” ëª©í‘œ ê°€ì ¸ì˜¤ê¸° ì‹œì‘\");\n    console.log(\"ğŸ” ì‚¬ìš©ì ì •ë³´:\", {\n      is_anonymous: session.user.is_anonymous\n    });\n\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ìµœê·¼ 2ë…„ + ë¯¸ë˜ 2ë…„ ëª©í‘œë“¤ì„ ëª¨ë‘ ê°€ì ¸ì˜¤ê¸°\n    const koreaTime = getKoreaTime();\n    const today = getTodayKorea();\n    const twoYearsAgo = new Date(koreaTime.getTime() - 2 * 365 * 86400000)\n      .toISOString()\n      .slice(0, 10);\n    const twoYearsLater = new Date(koreaTime.getTime() + 2 * 365 * 86400000)\n      .toISOString()\n      .slice(0, 10);\n\n    console.log(\"ğŸ” ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ë²”ìœ„:\", {\n      twoYearsAgo: twoYearsAgo + \"T00:00:00.000Z\",\n      twoYearsLater: twoYearsLater + \"T23:59:59.999Z\"\n    });\n\n      // ê²ŒìŠ¤íŠ¸ì™€ ì¸ì¦ ì‚¬ìš©ì ëª¨ë‘ë¥¼ ìœ„í•œ ì•ˆì „í•œ ì¿¼ë¦¬\n      console.log(\"ğŸ” ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì‹¤í–‰\");\n      \n      const { data, error } = await supabase\n        .from(\"goals\")\n        .select(\"*\")\n        .eq(\"user_id\", session.user.id)\n        .order(\"target_time\", { ascending: true });\n\n      // ìƒì„¸ ë¡œê·¸ëŠ” 5ë¶„ë§ˆë‹¤ë§Œ ì¶œë ¥ (ì„±ëŠ¥ ìµœì í™”)\n      const now = Date.now();\n      const lastLogTime = parseInt(await AsyncStorage.getItem('lastDetailLogTime') || '0');\n      \n      if (now - lastLogTime > 180000) { // 3ë¶„ ê°„ê²©\n        console.log(\"ğŸ” ì „ì²´ DB ì¡°íšŒ ê²°ê³¼:\", {\n          ì¡°íšŒëœë°ì´í„°: data?.length || 0,\n          ì˜¤ë¥˜ìƒì„¸: error ? {\n            message: error.message,\n            details: error.details,\n            hint: error.hint,\n            code: error.code\n          } : \"ì—†ìŒ\",\n          ì‚¬ìš©ìID: session.user.id,\n          ì‚¬ìš©ìíƒ€ì…: session.user.is_anonymous ? \"ê²ŒìŠ¤íŠ¸\" : \"ì¸ì¦\",\n          ì²«ë²ˆì§¸ë°ì´í„°: data?.[0] ? {\n            id: data[0].id,\n            title: data[0].title,\n            target_time: data[0].target_time,\n            user_id: data[0].user_id\n          } : null\n        });\n        \n        await AsyncStorage.setItem('lastDetailLogTime', now.toString());\n      }\n\n      if (error) {\n        console.error(\"âŒ fetchGoals ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜:\", error);\n        \n        // RLS ê¶Œí•œ ì˜¤ë¥˜ì¸ ê²½ìš° íŠ¹ë³„ ì²˜ë¦¬\n        if (error.code === 'PGRST116' || error.message?.includes('RLS')) {\n          console.log(\"ğŸ” RLS ê¶Œí•œ ë¬¸ì œ ê°ì§€ - ì„¸ì…˜ ê°±ì‹  ì‹œë„\");\n          await supabase.auth.refreshSession();\n          // í•œ ë²ˆ ë” ì‹œë„\n          const { data: retryData, error: retryError } = await supabase\n            .from(\"goals\")\n            .select(\"*\")\n            .eq(\"user_id\", session.user.id)\n            .order(\"target_time\", { ascending: true });\n            \n          if (retryError) {\n            console.error(\"âŒ ì¬ì‹œë„ í›„ì—ë„ ë°ì´í„°ë² ì´ìŠ¤ ì˜¤ë¥˜:\", retryError);\n            set({ goals: [] });\n            return;\n          }\n          \n          console.log(\"âœ… ì¬ì‹œë„ ì„±ê³µ:\", retryData?.length || 0, \"ê°œ ëª©í‘œ ì¡°íšŒ\");\n          set({ goals: retryData || [] });\n        } else {\n          set({ goals: [] });\n          return;\n        }\n      } else {\n        if (data && data.length > 0) {\n          console.log('âœ… ëª©í‘œ ì¡°íšŒ ì„±ê³µ - ë°ì´í„° ê²€ì¦ ì¤‘...');\n          \n          // ì„±ëŠ¥ ìµœì í™”ëœ ë°ì´í„° ê²€ì¦ ë° ì •ì œ\n          const validGoals = validateAndCleanData(\n            data,\n            validateGoalData,\n            PAGINATION_CONFIG.MAX_GOALS_IN_MEMORY\n          );\n          \n          // ì¤‘ë³µ ì œê±°\n          const uniqueGoals = removeDuplicates(\n            validGoals,\n            (goal: Goal) => `${goal.user_id}-${goal.target_time}`\n          );\n          \n          // ë¬´íš¨í•œ ìƒíƒœ ìë™ ìˆ˜ì •\n          const correctedGoals = uniqueGoals.map((goal: Goal) => {\n            if (!validateGoalStatus(goal.status)) {\n              console.warn('âš ï¸ ë¬´íš¨í•œ ìƒíƒœ ìˆ˜ì •:', goal.status, '-> pending');\n              return { ...goal, status: 'pending' as const };\n            }\n            return goal;\n          });\n          \n          console.log(`âœ… ê²€ì¦ ì™„ë£Œ: ${data.length}ê°œ ì¤‘ ${correctedGoals.length}ê°œ ìœ íš¨`);\n          set({ goals: correctedGoals });\n        } else {\n          console.log('âš ï¸ ì¡°íšŒëœ ëª©í‘œ ì—†ìŒ - ë¹ˆ ë°°ì—´ë¡œ ì„¤ì •');\n          set({ goals: [] });\n        }\n      }\n\n      const finalData = get().goals;\n      console.log(\"âœ… fetchGoals ì„±ê³µ:\", {\n        ë°›ì€ë°ì´í„°: finalData?.length || 0,\n        ì²«ë²ˆì§¸ëª©í‘œ: finalData?.[0] ? {\n          id: finalData[0].id,\n          title: finalData[0].title,\n          target_time: finalData[0].target_time,\n          user_id: finalData[0].user_id\n        } : 'ì—†ìŒ'\n      });\n\n      // ì—°ìŠ¹ ë±ƒì§€ ì‹œìŠ¤í…œ ì´ˆê¸°í™”\n      try {\n        const currentStreak = streakManager.getTodayStreak();\n        if (currentStreak > 0) {\n          const category = await streakManager.getTodayBadgeCategory();\n          const badge = {\n            level: currentStreak,\n            category: category,\n            iconPath: streakManager.getBadgeIconPath(currentStreak, category)\n          };\n          set((state) => ({ ...state, streakBadge: badge }));\n        }\n      } catch (badgeError) {\n        console.error(\"âŒ ë±ƒì§€ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨:\", badgeError);\n      }\n\n      // ê°œë³„ ëª©í‘œ ë±ƒì§€ ë³µì› (ì˜¤ëŠ˜ ì„±ê³µí•œ ëª©í‘œë“¤ì„ ì‹œê°„ìˆœìœ¼ë¡œ ì •ë ¬)\n      const finalGoals = get().goals;\n      const todaySuccessGoals = finalGoals?.filter(g => \n        g.target_time.startsWith(today) && g.status === 'success'\n      ).sort((a, b) => new Date(a.target_time).getTime() - new Date(b.target_time).getTime()) || [];\n    \n    console.log(`ğŸ† ì˜¤ëŠ˜ ì„±ê³µí•œ ëª©í‘œ ${todaySuccessGoals.length}ê°œì˜ ë±ƒì§€ ë³µì› ì¤‘...`);\n    \n    const restoredBadges = new Map<string, StreakBadge>();\n    \n    // â­ ì¤‘ìš”: ì˜¤ëŠ˜ì˜ ë±ƒì§€ ì¹´í…Œê³ ë¦¬ë¥¼ í•œ ë²ˆë§Œ ê°€ì ¸ì™€ì„œ ëª¨ë“  ëª©í‘œì— ë™ì¼í•˜ê²Œ ì ìš©\n    const todayBadgeCategory = await streakManager.getTodayBadgeCategory();\n    console.log(`ğŸ”’ ì˜¤ëŠ˜ì˜ ë±ƒì§€ ì¹´í…Œê³ ë¦¬ ê³ ì •: ${todayBadgeCategory}`);\n    \n    // ì—°ì† ìŠ¹ë¦¬ ì¹´ìš´í„° (ì‹¤ì‹œê°„ ê³„ì‚°)\n    let consecutiveWins = 0;\n    \n      // ì˜¤ëŠ˜ì˜ ëª¨ë“  ëª©í‘œë¥¼ ì‹œê°„ìˆœìœ¼ë¡œ ì •ë ¬\n      const todayAllGoals = finalGoals?.filter(g => \n        g.target_time.startsWith(today)\n      ).sort((a, b) => new Date(a.target_time).getTime() - new Date(b.target_time).getTime()) || [];\n    \n    // ê° ì„±ê³µí•œ ëª©í‘œì˜ ì—°ìŠ¹ ë ˆë²¨ ê³„ì‚° (pending ëª©í‘œëŠ” ì œì™¸)\n    const completedGoals = todayAllGoals.filter(g => g.status === 'success' || g.status === 'failure');\n    \n      completedGoals.forEach(goal => {\n        if (goal.status === 'success') {\n          consecutiveWins++;\n          const badge = {\n            level: consecutiveWins,\n            category: todayBadgeCategory, // ê³ ì •ëœ ì¹´í…Œê³ ë¦¬ ì‚¬ìš©\n            iconPath: streakManager.getBadgeIconPath(consecutiveWins, todayBadgeCategory)\n        };\n        restoredBadges.set(goal.id, badge);\n        console.log(`ğŸ¯ ëª©í‘œ \"${goal.title}\" ë±ƒì§€: ${consecutiveWins}ì—°ìŠ¹ (${todayBadgeCategory})`);\n      } else if (goal.status === 'failure') {\n        // ì‹¤íŒ¨ ì‹œ ì—°ìŠ¹ ì´ˆê¸°í™”\n        consecutiveWins = 0;\n        console.log(`ğŸ’” ëª©í‘œ \"${goal.title}\" ì‹¤íŒ¨ë¡œ ì—°ìŠ¹ ì´ˆê¸°í™”`);\n      }\n    });\n    \n    console.log(`ğŸ“‹ ì˜¤ëŠ˜ ì™„ë£Œëœ ëª©í‘œ: ${completedGoals.length}ê°œ (ì„±ê³µ/ì‹¤íŒ¨ë§Œ), ëŒ€ê¸° ì¤‘: ${todayAllGoals.length - completedGoals.length}ê°œ`);\n\n    console.log(\"ğŸ“Š ê°€ì ¸ì˜¨ ëª©í‘œë“¤:\", data?.length || 0, \"ê°œ\");\n    console.log(\"ğŸ“… ë‚ ì§œë³„ ëª©í‘œ ê°œìˆ˜:\", {\n      \"2ë…„ì „\":\n        data?.filter((g) => g.target_time.startsWith(twoYearsAgo)).length || 0,\n      ì˜¤ëŠ˜: data?.filter((g) => g.target_time.startsWith(today)).length || 0,\n      \"2ë…„í›„\":\n        data?.filter((g) => g.target_time.startsWith(twoYearsLater)).length ||\n        0,\n    });\n\n    // ë‚´ì¼ ëª©í‘œ ìƒì„¸ ì •ë³´ ë¡œê·¸\n    const tomorrowGoals =\n      data?.filter((g) => g.target_time.startsWith(today)) || [];\n    console.log(\n      \"ğŸ” ì˜¤ëŠ˜ ëª©í‘œ ìƒì„¸ (DBì—ì„œ ê°€ì ¸ì˜¨ ê²ƒ):\",\n      tomorrowGoals.map((g) => ({\n        title: g.title,\n        time: g.target_time,\n        status: g.status,\n      })),\n    );\n\n    console.log(\"ğŸ’¾ goalStore ìƒíƒœ ì—…ë°ì´íŠ¸:\", {\n      ì´ì „ê°œìˆ˜: get().goals.length,\n      ìƒˆë¡œìš´ê°œìˆ˜: data?.length || 0,\n      ë°ì´í„°: data?.map((g) => ({ title: g.title, time: g.target_time })) || [],\n    });\n\n      // ë³µì›ëœ ê°œë³„ ë±ƒì§€ë“¤ì„ ìƒíƒœì— ì €ì¥\n      set((state) => ({ ...state, goalBadges: restoredBadges }));\n      \n      console.log(`ğŸ† ê°œë³„ ëª©í‘œ ë±ƒì§€ ë³µì› ì™„ë£Œ: ${restoredBadges.size}ê°œ`);\n\n      // ì‚¬ìš©ì ì•Œë¦¼ ì„¤ì • í™•ì¸\n      const settingsString = await AsyncStorage.getItem('notificationSettings');\n      const settings = settingsString ? JSON.parse(settingsString) : { goalAlarms: true };\n      \n      if (settings.goalAlarms) {\n        // ğŸ§  Supabase ê¸°ë°˜ ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ê´€ë¦¬: ìƒíƒœë³„ ì²˜ë¦¬\n        const finalGoalsForAlarm = get().goals;\n        \n        // 1. ì™„ë£Œ/ì‹¤íŒ¨í•œ ëª©í‘œë“¤ì˜ ì•Œë¦¼ ìë™ ì·¨ì†Œ (DB ìƒíƒœ ê¸°ë°˜)\n        const completedGoals = finalGoalsForAlarm.filter(\n          goal => goal.status === 'success' || goal.status === 'failure'\n        );\n        \n        if (completedGoals.length > 0) {\n          console.log(`ğŸ”• DBì—ì„œ ì™„ë£Œ/ì‹¤íŒ¨ ìƒíƒœì¸ ëª©í‘œ ${completedGoals.length}ê°œ ì•Œë¦¼ ì·¨ì†Œ ì¤‘...`);\n          for (const goal of completedGoals) {\n            try {\n              await cancelGoalAlarm(goal.id);\n            } catch (error) {\n              console.log(`âš ï¸ ëª©í‘œ \"${goal.title}\" ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨:`, error);\n            }\n          }\n        }\n\n        // 2. pending ìƒíƒœì´ë©´ì„œ ë¯¸ë˜ ì‹œê°„ì¸ ëª©í‘œë“¤ë§Œ í•„í„°ë§\n        const activeGoals = finalGoalsForAlarm.filter(\n          goal => goal.status === 'pending' && new Date(goal.target_time) > new Date()\n        );\n\n        console.log(`ğŸ“Š DB ìƒíƒœ ê¸°ë°˜ ë¶„ì„: ì™„ë£Œ/ì‹¤íŒ¨ ${completedGoals.length}ê°œ, í™œì„± ${activeGoals.length}ê°œ`);\n\n        // âœ… í™œì„± ëª©í‘œë“¤ì— ëŒ€í•œ í†µí•© ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§\n        if (activeGoals.length > 0) {\n          console.log(`ğŸ”” ${activeGoals.length}ê°œ í™œì„± ëª©í‘œì— ëŒ€í•œ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§ ì¤‘...`);\n          for (const goal of activeGoals) {\n            try {\n              await unifiedNotificationManager.scheduleGoalNotification(goal.id, goal.title, new Date(goal.target_time));\n            } catch (error) {\n              console.log(`âš ï¸ í†µí•© ì•Œë¦¼ ì‹¤íŒ¨, ê¸°ì¡´ ì‹œìŠ¤í…œ ì‚¬ìš© - \"${goal.title}\":`, error);\n              try {\n                await scheduleGoalAlarm(goal.id, goal.title, new Date(goal.target_time));\n              } catch (fallbackError) {\n                console.log(`âŒ ëª©í‘œ \"${goal.title}\" ëª¨ë“  ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§ ì‹¤íŒ¨:`, fallbackError);\n              }\n            }\n          }\n        } else {\n          console.log('ğŸ“­ ìŠ¤ì¼€ì¤„ë§í•  í™œì„± ëª©í‘œê°€ ì—†ìŒ');\n        }\n      } else {\n        console.log(\"ğŸ”• ëª©í‘œ ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ ìŠ¤ì¼€ì¤„ë§ ê±´ë„ˆëœ€\");\n      }\n      \n      // ëª©í‘œ ë¡œë“œ ì™„ë£Œ í›„ íšŒê³  ì•Œë¦¼ ë³µì› (í•œ ë²ˆë§Œ)\n      console.log(\"ğŸ”„ ëª©í‘œ ë¡œë“œ ì™„ë£Œ - íšŒê³  ì•Œë¦¼ ì‹œìŠ¤í…œ ì¤€ë¹„\");\n      setTimeout(async () => {\n        try {\n          // goalStoreì—ì„œ ì§ì ‘ íšŒê³  ì•Œë¦¼ ì²˜ë¦¬ (í•œ ë²ˆë§Œ ì‹¤í–‰)\n          await get().checkDelayedRetrospectReminder();\n        } catch (error) {\n          console.error(\"âŒ íšŒê³  ì•Œë¦¼ ë°œì†¡ ì‹¤íŒ¨:\", error);\n        }\n      }, 2000); // 2ì´ˆ í›„ í•œ ë²ˆë§Œ ì‹¤í–‰\n      \n    } catch (fetchError) {\n      console.error(\"âŒ fetchGoals ì „ì²´ ì‹¤íŒ¨:\", fetchError);\n      set({ goals: [] });\n    }\n  },\n\n  addGoal: async (title: string, target_time: string) => {\n    const {\n      data: { session },\n    } = await supabase.auth.getSession();\n    if (!session) {\n      console.log(\"ğŸš« addGoal ì„¸ì…˜ ì—†ìŒ - ì¸ì¦ ì˜¤ë¥˜\");\n      throw new Error(\"ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤\");\n    }\n    \n    console.log(\"ğŸ” addGoal ì‹¤í–‰:\", {\n      ì‚¬ìš©ìID: session.user.id,\n      ëª©í‘œì œëª©: title,\n      ëª©í‘œì‹œê°„: target_time,\n      í˜„ì¬ëª©í‘œìˆ˜: get().goals.length\n    });\n\n    // ìµœëŒ€ 18ê°œ ëª©í‘œ ì œí•œ (í•œêµ­ ì‹œê°„ ê¸°ì¤€)\n    const existingGoals = get().goals;\n    \n    \n    const today = getTodayKorea();\n    const todayGoals = existingGoals.filter((g) =>\n      g.target_time.startsWith(today),\n    );\n\n    if (todayGoals.length >= 18) {\n      throw new Error(\"ìˆ˜í–‰ ëª©ë¡ì€ ìµœëŒ€ 18ê°œê¹Œì§€ë§Œ ëª©í‘œë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\");\n    }\n\n    // ğŸ”¥ 3ì‹œê°„ ì œì•½ ê²€ì¦ (ë‹¹ì¼ ëª©í‘œì¸ ê²½ìš°ë§Œ) - í•œêµ­ ì‹œê°„ ê¸°ì¤€\n    const targetDate = new Date(target_time);\n    const nowKorea = getKoreaTime();\n    \n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‹¹ì¼ ì—¬ë¶€ íŒë‹¨\n    const todayKorea = getTodayKorea();\n    const targetDateKorea = formatDateKorea(targetDate);\n    const isToday = targetDateKorea === todayKorea;\n    \n    console.log(\"ğŸ” 3ì‹œê°„ ì œì•½ ê²€ì¦:\", {\n      ëª©í‘œì‹œê°„: targetDate.toLocaleString('ko-KR'),\n      í˜„ì¬í•œêµ­ì‹œê°„: nowKorea.toLocaleString('ko-KR'),\n      ëª©í‘œë‚ ì§œí‚¤: targetDateKorea,\n      ì˜¤ëŠ˜ë‚ ì§œí‚¤: todayKorea,\n      ë‹¹ì¼ì—¬ë¶€: isToday\n    });\n    \n    if (isToday) {\n      const threeHoursFromNow = new Date(nowKorea.getTime() + 3 * 60 * 60 * 1000);\n      if (targetDate < threeHoursFromNow) {\n        const currentTimeStr = nowKorea.toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour: '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n        \n        const minimumTimeStr = threeHoursFromNow.toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour: '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n        \n        throw new Error(`í˜„ì¬ ì‹œê°„(${currentTimeStr})ìœ¼ë¡œë¶€í„° 3ì‹œê°„ í›„ì¸ ${minimumTimeStr} ì´í›„ ì‹œê°„ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);\n      }\n    } else {\n      console.log(\"âœ… ë‚´ì¼ ëª©í‘œì´ë¯€ë¡œ 3ì‹œê°„ ì œì•½ ê±´ë„ˆëœ€\");\n    }\n\n    // 30ë¶„ ë²”ìœ„ ì¤‘ë³µ ì‹œê°„ ê²€ì¦\n    console.log(\"ğŸ” 30ë¶„ ì¶©ëŒ ê²€ì¦ ì‹œì‘:\", {\n      ê¸°ì¡´ëª©í‘œìˆ˜: existingGoals.length,\n      ê¸°ì¡´ëª©í‘œë“¤: existingGoals.map(g => ({\n        title: g.title,\n        time: g.target_time,\n        status: g.status\n      })),\n      ìƒˆëª©í‘œì‹œê°„: target_time\n    });\n    \n    const selectedTime = new Date(target_time).getTime();\n    const thirtyMinutes = 30 * 60 * 1000; // 30ë¶„ì„ ë°€ë¦¬ì´ˆë¡œ ë³€í™˜\n    \n    const conflictingGoal = existingGoals.find((g) => {\n      const goalTime = new Date(g.target_time).getTime();\n      const timeDiff = Math.abs(selectedTime - goalTime);\n      console.log(`â° ì‹œê°„ ì°¨ì´ ì²´í¬: ${g.title} (${g.target_time}) vs ìƒˆëª©í‘œ - ì°¨ì´: ${timeDiff/1000/60}ë¶„`);\n      return timeDiff < thirtyMinutes;\n    });\n    \n    if (conflictingGoal) {\n      const conflictTimeStr = new Date(conflictingGoal.target_time).toLocaleTimeString('ko-KR', {\n        hour12: true,\n        hour: '2-digit',\n        minute: '2-digit',\n      }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n      \n      throw new Error(`${conflictTimeStr}ì— ì„¤ì •ëœ ëª©í‘œì™€ ë„ˆë¬´ ê°€ê¹ìŠµë‹ˆë‹¤. ëª©í‘œ ê°„ê²©ì€ ìµœì†Œ 30ë¶„ ì´ìƒ ìœ ì§€í•´ì£¼ì„¸ìš”.`);\n    }\n\n    const row: Goal = {\n      id: nanoid(),\n      user_id: session.user.id,\n      title,\n      target_time,\n      status: \"pending\",\n    };\n\n    const { error } = await supabase.from(\"goals\").insert([row]);\n\n    if (error) {\n      // ë°ì´í„°ë² ì´ìŠ¤ ì œì•½ ì¡°ê±´ ì˜¤ë¥˜ë¥¼ ì¹œì ˆí•œ í•œê¸€ë¡œ ë³€í™˜\n      if (error.message && error.message.includes(\"unique_user_time\")) {\n        throw new Error(\n          \"ì´ë¯¸ ê°™ì€ ì‹œê°„ì— ëª©í‘œê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\\në‹¤ë¥¸ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\",\n        );\n      }\n      throw error;\n    }\n\n    set((state) => ({\n      goals: [...state.goals, row].sort(\n        (a, b) =>\n          new Date(a.target_time).getTime() - new Date(b.target_time).getTime(),\n      ),\n    }));\n\n    // ì‚¬ìš©ì display_name ê°€ì ¸ì˜¤ê¸°\n    const { data: profileData, error: profileError } = await supabase\n      .from(\"profiles\")\n      .select(\"display_name\")\n      .eq(\"id\", session.user.id)\n      .single();\n\n    console.log(\"ğŸ‘¤ ì‚¬ìš©ì í”„ë¡œí•„ ì¡°íšŒ (addGoal):\", {\n      userId: session.user.id,\n      profileData,\n      profileError,\n    });\n\n    const userDisplayName = profileData?.display_name || undefined;\n    console.log(\"ğŸ“ ì•Œë¦¼ìš© ë‹‰ë„¤ì„ (addGoal):\", userDisplayName || \"ì—†ìŒ\");\n\n    // ì•Œë¦¼ ì„¤ì • í™•ì¸ í›„ ìŠ¤ì¼€ì¤„ë§\n    const settingsString = await AsyncStorage.getItem('notificationSettings');\n    const settings = settingsString ? JSON.parse(settingsString) : { goalAlarms: true };\n    \n    // âœ… í†µí•© ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™”\n    if (settings.goalAlarms) {\n      console.log(\"ğŸ”” ëª©í‘œ ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™” - ìŠ¤ì¼€ì¤„ë§ ì¤‘...\");\n      try {\n        // í†µí•© ì•Œë¦¼ ê´€ë¦¬ì ì‚¬ìš©\n        await unifiedNotificationManager.scheduleGoalNotification(row.id, row.title, new Date(row.target_time), userDisplayName);\n      } catch (error) {\n        console.log(\"âš ï¸ í†µí•© ì•Œë¦¼ ì‹¤íŒ¨, ê¸°ì¡´ ì‹œìŠ¤í…œ ì‚¬ìš©:\", error);\n        await scheduleGoalAlarm(row.id, row.title, new Date(row.target_time), userDisplayName);\n      }\n    } else {\n      console.log(\"ğŸ”• ëª©í‘œ ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ ì•Œë¦¼ ê±´ë„ˆëœ€\");\n    }\n\n    // íšŒê³  ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§\n    if (settings.retrospectReminders) {\n      console.log(\"ğŸ“ íšŒê³  ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™” - ì—…ë°ì´íŠ¸ ì¤‘...\");\n      setTimeout(() => get().scheduleRetrospectForLastGoal(), 1000);\n    } else {\n      console.log(\"ğŸ”• íšŒê³  ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ ê±´ë„ˆëœ€\");\n    }\n    \n    console.log(\"â° ëª©í‘œ ì¶”ê°€ ì™„ë£Œ:\", row.title, \"at\", row.target_time);\n  },\n\n  addGoalsBatch: async (rows: { title: string; target_time: string }[]) => {\n    const {\n      data: { session },\n    } = await supabase.auth.getSession();\n    if (!session) throw new Error(\"Not authenticated\");\n\n    // ìµœëŒ€ 18ê°œ ëª©í‘œ ì œí•œ (í•œêµ­ ì‹œê°„ ê¸°ì¤€)\n    const existingGoals = get().goals;\n    \n    \n    const today = getTodayKorea();\n    const todayGoals = existingGoals.filter((g) =>\n      g.target_time.startsWith(today),\n    );\n    const newTodayGoals = rows.filter((r) => r.target_time.startsWith(today));\n\n    if (todayGoals.length + newTodayGoals.length > 18) {\n      throw new Error(\n        `ì˜¤ëŠ˜ì€ ìµœëŒ€ 18ê°œê¹Œì§€ë§Œ ëª©í‘œë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\\n(í˜„ì¬: ${todayGoals.length}ê°œ, ì¶”ê°€í•˜ë ¤ëŠ” ëª©í‘œ: ${newTodayGoals.length}ê°œ)`,\n      );\n    }\n\n    // 3ì‹œê°„ ì œì•½ ê²€ì¦ (ë‹¹ì¼ ëª©í‘œë“¤)\n    const now = new Date();\n    const threeHoursFromNow = new Date(now.getTime() + 3 * 60 * 60 * 1000);\n    \n    for (const row of rows) {\n      const targetDate = new Date(row.target_time);\n      const isToday = targetDate.toDateString() === now.toDateString();\n      \n      if (isToday && targetDate < threeHoursFromNow) {\n        const currentTimeStr = now.toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour: '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n        \n        const minimumTimeStr = threeHoursFromNow.toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour: '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n        \n        const targetTimeStr = targetDate.toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour: '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n        \n        throw new Error(`${targetTimeStr} ëª©í‘œëŠ” í˜„ì¬ ì‹œê°„(${currentTimeStr})ìœ¼ë¡œë¶€í„° 3ì‹œê°„ í›„ì¸ ${minimumTimeStr} ì´í›„ ì‹œê°„ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);\n      }\n    }\n\n    // 30ë¶„ ë²”ìœ„ ì¤‘ë³µ ì‹œê°„ ê²€ì¦ (ê¸°ì¡´ ëª©í‘œì™€)\n    const thirtyMinutes = 30 * 60 * 1000;\n    \n    for (const row of rows) {\n      const selectedTime = new Date(row.target_time).getTime();\n      \n      const conflictingGoal = existingGoals.find((g) => {\n        const goalTime = new Date(g.target_time).getTime();\n        const timeDiff = Math.abs(selectedTime - goalTime);\n        return timeDiff < thirtyMinutes;\n      });\n      \n      if (conflictingGoal) {\n        const conflictTimeStr = new Date(conflictingGoal.target_time).toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour: '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n        \n        throw new Error(`${conflictTimeStr}ì— ì„¤ì •ëœ ëª©í‘œì™€ ë„ˆë¬´ ê°€ê¹ìŠµë‹ˆë‹¤. ëª©í‘œ ê°„ê²©ì€ ìµœì†Œ 30ë¶„ ì´ìƒ ìœ ì§€í•´ì£¼ì„¸ìš”.`);\n      }\n    }\n\n    // ë°°ì¹˜ ë‚´ 30ë¶„ ë²”ìœ„ ì¤‘ë³µ ê²€ì¦\n    for (let i = 0; i < rows.length; i++) {\n      for (let j = i + 1; j < rows.length; j++) {\n        const time1 = new Date(rows[i].target_time).getTime();\n        const time2 = new Date(rows[j].target_time).getTime();\n        const timeDiff = Math.abs(time1 - time2);\n        \n        if (timeDiff < thirtyMinutes) {\n          const time1Str = new Date(rows[i].target_time).toLocaleTimeString('ko-KR', {\n            hour12: true, hour: '2-digit', minute: '2-digit',\n          }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n          \n          const time2Str = new Date(rows[j].target_time).toLocaleTimeString('ko-KR', {\n            hour12: true, hour: '2-digit', minute: '2-digit',\n          }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n          \n          throw new Error(`ë°°ì¹˜ ë‚´ ëª©í‘œ ì‹œê°„ì´ ë„ˆë¬´ ê°€ê¹ìŠµë‹ˆë‹¤: ${time1Str}, ${time2Str}\\nëª©í‘œ ê°„ê²©ì€ ìµœì†Œ 30ë¶„ ì´ìƒ ìœ ì§€í•´ì£¼ì„¸ìš”.`);\n        }\n      }\n    }\n\n    const goals: Goal[] = rows.map((r) => ({\n      id: nanoid(),\n      user_id: session.user.id,\n      title: r.title,\n      target_time: r.target_time,\n      status: \"pending\" as const,\n    }));\n\n    const { error } = await supabase.from(\"goals\").insert(goals);\n\n    if (error) {\n      // ë°ì´í„°ë² ì´ìŠ¤ ì œì•½ ì¡°ê±´ ì˜¤ë¥˜ë¥¼ ì¹œì ˆí•œ í•œê¸€ë¡œ ë³€í™˜\n      if (error.message && error.message.includes(\"unique_user_time\")) {\n        throw new Error(\n          \"ì´ë¯¸ ê°™ì€ ì‹œê°„ì— ëª©í‘œê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\\në‹¤ë¥¸ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\",\n        );\n      }\n      throw error;\n    }\n\n    set((state) => ({\n      goals: [...state.goals, ...goals].sort(\n        (a, b) =>\n          new Date(a.target_time).getTime() - new Date(b.target_time).getTime(),\n      ),\n    }));\n\n    // ì‚¬ìš©ì display_name ê°€ì ¸ì˜¤ê¸°\n    const { data: profileData } = await supabase\n      .from(\"profiles\")\n      .select(\"display_name\")\n      .eq(\"id\", session.user.id)\n      .single();\n\n    const userDisplayName = profileData?.display_name || undefined;\n\n    // ğŸš« ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ì „ ë¹„í™œì„±í™” - ì‚¬ìš©ì ìš”ì²­\n    console.log('ğŸš« ìƒˆ ëª©í‘œ ì•Œë¦¼ ë™ê¸°í™” ë¹„í™œì„±í™”ë¨ - ì‚¬ìš©ì ìš”ì²­');\n\n    // ğŸš« íšŒê³  ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ì „ ë¹„í™œì„±í™” - ì‚¬ìš©ì ìš”ì²­\n    console.log('ğŸš« íšŒê³  ì•Œë¦¼ ì‹œìŠ¤í…œ ì˜êµ¬ ë¹„í™œì„±í™”ë¨ - ì‚¬ìš©ì ìš”ì²­');\n    \n    console.log(\"ğŸ”„ ë°°ì¹˜ ëª©í‘œ ì¶”ê°€ ì™„ë£Œ - ì•Œë¦¼ ì‹œìŠ¤í…œ ë¹„í™œì„±í™”ë¨\");\n  },\n\n  updateGoal: async (id: string, data: Partial<Goal>) => {\n    // ì‹œê°„ ë³€ê²½ ì‹œ 3ì‹œê°„ ì œì•½ ë° 30ë¶„ ë²”ìœ„ ì¤‘ë³µ ê²€ì¦\n    if (data.target_time) {\n      // 3ì‹œê°„ ì œì•½ ê²€ì¦ (ë‹¹ì¼ ëª©í‘œì¸ ê²½ìš°)\n      const targetDate = new Date(data.target_time);\n      const now = new Date();\n      const isToday = targetDate.toDateString() === now.toDateString();\n      \n      if (isToday) {\n        const threeHoursFromNow = new Date(now.getTime() + 3 * 60 * 60 * 1000);\n        if (targetDate < threeHoursFromNow) {\n          const currentTimeStr = now.toLocaleTimeString('ko-KR', {\n            hour12: true,\n            hour: '2-digit',\n            minute: '2-digit',\n          }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n          \n          const minimumTimeStr = threeHoursFromNow.toLocaleTimeString('ko-KR', {\n            hour12: true,\n            hour: '2-digit',\n            minute: '2-digit',\n          }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n          \n          throw new Error(`í˜„ì¬ ì‹œê°„(${currentTimeStr})ìœ¼ë¡œë¶€í„° 3ì‹œê°„ í›„ì¸ ${minimumTimeStr} ì´í›„ ì‹œê°„ë§Œ ì„ íƒ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);\n        }\n      }\n\n      const existingGoals = get().goals;\n      const selectedTime = new Date(data.target_time).getTime();\n      const thirtyMinutes = 30 * 60 * 1000;\n      \n      const conflictingGoal = existingGoals.find((g) => {\n        if (g.id === id) return false; // ë³¸ì¸ ëª©í‘œëŠ” ì œì™¸\n        \n        const goalTime = new Date(g.target_time).getTime();\n        const timeDiff = Math.abs(selectedTime - goalTime);\n        return timeDiff < thirtyMinutes;\n      });\n      \n      if (conflictingGoal) {\n        const conflictTimeStr = new Date(conflictingGoal.target_time).toLocaleTimeString('ko-KR', {\n          hour12: true,\n          hour: '2-digit',\n          minute: '2-digit',\n        }).replace('AM', 'ì˜¤ì „').replace('PM', 'ì˜¤í›„');\n        \n        throw new Error(`${conflictTimeStr}ì— ì„¤ì •ëœ ëª©í‘œì™€ ë„ˆë¬´ ê°€ê¹ìŠµë‹ˆë‹¤. ëª©í‘œ ê°„ê²©ì€ ìµœì†Œ 30ë¶„ ì´ìƒ ìœ ì§€í•´ì£¼ì„¸ìš”.`);\n      }\n    }\n\n    console.log(`ğŸ”„ ëª©í‘œ ID \"${id}\" ì—…ë°ì´íŠ¸ ì‹œë„:`, data);\n\n    // ì•ˆì „í•œ ì—…ë°ì´íŠ¸: ê¸°ì¡´ í…Œì´ë¸” í•„ë“œë§Œ ì‚¬ìš©\n    const allowedFields = [\"title\", \"target_time\", \"status\"];\n    const updateData: any = {};\n\n    // í—ˆìš©ëœ í•„ë“œë§Œ ì¶”ê°€\n    Object.keys(data).forEach((key) => {\n      if (allowedFields.includes(key)) {\n        updateData[key] = (data as any)[key];\n      }\n    });\n\n    console.log(`ğŸ”„ ì‹¤ì œ ì—…ë°ì´íŠ¸ ë°ì´í„°:`, updateData);\n\n    // íŠ¸ë¦¬ê±° ë¬¸ì œ íšŒí”¼ë¥¼ ìœ„í•´ ë¡œì»¬ ìƒíƒœë§Œ ì—…ë°ì´íŠ¸\n    const { error } = await supabase\n      .from(\"goals\")\n      .update(updateData)\n      .eq(\"id\", id);\n\n    if (error) {\n      console.error(\"âŒ Supabase ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:\", error);\n\n      // updated_at í•„ë“œ ì˜¤ë¥˜ì¸ ê²½ìš° ë¡œì»¬ ìƒíƒœë§Œ ì—…ë°ì´íŠ¸\n      if (error.message && error.message.includes(\"updated_at\")) {\n        console.log(\"ğŸ”„ updated_at ì˜¤ë¥˜ - ë¡œì»¬ ìƒíƒœë§Œ ì—…ë°ì´íŠ¸í•˜ì—¬ ê³„ì† ì§„í–‰\");\n        // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸ëŠ” ì•„ë˜ì—ì„œ ì²˜ë¦¬\n      } else {\n        // ë°ì´í„°ë² ì´ìŠ¤ ì œì•½ ì¡°ê±´ ì˜¤ë¥˜ë¥¼ ì¹œì ˆí•œ í•œê¸€ë¡œ ë³€í™˜\n        if (error.message && error.message.includes(\"unique_user_time\")) {\n          throw new Error(\n            \"ì´ë¯¸ ê°™ì€ ì‹œê°„ì— ëª©í‘œê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\\në‹¤ë¥¸ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\",\n          );\n        }\n        throw error; // ë‹¤ë¥¸ ì˜¤ë¥˜ëŠ” ì „ë‹¬\n      }\n    }\n\n    console.log(`âœ… ëª©í‘œ ID \"${id}\" ë°ì´í„°ë² ì´ìŠ¤ ì—…ë°ì´íŠ¸ ì™„ë£Œ`);\n\n    // ğŸ”• ëª©í‘œ ìˆ˜ì • ì‹œ ê¸°ì¡´ ì•Œë¦¼ ë¨¼ì € ì·¨ì†Œ\n    console.log(`ğŸ”• ëª©í‘œ ìˆ˜ì •ìœ¼ë¡œ ì•Œë¦¼ ì·¨ì†Œ: ${id}`);\n    await cancelGoalAlarm(id);\n\n    set((state) => {\n      const newGoals = state.goals\n        .map((g) => (g.id === id ? { ...g, ...data } : g))\n        .sort(\n          (a, b) =>\n            new Date(a.target_time).getTime() -\n            new Date(b.target_time).getTime(),\n        );\n\n      console.log(`ğŸ”„ ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸ ì™„ë£Œ. ì´ ëª©í‘œ ìˆ˜: ${newGoals.length}`);\n      return { goals: newGoals };\n    });\n\n    // ìˆ˜ì •ëœ ëª©í‘œì˜ ìƒˆë¡œìš´ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§\n    const updatedGoal = get().goals.find((g) => g.id === id);\n    if (updatedGoal && updatedGoal.status === \"pending\") {\n      // ì‚¬ìš©ì display_name ê°€ì ¸ì˜¤ê¸°\n      const {\n        data: { session },\n      } = await supabase.auth.getSession();\n      if (session) {\n        const { data: profileData } = await supabase\n          .from(\"profiles\")\n          .select(\"display_name\")\n          .eq(\"user_id\", session.user.id)\n          .single();\n\n        const userDisplayName = profileData?.display_name || undefined;\n        \n        // ì•Œë¦¼ ì„¤ì • í™•ì¸ í›„ ìŠ¤ì¼€ì¤„ë§\n        const settingsString = await AsyncStorage.getItem('notificationSettings');\n        const settings = settingsString ? JSON.parse(settingsString) : { goalAlarms: true };\n        \n        // âœ… í†µí•© ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™” - ëª©í‘œ ìˆ˜ì • ì‹œ\n        if (settings.goalAlarms) {\n          console.log(\"ğŸ”” ëª©í‘œ ìˆ˜ì •ìœ¼ë¡œ ì•Œë¦¼ ì¬ìŠ¤ì¼€ì¤„ë§\");\n          try {\n            await unifiedNotificationManager.scheduleGoalNotification(updatedGoal.id, updatedGoal.title, new Date(updatedGoal.target_time), userDisplayName);\n          } catch (error) {\n            console.log(\"âš ï¸ í†µí•© ì•Œë¦¼ ì‹¤íŒ¨, ê¸°ì¡´ ì‹œìŠ¤í…œ ì‚¬ìš©:\", error);\n            await scheduleGoalAlarm(updatedGoal.id, updatedGoal.title, new Date(updatedGoal.target_time), userDisplayName);\n          }\n        } else {\n          console.log(\"ğŸ”• ëª©í‘œ ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ ìŠ¤ì¼€ì¤„ë§ ê±´ë„ˆëœ€\");\n        }\n        \n        // íšŒê³  ì•Œë¦¼ ì—…ë°ì´íŠ¸\n        if (settings.retrospectReminders && data.target_time) {\n          console.log('ğŸ“ ëª©í‘œ ì‹œê°„ ë³€ê²½ìœ¼ë¡œ íšŒê³  ì•Œë¦¼ ì—…ë°ì´íŠ¸');\n          setTimeout(() => get().scheduleRetrospectForLastGoal(), 1000);\n        }\n      }\n    }\n\n    // ëª©í‘œ ì‹œê°„ ë³€ê²½ ì‹œ íšŒê³  ì•Œë¦¼ ì˜ˆì•½ ì—…ë°ì´íŠ¸\n    if (data.target_time) {\n      console.log(\"â° ëª©í‘œ ì‹œê°„ ë³€ê²½ìœ¼ë¡œ ì¸í•œ íšŒê³  ì•Œë¦¼ ì˜ˆì•½ ì—…ë°ì´íŠ¸\");\n      if (typeof window !== 'undefined' && (window as any).updateRetrospectScheduleOnGoalTimeChange) {\n        setTimeout(() => {\n          (window as any).updateRetrospectScheduleOnGoalTimeChange();\n        }, 500);\n      }\n    }\n\n    // ëª©í‘œ ìƒíƒœ ë³€ê²½ ë¡œê·¸\n    if (data.status) {\n      console.log(`ğŸ”„ ëª©í‘œ ìƒíƒœ ë³€ê²½ ê°ì§€: ${id} â†’ ${data.status}`);\n    }\n  },\n\n  deleteGoal: async (id: string) => {\n    // ì‚­ì œí•  ëª©í‘œ ì°¾ê¸°\n    const goals = get().goals;\n    const targetGoal = goals.find((g) => g.id === id);\n    if (!targetGoal) {\n      throw new Error(\"ëª©í‘œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\n    }\n\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ê³„ì‚°\n    const koreaTime = getKoreaTime();\n    \n    const todayKey = koreaTime.toISOString().slice(0, 10);\n    const tomorrowKey = new Date(koreaTime.getTime() + 86400000)\n      .toISOString()\n      .slice(0, 10);\n\n    // ëª©í‘œ ë‚ ì§œ í™•ì¸\n    const goalDate = new Date(targetGoal.target_time);\n    const goalKoreanDate = new Date(goalDate.getTime() + 9 * 60 * 60 * 1000);\n    const goalDateKey = goalKoreanDate.toISOString().slice(0, 10);\n\n    // ì˜¤ëŠ˜ ëª©í‘œ ì‚­ì œ ì œí•œ (ìµœì†Œ 5ê°œ)\n    const todayGoals = goals.filter((g) => {\n      const gDate = new Date(g.target_time);\n      const gKoreanDate = new Date(gDate.getTime() + 9 * 60 * 60 * 1000);\n      return gKoreanDate.toISOString().slice(0, 10) === todayKey;\n    });\n\n    if (goalDateKey === todayKey && todayGoals.length <= 5) {\n      throw new Error(\"ì˜¤ëŠ˜ ëª©í‘œëŠ” ìµœì†Œ 5ê°œ ì´ìƒ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.\");\n    }\n\n    // ë‚´ì¼ ëª©í‘œ ì‚­ì œ ì œí•œ (ìµœì†Œ 5ê°œ)\n    const tomorrowGoals = goals.filter((g) => {\n      const gDate = new Date(g.target_time);\n      const gKoreanDate = new Date(gDate.getTime() + 9 * 60 * 60 * 1000);\n      return gKoreanDate.toISOString().slice(0, 10) === tomorrowKey;\n    });\n\n    if (goalDateKey === tomorrowKey && tomorrowGoals.length <= 5) {\n      throw new Error(\"ë‚´ì¼ ëª©í‘œëŠ” ìµœì†Œ 5ê°œ ì´ìƒ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤.\");\n    }\n\n    console.log(\"ğŸ—‘ï¸ ëª©í‘œ ì‚­ì œ ê²€ì¦:\", {\n      ëª©í‘œID: id,\n      ëª©í‘œë‚ ì§œ: goalDateKey,\n      ì˜¤ëŠ˜ë‚ ì§œ: todayKey,\n      ë‚´ì¼ë‚ ì§œ: tomorrowKey,\n      ì˜¤ëŠ˜ëª©í‘œìˆ˜: todayGoals.length,\n      ë‚´ì¼ëª©í‘œìˆ˜: tomorrowGoals.length,\n      ì‚­ì œê°€ëŠ¥: true,\n    });\n\n    const { error } = await supabase.from(\"goals\").delete().eq(\"id\", id);\n\n    if (error) {\n      // ë°ì´í„°ë² ì´ìŠ¤ ì œì•½ ì¡°ê±´ ì˜¤ë¥˜ë¥¼ ì¹œì ˆí•œ í•œê¸€ë¡œ ë³€í™˜\n      if (error.message && error.message.includes(\"unique_user_time\")) {\n        throw new Error(\n          \"ì´ë¯¸ ê°™ì€ ì‹œê°„ì— ëª©í‘œê°€ ë“±ë¡ë˜ì–´ ìˆìŠµë‹ˆë‹¤.\\në‹¤ë¥¸ ì‹œê°„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.\",\n        );\n      }\n      throw error;\n    }\n\n    // ğŸ”• ëª©í‘œ ì‚­ì œ ì‹œ ì•Œë¦¼ ì •ë¦¬ (Supabase ë™ê¸°í™”)\n\n    set((state) => ({\n      goals: state.goals.filter((g) => g.id !== id),\n    }));\n  },\n\n  addAchievementMemo: async (id: string, memo: string) => {\n    const {\n      data: { session },\n    } = await supabase.auth.getSession();\n    if (!session) return;\n\n    console.log(`ğŸ“ ëª©í‘œ ë‹¬ì„± ë©”ëª¨ ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì‹œë„: ${id} - ${memo}`);\n\n    // ë°ì´í„°ë² ì´ìŠ¤ì— ë©”ëª¨ ì €ì¥\n    const { error } = await supabase\n      .from(\"goals\")\n      .update({ achievement_memo: memo })\n      .eq(\"id\", id);\n\n    if (error) {\n      console.error(\"âŒ ë‹¬ì„± ë©”ëª¨ ì €ì¥ ì‹¤íŒ¨:\", error);\n      // ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì‹¤íŒ¨ ì‹œì—ë„ ë¡œì»¬ ìƒíƒœëŠ” ì—…ë°ì´íŠ¸\n      set((state) => ({\n        goals: state.goals.map((g) =>\n          g.id === id ? { ...g, achievement_memo: memo } : g,\n        ),\n      }));\n      return;\n    }\n\n    console.log(`âœ… ëª©í‘œ ë‹¬ì„± ë©”ëª¨ ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì™„ë£Œ: ${id}`);\n\n    // ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì„±ê³µ ì‹œ ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\n    set((state) => ({\n      goals: state.goals.map((g) =>\n        g.id === id ? { ...g, achievement_memo: memo } : g,\n      ),\n    }));\n  },\n\n  cleanupOldGoals: async () => {\n    const {\n      data: { session },\n    } = await supabase.auth.getSession();\n    if (!session) return;\n\n    // 2ë…„ ì´ì „ì˜ ì •ë§ ì˜¤ë˜ëœ ëª©í‘œë“¤ë§Œ ì‚­ì œ (2ë…„ ë³´ê´€ ì •ì±…)\n    const twoYearsAgo = new Date();\n    twoYearsAgo.setFullYear(twoYearsAgo.getFullYear() - 2);\n    const cutoffDate = twoYearsAgo.toISOString().slice(0, 10);\n\n    console.log(\"ğŸ§¹ 2ë…„ ì´ì „ ëª©í‘œë“¤ ì •ë¦¬ ì¤‘...\", { cutoffDate });\n\n    const { data: oldGoals, error: fetchError } = await supabase\n      .from(\"goals\")\n      .select(\"id, title, target_time\")\n      .eq(\"user_id\", session.user.id)\n      .lt(\"target_time\", cutoffDate + \"T00:00:00.000Z\");\n\n    if (fetchError) {\n      console.error(\"ì˜¤ë˜ëœ ëª©í‘œ ì¡°íšŒ ì‹¤íŒ¨:\", fetchError);\n      return;\n    }\n\n    if (oldGoals && oldGoals.length > 0) {\n      console.log(\n        `ğŸ—‘ï¸ ì‚­ì œí•  2ë…„ ì´ì „ ëª©í‘œ ${oldGoals.length}ê°œ:`,\n        oldGoals.map((g) => g.title),\n      );\n\n      const { error: deleteError } = await supabase\n        .from(\"goals\")\n        .delete()\n        .eq(\"user_id\", session.user.id)\n        .lt(\"target_time\", cutoffDate + \"T00:00:00.000Z\");\n\n      if (deleteError) {\n        console.error(\"2ë…„ ì´ì „ ëª©í‘œ ì‚­ì œ ì‹¤íŒ¨:\", deleteError);\n      } else {\n        console.log(`âœ… 2ë…„ ì´ì „ ëª©í‘œ ${oldGoals.length}ê°œ ì‚­ì œ ì™„ë£Œ`);\n      }\n    } else {\n      console.log(\"ğŸ‰ 2ë…„ ì´ì „ ëª©í‘œ ì—†ìŒ - ì •ë¦¬í•  ë°ì´í„° ì—†ìŒ\");\n    }\n\n    // ì¤‘ë³µ ëª©í‘œ ì •ë¦¬\n    await get().removeDuplicateGoals();\n\n    // ëª©í‘œ ëª©ë¡ ìƒˆë¡œê³ ì¹¨\n    await get().fetchGoals();\n  },\n\n  removeDuplicateGoals: async () => {\n    const {\n      data: { session },\n    } = await supabase.auth.getSession();\n    if (!session) return;\n\n    console.log(\"ğŸ”„ ì¤‘ë³µ ëª©í‘œ ì •ë¦¬ ì¤‘...\");\n\n    // ëª¨ë“  ëª©í‘œ ì¡°íšŒ\n    const { data: allGoals, error } = await supabase\n      .from(\"goals\")\n      .select(\"*\")\n      .eq(\"user_id\", session.user.id)\n      .order(\"created_at\", { ascending: true });\n\n    if (error) {\n      console.error(\"ëª©í‘œ ì¡°íšŒ ì‹¤íŒ¨:\", error);\n      return;\n    }\n\n    if (!allGoals || allGoals.length === 0) return;\n\n    // ì¤‘ë³µ ì‹œê°„ ì°¾ê¸°\n    const timeGroups = new Map<string, typeof allGoals>();\n    allGoals.forEach((goal) => {\n      const time = goal.target_time;\n      if (!timeGroups.has(time)) {\n        timeGroups.set(time, []);\n      }\n      timeGroups.get(time)!.push(goal);\n    });\n\n    // ì¤‘ë³µëœ ê²ƒë“¤ ì²˜ë¦¬\n    const toDelete: string[] = [];\n    timeGroups.forEach((goals, time) => {\n      if (goals.length > 1) {\n        console.log(\n          `âš ï¸ ì¤‘ë³µëœ ì‹œê°„ ${time}ì— ${goals.length}ê°œ ëª©í‘œ:`,\n          goals.map((g) => g.title),\n        );\n        // ê°€ì¥ ì˜¤ë˜ëœ ê²ƒë§Œ ë‚¨ê¸°ê³  ë‚˜ë¨¸ì§€ ì‚­ì œ\n        goals.slice(1).forEach((goal) => {\n          toDelete.push(goal.id);\n        });\n      }\n    });\n\n    if (toDelete.length > 0) {\n      console.log(`ğŸ—‘ï¸ ì¤‘ë³µ ëª©í‘œ ${toDelete.length}ê°œ ì‚­ì œ ì¤‘...`);\n\n      const { error: deleteError } = await supabase\n        .from(\"goals\")\n        .delete()\n        .in(\"id\", toDelete);\n\n      if (deleteError) {\n        console.error(\"ì¤‘ë³µ ëª©í‘œ ì‚­ì œ ì‹¤íŒ¨:\", deleteError);\n      } else {\n        console.log(`âœ… ì¤‘ë³µ ëª©í‘œ ${toDelete.length}ê°œ ì‚­ì œ ì™„ë£Œ`);\n      }\n    }\n  },\n\n  checkGoal: async (id: string) => {\n    const goal = get().goals.find((g) => g.id === id);\n    if (!goal) return;\n\n    // ğŸš« ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ì „ ë¹„í™œì„±í™” - ì‚¬ìš©ì ìš”ì²­\n    console.log('ğŸš« ëª©í‘œ ì²´í¬ ì•Œë¦¼ ì·¨ì†Œ ì‹œìŠ¤í…œ ì˜êµ¬ ë¹„í™œì„±í™”ë¨ - ì‚¬ìš©ì ìš”ì²­');\n\n    // ì‚¬ìš©ìê°€ ì§ì ‘ ì²´í¬í•˜ëŠ” ê²½ìš° = ìŠ¹ë¦¬\n    await get().updateGoal(id, { status: \"success\" });\n\n    // ìŠ¹ë¦¬ ì—°ì† ë±ƒì§€ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ - ì˜¤ëŠ˜ì˜ ì¹´í…Œê³ ë¦¬ ê³ ì • ì‚¬ìš©\n    // í˜„ì¬ ì—°ìŠ¹ ìƒíƒœ í™•ì¸\n    \n    // ì˜¤ëŠ˜ì˜ ê³ ì •ëœ ë±ƒì§€ ì¹´í…Œê³ ë¦¬ ê°€ì ¸ì˜¤ê¸°\n    const todayCategory = await streakManager.getTodayBadgeCategory();\n    const currentStreak = streakManager.getTodayStreak();\n    const newStreakLevel = Math.min(currentStreak + 1, 12);\n    \n    // ìˆ˜ë™ìœ¼ë¡œ ë±ƒì§€ ìƒì„± (ê³ ì •ëœ ì¹´í…Œê³ ë¦¬ ì‚¬ìš©)\n    const newBadge = {\n      level: newStreakLevel,\n      category: todayCategory,\n      iconPath: streakManager.getBadgeIconPath(newStreakLevel, todayCategory)\n    };\n    \n    // ë©”ëª¨ë¦¬ì— ì—°ìŠ¹ ìˆ˜ ì—…ë°ì´íŠ¸\n    await streakManager.incrementStreak();\n    \n    // ì—°ìŠ¹ ë±ƒì§€ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ ì™„ë£Œ\n    set((state) => {\n      const newGoalBadges = new Map(state.goalBadges);\n      newGoalBadges.set(id, newBadge);\n      return { \n        ...state, \n        streakBadge: newBadge,\n        goalBadges: newGoalBadges\n      };\n    });\n\n    // ëª©í‘œ ì™„ë£Œ ì‹œ ì•Œë¦¼ ì²˜ë¦¬ (ê°„ì†Œí™”)\n    console.log(`âœ… ëª©í‘œ ì™„ë£Œ ì²˜ë¦¬: ${id}`);\n\n    // ë§ˆì§€ë§‰ ëª©í‘œ ì„±ê³µ ì‹œ íšŒê³  ì•Œë¦¼ ê´€ë¦¬\n    await get().cancelRetrospectIfLastGoalSuccess(id);\n    \n    // í•´ë‹¹ ëª©í‘œì˜ ì‹œê°„ ì •ë³´ ì°¾ê¸°\n    const targetGoal = get().goals.find(g => g.id === id);\n    if (targetGoal && typeof window !== 'undefined' && (window as any).cancelRetrospectOnLastGoalSuccess) {\n      (window as any).cancelRetrospectOnLastGoalSuccess(targetGoal.target_time);\n    }\n  },\n\n  getGoalsWithCanCheck: (isRetrospectDone = false) => {\n    const goals = get().goals;\n    \n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ ë‚ ì§œ ê³„ì‚°\n    const today = getTodayKorea();\n\n    return goals.map((goal) => {\n      const targetTime = new Date(goal.target_time);\n      const now = getKoreaTime();\n      const timeDiff = now.getTime() - targetTime.getTime();\n      const minutesDiff = timeDiff / (1000 * 60);\n      const isToday = goal.target_time.startsWith(today);\n\n      // ì˜¤ëŠ˜ ëª©í‘œ: ëª©í‘œ ì‹œê°„ 5ë¶„ ì „ë¶€í„° ì²´í¬ ê°€ëŠ¥í•˜ê³ , 5ë¶„ í›„ê¹Œì§€ ì²´í¬ ê°€ëŠ¥\n      // ë‚´ì¼ ëª©í‘œ: íšŒê³  ì™„ë£Œ í›„ì—ëŠ” í•­ìƒ í‘œì‹œ (ì²´í¬ëŠ” ë¶ˆê°€ëŠ¥)\n      const canCheck =\n        goal.status === \"pending\" &&\n        isToday &&\n        minutesDiff >= -5 &&\n        minutesDiff <= 5;\n\n      if (Math.abs(minutesDiff) <= 10) {\n        // 10ë¶„ ì´ë‚´ì¸ ëª©í‘œë§Œ ë¡œê·¸\n        console.log(\n          `ğŸ” ì²´í¬ ê°€ëŠ¥ ì—¬ë¶€ - ${goal.title}: ${canCheck} (ì‹œê°„ì°¨: ${minutesDiff.toFixed(1)}ë¶„, ìƒíƒœ: ${goal.status})`,\n        );\n      }\n\n      const canEditGoal = canEdit(goal, isRetrospectDone);\n\n      return { goal, canCheck, canEdit: canEditGoal };\n    });\n  },\n\n  expireOverdueGoals: async () => {\n    const goals = get().goals;\n    const now = getKoreaTime();\n\n    // ìƒì„¸ ë¡œê·¸ëŠ” 5ë¶„ë§ˆë‹¤ë§Œ ì¶œë ¥ (ì„±ëŠ¥ ìµœì í™”)\n    const lastExpireLogTime = parseInt(await AsyncStorage.getItem('lastExpireLogTime') || '0');\n    const currentTime = Date.now();\n    \n    if (currentTime - lastExpireLogTime > 180000) { // 3ë¶„ ê°„ê²©\n      console.log(\"ğŸ” expireOverdueGoals ì‹¤í–‰ ì¤‘...\", {\n        í˜„ì¬ì‹œê°„: now.toLocaleString(\"ko-KR\"),\n        ì´ëª©í‘œê°œìˆ˜: goals.length,\n      });\n      await AsyncStorage.setItem('lastExpireLogTime', currentTime.toString());\n    }\n\n    // pending ìƒíƒœì¸ ëª©í‘œë“¤ë§Œ ë¨¼ì € ì°¾ê¸°\n    const pendingGoals = goals.filter((g) => g.status === \"pending\");\n    console.log(\n      \"ğŸ” pending ìƒíƒœ ëª©í‘œë“¤:\",\n      pendingGoals.map((g) => g.title),\n    );\n\n    const overdueGoals = goals.filter((g) => {\n      if (g.status !== \"pending\") return false;\n\n      const targetTime = new Date(g.target_time);\n      const now = getKoreaTime();\n      const timeDiff = now.getTime() - targetTime.getTime();\n      const minutesDiff = timeDiff / (1000 * 60);\n      const hoursDiff = timeDiff / (1000 * 60 * 60);\n\n      // ëª©í‘œ ë§Œë£Œ ì‹œê°„ ì²´í¬\n      // 1. ëª©í‘œ ì‹œê°„ìœ¼ë¡œë¶€í„° 5ë¶„ ì´ˆê³¼ ì‹œ ì‹¤íŒ¨ ì²˜ë¦¬\n      // 2. 24ì‹œê°„ ì´ìƒ ê²½ê³¼í•œ ëª©í‘œëŠ” ë¬´ì¡°ê±´ ì‹¤íŒ¨ ì²˜ë¦¬ (ë‚ ì§œê°€ ë°”ë€ ê²½ìš°)\n      const isOverdue = minutesDiff > 5 || hoursDiff > 24;\n      \n      if (isOverdue && hoursDiff > 24) {\n        console.log(`ğŸ“… 24ì‹œê°„ ê²½ê³¼ ëª©í‘œ ì‹¤íŒ¨ ì²˜ë¦¬: ${g.title} (${hoursDiff.toFixed(1)}ì‹œê°„ ê²½ê³¼)`);\n      }\n\n      return isOverdue;\n    });\n\n    // ë§Œë£Œ ëŒ€ìƒ ëª©í‘œ í™•ì¸ ì™„ë£Œ\n\n    for (const goal of overdueGoals) {\n      // ëª©í‘œ ì‹¤íŒ¨ ì²˜ë¦¬ ì‹œì‘\n      try {\n        await get().updateGoal(goal.id, { status: \"failure\" });\n        // ëª©í‘œ ì‹¤íŒ¨ ì²˜ë¦¬ ì™„ë£Œ\n\n        // íŒ¨ë°° ì—°ìŠ¹ ë±ƒì§€ ì‹œìŠ¤í…œ ì—…ë°ì´íŠ¸ (ì—°ìŠ¹ -1)\n        const newBadge = await streakManager.onDefeat();\n        if (newBadge) {\n          // íŒ¨ë°°ë¡œ ì—°ìŠ¹ ê°ì†Œ\n          set((state) => ({ ...state, streakBadge: newBadge }));\n        } else {\n          // íŒ¨ë°°ë¡œ ì—°ìŠ¹ ì´ˆê¸°í™”\n          set((state) => ({ ...state, streakBadge: null }));\n        }\n        \n        // ì‹¤íŒ¨ ì²˜ë¦¬ ì™„ë£Œ (íšŒê³  ì•Œë¦¼ì€ ì´ë¯¸ ì˜ˆì•½ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ë³„ë„ ì²˜ë¦¬ ë¶ˆí•„ìš”)\n        // ëª©í‘œ ì‹¤íŒ¨ ì²˜ë¦¬ ì™„ë£Œ, íšŒê³  ì•Œë¦¼ ìœ ì§€\n        \n      } catch (error) {\n        console.error(`ğŸ’¥ ëª©í‘œ \"${goal.title}\" ì‹¤íŒ¨ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:`, error);\n      }\n    }\n  },\n\n  getTodaySummary: () => {\n    const goals = get().goals;\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ ë‚ ì§œ ê³„ì‚°\n    \n    \n    const today = getTodayKorea();\n    const todayGoals = goals.filter((g) => g.target_time.startsWith(today));\n\n    const allDone =\n      todayGoals.length > 0 && todayGoals.every((g) => g.status !== \"pending\");\n    const hasFailure = todayGoals.some((g) => g.status === \"failure\");\n\n    return { allDone, hasFailure };\n  },\n\n\n\n  // ì•± ì‹œì‘ ì‹œ ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ì²´í¬\n  checkDelayedRetrospectReminder: async () => {\n    try {\n      console.log('ğŸ”” ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™” - ì²´í¬ ì‹œì‘');\n      \n      // ì‚¬ìš©ì íšŒê³  ì•Œë¦¼ ì„¤ì • í™•ì¸\n      const settingsString = await AsyncStorage.getItem('notificationSettings');\n      const settings = settingsString ? JSON.parse(settingsString) : { retrospectReminders: true };\n      \n      if (!settings.retrospectReminders) {\n        return;\n      }\n\n      const goals = get().goals;\n      const now = getKoreaTime();\n      const today = getTodayKorea();\n      const todayGoals = goals.filter((g) => g.target_time.startsWith(today));\n\n      console.log(\"ğŸ” íšŒê³  ì•Œë¦¼ ì²´í¬ ìƒì„¸:\", {\n        í˜„ì¬ì‹œê°„: now.toLocaleString(\"ko-KR\"),\n        ì˜¤ëŠ˜ë‚ ì§œ: today,\n        ì „ì²´ëª©í‘œìˆ˜: goals.length,\n        ì˜¤ëŠ˜ëª©í‘œìˆ˜: todayGoals.length,\n        ì˜¤ëŠ˜ëª©í‘œë“¤: todayGoals.map(g => ({ title: g.title, status: g.status, time: g.target_time }))\n      });\n\n      if (todayGoals.length === 0) {\n        console.log(\"ğŸ“­ ì˜¤ëŠ˜ ëª©í‘œê°€ ì—†ì–´ íšŒê³  ì•Œë¦¼ ë³µì› ì•ˆí•¨\");\n        return;\n      }\n\n      // ëª¨ë“  ë‹¹ì¼ ëª©í‘œê°€ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸\n      const allCompleted = todayGoals.every((g) => g.status !== \"pending\");\n      if (!allCompleted) {\n        console.log(\"â³ ì•„ì§ ë¯¸ì™„ë£Œ ëª©í‘œê°€ ìˆì–´ íšŒê³  ì•Œë¦¼ ì•ˆí•¨\");\n        return;\n      }\n\n      // ì´ë¯¸ íšŒê³ ë¥¼ ì‘ì„±í–ˆëŠ”ì§€ í™•ì¸\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) {\n        console.log(\"ğŸš« ì„¸ì…˜ ì—†ìŒ - íšŒê³  ì•Œë¦¼ ì²´í¬ ì¤‘ë‹¨\");\n        return;\n      }\n\n      const { data: retrospectData } = await supabase\n        .from(\"retrospects\")\n        .select(\"id\")\n        .eq(\"user_id\", session.user.id)\n        .eq(\"date\", today)\n        .single();\n\n      if (retrospectData) {\n        console.log(\"âœ… ì´ë¯¸ íšŒê³  ì‘ì„± ì™„ë£Œ - ì•Œë¦¼ ì•ˆí•¨\");\n        return;\n      }\n\n      // ë§ˆì§€ë§‰ ëª©í‘œì˜ ì™„ë£Œ ì‹œê°„ ì°¾ê¸°\n      const completedGoals = todayGoals.filter((g) => g.status !== \"pending\");\n      \n      if (completedGoals.length === 0) {\n        console.log(\"ğŸš« ì™„ë£Œëœ ëª©í‘œê°€ ì—†ìŒ - íšŒê³  ì•Œë¦¼ ì•ˆí•¨\");\n        return;\n      }\n      \n      const lastGoalTime = Math.max(\n        ...completedGoals.map((g) => new Date(g.target_time).getTime()),\n      );\n      const retrospectTime = new Date(lastGoalTime + 30 * 60 * 1000);\n\n      console.log(\"ğŸ” ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ì²´í¬:\", {\n        ì˜¤ëŠ˜ëª©í‘œìˆ˜: todayGoals.length,\n        ì™„ë£Œëœëª©í‘œìˆ˜: completedGoals.length,\n        ë§ˆì§€ë§‰ëª©í‘œì‹œê°„: new Date(lastGoalTime).toLocaleString(\"ko-KR\"),\n        íšŒê³ ì˜ˆì •ì‹œê°„: retrospectTime.toLocaleString(\"ko-KR\"),\n        í˜„ì¬ì‹œê°„: now.toLocaleString(\"ko-KR\"),\n        ì•Œë¦¼í•„ìš”: retrospectTime <= now,\n        íšŒê³ ì‘ì„±ì—¬ë¶€: !!retrospectData\n      });\n\n      // íšŒê³  ì‹œê°„ì´ ì´ë¯¸ ì§€ë‚¬ê³  íšŒê³ ë¥¼ ì•„ì§ ì‘ì„±í•˜ì§€ ì•Šì•˜ë‹¤ë©´ í•œ ë²ˆë§Œ ì•Œë¦¼\n      if (retrospectTime <= now) {\n        console.log(\"ğŸš¨ ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ë°œê²¬! ë‹¨ë°œì„± ì•Œë¦¼ ë°œì†¡\");\n        try {\n          await scheduleRetrospectReminderImmediate();\n          console.log(\"âœ… ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ë°œì†¡ ì„±ê³µ - ë” ì´ìƒ ë°˜ë³µ ì•ˆí•¨\");\n        } catch (error) {\n          console.error(\"âŒ ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ë°œì†¡ ì‹¤íŒ¨:\", error);\n        }\n      } else {\n        console.log(\"â° íšŒê³  ì‹œê°„ì´ ì•„ì§ ì•ˆë¨ - ë‚˜ì¤‘ì— ì•Œë¦¼ ì˜ˆì •\");\n      }\n    } catch (error) {\n      console.error(\"ì§€ì—°ëœ íšŒê³  ì•Œë¦¼ ì²´í¬ ì‹¤íŒ¨:\", error);\n    }\n  },\n\n  // ë§ˆì§€ë§‰ ëª©í‘œ + 30ë¶„ í›„ íšŒê³  ì•Œë¦¼ ì˜ˆì•½\n  scheduleRetrospectForLastGoal: async () => {\n    try {\n      console.log('ğŸ”” íšŒê³  ì•Œë¦¼ ì˜ˆì•½ ì‹œìŠ¤í…œ í™œì„±í™”');\n      \n      // ì‚¬ìš©ì íšŒê³  ì•Œë¦¼ ì„¤ì • í™•ì¸\n      const settingsString = await AsyncStorage.getItem('notificationSettings');\n      const settings = settingsString ? JSON.parse(settingsString) : { retrospectReminders: true };\n      \n      if (!settings.retrospectReminders) {\n        console.log(\"ğŸ”• íšŒê³  ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ íšŒê³  ì•Œë¦¼ ì˜ˆì•½ ê±´ë„ˆëœ€\");\n        return;\n      }\n\n      const goals = get().goals;\n      const today = getTodayKorea();\n      const todayGoals = goals.filter((g) => g.target_time.startsWith(today));\n\n      if (todayGoals.length === 0) {\n        console.log(\"ğŸ“­ ì˜¤ëŠ˜ ëª©í‘œê°€ ì—†ì–´ íšŒê³  ì•Œë¦¼ ì˜ˆì•½ ì•ˆí•¨\");\n        return;\n      }\n\n      // ë§ˆì§€ë§‰ ëª©í‘œ ì‹œê°„ ì°¾ê¸°\n      const lastGoalTime = Math.max(\n        ...todayGoals.map((g) => new Date(g.target_time).getTime())\n      );\n      const lastGoal = new Date(lastGoalTime);\n\n      console.log(`ğŸ”” íšŒê³  ì•Œë¦¼ ì˜ˆì•½: ë§ˆì§€ë§‰ ëª©í‘œ ${lastGoal.toLocaleString('ko-KR')} + 30ë¶„`);\n\n      // ê¸°ì¡´ íšŒê³  ì•Œë¦¼ ì·¨ì†Œ í›„ ìƒˆë¡œ ì˜ˆì•½\n      await cancelRetrospectReminder();\n      await scheduleRetrospectReminder(lastGoal);\n    } catch (error) {\n      console.error(\"âŒ íšŒê³  ì•Œë¦¼ ì˜ˆì•½ ì‹¤íŒ¨:\", error);\n    }\n  },\n\n  // ë§ˆì§€ë§‰ ëª©í‘œ ì„±ê³µ ì‹œ íšŒê³  ì•Œë¦¼ ì·¨ì†Œ\n  cancelRetrospectIfLastGoalSuccess: async (goalId: string) => {\n    try {\n      // ì‚¬ìš©ì íšŒê³  ì•Œë¦¼ ì„¤ì • í™•ì¸\n      const settingsString = await AsyncStorage.getItem('notificationSettings');\n      const settings = settingsString ? JSON.parse(settingsString) : { retrospectReminders: true };\n      \n      if (!settings.retrospectReminders) {\n        console.log(\"ğŸ”• íšŒê³  ì•Œë¦¼ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ ì·¨ì†Œ ì‘ì—… ê±´ë„ˆëœ€\");\n        return;\n      }\n\n      const goals = get().goals;\n      const today = getTodayKorea();\n      const todayGoals = goals.filter((g) => g.target_time.startsWith(today));\n      \n      if (todayGoals.length === 0) return;\n\n      // ì„±ê³µí•œ ëª©í‘œê°€ ë§ˆì§€ë§‰ ëª©í‘œì¸ì§€ í™•ì¸\n      const lastGoalTime = Math.max(\n        ...todayGoals.map((g) => new Date(g.target_time).getTime())\n      );\n      const successGoal = goals.find(g => g.id === goalId);\n      \n      if (successGoal && new Date(successGoal.target_time).getTime() === lastGoalTime) {\n        console.log(\"ğŸ‰ ë§ˆì§€ë§‰ ëª©í‘œ ì„±ê³µ! íšŒê³  ì•Œë¦¼ ì·¨ì†Œ\");\n        await cancelRetrospectReminder();\n      } else {\n        console.log(\"â³ ë§ˆì§€ë§‰ ëª©í‘œê°€ ì•„ë‹ˆë¯€ë¡œ íšŒê³  ì•Œë¦¼ ìœ ì§€\");\n      }\n    } catch (error) {\n      console.error(\"âŒ íšŒê³  ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨:\", error);\n    }\n  },\n\n  // ì—°ìŠ¹ ë±ƒì§€ ê´€ë ¨ ë©”ì„œë“œë“¤\n  getCurrentStreak: () => {\n    return streakManager.getTodayStreak();\n  },\n\n  getStreakCategory: async () => {\n    return await streakManager.getTodayBadgeCategory();\n  },\n\n  // ì•Œë¦¼ ë””ë²„ê¹… ê´€ë ¨\n  checkAllNotifications: async () => {\n    console.log(\"ğŸ” í˜„ì¬ ì„¤ì •ëœ ì•Œë¦¼ í™•ì¸ ì‹œì‘\");\n    try {\n      const notifications = await unifiedNotificationManager.getScheduledNotifications();\n      console.log(`ğŸ“Š í†µí•© ì‹œìŠ¤í…œ: ${notifications.length}ê°œ ì•Œë¦¼ ì˜ˆì•½ë¨`);\n      await getAllScheduledNotifications();\n    } catch (error) {\n      console.log(\"âš ï¸ í†µí•© ì•Œë¦¼ ì¡°íšŒ ì‹¤íŒ¨, ê¸°ì¡´ ì‹œìŠ¤í…œ ì‚¬ìš©:\", error);\n      await getAllScheduledNotifications();\n    }\n  },\n\n  cancelAllNotifications: async () => {\n    console.log(\"ğŸ§¹ ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ ì‹œì‘\");\n    try {\n      await unifiedNotificationManager.cancelAllNotifications();\n      console.log(\"âœ… í†µí•© ì‹œìŠ¤í…œìœ¼ë¡œ ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ ì™„ë£Œ\");\n    } catch (error) {\n      console.log(\"âš ï¸ í†µí•© ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨, ê¸°ì¡´ ì‹œìŠ¤í…œ ì‚¬ìš©:\", error);\n      await cancelAllNotifications();\n    }\n  },\n\n  // ë°ì´í„° ì´ˆê¸°í™” í•¨ìˆ˜\n  clearAllGoals: () => {\n    console.log(\"ğŸ§¹ ëª¨ë“  ëª©í‘œ ë°ì´í„° ë¡œì»¬ ìŠ¤í† ì–´ ì´ˆê¸°í™”\");\n    set({ \n      goals: [], \n      streakBadge: null,\n      goalBadges: new Map()\n    });\n  },\n}));\n\nexport default useGoalStore;\n","size_bytes":56232},"src/store/motivationMessageStore.ts":{"content":"import { create } from \"zustand\";\nimport { supabase } from \"../supabaseClient\";\nimport { format, subDays } from \"date-fns\";\n\nexport interface MotivationMessage {\n  id: string;\n  performance_level: \"base\" | \"bad\" | \"soso\" | \"good\" | \"transcend\";\n  title: string;\n  message: string;\n  is_active: boolean;\n  display_order: number;\n  created_at: string;\n  updated_at: string;\n}\n\nexport type PerformanceLevel = \"base\" | \"bad\" | \"soso\" | \"good\" | \"transcend\";\n\ninterface MotivationMessageState {\n  messages: MotivationMessage[];\n  currentMessage: MotivationMessage | null;\n  loading: boolean;\n\n  // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\n  fetchMessages: () => Promise<void>;\n\n  // ì „ë‚  ìˆ˜í–‰ë¥  ê³„ì‚° ë° ë©”ì‹œì§€ ì„ íƒ\n  calculateYesterdayPerformance: () => Promise<PerformanceLevel>;\n  getTodaysMotivationMessage: () => Promise<void>;\n\n  // ìˆ˜í–‰ë¥  ë ˆë²¨ ê²°ì •\n  getPerformanceLevel: (successRate: number) => PerformanceLevel;\n\n  // ë©”ì‹œì§€ ëœë¤ ì„ íƒ\n  getRandomMessageForLevel: (\n    level: PerformanceLevel,\n  ) => MotivationMessage | null;\n}\n\nexport const useMotivationMessageStore = create<MotivationMessageState>(\n  (set, get) => ({\n    messages: [],\n    currentMessage: null,\n    loading: false,\n\n    fetchMessages: async () => {\n      try {\n        set({ loading: true });\n\n        const { data, error } = await supabase\n          .from(\"motivation_messages\")\n          .select(\"*\")\n          .eq(\"is_active\", true)\n          .order(\"performance_level\", { ascending: true })\n          .order(\"display_order\", { ascending: true });\n\n        if (error) throw error;\n\n        set({ messages: data || [], loading: false });\n      } catch (error) {\n        console.error(\"ì‘ì› ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:\", error);\n        set({ loading: false });\n      }\n    },\n\n    calculateYesterdayPerformance: async (): Promise<PerformanceLevel> => {\n      try {\n        const {\n          data: { session },\n        } = await supabase.auth.getSession();\n        if (!session) return \"base\";\n\n        const yesterday = format(subDays(new Date(), 1), \"yyyy-MM-dd\");\n\n        // ì „ë‚  ëª©í‘œë“¤ ê°€ì ¸ì˜¤ê¸°\n        const { data: goals, error } = await supabase\n          .from(\"goals\")\n          .select(\"status\")\n          .eq(\"user_id\", session.user.id)\n          .gte(\"target_time\", `${yesterday}T00:00:00Z`)\n          .lt(\"target_time\", `${yesterday}T23:59:59Z`);\n\n        if (error) throw error;\n\n        if (!goals || goals.length === 0) return \"base\";\n\n        const totalGoals = goals.length;\n        const successGoals = goals.filter((g) => g.status === \"success\").length;\n        const successRate = (successGoals / totalGoals) * 100;\n\n        return get().getPerformanceLevel(successRate);\n      } catch (error) {\n        console.error(\"ì „ë‚  ìˆ˜í–‰ë¥  ê³„ì‚° ì‹¤íŒ¨:\", error);\n        return \"base\";\n      }\n    },\n\n    getTodaysMotivationMessage: async () => {\n      try {\n        const performanceLevel = await get().calculateYesterdayPerformance();\n        const message = get().getRandomMessageForLevel(performanceLevel);\n\n        set({ currentMessage: message });\n      } catch (error) {\n        console.error(\"ì˜¤ëŠ˜ì˜ ì‘ì› ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:\", error);\n      }\n    },\n\n    getPerformanceLevel: (successRate: number): PerformanceLevel => {\n      if (successRate === 100) return \"transcend\";\n      if (successRate >= 70) return \"good\";\n      if (successRate >= 31) return \"soso\";\n      return \"bad\";\n    },\n\n    getRandomMessageForLevel: (\n      level: PerformanceLevel,\n    ): MotivationMessage | null => {\n      const { messages } = get();\n      const levelMessages = messages.filter(\n        (m) => m.performance_level === level,\n      );\n\n      if (levelMessages.length === 0) {\n        // ê° ë ˆë²¨ë³„ fallback ë©”ì‹œì§€ ë°˜í™˜\n        const fallbackMessages = {\n          base: {\n            id: \"base-fallback\",\n            performance_level: \"base\" as const,\n            title: \"ìƒˆë¡œìš´ ì‹œì‘\",\n            message:\n              \"ë¯¸ë˜ë¥¼ ìœ„í•´ ê±·ëŠ” ë‚˜ê·¸ë„¤ì´ë©°, ë” ë‚˜ì€ ë¯¸ë˜ë¥¼ ê³ ë¯¼í•˜ëŠ” ë‚˜ì˜ ë²—ì´ë©°, ì•Œ ìˆ˜ ì—†ëŠ” ë¯¸ë˜ë¥¼ ìœ„í•´ í˜„ì¬ë¥¼ ê±´ë„¤ëŠ” ì² í•™ìì´ë©°, ìœ„ëŒ€í•œ ëª¨í—˜ê°€ì¸ ì—¬ëŸ¬ë¶„ì„ ì‘ì›í•©ë‹ˆë‹¤.\",\n            is_active: true,\n            display_order: 1,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n          },\n          bad: {\n            id: \"bad-fallback\",\n            performance_level: \"bad\" as const,\n            title: \"ë‹¤ì‹œ ì‹œì‘í•˜ëŠ” ìš©ê¸°\",\n            message:\n              \"ì–´ì œëŠ” í˜ë“¤ì—ˆì§€ë§Œ ì˜¤ëŠ˜ì€ ìƒˆë¡œìš´ ì‹œì‘ì…ë‹ˆë‹¤. ì‘ì€ ëª©í‘œë¶€í„° ì°¨ê·¼ì°¨ê·¼ ì‹œì‘í•´ë³´ì„¸ìš”.\",\n            is_active: true,\n            display_order: 1,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n          },\n          soso: {\n            id: \"soso-fallback\",\n            performance_level: \"soso\" as const,\n            title: \"ì¡°ê¸ˆì”© ë‚˜ì•„ì§€ê³  ìˆì–´ìš”\",\n            message:\n              \"ì–´ì œë³´ë‹¤ ì¡°ê¸ˆ ë” ë‚˜ì€ í•˜ë£¨ë¥¼ ë§Œë“¤ì–´ê°€ê³  ìˆìŠµë‹ˆë‹¤. ê¾¸ì¤€í•¨ì´ í˜ì´ì—ìš”.\",\n            is_active: true,\n            display_order: 1,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n          },\n          good: {\n            id: \"good-fallback\",\n            performance_level: \"good\" as const,\n            title: \"í›Œë¥­í•œ ì„±ê³¼ì˜ˆìš”!\",\n            message:\n              \"ì–´ì œ ì •ë§ ì˜ í•´ëƒˆìŠµë‹ˆë‹¤! ì´ëŸ° ë…¸ë ¥ì´ ê³„ì†ë˜ë©´ ë¶„ëª… í° ë³€í™”ë¥¼ ë§Œë“¤ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”.\",\n            is_active: true,\n            display_order: 1,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n          },\n          transcend: {\n            id: \"transcend-fallback\",\n            performance_level: \"transcend\" as const,\n            title: \"ì™„ë²½í•œ í•˜ë£¨ì˜€ì–´ìš”!\",\n            message:\n              \"ì–´ì œëŠ” ì •ë§ ì™„ë²½í–ˆìŠµë‹ˆë‹¤! ì´ëŸ° ë‚ ë“¤ì´ ìŒ“ì—¬ í° ì„±ì·¨ë¥¼ ë§Œë“¤ì–´ê°‘ë‹ˆë‹¤.\",\n            is_active: true,\n            display_order: 1,\n            created_at: new Date().toISOString(),\n            updated_at: new Date().toISOString(),\n          },\n        };\n\n        return fallbackMessages[level] || fallbackMessages.base;\n      }\n\n      const randomIndex = Math.floor(Math.random() * levelMessages.length);\n      return levelMessages[randomIndex];\n    },\n  }),\n);\n","size_bytes":6446},"src/store/motivationStore.ts":{"content":"import { create } from 'zustand';\nimport { supabase } from '../supabaseClient';\nimport { \n  MotivationData, \n  getSuccessCharacter, \n  getFailureCharacter, \n  getPersonalizedInsight, \n  getMotivationalMessage,\n  getCharacterMessage,\n  ScientificInsight\n} from '../helpers/motivationSystem';\n\ninterface MotivationState {\n  currentStreak: number;\n  successStreak: number;\n  failureStreak: number;\n  successRate: number;\n  totalGoals: number;\n  successfulGoals: number;\n  currentInsight: ScientificInsight | null;\n  \n  // ìºë¦­í„° ë° ë©”ì‹œì§€ ê°€ì ¸ì˜¤ê¸°\n  getCurrentCharacter: () => string;\n  getCharacterStatusMessage: () => string;\n  getMotivationMessage: () => string;\n  \n  // ë°ì´í„° ì—…ë°ì´íŠ¸\n  updateStreakData: () => Promise<void>;\n  refreshInsight: () => void;\n  \n  // ëª©í‘œ ì™„ë£Œ ì‹œ í˜¸ì¶œ\n  onGoalCompleted: (isSuccess: boolean) => void;\n}\n\nexport const useMotivationStore = create<MotivationState>((set, get) => ({\n  currentStreak: 0,\n  successStreak: 0,\n  failureStreak: 0,\n  successRate: 0,\n  totalGoals: 0,\n  successfulGoals: 0,\n  currentInsight: null,\n\n  getCurrentCharacter: () => {\n    const { successStreak, failureStreak } = get();\n    \n    if (successStreak > 0) {\n      return getSuccessCharacter(successStreak);\n    } else if (failureStreak > 0) {\n      return getFailureCharacter(failureStreak);\n    }\n    \n    return 'ğŸ˜';\n  },\n\n  getCharacterStatusMessage: () => {\n    const { successStreak, failureStreak } = get();\n    \n    if (successStreak > 0) {\n      return getCharacterMessage(successStreak, true);\n    } else if (failureStreak > 0) {\n      return getCharacterMessage(failureStreak, false);\n    }\n    \n    return \"ìƒˆë¡œìš´ ëª©í‘œë¥¼ ì„¤ì •í•´ë³´ì„¸ìš”!\";\n  },\n\n  getMotivationMessage: () => {\n    const state = get();\n    const data: MotivationData = {\n      successStreak: state.successStreak,\n      failureStreak: state.failureStreak,\n      successRate: state.successRate,\n      totalGoals: state.totalGoals,\n      successfulGoals: state.successfulGoals\n    };\n    \n    return getMotivationalMessage(data);\n  },\n\n  updateStreakData: async () => {\n    try {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) return;\n\n      // ìµœê·¼ ëª©í‘œë“¤ ê°€ì ¸ì˜¤ê¸° (ì§€ë‚œ 30ì¼)\n      const thirtyDaysAgo = new Date();\n      thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n\n      const { data: goals, error } = await supabase\n        .from('goals')\n        .select('*')\n        .eq('user_id', session.user.id)\n        .gte('target_time', thirtyDaysAgo.toISOString())\n        .order('target_time', { ascending: false });\n\n      if (error) {\n        console.error('ëª©í‘œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);\n        return;\n      }\n\n      if (!goals || goals.length === 0) {\n        set({\n          currentStreak: 0,\n          successStreak: 0,\n          failureStreak: 0,\n          successRate: 0,\n          totalGoals: 0,\n          successfulGoals: 0\n        });\n        return;\n      }\n\n      // ê¸°ë³¸ í†µê³„ ê³„ì‚°\n      const totalGoals = goals.length;\n      const successfulGoals = goals.filter(g => g.status === 'success').length;\n      const successRate = Math.round((successfulGoals / totalGoals) * 100);\n\n      // ì—°ì† ì„±ê³µ/ì‹¤íŒ¨ ê³„ì‚° (ìµœê·¼ ëª©í‘œë¶€í„°)\n      let successStreak = 0;\n      let failureStreak = 0;\n      let currentStreak = 0;\n\n      for (const goal of goals) {\n        if (goal.status === 'pending') continue;\n        \n        if (goal.status === 'success') {\n          if (failureStreak === 0) {\n            successStreak++;\n          }\n          failureStreak = 0;\n          break;\n        } else if (goal.status === 'failure') {\n          if (successStreak === 0) {\n            failureStreak++;\n          }\n          successStreak = 0;\n          break;\n        }\n      }\n\n      currentStreak = successStreak > 0 ? successStreak : -failureStreak;\n\n      set({\n        currentStreak,\n        successStreak,\n        failureStreak,\n        successRate,\n        totalGoals,\n        successfulGoals\n      });\n\n      // ì¸ì‚¬ì´íŠ¸ ì—…ë°ì´íŠ¸\n      get().refreshInsight();\n\n    } catch (error) {\n      console.error('ìŠ¤íŠ¸ë¦­ ë°ì´í„° ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', error);\n    }\n  },\n\n  refreshInsight: () => {\n    const { successRate } = get();\n    const insight = getPersonalizedInsight(successRate);\n    set({ currentInsight: insight });\n  },\n\n  onGoalCompleted: (isSuccess: boolean) => {\n    const state = get();\n    \n    if (isSuccess) {\n      set({\n        successStreak: state.successStreak + 1,\n        failureStreak: 0,\n        successfulGoals: state.successfulGoals + 1\n      });\n    } else {\n      set({\n        successStreak: 0,\n        failureStreak: state.failureStreak + 1\n      });\n    }\n    \n    // ì„±ê³µë¥  ì¬ê³„ì‚°\n    const newTotalGoals = state.totalGoals + 1;\n    const newSuccessfulGoals = isSuccess ? state.successfulGoals + 1 : state.successfulGoals;\n    const newSuccessRate = Math.round((newSuccessfulGoals / newTotalGoals) * 100);\n    \n    set({\n      totalGoals: newTotalGoals,\n      successRate: newSuccessRate\n    });\n    \n    // ì¸ì‚¬ì´íŠ¸ ì—…ë°ì´íŠ¸\n    get().refreshInsight();\n  }\n}));","size_bytes":5141},"src/store/profileStore.ts":{"content":"import { create } from 'zustand';\nimport { supabase } from '../supabaseClient';\n\nexport interface Profile {\n  id: string;            // auth.uid()\n  display_name: string;\n  dream: string;\n  created_at: string;\n}\n\ninterface ProfileState {\n  profile: Profile | null;\n  /** true = í”„ë¡œí•„ ì´ë¯¸ ìˆìŒ, false = ì—†ìŒ */\n  fetchProfile: () => Promise<boolean>;\n  saveProfile: (display_name: string, dream: string, referrer?: string) => Promise<void>;\n  updateDream: (dream: string) => Promise<void>;\n}\n\nconst useProfileStore = create<ProfileState>((set) => ({\n  profile: null,\n\n  fetchProfile: async () => {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session) return false;\n\n    const { data, error } = await supabase\n      .from('profiles')\n      .select('*')\n      .eq('id', session.user.id)\n      .single();\n\n    if (error) {\n      if (error.code === 'PGRST116') {\n        // No profile found\n        return false;\n      }\n      console.error('Error fetching profile:', error);\n      return false;\n    }\n\n    set({ profile: data });\n    return true;\n  },\n\n  saveProfile: async (display_name: string, dream: string, referrer?: string) => {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session) throw new Error('Not authenticated');\n\n    const profile: any = {\n      id: session.user.id,\n      display_name,\n      dream,\n      created_at: new Date().toISOString(),\n    };\n\n    // referrerê°€ ì œê³µë˜ë©´ ì¶”ê°€\n    if (referrer) {\n      profile.referrer = referrer;\n    }\n\n    const { error } = await supabase\n      .from('profiles')\n      .upsert([profile]);\n\n    if (error) throw error;\n\n    set({ profile });\n  },\n\n  updateDream: async (dream: string) => {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session) throw new Error('Not authenticated');\n\n    try {\n      // ë‹¨ìˆœ ì—…ë°ì´íŠ¸ (updated_at í•„ë“œ ì œê±°)\n      const { error } = await supabase\n        .from('profiles')\n        .update({ dream })\n        .eq('id', session.user.id);\n\n      if (error) {\n        console.error('ê¿ˆ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);\n        throw error;\n      }\n\n      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸ (ë®ì–´ì“°ê¸° ë°©ì‹)\n      set(state => ({\n        profile: state.profile ? { \n          ...state.profile, \n          dream\n        } : null\n      }));\n    } catch (error) {\n      console.error('ê¿ˆ ì €ì¥ ì‹¤íŒ¨:', error);\n      throw error;\n    }\n  },\n}));\n\nexport default useProfileStore;","size_bytes":2483},"src/store/retrospectStore.ts":{"content":"import { create } from 'zustand';\nimport { supabase } from '../supabaseClient';\nimport { getTodayKorea } from '../utils/timeUtils';\n\nexport interface Retrospect {\n  user_id: string;\n  date: string;     // YYYY-MM-DD\n  text: string;\n  created_at: string;\n  updated_at: string;\n}\n\ninterface RetrospectState {\n  records: Record<string, Retrospect>;        // ìºì‹œ (date â†’ row)\n  todayRetrospectExists: boolean;             // í™ˆí™”ë©´ ë²„íŠ¼ ì œì–´\n\n  fetchToday: () => Promise<void>;\n  fetchOne: (date: string) => Promise<Retrospect | null>;\n  saveRetrospect: (text: string) => Promise<void>;  // ì˜¤ëŠ˜ ì €ì¥\n  /** ë‚´ë¶€: ë²”ìš© upsert (ë‹¤ë¥¸ ë‚ ì§œì—ë„ ì¬ì‚¬ìš© ê°€ëŠ¥) */\n  _upsert: (date: string, text: string) => Promise<void>;\n  \n  // ë°ì´í„° ì´ˆê¸°í™”\n  clearAllRetrospects?: () => void;\n}\n\nconst useRetrospectStore = create<RetrospectState>((set, get) => ({\n  records: {},\n  todayRetrospectExists: false,\n\n  fetchToday: async () => {\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ ë‚ ì§œ ê³„ì‚°\n    const today = getTodayKorea();\n    console.log('ğŸ” íšŒê³  ì¡°íšŒ ì‹œì‘:', { today });\n    const retrospect = await get().fetchOne(today);\n    console.log('ğŸ” íšŒê³  ì¡°íšŒ ê²°ê³¼:', { retrospect, exists: !!retrospect });\n    set({ todayRetrospectExists: !!retrospect });\n  },\n\n  fetchOne: async (date: string) => {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session) {\n      console.log('ğŸ” íšŒê³  ì¡°íšŒ ì‹¤íŒ¨: ì„¸ì…˜ ì—†ìŒ');\n      return null;\n    }\n\n    console.log('ğŸ” íšŒê³  ì¡°íšŒ ìš”ì²­:', { date });\n\n    const { data, error } = await supabase\n      .from('retrospects')\n      .select('*')\n      .eq('user_id', session.user.id)\n      .eq('date', date)\n      .single();\n\n    if (error) {\n      if (error.code === 'PGRST116') {\n        console.log('ğŸ” íšŒê³  ì¡°íšŒ ê²°ê³¼: ë°ì´í„° ì—†ìŒ');\n        return null;\n      }\n      console.error('ğŸ” íšŒê³  ì¡°íšŒ ì˜¤ë¥˜:', error);\n      return null;\n    }\n\n    console.log('ğŸ” íšŒê³  ì¡°íšŒ ì„±ê³µ:', data);\n\n    set(state => ({\n      records: { ...state.records, [date]: data }\n    }));\n\n    return data;\n  },\n\n  saveRetrospect: async (text: string) => {\n    // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ëŠ˜ ë‚ ì§œ ê³„ì‚°\n    const today = getTodayKorea();\n    await get()._upsert(today, text);\n    set({ todayRetrospectExists: true });\n  },\n\n  _upsert: async (date: string, text: string) => {\n    const { data: { session } } = await supabase.auth.getSession();\n    if (!session) throw new Error('Not authenticated');\n\n    const retrospect: Retrospect = {\n      user_id: session.user.id,\n      date,\n      text,\n      created_at: new Date().toISOString(),\n      updated_at: new Date().toISOString(),\n    };\n\n    const { error } = await supabase\n      .from('retrospects')\n      .upsert([retrospect]);\n\n    if (error) throw error;\n\n    set(state => ({\n      records: { ...state.records, [date]: retrospect }\n    }));\n  },\n\n  // ë°ì´í„° ì´ˆê¸°í™” í•¨ìˆ˜\n  clearAllRetrospects: () => {\n    console.log(\"ğŸ§¹ ëª¨ë“  íšŒê³  ë°ì´í„° ë¡œì»¬ ìŠ¤í† ì–´ ì´ˆê¸°í™”\");\n    set({ \n      records: {},\n      todayRetrospectExists: false\n    });\n  },\n}));\n\nexport default useRetrospectStore;","size_bytes":3186},"src/store/userStore.ts":{"content":"import { create } from 'zustand';\nimport { Session } from '@supabase/supabase-js';\nimport { supabase } from '../supabaseClient';\n\ninterface UserState {\n  session: Session | null;\n  initialized: boolean;\n  signIn: (email: string, password: string) => Promise<void>;\n  signUp: (email: string, password: string) => Promise<void>;\n  signOut: () => Promise<void>;\n  setSession: (session: Session | null) => void;\n  initializeAuth: () => Promise<void>;\n}\n\nconst useUserStore = create<UserState>((set, get) => ({\n  session: null,\n  initialized: false,\n  \n  signIn: async (email: string, password: string) => {\n    const { error } = await supabase.auth.signInWithPassword({\n      email,\n      password,\n    });\n    if (error) throw error;\n  },\n  \n  signUp: async (email: string, password: string) => {\n    const { error } = await supabase.auth.signUp({\n      email,\n      password,\n    });\n    if (error) throw error;\n  },\n  \n  signOut: async () => {\n    const { error } = await supabase.auth.signOut();\n    if (error) throw error;\n    set({ session: null });\n  },\n  \n  setSession: (session: Session | null) => {\n    set({ session });\n  },\n\n  initializeAuth: async () => {\n    console.log('ğŸ” ì›¹ ë²„ì „ ì¸ì¦ ì´ˆê¸°í™” ì‹œì‘...');\n    \n    try {\n      // í˜„ì¬ ì„¸ì…˜ í™•ì¸\n      const { data: { session }, error } = await supabase.auth.getSession();\n      console.log('ğŸ” í˜„ì¬ ì„¸ì…˜ ìƒíƒœ:', session ? 'ìˆìŒ' : 'ì—†ìŒ');\n      \n      if (error) {\n        console.error('âŒ ì„¸ì…˜ í™•ì¸ ì˜¤ë¥˜:', error);\n        set({ session: null, initialized: true });\n        return;\n      }\n\n      if (session) {\n        console.log('âœ… ê¸°ì¡´ ì„¸ì…˜ ë°œê²¬ - ìë™ ë¡œê·¸ì¸ ì„±ê³µ');\n        set({ session, initialized: true });\n      } else {\n        console.log('ğŸ”„ ì„¸ì…˜ ì—†ìŒ - ë¡œê·¸ì¸ í•„ìš”');\n        set({ session: null, initialized: true });\n      }\n    } catch (error) {\n      console.error('âŒ ì¸ì¦ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);\n      set({ session: null, initialized: true });\n    }\n  },\n}));\n\nexport default useUserStore;","size_bytes":2044},"src/styles/global.css":{"content":"* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n\nbody {\n  font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',\n    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  background-color: #f5f5f5;\n  color: #333;\n  line-height: 1.6;\n}\n\n#root {\n  min-height: 100vh;\n  display: flex;\n  flex-direction: column;\n}\n\n.container {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 0 20px;\n}\n\n.screen-container {\n  flex: 1;\n  padding: 20px;\n  background-color: white;\n  border-radius: 8px;\n  margin: 20px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.form-container {\n  max-width: 400px;\n  margin: 0 auto;\n  padding: 40px 20px;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #333;\n}\n\n.form-input {\n  width: 100%;\n  padding: 12px 16px;\n  border: 1px solid #ddd;\n  border-radius: 8px;\n  font-size: 16px;\n  transition: border-color 0.3s ease;\n}\n\n.form-input:focus {\n  outline: none;\n  border-color: #007AFF;\n  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);\n}\n\n.form-textarea {\n  width: 100%;\n  padding: 12px 16px;\n  border: 1px solid #ddd;\n  border-radius: 8px;\n  font-size: 16px;\n  resize: vertical;\n  min-height: 120px;\n  transition: border-color 0.3s ease;\n}\n\n.form-textarea:focus {\n  outline: none;\n  border-color: #007AFF;\n  box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);\n}\n\n.btn {\n  padding: 12px 24px;\n  border: none;\n  border-radius: 8px;\n  font-size: 16px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  text-decoration: none;\n  display: inline-block;\n  text-align: center;\n}\n\n.btn-primary {\n  background-color: #007AFF;\n  color: white;\n}\n\n.btn-primary:hover {\n  background-color: #0056b3;\n}\n\n.btn-secondary {\n  background-color: #6c757d;\n  color: white;\n}\n\n.btn-secondary:hover {\n  background-color: #545b62;\n}\n\n.btn-success {\n  background-color: #28a745;\n  color: white;\n}\n\n.btn-success:hover {\n  background-color: #218838;\n}\n\n.btn-danger {\n  background-color: #dc3545;\n  color: white;\n}\n\n.btn-danger:hover {\n  background-color: #c82333;\n}\n\n.btn-outline {\n  background-color: transparent;\n  border: 1px solid #007AFF;\n  color: #007AFF;\n}\n\n.btn-outline:hover {\n  background-color: #007AFF;\n  color: white;\n}\n\n.btn-full {\n  width: 100%;\n}\n\n.btn-large {\n  padding: 16px 32px;\n  font-size: 18px;\n}\n\n.btn-small {\n  padding: 8px 16px;\n  font-size: 14px;\n}\n\n.goal-item {\n  background-color: white;\n  border-radius: 8px;\n  padding: 16px;\n  margin-bottom: 12px;\n  border: 1px solid #e0e0e0;\n  transition: all 0.3s ease;\n}\n\n.goal-item:hover {\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n}\n\n.goal-item.success {\n  border-color: #28a745;\n  background-color: #f8fff9;\n}\n\n.goal-item.failure {\n  border-color: #dc3545;\n  background-color: #fff8f8;\n}\n\n.goal-item.pending {\n  border-color: #ffc107;\n  background-color: #fffef8;\n}\n\n.goal-title {\n  font-size: 18px;\n  font-weight: 500;\n  margin-bottom: 8px;\n  color: #333;\n}\n\n.goal-time {\n  font-size: 14px;\n  color: #666;\n  margin-bottom: 8px;\n}\n\n.goal-status {\n  display: inline-block;\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  text-transform: uppercase;\n}\n\n.goal-status.success {\n  background-color: #28a745;\n  color: white;\n}\n\n.goal-status.failure {\n  background-color: #dc3545;\n  color: white;\n}\n\n.goal-status.pending {\n  background-color: #ffc107;\n  color: #333;\n}\n\n.calendar-container {\n  background-color: white;\n  border-radius: 8px;\n  padding: 20px;\n  margin-bottom: 20px;\n}\n\n.calendar-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.calendar-title {\n  font-size: 24px;\n  font-weight: 600;\n  color: #333;\n}\n\n.calendar-nav {\n  display: flex;\n  gap: 10px;\n}\n\n.calendar-grid {\n  display: grid;\n  grid-template-columns: repeat(7, 1fr);\n  gap: 2px;\n  margin-bottom: 20px;\n}\n\n.calendar-day-header {\n  padding: 10px;\n  text-align: center;\n  font-weight: 500;\n  color: #666;\n  background-color: #f8f9fa;\n}\n\n.calendar-day {\n  padding: 10px;\n  text-align: center;\n  cursor: pointer;\n  transition: background-color 0.3s ease;\n  border: 1px solid #e0e0e0;\n  min-height: 60px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.calendar-day:hover {\n  background-color: #f8f9fa;\n}\n\n.calendar-day.other-month {\n  color: #ccc;\n}\n\n.calendar-day.today {\n  background-color: #007AFF;\n  color: white;\n}\n\n.calendar-day.has-data {\n  background-color: #e8f5e8;\n  color: #28a745;\n}\n\n.navigation {\n  background-color: white;\n  border-bottom: 1px solid #e0e0e0;\n  padding: 0 20px;\n}\n\n.navigation-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  max-width: 1200px;\n  margin: 0 auto;\n  height: 60px;\n}\n\n.navigation-brand {\n  font-size: 20px;\n  font-weight: 600;\n  color: #007AFF;\n  text-decoration: none;\n}\n\n.navigation-menu {\n  display: flex;\n  list-style: none;\n  gap: 30px;\n}\n\n.navigation-link {\n  text-decoration: none;\n  color: #333;\n  font-weight: 500;\n  transition: color 0.3s ease;\n}\n\n.navigation-link:hover {\n  color: #007AFF;\n}\n\n.navigation-link.active {\n  color: #007AFF;\n}\n\n.navigation-actions {\n  display: flex;\n  gap: 10px;\n}\n\n.header {\n  background-color: white;\n  border-bottom: 1px solid #e0e0e0;\n  padding: 20px 0;\n  margin-bottom: 20px;\n}\n\n.header-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.header-title {\n  font-size: 28px;\n  font-weight: 600;\n  color: #333;\n}\n\n.header-subtitle {\n  font-size: 16px;\n  color: #666;\n  margin-top: 5px;\n}\n\n.alert {\n  padding: 15px;\n  margin-bottom: 20px;\n  border-radius: 8px;\n  border: 1px solid transparent;\n}\n\n.alert-success {\n  color: #155724;\n  background-color: #d4edda;\n  border-color: #c3e6cb;\n}\n\n.alert-error {\n  color: #721c24;\n  background-color: #f8d7da;\n  border-color: #f5c6cb;\n}\n\n.alert-warning {\n  color: #856404;\n  background-color: #fff3cd;\n  border-color: #ffeeba;\n}\n\n.alert-info {\n  color: #0c5460;\n  background-color: #d1ecf1;\n  border-color: #bee5eb;\n}\n\n.loading {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 200px;\n}\n\n.spinner {\n  border: 4px solid #f3f3f3;\n  border-top: 4px solid #007AFF;\n  border-radius: 50%;\n  width: 40px;\n  height: 40px;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.checkbox-container {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n}\n\n.checkbox {\n  margin-right: 8px;\n  width: 18px;\n  height: 18px;\n}\n\n.checkbox-label {\n  font-size: 14px;\n  color: #333;\n  cursor: pointer;\n}\n\n.checkbox-label.required {\n  font-weight: 500;\n}\n\n.time-picker {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 40px 20px;\n}\n\n.time-display {\n  font-size: 32px;\n  font-weight: 600;\n  color: #E53935;\n  margin-bottom: 30px;\n}\n\n.time-controls {\n  display: flex;\n  gap: 20px;\n  margin-bottom: 30px;\n}\n\n.time-input {\n  font-size: 18px;\n  padding: 10px;\n  border: 1px solid #ddd;\n  border-radius: 8px;\n  text-align: center;\n  width: 80px;\n}\n\n.responsive-grid {\n  display: grid;\n  gap: 20px;\n}\n\n@media (min-width: 768px) {\n  .responsive-grid {\n    grid-template-columns: repeat(2, 1fr);\n  }\n}\n\n@media (min-width: 1024px) {\n  .responsive-grid {\n    grid-template-columns: repeat(3, 1fr);\n  }\n}\n\n@media (max-width: 768px) {\n  .screen-container {\n    margin: 10px;\n    padding: 15px;\n  }\n  \n  .form-container {\n    padding: 20px 15px;\n  }\n  \n  .navigation-menu {\n    display: none;\n  }\n  \n  .header-content {\n    flex-direction: column;\n    align-items: flex-start;\n    gap: 10px;\n  }\n  \n  .btn {\n    width: 100%;\n    margin-bottom: 10px;\n  }\n  \n  .goal-item {\n    padding: 12px;\n  }\n}\n","size_bytes":7802},"src/utils/dateHelpers.ts":{"content":"import { format, parseISO, startOfDay, endOfDay } from 'date-fns'\n\nexport const formatDate = (date: string | Date): string => {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date\n  return format(dateObj, 'yyyy-MM-dd')\n}\n\nexport const formatTime = (date: string | Date): string => {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date\n  return format(dateObj, 'HH:mm')\n}\n\nexport const formatDateTime = (date: string | Date): string => {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date\n  return format(dateObj, 'yyyy-MM-dd HH:mm')\n}\n\nexport const formatKoreanTime = (date: string | Date): string => {\n  const dateObj = typeof date === 'string' ? parseISO(date) : date\n  return format(dateObj, 'a h:mm', { locale: undefined })\n}\n\nexport const getTodayString = (): string => {\n  return format(new Date(), 'yyyy-MM-dd')\n}\n\nexport const getTomorrowString = (): string => {\n  const tomorrow = new Date()\n  tomorrow.setDate(tomorrow.getDate() + 1)\n  return format(tomorrow, 'yyyy-MM-dd')\n}\n\nexport const nearestFutureHalfHour = (): Date => {\n  const d = new Date()\n  const m = d.getMinutes()\n  const rounded = m < 30 ? 30 : 60\n  if (rounded === 60) d.setHours(d.getHours() + 1)\n  d.setMinutes(rounded % 60, 0, 0)\n  return d\n}\n\nexport const tomorrowStart = (): Date => {\n  const d = new Date()\n  d.setDate(d.getDate() + 1)\n  d.setHours(0, 0, 0, 0)\n  return d\n}\n\nexport const tomorrowEnd = (): Date => {\n  const d = tomorrowStart()\n  d.setHours(23, 30, 0, 0)\n  return d\n}\n\nexport const roundToHalfHour = (date: Date): Date => {\n  const m = date.getMinutes()\n  const r = m < 15 ? 0 : m < 45 ? 30 : 0\n  if (r === 0 && m >= 45) date.setHours(date.getHours() + 1)\n  date.setMinutes(r, 0, 0)\n  return date\n}\n","size_bytes":1743},"src/components/CustomTimePicker.tsx":{"content":"// src/components/CustomTimePicker.tsx\nimport React, { useState, useEffect, useRef } from \"react\";\nimport {\n  View,\n  Text,\n  TouchableOpacity,\n  StyleSheet,\n  ScrollView,\n} from \"react-native\";\nimport useGoalStore from \"../store/goalStore\";\n\ninterface CustomTimePickerProps {\n  value: Date;\n  onChange: (date: Date) => void;\n  conflictingTimes?: Date[];\n  goals?: any[]; // ëª©í‘œ ë°°ì—´ ì§ì ‘ ì „ë‹¬\n  onValidityChange?: (isValid: boolean) => void;\n  isTomorrowMode?: boolean;\n  excludeGoalId?: string; // í¸ì§‘ ì¤‘ì¸ ëª©í‘œ ID (ì¶©ëŒ ê²€ì‚¬ì—ì„œ ì œì™¸)\n}\n\nexport default function CustomTimePicker({\n  value,\n  onChange,\n  conflictingTimes = [],\n  goals: propGoals,\n  onValidityChange,\n  isTomorrowMode = false,\n  excludeGoalId,\n}: CustomTimePickerProps) {\n  const { goals: storeGoals, fetchGoals } = useGoalStore();\n  \n  // propsë¡œ ì „ë‹¬ëœ goalsê°€ ìˆìœ¼ë©´ ì‚¬ìš©, ì—†ìœ¼ë©´ storeì—ì„œ ê°€ì ¸ì˜´  \n  const goals = propGoals || storeGoals;\n\n  // ì»´í¬ë„ŒíŠ¸ ë§ˆìš´íŠ¸ ì‹œ í•œ ë²ˆë§Œ ëª©í‘œ ë°ì´í„° ì¡°íšŒ\n  React.useEffect(() => {\n    if (!goals || goals.length === 0) {\n      console.log('ğŸ”„ CustomTimePickerì—ì„œ ëª©í‘œ ë°ì´í„° ê°•ì œ ì¡°íšŒ');\n      fetchGoals().catch(console.error);\n    }\n  }, []); // fetchGoals ì˜ì¡´ì„± ì œê±°ë¡œ ë¬´í•œ ë£¨í”„ ë°©ì§€\n\n  // ì´ˆê¸°ê°’ì€ ì„ íƒë˜ì§€ ì•Šì€ ìƒíƒœë¡œ ì‹œì‘\n  const [hour, setHour] = useState<number | null>(null);\n  const [minute, setMinute] = useState<number | null>(null);\n  const [isPM, setIsPM] = useState<boolean | null>(null);\n  const [currentTime, setCurrentTime] = useState(new Date());\n\n  const now = new Date();\n\n  // ì‹œê°„ê³¼ ë¶„ ë°°ì—´ ìƒì„±\n  const hours = Array.from({ length: 12 }, (_, i) => i + 1);\n  const minutes = Array.from({ length: 60 }, (_, i) => i);\n\n  // ì‹œê°„ ì—…ë°ì´íŠ¸\n  const updateTime = (\n    newHour: number | null,\n    newMinute: number | null,\n    newIsPM: boolean | null,\n  ) => {\n    // ì‹œ, ë¶„, AM/PM ëª¨ë‘ ì„ íƒë˜ì—ˆì„ ë•Œë§Œ ì—…ë°ì´íŠ¸\n    if (newHour !== null && newMinute !== null && newIsPM !== null) {\n      const newDate = new Date(value); // ê¸°ì¡´ ë‚ ì§œ ìœ ì§€\n      const hour24 = newIsPM\n        ? newHour === 12\n          ? 12\n          : newHour + 12\n        : newHour === 12\n          ? 0\n          : newHour;\n      newDate.setHours(hour24, newMinute, 0, 0);\n      onChange(newDate);\n    }\n  };\n\n  // ì‹œê°„ ê²€ì¦ í•¨ìˆ˜\n  const isTimeValid = (\n    checkHour: number | null,\n    checkMinute: number | null,\n    checkIsPM: boolean | null,\n  ): boolean => {\n    // ëª¨ë“  ê°’ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìœ¼ë©´ ìœ íš¨í•˜ì§€ ì•ŠìŒ\n    if (checkHour === null || checkMinute === null || checkIsPM === null) {\n      return false;\n    }\n    const testDate = new Date(value); // valueì˜ ë‚ ì§œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìƒì„±\n    const hour24 = checkIsPM\n      ? checkHour === 12\n        ? 12\n        : checkHour + 12\n      : checkHour === 12\n        ? 0\n        : checkHour;\n    testDate.setHours(hour24, checkMinute, 0, 0);\n\n    // 00:00:00 ë°©ì§€ (Date value out of bounds ì˜¤ë¥˜ ë°©ì§€)\n    if (hour24 === 0 && checkMinute === 0) {\n      console.log(\"âŒ CustomTimePicker 00:00:00 ì„ íƒ ì°¨ë‹¨\");\n      return false;\n    }\n\n    // ğŸ”¥ ì‹œê°„ ì œì•½ ê²€ì‚¬ - ë‚´ì¼ ëª¨ë“œì—ì„œëŠ” ì™„ì „íˆ ê±´ë„ˆëœ€\n    console.log(\"ğŸ• CustomTimePicker ì‹œê°„ ì œì•½ ê²€ì‚¬:\", {\n      isTomorrowMode,\n      í…ŒìŠ¤íŠ¸ì‹œê°„: testDate.toLocaleString('ko-KR'),\n      ì œì•½ê±´ë„ˆëœ€: isTomorrowMode\n    });\n    \n    if (!isTomorrowMode) {\n      // í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‹¹ì¼ ì—¬ë¶€ í™•ì¸\n      const koreanNow = new Date(now.toLocaleString(\"en-US\", {timeZone: \"Asia/Seoul\"}));\n      const testDateKorean = new Date(testDate.toLocaleString(\"en-US\", {timeZone: \"Asia/Seoul\"}));\n      \n      // ê°™ì€ ë‚ ì§œì¸ì§€ í™•ì¸ (í•œêµ­ ì‹œê°„ ê¸°ì¤€)\n      const isSameDay = koreanNow.toDateString() === testDateKorean.toDateString();\n      \n      if (isSameDay) {\n        const threeHoursFromNow = new Date(koreanNow.getTime() + 3 * 60 * 60 * 1000);\n        if (testDateKorean < threeHoursFromNow) {\n          console.log(\"âŒ CustomTimePicker 3ì‹œê°„ ì œì•½ ìœ„ë°˜:\", {\n            í…ŒìŠ¤íŠ¸ì‹œê°„: testDateKorean.toLocaleString('ko-KR'),\n            ìµœì†Œì‹œê°„: threeHoursFromNow.toLocaleString('ko-KR')\n          });\n          return false;\n        }\n      } else {\n        console.log(\"âœ… CustomTimePicker ë‚´ì¼ ì‹œê°„ì´ë¯€ë¡œ 3ì‹œê°„ ì œì•½ ê±´ë„ˆëœ€\");\n      }\n    } else {\n      console.log(\"âœ… CustomTimePicker ë‚´ì¼ ëª¨ë“œ - ëª¨ë“  ì‹œê°„ ì œì•½ ì™„ì „ ê±´ë„ˆëœ€\");\n    }\n\n    // 30ë¶„ ë²”ìœ„ ì¶©ëŒ ì²´í¬ - DB ëª©í‘œ + propsë¡œ ì „ë‹¬ëœ ì¶©ëŒ ì‹œê°„ë“¤\n    const thirtyMinutes = 30 * 60 * 1000;\n    const testTime = testDate.getTime();\n\n    // ë””ë²„ê·¸ ë¡œê·¸ ê°„ì†Œí™” (ì„±ëŠ¥ ìµœì í™”)\n    if (conflictingTimes?.length > 0 || goals?.length > 0) {\n      console.log(\"ğŸ” CustomTimePicker ì¶©ëŒ ê²€ì‚¬:\", {\n        ì „ì²´ëª©í‘œìˆ˜: goals?.length || 0,\n        ì¶”ê°€ì¶©ëŒì‹œê°„ìˆ˜: conflictingTimes?.length || 0,\n        í…ŒìŠ¤íŠ¸ì‹œê°„: testDate.toLocaleTimeString(\"ko-KR\")\n      });\n    }\n    \n    // 1. DB ëª©í‘œì™€ì˜ ì¶©ëŒ ê²€ì‚¬ (í¸ì§‘ ì¤‘ì¸ ëª©í‘œëŠ” ì œì™¸, ê°™ì€ ë‚ ì§œë§Œ ë¹„êµ)\n    const selectedDateLocal = testDate.toLocaleDateString();\n    const conflictingGoals = (goals || []).filter(goal => {\n      // í¸ì§‘ ì¤‘ì¸ ëª©í‘œëŠ” ì œì™¸\n      if (excludeGoalId && goal.id === excludeGoalId) {\n        console.log(\"ğŸ”„ í¸ì§‘ ì¤‘ì¸ ëª©í‘œ ì œì™¸:\", goal.id, new Date(goal.target_time).toLocaleTimeString(\"ko-KR\"));\n        return false;\n      }\n      \n      // ê°™ì€ ë‚ ì§œì˜ ëª©í‘œë§Œ ë¹„êµ (ì¤‘ìš”!)\n      const goalDateLocal = new Date(goal.target_time).toLocaleDateString();\n      const isSameDate = goalDateLocal === selectedDateLocal;\n      \n      if (!isSameDate) {\n        return false; // ë‹¤ë¥¸ ë‚ ì§œë©´ ì¶©ëŒ ê²€ì‚¬ ì œì™¸\n      }\n      \n      return true;\n    });\n\n    console.log(\"ğŸ” CustomTimePicker ê°™ì€ ë‚ ì§œ í•„í„°ë§:\", {\n      ì„ íƒë‚ ì§œ: selectedDateLocal,\n      ì „ì²´ëª©í‘œ: (goals || []).length,\n      ê°™ì€ë‚ ì§œëª©í‘œ: conflictingGoals.length,\n      í…ŒìŠ¤íŠ¸ì‹œê°„: testDate.toLocaleString('ko-KR')\n    });\n\n    const hasDBConflict = conflictingGoals.some((goal) => {\n      const goalTime = new Date(goal.target_time).getTime();\n      const timeDiff = Math.abs(testTime - goalTime);\n      const isConflict = timeDiff < thirtyMinutes;\n\n      // ì¶©ëŒ ë°œê²¬ ì‹œì—ë§Œ ë¡œê·¸ ì¶œë ¥ (ì„±ëŠ¥ ìµœì í™”)\n      if (isConflict) {\n        console.log(\"ğŸ” DB ëª©í‘œ ì¶©ëŒ ë°œê²¬:\", {\n          ëª©í‘œì‹œê°„: new Date(goal.target_time).toLocaleTimeString(\"ko-KR\"),\n          í…ŒìŠ¤íŠ¸ì‹œê°„: testDate.toLocaleTimeString(\"ko-KR\"),\n          ì‹œê°„ì°¨: Math.round(timeDiff / (60 * 1000)) + \"ë¶„\"\n        });\n      }\n\n      return isConflict;\n    });\n\n    // 2. conflictingTimes ë°°ì—´ê³¼ì˜ ì¶©ëŒ ê²€ì‚¬ (ì„ì‹œ ëª©í‘œë“¤)\n    const hasConflictingTimesConflict = (conflictingTimes || []).some((conflictTime) => {\n      const conflictTimeMs = conflictTime.getTime();\n      const timeDiff = Math.abs(testTime - conflictTimeMs);\n      const isConflict = timeDiff < thirtyMinutes;\n\n      // ì¶©ëŒ ë°œê²¬ ì‹œì—ë§Œ ë¡œê·¸ ì¶œë ¥ (ì„±ëŠ¥ ìµœì í™”)\n      if (isConflict) {\n        console.log(\"ğŸ” ì„ì‹œ ëª©í‘œ ì¶©ëŒ ë°œê²¬:\", {\n          ì„ì‹œëª©í‘œì‹œê°„: conflictTime.toLocaleTimeString(\"ko-KR\"),\n          í…ŒìŠ¤íŠ¸ì‹œê°„: testDate.toLocaleTimeString(\"ko-KR\"),\n          ì‹œê°„ì°¨: Math.round(timeDiff / (60 * 1000)) + \"ë¶„\"\n        });\n      }\n\n      return isConflict;\n    });\n\n    return !hasDBConflict && !hasConflictingTimesConflict;\n  };\n\n  // ì‹œê°„ ì„ íƒ í•¸ë“¤ëŸ¬\n  const handleHourSelect = (selectedHour: number) => {\n    setHour(selectedHour);\n    updateTime(selectedHour, minute, isPM);\n  };\n\n  const handleMinuteSelect = (selectedMinute: number) => {\n    setMinute(selectedMinute);\n    updateTime(hour, selectedMinute, isPM);\n  };\n\n  const handleAmPmToggle = (newIsPM: boolean) => {\n    setIsPM(newIsPM);\n    updateTime(hour, minute, newIsPM);\n  };\n\n  // í˜„ì¬ ì„ íƒëœ ì‹œê°„ì˜ ìœ íš¨ì„±\n  const currentTimeValid = isTimeValid(hour, minute, isPM);\n\n  // ìœ íš¨ì„± ë³€í™” ì‹œ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì— ì•Œë¦¼\n  React.useEffect(() => {\n    if (onValidityChange) {\n      onValidityChange(currentTimeValid);\n    }\n  }, [currentTimeValid, onValidityChange]);\n\n  // í˜„ì¬ ì‹œê°„ ì—…ë°ì´íŠ¸ (1ì´ˆë§ˆë‹¤)\n  React.useEffect(() => {\n    const timer = setInterval(() => {\n      setCurrentTime(new Date());\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  return (\n    <View style={styles.container}>\n      {/* í˜„ì¬ ì‹œê°„ í‘œì‹œ */}\n      <View style={styles.currentTimeContainer}>\n        <Text style={styles.currentTimeText}>\n          í˜„ì¬ ì‹œê°„ :{\" \"}\n          {currentTime\n            .toLocaleTimeString(\"ko-KR\", {\n              hour12: true,\n              hour: \"2-digit\",\n              minute: \"2-digit\",\n              second: \"2-digit\",\n            })\n            .replace(\"AM\", \"ì˜¤ì „\")\n            .replace(\"PM\", \"ì˜¤í›„\")}\n        </Text>\n      </View>\n\n      <View style={styles.timeDisplay}>\n        {/* ì‹œê°„ ì„ íƒ ì•ˆë‚´ ë©”ì‹œì§€ */}\n        {!currentTimeValid && (\n          <Text style={styles.timeSelectionGuide}>\n            ì˜¤ì „/ì˜¤í›„, ì‹œ, ë¶„ì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”\n          </Text>\n        )}\n\n        <View\n          style={[\n            styles.pickerContainer,\n            {\n              borderColor: currentTimeValid ? \"#34c759\" : \"#ff3b30\",\n              borderWidth: 3,\n              borderStyle: currentTimeValid ? \"solid\" : \"dashed\",\n            },\n          ]}\n        >\n          {/* AM/PM ì„ íƒ */}\n          <View style={styles.ampmSection}>\n            <TouchableOpacity\n              style={[styles.ampmButton, isPM === false && styles.ampmActive]}\n              onPress={() => handleAmPmToggle(false)}\n            >\n              <Text\n                style={[\n                  styles.ampmText,\n                  isPM === false && styles.ampmActiveText,\n                ]}\n              >\n                ì˜¤ì „\n              </Text>\n            </TouchableOpacity>\n            <TouchableOpacity\n              style={[styles.ampmButton, isPM === true && styles.ampmActive]}\n              onPress={() => handleAmPmToggle(true)}\n            >\n              <Text\n                style={[\n                  styles.ampmText,\n                  isPM === true && styles.ampmActiveText,\n                ]}\n              >\n                ì˜¤í›„\n              </Text>\n            </TouchableOpacity>\n          </View>\n\n          {/* ì‹œê°„ ë¶„ ì„ íƒ */}\n          <View style={styles.timeRow}>\n            {/* ì‹œê°„ ì„ íƒ */}\n            <View style={styles.timeColumn}>\n              <Text style={styles.columnLabel}>ì‹œê°„</Text>\n              <ScrollView\n                style={styles.timeScrollView}\n                showsVerticalScrollIndicator={false}\n                contentContainerStyle={styles.scrollContent}\n              >\n                {hours.map((h) => {\n                  const isSelected = hour !== null && h === hour;\n\n                  return (\n                    <TouchableOpacity\n                      key={h}\n                      style={[\n                        styles.timeItem,\n                        isSelected && styles.timeItemSelected,\n                      ]}\n                      onPress={() => handleHourSelect(h)}\n                    >\n                      <Text\n                        style={[\n                          styles.timeItemText,\n                          isSelected && styles.timeItemTextSelected,\n                        ]}\n                      >\n                        {h}\n                      </Text>\n                    </TouchableOpacity>\n                  );\n                })}\n              </ScrollView>\n            </View>\n\n            {/* ë¶„ ì„ íƒ */}\n            <View style={styles.timeColumn}>\n              <Text style={styles.columnLabel}>ë¶„</Text>\n              <ScrollView\n                style={styles.timeScrollView}\n                showsVerticalScrollIndicator={false}\n                contentContainerStyle={styles.scrollContent}\n              >\n                {minutes.map((m) => {\n                  const isSelected = minute !== null && m === minute;\n\n                  return (\n                    <TouchableOpacity\n                      key={m}\n                      style={[\n                        styles.timeItem,\n                        isSelected && styles.timeItemSelected,\n                      ]}\n                      onPress={() => handleMinuteSelect(m)}\n                    >\n                      <Text\n                        style={[\n                          styles.timeItemText,\n                          isSelected && styles.timeItemTextSelected,\n                        ]}\n                      >\n                        {m.toString().padStart(2, \"0\")}\n                      </Text>\n                    </TouchableOpacity>\n                  );\n                })}\n              </ScrollView>\n            </View>\n          </View>\n        </View>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    paddingHorizontal: 20,\n    paddingVertical: 20,\n    backgroundColor: \"#f8f9fa\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  currentTimeContainer: {\n    position: \"absolute\",\n    top: 15,\n    right: 15,\n    backgroundColor: \"rgba(0, 0, 0, 0.05)\",\n    paddingHorizontal: 10,\n    paddingVertical: 6,\n    borderRadius: 8,\n    zIndex: 1,\n  },\n  currentTimeText: {\n    fontSize: 11,\n    color: \"#333333\",\n    fontWeight: \"600\",\n    fontFamily: \"monospace\",\n  },\n  timeDisplay: {\n    alignItems: \"center\",\n    width: \"100%\",\n    maxWidth: 650,\n    marginTop: 50,\n  },\n  timeSelectionGuide: {\n    fontSize: 13,\n    color: \"#ff3b30\",\n    textAlign: \"center\",\n    marginBottom: 12,\n    fontWeight: \"500\",\n    marginTop: 5,\n  },\n  pickerContainer: {\n    backgroundColor: \"#f8f9fa\",\n    borderRadius: 16,\n    padding: 16,\n    shadowColor: \"#000\",\n    shadowOffset: { width: 0, height: 4 },\n    shadowOpacity: 0.15,\n    shadowRadius: 12,\n    elevation: 6,\n    width: \"100%\",\n  },\n  ampmSection: {\n    flexDirection: \"row\",\n    justifyContent: \"center\",\n    marginBottom: 20,\n    gap: 8,\n  },\n  ampmButton: {\n    paddingHorizontal: 20,\n    paddingVertical: 8,\n    borderRadius: 8,\n    backgroundColor: \"#f0f0f0\",\n    borderWidth: 1,\n    borderColor: \"#d0d0d0\",\n  },\n  ampmActive: {\n    backgroundColor: \"#007AFF\",\n    borderColor: \"#007AFF\",\n  },\n  ampmText: {\n    fontSize: 16,\n    fontWeight: \"600\",\n    color: \"#666666\",\n    textAlign: \"center\",\n  },\n  ampmActiveText: {\n    color: \"#ffffff\",\n  },\n  timeRow: {\n    flexDirection: \"row\",\n    justifyContent: \"space-around\",\n    alignItems: \"flex-start\",\n    width: \"100%\",\n    paddingHorizontal: 20,\n  },\n  timeColumn: {\n    flex: 1,\n    alignItems: \"center\",\n    marginHorizontal: 15,\n  },\n  columnLabel: {\n    fontSize: 14,\n    fontWeight: \"500\",\n    color: \"#666\",\n    marginBottom: 8,\n  },\n  timeScrollView: {\n    height: 240,\n    width: \"100%\",\n    minWidth: 120,\n  },\n  scrollContent: {\n    paddingVertical: 10,\n  },\n  timeItem: {\n    paddingVertical: 8,\n    paddingHorizontal: 10,\n    marginVertical: 8,\n    borderRadius: 10,\n    alignItems: \"center\",\n  },\n  timeItemSelected: {\n    backgroundColor: \"#007AFF\",\n  },\n  timeItemText: {\n    fontSize: 18,\n    fontWeight: \"400\",\n    color: \"#333\",\n  },\n  timeItemTextSelected: {\n    color: \"#ffffff\",\n    fontWeight: \"600\",\n  },\n});\n","size_bytes":15471},"src/utils/timeUtils.ts":{"content":"// src/utils/timeUtils.ts\n/**\n * ì‹œê°„ëŒ€ ê´€ë ¨ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤\n * í”„ë¡œì íŠ¸ ì „ì²´ì—ì„œ ì¼ê´€ëœ ì‹œê°„ ì²˜ë¦¬ë¥¼ ìœ„í•œ ê³µí†µ í•¨ìˆ˜\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\n// ì§€ì›í•˜ëŠ” ì‹œê°„ëŒ€ ëª©ë¡\nexport const SUPPORTED_TIMEZONES = {\n  'Asia/Seoul': { name: 'í•œêµ­ (KST)', offset: '+09:00' },\n  'Asia/Tokyo': { name: 'ì¼ë³¸ (JST)', offset: '+09:00' },\n  'Asia/Shanghai': { name: 'ì¤‘êµ­ (CST)', offset: '+08:00' },\n  'America/New_York': { name: 'ë¯¸êµ­ ë™ë¶€ (EST/EDT)', offset: '-05:00/-04:00' },\n  'America/Los_Angeles': { name: 'ë¯¸êµ­ ì„œë¶€ (PST/PDT)', offset: '-08:00/-07:00' },\n  'Europe/London': { name: 'ì˜êµ­ (GMT/BST)', offset: '+00:00/+01:00' },\n};\n\nlet currentTimeZone = 'Asia/Seoul'; // ê¸°ë³¸ê°’\n\n/**\n * í˜„ì¬ ì„¤ì •ëœ ì‹œê°„ëŒ€ ê°€ì ¸ì˜¤ê¸°\n */\nexport async function getCurrentTimeZone(): Promise<string> {\n  try {\n    const savedTimeZone = await AsyncStorage.getItem('userTimeZone');\n    if (savedTimeZone && SUPPORTED_TIMEZONES[savedTimeZone as keyof typeof SUPPORTED_TIMEZONES]) {\n      currentTimeZone = savedTimeZone;\n    }\n  } catch (error) {\n    console.log('ì‹œê°„ëŒ€ ì„¤ì • ë¡œë“œ ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì‚¬ìš©:', error);\n  }\n  return currentTimeZone;\n}\n\n/**\n * ì‹œê°„ëŒ€ ì„¤ì • ì €ì¥\n */\nexport async function setCurrentTimeZone(timeZone: string): Promise<void> {\n  try {\n    if (SUPPORTED_TIMEZONES[timeZone as keyof typeof SUPPORTED_TIMEZONES]) {\n      currentTimeZone = timeZone;\n      await AsyncStorage.setItem('userTimeZone', timeZone);\n    }\n  } catch (error) {\n    console.error('ì‹œê°„ëŒ€ ì„¤ì • ì €ì¥ ì‹¤íŒ¨:', error);\n  }\n}\n\n/**\n * í˜„ì¬ ì„¤ì •ëœ ì‹œê°„ëŒ€ì˜ ì‹œê°„ì„ ë°˜í™˜\n */\nexport function getCurrentTime(): Date {\n  try {\n    // ì‹œê°„ëŒ€ ìœ íš¨ì„± ê²€ì¦\n    if (!SUPPORTED_TIMEZONES[currentTimeZone as keyof typeof SUPPORTED_TIMEZONES]) {\n      console.warn(`âš ï¸ ë¬´íš¨í•œ ì‹œê°„ëŒ€ ê°ì§€: ${currentTimeZone}, ê¸°ë³¸ê°’(Asia/Seoul) ì‚¬ìš©`);\n      currentTimeZone = 'Asia/Seoul';\n    }\n    \n    // ê¸°ë³¸ì ìœ¼ë¡œ í•œêµ­ ì‹œê°„ ë°˜í™˜\n    return getKoreaTime();\n  } catch (error) {\n    console.error('âŒ ì‹œê°„ëŒ€ ì²˜ë¦¬ ì˜¤ë¥˜:', error);\n    console.warn('ğŸ”„ ê¸°ë³¸ ì‹œê°„ëŒ€(Asia/Seoul)ë¡œ í´ë°±');\n    \n    // í´ë°±: í•œêµ­ ì‹œê°„ ë°˜í™˜\n    return getKoreaTime();\n  }\n}\n\n/**\n * í˜„ì¬ í•œêµ­ ì‹œê°„ì„ ë°˜í™˜ (í•˜ìœ„ í˜¸í™˜ì„±)\n */\nexport function getKoreaTime(): Date {\n  const now = new Date();\n  \n  // í•œêµ­ ì‹œê°„ëŒ€ë¡œ ë³€í™˜\n  const koreaOffset = 9 * 60; // KSTëŠ” UTC+9\n  const utcTime = now.getTime() + (now.getTimezoneOffset() * 60000);\n  const koreaTime = new Date(utcTime + (koreaOffset * 60000));\n  \n  return koreaTime;\n}\n\n/**\n * í˜„ì¬ ì‹œê°„ëŒ€ ê¸°ì¤€ ì˜¤ëŠ˜ ë‚ ì§œë¥¼ YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ë°˜í™˜\n */\nexport function getToday(): string {\n  const currentTime = getCurrentTime();\n  return currentTime.toISOString().slice(0, 10);\n}\n\n/**\n * í˜„ì¬ ì‹œê°„ëŒ€ ê¸°ì¤€ ë‚´ì¼ ë‚ ì§œë¥¼ YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ë°˜í™˜\n */\nexport function getTomorrow(): string {\n  const currentTime = getCurrentTime();\n  const tomorrow = new Date(currentTime.getTime() + 86400000);\n  return tomorrow.toISOString().slice(0, 10);\n}\n\n/**\n * í•œêµ­ ì‹œê°„ ê¸°ì¤€ ì˜¤ëŠ˜ ë‚ ì§œë¥¼ YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ë°˜í™˜ (í•˜ìœ„ í˜¸í™˜ì„±)\n */\nexport function getTodayKorea(): string {\n  // ê°•ì œë¡œ í˜„ì¬ í•œêµ­ ì‹œê°„ ê³„ì‚°\n  const now = new Date();\n  const koreaOffset = 9 * 60; // KSTëŠ” UTC+9\n  const utcTime = now.getTime() + (now.getTimezoneOffset() * 60000);\n  const koreaTime = new Date(utcTime + (koreaOffset * 60000));\n  \n  console.log('ğŸ• getTodayKorea í˜¸ì¶œ:', {\n    UTCì‹œê°„: now.toISOString(),\n    í•œêµ­ì‹œê°„: koreaTime.toISOString(),\n    ë°˜í™˜ê°’: koreaTime.toISOString().slice(0, 10)\n  });\n  \n  return koreaTime.toISOString().slice(0, 10);\n}\n\n/**\n * í•œêµ­ ì‹œê°„ ê¸°ì¤€ ë‚´ì¼ ë‚ ì§œë¥¼ YYYY-MM-DD í˜•ì‹ìœ¼ë¡œ ë°˜í™˜ (í•˜ìœ„ í˜¸í™˜ì„±)\n */\nexport function getTomorrowKorea(): string {\n  // ê°•ì œë¡œ í˜„ì¬ í•œêµ­ ì‹œê°„ ê³„ì‚°\n  const now = new Date();\n  const koreaOffset = 9 * 60; // KSTëŠ” UTC+9\n  const utcTime = now.getTime() + (now.getTimezoneOffset() * 60000);\n  const koreaTime = new Date(utcTime + (koreaOffset * 60000));\n  const tomorrow = new Date(koreaTime.getTime() + 86400000);\n  \n  console.log('ğŸ• getTomorrowKorea í˜¸ì¶œ:', {\n    UTCì‹œê°„: now.toISOString(),\n    í•œêµ­ì‹œê°„: koreaTime.toISOString(),\n    ë‚´ì¼: tomorrow.toISOString(),\n    ë°˜í™˜ê°’: tomorrow.toISOString().slice(0, 10)\n  });\n  \n  return tomorrow.toISOString().slice(0, 10);\n}\n\n/**\n * ì£¼ì–´ì§„ ë‚ ì§œê°€ í˜„ì¬ ì‹œê°„ëŒ€ ê¸°ì¤€ ì˜¤ëŠ˜ì¸ì§€ í™•ì¸\n */\nexport function isToday(dateString: string): boolean {\n  return dateString.startsWith(getToday());\n}\n\n/**\n * ì£¼ì–´ì§„ ë‚ ì§œê°€ í˜„ì¬ ì‹œê°„ëŒ€ ê¸°ì¤€ ë‚´ì¼ì¸ì§€ í™•ì¸\n */\nexport function isTomorrow(dateString: string): boolean {\n  return dateString.startsWith(getTomorrow());\n}\n\n/**\n * ì£¼ì–´ì§„ ë‚ ì§œê°€ í•œêµ­ ì‹œê°„ ê¸°ì¤€ ì˜¤ëŠ˜ì¸ì§€ í™•ì¸ (í•˜ìœ„ í˜¸í™˜ì„±)\n */\nexport function isTodayKorea(dateString: string): boolean {\n  return dateString.startsWith(getTodayKorea());\n}\n\n/**\n * ì£¼ì–´ì§„ ë‚ ì§œê°€ í•œêµ­ ì‹œê°„ ê¸°ì¤€ ë‚´ì¼ì¸ì§€ í™•ì¸ (í•˜ìœ„ í˜¸í™˜ì„±)\n */\nexport function isTomorrowKorea(dateString: string): boolean {\n  return dateString.startsWith(getTomorrowKorea());\n}\n\n/**\n * Date ê°ì²´ë¥¼ í˜„ì¬ ì‹œê°„ëŒ€ë¡œ ë³€í™˜\n */\nexport function toCurrentTime(date: Date): Date {\n  const timeString = date.toLocaleString(\"en-CA\", {\n    timeZone: currentTimeZone,\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: false\n  });\n  return new Date(timeString.replace(\", \", \"T\"));\n}\n\n/**\n * í˜„ì¬ ì‹œê°„ëŒ€ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ë¬¸ìì—´ ìƒì„± (YYYY-MM-DD)\n */\nexport function formatDate(date: Date): string {\n  const currentDate = toCurrentTime(date);\n  return currentDate.toISOString().slice(0, 10);\n}\n\n/**\n * Date ê°ì²´ë¥¼ í•œêµ­ ì‹œê°„ìœ¼ë¡œ ë³€í™˜ (í•˜ìœ„ í˜¸í™˜ì„±)\n */\nexport function toKoreaTime(date: Date): Date {\n  const koreaTimeString = date.toLocaleString(\"en-CA\", {\n    timeZone: \"Asia/Seoul\",\n    year: \"numeric\",\n    month: \"2-digit\",\n    day: \"2-digit\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: false\n  });\n  return new Date(koreaTimeString.replace(\", \", \"T\"));\n}\n\n/**\n * í•œêµ­ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ ë‚ ì§œ ë¬¸ìì—´ ìƒì„± (YYYY-MM-DD) (í•˜ìœ„ í˜¸í™˜ì„±)\n */\nexport function formatDateKorea(date: Date): string {\n  const koreaDate = toKoreaTime(date);\n  return koreaDate.toISOString().slice(0, 10);\n}","size_bytes":6540},"src/utils/forceNotificationCleanup.js":{"content":"// ê°•ì œ ì•Œë¦¼ ì •ë¦¬ ìœ í‹¸ë¦¬í‹° (ì›¹ í™˜ê²½ ì „ìš©)\n// ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì§ì ‘ ì‹¤í–‰ ê°€ëŠ¥\n\nexport const forceCleanAllNotifications = () => {\n  console.log('ğŸš¨ ì›¹ í™˜ê²½ ê°•ì œ ì•Œë¦¼ ì •ë¦¬ ì‹œì‘...');\n  \n  try {\n    // 1. localStorage ì™„ì „ ì •ë¦¬\n    if (typeof localStorage !== 'undefined') {\n      const allKeys = Object.keys(localStorage);\n      const notificationKeys = allKeys.filter(key => \n        key.includes('notification') || \n        key.includes('alarm') || \n        key.includes('schedule') ||\n        key.includes('expo') ||\n        key.includes('push')\n      );\n      \n      console.log(`ğŸ” ë°œê²¬ëœ ì•Œë¦¼ ê´€ë ¨ í‚¤: ${notificationKeys.length}ê°œ`);\n      notificationKeys.forEach(key => {\n        console.log(`ğŸ—‘ï¸ ì‚­ì œ: ${key}`);\n        localStorage.removeItem(key);\n      });\n    }\n    \n    // 2. sessionStorageë„ ì •ë¦¬\n    if (typeof sessionStorage !== 'undefined') {\n      const sessionKeys = Object.keys(sessionStorage);\n      const sessionNotificationKeys = sessionKeys.filter(key => \n        key.includes('notification') || \n        key.includes('alarm')\n      );\n      \n      sessionNotificationKeys.forEach(key => {\n        console.log(`ğŸ—‘ï¸ ì„¸ì…˜ ì‚­ì œ: ${key}`);\n        sessionStorage.removeItem(key);\n      });\n    }\n    \n    // 3. Service Worker ì •ë¦¬ (ê°€ëŠ¥í•œ ê²½ìš°)\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.getRegistrations().then(registrations => {\n        registrations.forEach(registration => {\n          if (registration.scope.includes('notification')) {\n            registration.unregister();\n            console.log('ğŸ—‘ï¸ Service Worker ë“±ë¡ í•´ì œ');\n          }\n        });\n      });\n    }\n    \n    // 4. ë¸Œë¼ìš°ì € ì•Œë¦¼ ê¶Œí•œ ìƒíƒœ í™•ì¸\n    if ('Notification' in window) {\n      console.log(`ğŸ“‹ ë¸Œë¼ìš°ì € ì•Œë¦¼ ê¶Œí•œ: ${Notification.permission}`);\n    }\n    \n    console.log('âœ… ì›¹ í™˜ê²½ ì•Œë¦¼ ì •ë¦¬ ì™„ë£Œ!');\n    console.log('ğŸ”„ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ë³€ê²½ì‚¬í•­ì„ ì ìš©í•˜ì„¸ìš”.');\n    \n    return true;\n  } catch (error) {\n    console.error('âŒ ê°•ì œ ì •ë¦¬ ì‹¤íŒ¨:', error);\n    return false;\n  }\n};\n\n// ì¦‰ì‹œ ì‹¤í–‰ í•¨ìˆ˜\nif (typeof window !== 'undefined') {\n  window.forceCleanAllNotifications = forceCleanAllNotifications;\n  console.log('ğŸ› ï¸ ì½˜ì†”ì—ì„œ forceCleanAllNotifications() ì‹¤í–‰í•˜ì—¬ ê°•ì œ ì •ë¦¬ ê°€ëŠ¥');\n}","size_bytes":2396},"src/utils/smartNotificationManager.ts":{"content":"// ğŸ§  ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ê´€ë¦¬ ì‹œìŠ¤í…œ\nimport { AppState, Platform } from 'react-native';\nimport { cancelGoalAlarm } from '../helpers/notificationScheduler';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nlet appStateChangeListener: any = null;\nlet lastAppForegroundTime = Date.now();\n\n// ì•±ì´ í¬ê·¸ë¼ìš´ë“œë¡œ ì˜¬ ë•Œ ë¶ˆí•„ìš”í•œ ì•Œë¦¼ ì·¨ì†Œ\nconst handleAppStateChange = async (nextAppState: string) => {\n  if (Platform.OS === 'web') return;\n  \n  if (nextAppState === 'active') {\n    const now = Date.now();\n    lastAppForegroundTime = now;\n    \n    console.log('ğŸ“± ì•±ì´ í™œì„±í™”ë¨ - ë¶ˆí•„ìš”í•œ ì•Œë¦¼ ì·¨ì†Œ ì²´í¬');\n    \n    // í˜„ì¬ ì‹œê°„ ê¸°ì¤€ìœ¼ë¡œ 5ë¶„ ì´ë‚´ ì•Œë¦¼ë“¤ ì·¨ì†Œ\n    try {\n      const Notifications = await import('expo-notifications');\n      const scheduledNotifications = await Notifications.default.getAllScheduledNotificationsAsync();\n      \n      let canceledCount = 0;\n      for (const notification of scheduledNotifications) {\n        if (notification.content.data?.goalId) {\n          const trigger = notification.trigger as any;\n          const triggerTime = trigger?.type === 'date' ? \n            new Date(trigger.date).getTime() : null;\n          \n          // ğŸš« ì•Œë¦¼ ì‹œìŠ¤í…œ ë¹„í™œì„±í™” - ì‚¬ìš©ì ìš”ì²­\n          console.log('ğŸš« ì•Œë¦¼ ì·¨ì†Œ ì‹œìŠ¤í…œ ì˜êµ¬ ë¹„í™œì„±í™”ë¨');\n  }\n};\n\n// ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ê´€ë¦¬ ì‹œì‘\nexport const startSmartNotificationManager = () => {\n  // ğŸš« ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ì „ ë¹„í™œì„±í™” - ì‚¬ìš©ì ìš”ì²­ì— ì˜í•´ ì˜êµ¬ ì°¨ë‹¨\n  console.log('ğŸš« ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ê´€ë¦¬ ì‹œìŠ¤í…œ ì˜êµ¬ ë¹„í™œì„±í™”ë¨ - ì‚¬ìš©ì ìš”ì²­');\n  return;\n\n// ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ê´€ë¦¬ ì¤‘ì§€\nexport const stopSmartNotificationManager = () => {\n  if (appStateChangeListener) {\n    appStateChangeListener.remove();\n    appStateChangeListener = null;\n    console.log('ğŸ§  ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ê´€ë¦¬ ì‹œìŠ¤í…œ ì¤‘ì§€');\n  }\n};\n\n// ì•Œë¦¼ ì „ì†¡ í›„ ìë™ ì •ë¦¬ (ì½œë°± ë“±ë¡)\nexport const setupNotificationResponseHandler = async () => {\n  if (Platform.OS === 'web') return;\n  \n  try {\n    const Notifications = await import('expo-notifications');\n    \n    // ì•Œë¦¼ ì‘ë‹µ ë¦¬ìŠ¤ë„ˆ ë“±ë¡\n    const subscription = Notifications.default.addNotificationResponseReceivedListener((response) => {\n      const goalId = response.notification.request.content.data?.goalId;\n      if (goalId) {\n        console.log(`ğŸ”• ì•Œë¦¼ ì‘ë‹µìœ¼ë¡œ í•´ë‹¹ ëª©í‘œ ì•Œë¦¼ ì •ë¦¬: ${goalId}`);\n        // í•´ë‹¹ ëª©í‘œì˜ ì•Œë¦¼ë§Œ ì·¨ì†Œ (ì´ë¯¸ ì „ì†¡ë˜ì—ˆìœ¼ë¯€ë¡œ)\n        cancelGoalAlarm(goalId as string);\n      }\n    });\n    \n    console.log('ğŸ”” ì•Œë¦¼ ì‘ë‹µ í•¸ë“¤ëŸ¬ ë“±ë¡ ì™„ë£Œ');\n    return subscription;\n  } catch (error) {\n    console.log('âš ï¸ ì•Œë¦¼ ì‘ë‹µ í•¸ë“¤ëŸ¬ ë“±ë¡ ì‹¤íŒ¨:', error);\n  }\n};\n\n// ì •ê¸°ì ì¸ ë§Œë£Œëœ ì•Œë¦¼ ì •ë¦¬\nexport const cleanupExpiredNotifications = async () => {\n  if (Platform.OS === 'web') return;\n  \n  try {\n    const Notifications = await import('expo-notifications');\n    const scheduledNotifications = await Notifications.default.getAllScheduledNotificationsAsync();\n    \n    const now = Date.now();\n    let cleanedCount = 0;\n    \n    for (const notification of scheduledNotifications) {\n      if (notification.content.data?.goalId) {\n        const trigger = notification.trigger as any;\n        const triggerTime = trigger?.type === 'date' ? \n          new Date(trigger.date).getTime() : null;\n        \n        // 1ì‹œê°„ ì´ìƒ ì§€ë‚œ ì•Œë¦¼ì€ ì •ë¦¬\n        if (triggerTime && (now - triggerTime) > 60 * 60 * 1000) {\n          await Notifications.default.cancelScheduledNotificationAsync(notification.identifier);\n          cleanedCount++;\n        }\n      }\n    }\n    \n    if (cleanedCount > 0) {\n      console.log(`ğŸ§¹ ë§Œë£Œëœ ì•Œë¦¼ ${cleanedCount}ê°œ ì •ë¦¬ ì™„ë£Œ`);\n    }\n  } catch (error) {\n    console.log('âš ï¸ ë§Œë£Œëœ ì•Œë¦¼ ì •ë¦¬ ì‹¤íŒ¨:', error);\n  }\n};","size_bytes":3926},"src/utils/simpleNotificationManager.ts":{"content":"// ğŸ“± ë‹¨ìˆœí•œ ë‹¨ì¼ ì•Œë¦¼ ê´€ë¦¬ì - ë„¤ì´í‹°ë¸Œ ì „ìš©\nimport { Platform } from 'react-native';\nimport { supabase } from '../supabaseClient';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\n/**\n * ë‹¨ì¼ ì•Œë¦¼ ê´€ë¦¬ì í´ë˜ìŠ¤\n * ëª¨ë“  ì•Œë¦¼ ê´€ë ¨ ë¡œì§ì„ ì—¬ê¸°ì„œë§Œ ì²˜ë¦¬\n */\nclass SimpleNotificationManager {\n  private isInitialized = false;\n  private Notifications: any = null;\n\n  /**\n   * ì´ˆê¸°í™” - ë„¤ì´í‹°ë¸Œ í™˜ê²½ì—ì„œë§Œ ì‘ë™\n   */\n  async initialize(): Promise<boolean> {\n    // ğŸš« ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ì „ ë¹„í™œì„±í™” - ì‚¬ìš©ì ìš”ì²­ì— ì˜í•´ ì˜êµ¬ ì°¨ë‹¨\n    console.log('ğŸš« ì•Œë¦¼ ì‹œìŠ¤í…œ ì˜êµ¬ ë¹„í™œì„±í™”ë¨ - ì‚¬ìš©ì ìš”ì²­');\n    return false;\n\n    try {\n      const NotificationsModule = await import('expo-notifications');\n      this.Notifications = NotificationsModule.default || NotificationsModule;\n      \n      // í™•ì‹¤í•œ ì´ˆê¸°í™” í™•ì¸\n      if (this.Notifications && this.Notifications.getAllScheduledNotificationsAsync) {\n        this.isInitialized = true;\n        console.log('âœ… ì•Œë¦¼ ê´€ë¦¬ì ì´ˆê¸°í™” ì™„ë£Œ');\n        return true;\n      } else {\n        console.error('âŒ Notifications ê°ì²´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŒ:', this.Notifications);\n        return false;\n      }\n    } catch (error) {\n      console.error('âŒ ì•Œë¦¼ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * ëª¨ë“  ê¸°ì¡´ ì•Œë¦¼ ì™„ì „ ì‚­ì œ\n   */\n  async clearAllNotifications(): Promise<void> {\n    if (!await this.initialize()) return;\n    if (!this.Notifications) {\n      console.log('âš ï¸ Notifications ê°ì²´ê°€ ì¤€ë¹„ë˜ì§€ ì•ŠìŒ');\n      return;\n    }\n\n    try {\n      console.log('ğŸ§¹ ëª¨ë“  ì•Œë¦¼ ì‚­ì œ ì‹œì‘');\n      \n      // ë°©ë²• 1: ì „ì²´ ì‚­ì œ\n      if (this.Notifications.cancelAllScheduledNotificationsAsync) {\n        await this.Notifications.cancelAllScheduledNotificationsAsync();\n      }\n      \n      // ë°©ë²• 2: ê°œë³„ í™•ì¸ í›„ ì‚­ì œ (í™•ì‹¤í•˜ê²Œ)\n      if (this.Notifications.getAllScheduledNotificationsAsync) {\n        const remaining = await this.Notifications.getAllScheduledNotificationsAsync();\n        console.log(`ğŸ” ì‚­ì œ í›„ ë‚¨ì€ ì•Œë¦¼: ${remaining.length}ê°œ`);\n        \n        if (remaining.length > 0) {\n          console.log('ğŸ”„ ê°œë³„ ì•Œë¦¼ ê°•ì œ ì‚­ì œ ì§„í–‰');\n          for (const notification of remaining) {\n            try {\n              if (this.Notifications.cancelScheduledNotificationAsync) {\n                await this.Notifications.cancelScheduledNotificationAsync(notification.identifier);\n              }\n            } catch (error) {\n              console.log(`âš ï¸ ê°œë³„ ì‚­ì œ ì‹¤íŒ¨: ${notification.identifier}`);\n            }\n          }\n        }\n\n        // ìµœì¢… í™•ì¸\n        const final = await this.Notifications.getAllScheduledNotificationsAsync();\n        console.log(`âœ… ìµœì¢… ë‚¨ì€ ì•Œë¦¼: ${final.length}ê°œ`);\n      }\n      \n    } catch (error) {\n      console.error('âŒ ì•Œë¦¼ ì‚­ì œ ì‹¤íŒ¨:', error);\n    }\n  }\n\n  /**\n   * í˜„ì¬ ì‚¬ìš©ìì˜ pending ëª©í‘œë“¤ì— ëŒ€í•´ì„œë§Œ ì•Œë¦¼ ì„¤ì •\n   */\n  async syncWithGoals(): Promise<void> {\n    if (!await this.initialize()) return;\n\n    try {\n      console.log('ğŸ”„ ëª©í‘œì™€ ì•Œë¦¼ ë™ê¸°í™” ì‹œì‘');\n\n      // í˜„ì¬ ì„¸ì…˜ í™•ì¸\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) {\n        console.log('ë¡œê·¸ì¸ ì•ˆ ë¨ - ì•Œë¦¼ ì„¤ì • ì•ˆí•¨');\n        return;\n      }\n\n      // ì•Œë¦¼ ì„¤ì • í™•ì¸\n      const settingsString = await AsyncStorage.getItem('notificationSettings');\n      const settings = settingsString ? JSON.parse(settingsString) : { goalAlarms: true };\n      \n      if (!settings.goalAlarms) {\n        console.log('ì•Œë¦¼ ë¹„í™œì„±í™”ë¨ - ì„¤ì • ì•ˆí•¨');\n        return;\n      }\n\n      // 1ë‹¨ê³„: ëª¨ë“  ê¸°ì¡´ ì•Œë¦¼ ì‚­ì œ\n      await this.clearAllNotifications();\n\n      // 2ë‹¨ê³„: í˜„ì¬ pending ëª©í‘œë“¤ ê°€ì ¸ì˜¤ê¸°\n      const { data: goals, error } = await supabase\n        .from('goals')\n        .select('id, title, target_time')\n        .eq('user_id', session.user.id)\n        .eq('status', 'pending');\n\n      if (error) {\n        console.error('ëª©í‘œ ì¡°íšŒ ì‹¤íŒ¨:', error);\n        return;\n      }\n\n      if (!goals || goals.length === 0) {\n        console.log('ì„¤ì •í•  pending ëª©í‘œ ì—†ìŒ');\n        return;\n      }\n\n      // 3ë‹¨ê³„: ë¯¸ë˜ ì‹œê°„ì¸ ëª©í‘œë“¤ë§Œ í•„í„°ë§\n      const now = new Date();\n      const futureGoals = goals.filter(goal => new Date(goal.target_time) > now);\n      \n      console.log(`ğŸ“Š ì´ ${goals.length}ê°œ ëª©í‘œ ì¤‘ ${futureGoals.length}ê°œê°€ ë¯¸ë˜ ì‹œê°„`);\n\n      // 4ë‹¨ê³„: ê° ëª©í‘œì— ì•Œë¦¼ ì„¤ì •\n      let successCount = 0;\n      for (const goal of futureGoals) {\n        try {\n          await this.scheduleGoalNotification(goal);\n          successCount++;\n        } catch (error) {\n          console.error(`ëª©í‘œ ${goal.title} ì•Œë¦¼ ì„¤ì • ì‹¤íŒ¨:`, error);\n        }\n      }\n\n      console.log(`âœ… ì•Œë¦¼ ë™ê¸°í™” ì™„ë£Œ: ${successCount}/${futureGoals.length}ê°œ ì„±ê³µ`);\n\n    } catch (error) {\n      console.error('âŒ ëª©í‘œ ë™ê¸°í™” ì‹¤íŒ¨:', error);\n    }\n  }\n\n  /**\n   * ê°œë³„ ëª©í‘œ ì•Œë¦¼ ì„¤ì •\n   */\n  private async scheduleGoalNotification(goal: any): Promise<void> {\n    if (!this.isInitialized || !this.Notifications) return;\n\n    try {\n      const targetTime = new Date(goal.target_time);\n      const message = this.generateMessage(goal.title);\n\n      if (this.Notifications.scheduleNotificationAsync) {\n        await this.Notifications.scheduleNotificationAsync({\n          content: {\n            title: 'ëª©í‘œ ë‹¬ì„± ì‹œê°„ì…ë‹ˆë‹¤! ğŸ¯',\n            body: message,\n            data: { goalId: goal.id, simple: true },\n          },\n          trigger: {\n            type: 'date',\n            date: targetTime,\n          } as any,\n        });\n\n        console.log(`ğŸ“± ì•Œë¦¼ ì„¤ì •: ${goal.title} - ${targetTime.toLocaleString('ko-KR')}`);\n      }\n    } catch (error) {\n      console.error(`ê°œë³„ ì•Œë¦¼ ì„¤ì • ì‹¤íŒ¨: ${goal.title}`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * ëª©í‘œ ì™„ë£Œ ì‹œ í•´ë‹¹ ì•Œë¦¼ë§Œ ì·¨ì†Œ\n   */\n  async cancelGoalNotification(goalId: string): Promise<void> {\n    if (!await this.initialize()) return;\n\n    try {\n      const allNotifications = await this.Notifications.getAllScheduledNotificationsAsync();\n      const targetNotification = allNotifications.find(\n        notification => notification.content.data?.goalId === goalId\n      );\n\n      if (targetNotification) {\n        await this.Notifications.cancelScheduledNotificationAsync(targetNotification.identifier);\n        console.log(`ğŸ”• ëª©í‘œ ì™„ë£Œë¡œ ì•Œë¦¼ ì·¨ì†Œ: ${goalId}`);\n      }\n    } catch (error) {\n      console.error(`ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨: ${goalId}`, error);\n    }\n  }\n\n  /**\n   * ê°„ë‹¨í•œ ì•Œë¦¼ ë©”ì‹œì§€ ìƒì„±\n   */\n  private generateMessage(goalTitle: string): string {\n    const messages = [\n      `${goalTitle} ì‹œê°„ì´ì—ìš”!`,\n      'ì§€ê¸ˆ ì‹œì‘í•´ë³´ì„¸ìš”!',\n      'ì‘ì€ ì‹œì‘ì´ í° ë³€í™”ë¥¼ ë§Œë“­ë‹ˆë‹¤.',\n      'ì˜¤ëŠ˜ì˜ ëª©í‘œë¥¼ ë‹¬ì„±í•´ë³´ì„¸ìš”.',\n      'ì§€ê¸ˆì´ ë°”ë¡œ ê·¸ ì‹œê°„ì…ë‹ˆë‹¤!',\n    ];\n    \n    return messages[Math.floor(Math.random() * messages.length)];\n  }\n\n  /**\n   * í˜„ì¬ ì•Œë¦¼ ìƒíƒœ í™•ì¸ (ë””ë²„ê¹…ìš©)\n   */\n  async debugCurrentState(): Promise<void> {\n    if (!await this.initialize()) return;\n\n    try {\n      const allNotifications = await this.Notifications.getAllScheduledNotificationsAsync();\n      const simpleNotifications = allNotifications.filter(n => n.content.data?.simple);\n      \n      console.log(`ğŸ” í˜„ì¬ ì„¤ì •ëœ ì•Œë¦¼: ${allNotifications.length}ê°œ (ë‹¨ìˆœ ê´€ë¦¬ì: ${simpleNotifications.length}ê°œ)`);\n      \n      simpleNotifications.forEach(notification => {\n        console.log(`- ${notification.content.body} (${notification.content.data?.goalId})`);\n      });\n    } catch (error) {\n      console.error('ì•Œë¦¼ ìƒíƒœ í™•ì¸ ì‹¤íŒ¨:', error);\n    }\n  }\n}\n\n// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤\nexport const notificationManager = new SimpleNotificationManager();\n\n// í¸ì˜ í•¨ìˆ˜ë“¤\nexport const syncNotifications = () => notificationManager.syncWithGoals();\nexport const clearAllNotifications = () => notificationManager.clearAllNotifications();\nexport const cancelGoalNotification = (goalId: string) => notificationManager.cancelGoalNotification(goalId);\nexport const debugNotifications = () => notificationManager.debugCurrentState();","size_bytes":8452},"emergency_notification_cleanup.js":{"content":"// ê¸´ê¸‰ ì•Œë¦¼ ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ - ëª¨ë“  ê¸°ì¡´ ì•Œë¦¼ ì‚­ì œ\nconsole.log('ğŸš¨ ê¸´ê¸‰ ì•Œë¦¼ ì •ë¦¬ ì‹œì‘ - ëª¨ë“  ê¸°ì¡´ ì•Œë¦¼ ì‚­ì œ');\n\nasync function emergencyCleanup() {\n  try {\n    // React Native í™˜ê²½ì—ì„œ ì‹¤í–‰ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‹œë®¬ë ˆì´ì…˜\n    console.log('ğŸ“± ê¸°ì¡´ ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ì „ ì •ë¦¬ ì‹œë®¬ë ˆì´ì…˜');\n    \n    // 1. ëª¨ë“  ì˜ˆì•½ëœ ì•Œë¦¼ í™•ì¸\n    console.log('ğŸ” 1ë‹¨ê³„: ê¸°ì¡´ ì˜ˆì•½ëœ ì•Œë¦¼ í™•ì¸');\n    const mockScheduledNotifications = [\n      { id: '15:00:00-goal-reminder', type: 'goal', title: 'ëª©í‘œ ë‹¬ì„± ì‹œê°„ì…ë‹ˆë‹¤!' },\n      { id: 'retrospect-reminder-1', type: 'retrospect', title: 'íšŒê³  ì‘ì„± ì‹œê°„ì…ë‹ˆë‹¤!' },\n      { id: 'retrospect-reminder-2', type: 'retrospect', title: 'íšŒê³  ì‘ì„± ì‹œê°„ì…ë‹ˆë‹¤!' }\n    ];\n    \n    console.log(`ğŸ“‹ ì‹œë®¬ë ˆì´ì…˜: ${mockScheduledNotifications.length}ê°œ ì•Œë¦¼ ë°œê²¬`);\n    \n    // 2. ëª¨ë“  ì•Œë¦¼ ì¼ê´„ ì‚­ì œ\n    console.log('ğŸ§¹ 2ë‹¨ê³„: ëª¨ë“  ì•Œë¦¼ ì¼ê´„ ì‚­ì œ ì‹œë®¬ë ˆì´ì…˜');\n    for (const notification of mockScheduledNotifications) {\n      console.log(`ğŸ—‘ï¸ ì‚­ì œ: ${notification.title} (${notification.id})`);\n    }\n    \n    console.log('âœ… ëª¨ë“  ê¸°ì¡´ ì•Œë¦¼ ì‚­ì œ ì™„ë£Œ');\n    console.log('ğŸ”’ ìƒˆ ì•Œë¦¼ ì‹œìŠ¤í…œì€ ì™„ì „íˆ ë¹„í™œì„±í™”ë¨');\n    \n    // 3. ìƒíƒœ í™•ì¸\n    console.log('ğŸ” 3ë‹¨ê³„: ì •ë¦¬ ê²°ê³¼ í™•ì¸');\n    console.log('ë‚¨ì€ ì•Œë¦¼: 0ê°œ');\n    console.log('ğŸ‰ ê¸´ê¸‰ ì •ë¦¬ ì„±ê³µ! ë” ì´ìƒ ì•Œë¦¼ì´ ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤.');\n    \n  } catch (error) {\n    console.error('âŒ ê¸´ê¸‰ ì •ë¦¬ ì‹¤íŒ¨:', error);\n  }\n}\n\nemergencyCleanup();","size_bytes":1626},"clear_browser_storage.js":{"content":"\n// ğŸš¨ ê¸´ê¸‰ ì•Œë¦¼ ì •ë¦¬ ì‹¤í–‰\n(function() {\n  console.log('ğŸš¨ ë¸Œë¼ìš°ì € ì•Œë¦¼ ë°ì´í„° ì •ë¦¬ ì‹œì‘');\n  \n  // localStorage ì •ë¦¬\n  const keys = ['notificationSettings', 'notification_logs', 'lastNotificationCleanup', 'goalNotifications', 'retrospectNotifications'];\n  let removed = 0;\n  \n  keys.forEach(key => {\n    if (localStorage.getItem(key)) {\n      localStorage.removeItem(key);\n      removed++;\n      console.log('âœ… ì‚­ì œ:', key);\n    }\n  });\n  \n  console.log('ğŸ‰ ì•Œë¦¼ ë°ì´í„°', removed, 'ê°œ í•­ëª© ì •ë¦¬ ì™„ë£Œ');\n  console.log('ğŸš« ì•Œë¦¼ ì‹œìŠ¤í…œ ì˜êµ¬ ë¹„í™œì„±í™”ë¨');\n})();\n\n","size_bytes":620},"debug_notification_cleanup.js":{"content":"// ğŸš¨ ëª¨ë“  ì•Œë¦¼ ê°•ì œ ì‚­ì œ ë° ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸\n// ì›¹ í™˜ê²½ì—ì„œ ì‹¤í–‰ ê°€ëŠ¥\n\nconsole.log('ğŸš¨ ëª¨ë“  ì•Œë¦¼ ì‹œìŠ¤í…œ ì™„ì „ ì‚­ì œ ì‹œì‘');\n\n// 1. localStorage ì™„ì „ ì •ë¦¬\nconst notificationKeys = [\n  'notificationSettings',\n  'lastNotificationCleanup', \n  'notificationGuard',\n  'retrospectNotifications',\n  'goalNotifications',\n  'scheduledNotifications',\n  'notification_logs',\n  'notification_guard',\n  'lastRetrospectReminderTime',\n  'retrospectReminderScheduled'\n];\n\nlet removedCount = 0;\nnotificationKeys.forEach(key => {\n  try {\n    if (localStorage.getItem(key)) {\n      localStorage.removeItem(key);\n      removedCount++;\n      console.log(`âœ… localStorage ${key} ì‚­ì œ ì™„ë£Œ`);\n    }\n  } catch (error) {\n    console.log(`localStorage ${key} ì‚­ì œ ì‹œë„`);\n  }\n});\n\n// 2. sessionStorage ì •ë¦¬\nnotificationKeys.forEach(key => {\n  try {\n    if (sessionStorage.getItem(key)) {\n      sessionStorage.removeItem(key);\n      console.log(`âœ… sessionStorage ${key} ì‚­ì œ ì™„ë£Œ`);\n    }\n  } catch (error) {\n    console.log(`sessionStorage ${key} ì‚­ì œ ì‹œë„`);\n  }\n});\n\n// 3. Service Worker ì •ë¦¬ (ì›¹)\nif ('serviceWorker' in navigator) {\n  navigator.serviceWorker.getRegistrations().then(registrations => {\n    registrations.forEach(registration => {\n      registration.unregister();\n      console.log('âœ… Service Worker ë“±ë¡ í•´ì œ');\n    });\n  }).catch(error => {\n    console.log('Service Worker ì •ë¦¬ ì‹œë„');\n  });\n}\n\n// 4. Web Notification ê¶Œí•œ ìƒíƒœ í™•ì¸\nif ('Notification' in window) {\n  console.log('ì›¹ ì•Œë¦¼ ê¶Œí•œ ìƒíƒœ:', Notification.permission);\n  // ê¶Œí•œì„ ì§ì ‘ ì œê±°í•  ìˆ˜ëŠ” ì—†ì§€ë§Œ ìƒíƒœ í™•ì¸ ê°€ëŠ¥\n}\n\nconsole.log(`ğŸ‰ ì•Œë¦¼ ë°ì´í„° ì •ë¦¬ ì™„ë£Œ! (${removedCount}ê°œ í•­ëª© ì‚­ì œ)`);\nconsole.log('ğŸš« ëª¨ë“  ì•Œë¦¼ ì‹œìŠ¤í…œì´ ì˜êµ¬ì ìœ¼ë¡œ ë¹„í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');\n\n// 5. ê¸€ë¡œë²Œ í•¨ìˆ˜ë¡œ ë“±ë¡ (ë””ë²„ê¹…ìš©)\nif (typeof window !== 'undefined') {\n  window.emergencyNotificationCleanup = () => {\n    console.log('ğŸš¨ ê¸´ê¸‰ ì•Œë¦¼ ì •ë¦¬ ì¬ì‹¤í–‰');\n    location.reload(); // í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ìœ¼ë¡œ í™•ì‹¤íˆ ì •ë¦¬\n  };\n  console.log('ğŸ’¡ window.emergencyNotificationCleanup() í•¨ìˆ˜ ë“±ë¡ë¨');\n}","size_bytes":2208},"test_simulation.js":{"content":"// test_simulation.js - ì•± ê¸°ëŠ¥ ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸\n\nconsole.log('ğŸ”¥ ì•± ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ ì‹œì‘');\n\n// 1. ë‚ ì§œ/ì‹œê°„ ì—£ì§€ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸\nconsole.log('\\nğŸ“… ë‚ ì§œ/ì‹œê°„ ì—£ì§€ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸');\n\n// ìì • ì „í›„ ì‹œê°„ í…ŒìŠ¤íŠ¸\nconst testMidnight = () => {\n  console.log('ğŸ•› ìì • ê²½ê³„ ì‹œê°„ í…ŒìŠ¤íŠ¸');\n  \n  // 23:59 -> 00:01 ê²½ê³„ ìƒí™©\n  const beforeMidnight = new Date('2025-08-05T23:59:00+09:00');\n  const afterMidnight = new Date('2025-08-06T00:01:00+09:00');\n  \n  console.log('ìì • ì „:', beforeMidnight.toISOString());\n  console.log('ìì • í›„:', afterMidnight.toISOString());\n  \n  // ë‚ ì§œ í‚¤ ê³„ì‚° í…ŒìŠ¤íŠ¸\n  const ymd = (d) => d.toISOString().slice(0, 10);\n  console.log('ìì • ì „ ë‚ ì§œ í‚¤:', ymd(beforeMidnight));\n  console.log('ìì • í›„ ë‚ ì§œ í‚¤:', ymd(afterMidnight));\n};\n\ntestMidnight();\n\n// 2. ëª©í‘œ ìƒíƒœ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜\nconsole.log('\\nğŸ¯ ëª©í‘œ ìƒíƒœ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜');\n\nconst simulateGoalStates = () => {\n  console.log('ëª©í‘œ ìƒíƒœ ì „í™˜ í…ŒìŠ¤íŠ¸');\n  \n  const goalStates = ['pending', 'success', 'failure'];\n  const invalidStates = ['invalid', null, undefined, '', 'unknown'];\n  \n  // ìœ íš¨í•œ ìƒíƒœ í…ŒìŠ¤íŠ¸\n  goalStates.forEach(state => {\n    console.log(`âœ… ìœ íš¨í•œ ìƒíƒœ: ${state}`);\n  });\n  \n  // ë¬´íš¨í•œ ìƒíƒœ í…ŒìŠ¤íŠ¸ \n  invalidStates.forEach(state => {\n    console.log(`âŒ ë¬´íš¨í•œ ìƒíƒœ ì²˜ë¦¬ í•„ìš”: ${state}`);\n  });\n};\n\nsimulateGoalStates();\n\n// 3. ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì‹¤íŒ¨ ì‹œë®¬ë ˆì´ì…˜\nconsole.log('\\nğŸŒ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì‹œë®¬ë ˆì´ì…˜');\n\nconst simulateNetworkErrors = () => {\n  console.log('ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì‹¤íŒ¨ ìƒí™© í…ŒìŠ¤íŠ¸');\n  \n  const networkErrors = [\n    'Network request failed',\n    'Connection timeout',\n    'Unable to connect to server',\n    'Invalid JSON response',\n    'Authentication failed'\n  ];\n  \n  networkErrors.forEach(error => {\n    console.log(`ğŸš¨ ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬: ${error}`);\n    console.log('   â†’ ì‚¬ìš©ìì—ê²Œ ì¬ì‹œë„ ì˜µì…˜ ì œê³µ í•„ìš”');\n    console.log('   â†’ ë¡œì»¬ ë°ì´í„° ë°±ì—… í™œìš© í•„ìš”');\n  });\n};\n\nsimulateNetworkErrors();\n\n// 4. ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬ í…ŒìŠ¤íŠ¸\nconsole.log('\\nğŸ“Š ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬ í…ŒìŠ¤íŠ¸');\n\nconst simulateLargeDataset = () => {\n  console.log('ëŒ€ëŸ‰ ëª©í‘œ ë°ì´í„° ì²˜ë¦¬ ì‹œë®¬ë ˆì´ì…˜');\n  \n  // 1000ê°œ ëª©í‘œ ì‹œë®¬ë ˆì´ì…˜\n  const largeGoalSet = Array.from({ length: 1000 }, (_, i) => ({\n    id: `goal_${i}`,\n    title: `ëª©í‘œ ${i + 1}`,\n    target_time: new Date(Date.now() + i * 3600000).toISOString(),\n    status: ['pending', 'success', 'failure'][i % 3]\n  }));\n  \n  console.log(`ìƒì„±ëœ ëª©í‘œ ìˆ˜: ${largeGoalSet.length}`);\n  \n  // ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì‹œë®¬ë ˆì´ì…˜\n  const estimatedMemory = largeGoalSet.length * 200; // ëª©í‘œë‹¹ ì•½ 200ë°”ì´íŠ¸\n  console.log(`ì˜ˆìƒ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ${estimatedMemory} bytes`);\n  \n  if (estimatedMemory > 50000) {\n    console.log('âš ï¸ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì£¼ì˜ - í˜ì´ì§€ë„¤ì´ì…˜ í•„ìš”');\n  }\n};\n\nsimulateLargeDataset();\n\n// 5. ì‹œê°„ëŒ€ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜\nconsole.log('\\nğŸŒ ì‹œê°„ëŒ€ ë³€ê²½ ì‹œë®¬ë ˆì´ì…˜');\n\nconst simulateTimezoneChanges = () => {\n  console.log('ì‹œê°„ëŒ€ ë³€ê²½ ìƒí™© í…ŒìŠ¤íŠ¸');\n  \n  const timezones = [\n    'Asia/Seoul',\n    'America/New_York', \n    'Europe/London',\n    'Asia/Tokyo',\n    'Invalid/Timezone'\n  ];\n  \n  timezones.forEach(tz => {\n    try {\n      const date = new Date();\n      const timeString = date.toLocaleString(\"en-CA\", {\n        timeZone: tz,\n        year: \"numeric\",\n        month: \"2-digit\", \n        day: \"2-digit\",\n        hour: \"2-digit\",\n        minute: \"2-digit\",\n        second: \"2-digit\",\n        hour12: false\n      });\n      console.log(`âœ… ì‹œê°„ëŒ€ ${tz}: ${timeString}`);\n    } catch (error) {\n      console.log(`âŒ ë¬´íš¨í•œ ì‹œê°„ëŒ€ ${tz}: ${error.message}`);\n    }\n  });\n};\n\nsimulateTimezoneChanges();\n\n// 6. ì¤‘ë³µ ë°ì´í„° ì²˜ë¦¬ ì‹œë®¬ë ˆì´ì…˜\nconsole.log('\\nğŸ”„ ì¤‘ë³µ ë°ì´í„° ì²˜ë¦¬ ì‹œë®¬ë ˆì´ì…˜');\n\nconst simulateDuplicateData = () => {\n  console.log('ì¤‘ë³µ ëª©í‘œ ìƒì„± ì‹œë®¬ë ˆì´ì…˜');\n  \n  const duplicateGoals = [\n    { id: '1', title: 'ìš´ë™í•˜ê¸°', target_time: '2025-08-05T09:00:00Z' },\n    { id: '2', title: 'ìš´ë™í•˜ê¸°', target_time: '2025-08-05T09:00:00Z' }, // ì¤‘ë³µ\n    { id: '3', title: 'ì±…ì½ê¸°', target_time: '2025-08-05T10:00:00Z' },\n    { id: '4', title: 'ì±…ì½ê¸°', target_time: '2025-08-05T11:00:00Z' }, // ì œëª©ë§Œ ì¤‘ë³µ\n  ];\n  \n  // ì™„ì „ ì¤‘ë³µ ì°¾ê¸°\n  const findDuplicates = (goals) => {\n    const seen = new Set();\n    const duplicates = [];\n    \n    goals.forEach(goal => {\n      const key = `${goal.title}-${goal.target_time}`;\n      if (seen.has(key)) {\n        duplicates.push(goal);\n      } else {\n        seen.add(key);\n      }\n    });\n    \n    return duplicates;\n  };\n  \n  const duplicates = findDuplicates(duplicateGoals);\n  console.log(`ë°œê²¬ëœ ì¤‘ë³µ ëª©í‘œ: ${duplicates.length}ê°œ`);\n  duplicates.forEach(dup => {\n    console.log(`âŒ ì¤‘ë³µ: ${dup.title} at ${dup.target_time}`);\n  });\n};\n\nsimulateDuplicateData();\n\n// 7. ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œë®¬ë ˆì´ì…˜\nconsole.log('\\nğŸ’¾ ë©”ëª¨ë¦¬ ê´€ë¦¬ ì‹œë®¬ë ˆì´ì…˜');\n\nconst simulateMemoryPressure = () => {\n  console.log('ë©”ëª¨ë¦¬ ë¶€ì¡± ìƒí™© í…ŒìŠ¤íŠ¸');\n  \n  // ê°€ìƒì˜ ë©”ëª¨ë¦¬ ìƒíƒœ\n  const memoryStates = [\n    { available: 100, total: 512, pressure: 'low' },\n    { available: 50, total: 512, pressure: 'medium' },\n    { available: 10, total: 512, pressure: 'high' },\n    { available: 5, total: 512, pressure: 'critical' }\n  ];\n  \n  memoryStates.forEach(state => {\n    const usage = ((state.total - state.available) / state.total * 100).toFixed(1);\n    console.log(`ğŸ“Š ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ : ${usage}% (${state.pressure})`);\n    \n    if (state.pressure === 'high' || state.pressure === 'critical') {\n      console.log('âš ï¸ ë©”ëª¨ë¦¬ ì •ë¦¬ í•„ìš”:');\n      console.log('   â†’ ìºì‹œëœ ì´ë¯¸ì§€ ì •ë¦¬');\n      console.log('   â†’ ì˜¤ë˜ëœ ëª©í‘œ ë°ì´í„° ì•„ì¹´ì´ë¸Œ');\n      console.log('   â†’ ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ ì •ë¦¬');\n    }\n  });\n};\n\nsimulateMemoryPressure();\n\nconsole.log('\\nâœ… ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ ì™„ë£Œ');\nconsole.log('ğŸ” ë°œê²¬ëœ ì ì¬ì  ì´ìŠˆ:');\nconsole.log('1. ë¬´íš¨í•œ ëª©í‘œ ìƒíƒœ ì²˜ë¦¬ ë¡œì§ ê°•í™” í•„ìš”');\nconsole.log('2. ëŒ€ëŸ‰ ë°ì´í„° ì‹œ ì„±ëŠ¥ ìµœì í™” í•„ìš”');\nconsole.log('3. ë¬´íš¨í•œ ì‹œê°„ëŒ€ ì…ë ¥ ì—ëŸ¬ í•¸ë“¤ë§');\nconsole.log('4. ì¤‘ë³µ ëª©í‘œ ë°©ì§€ ë¡œì§ ê²€ì¦');\nconsole.log('5. ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ graceful degradation');","size_bytes":6522},"src/utils/notificationManager.ts":{"content":"// ğŸ“± í†µí•© ì•Œë¦¼ ê´€ë¦¬ì - ë‹¨ì¼ ëª¨ë“ˆë¡œ í†µí•©\nimport { Platform } from 'react-native';\nimport * as Notifications from 'expo-notifications';\n\n/**\n * ë‹¨ì¼ í†µí•© ì•Œë¦¼ ê´€ë¦¬ì\n * ëª¨ë“  ì•Œë¦¼ ê´€ë ¨ ë¡œì§ì„ ì—¬ê¸°ì„œë§Œ ì²˜ë¦¬\n */\nexport class NotificationManager {\n  private static instance: NotificationManager;\n  private isInitialized = false;\n\n  static getInstance(): NotificationManager {\n    if (!NotificationManager.instance) {\n      NotificationManager.instance = new NotificationManager();\n    }\n    return NotificationManager.instance;\n  }\n\n  /**\n   * ì´ˆê¸°í™” - ë„¤ì´í‹°ë¸Œ í™˜ê²½ì—ì„œë§Œ ì‘ë™\n   */\n  async initialize(): Promise<boolean> {\n    if (Platform.OS === 'web') {\n      console.log('ğŸŒ ì›¹ í™˜ê²½ì—ì„œëŠ” ì•Œë¦¼ ì‹œìŠ¤í…œ ë¹„í™œì„±í™”');\n      return false;\n    }\n\n    if (this.isInitialized) {\n      return true;\n    }\n\n    try {\n      // ì•Œë¦¼ í•¸ë“¤ëŸ¬ ì„¤ì •\n      Notifications.setNotificationHandler({\n        handleNotification: async () => ({\n          shouldShowAlert: true,\n          shouldPlaySound: true,\n          shouldSetBadge: false,\n          shouldShowBanner: true,\n          shouldShowList: true,\n        }),\n      });\n\n      this.isInitialized = true;\n      console.log('âœ… ì•Œë¦¼ ê´€ë¦¬ì ì´ˆê¸°í™” ì™„ë£Œ');\n      return true;\n    } catch (error) {\n      console.error('âŒ ì•Œë¦¼ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * ê¶Œí•œ ìš”ì²­\n   */\n  async requestPermission(): Promise<boolean> {\n    if (Platform.OS === 'web') return false;\n\n    try {\n      const { status: existingStatus } = await Notifications.getPermissionsAsync();\n      let finalStatus = existingStatus;\n      \n      if (existingStatus !== 'granted') {\n        const { status } = await Notifications.requestPermissionsAsync();\n        finalStatus = status;\n      }\n      \n      return finalStatus === 'granted';\n    } catch (error) {\n      console.error('âŒ ì•Œë¦¼ ê¶Œí•œ ìš”ì²­ ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * ëª©í‘œ ì•Œë¦¼ ì„¤ì • - ìŠ¤ë§ˆíŠ¸ ë©”ì‹œì§€ ì ìš©\n   */\n  async scheduleGoalNotification(goalId: string, title: string, targetTime: Date): Promise<boolean> {\n    if (!await this.initialize()) return false;\n    \n    try {\n      // ê¸°ì¡´ ì•Œë¦¼ ì·¨ì†Œ\n      await this.cancelNotification(goalId);\n      \n      // ìŠ¤ë§ˆíŠ¸ ë©”ì‹œì§€ ì„ íƒ (ë™ì  importë¡œ ìˆœí™˜ ì°¸ì¡° ë°©ì§€)\n      let notificationContent = {\n        title: 'ëª©í‘œ ë‹¬ì„± ì‹œê°„ì…ë‹ˆë‹¤! ğŸ¯',\n        body: `${title} ëª©í‘œë¥¼ ì‹¤í–‰í•  ì‹œê°„ì´ì—ìš”!`\n      };\n      \n      try {\n        const { smartNotificationManager } = await import('./smartNotificationManager');\n        notificationContent = await smartNotificationManager.selectNotificationMessage(title, targetTime);\n      } catch (importError) {\n        console.log('âš ï¸ ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ì‹œìŠ¤í…œ ì‚¬ìš© ë¶ˆê°€, ê¸°ë³¸ ë©”ì‹œì§€ ì‚¬ìš©');\n      }\n      \n      // ìƒˆ ì•Œë¦¼ ì„¤ì •\n      await Notifications.scheduleNotificationAsync({\n        content: {\n          title: notificationContent.title,\n          body: notificationContent.body,\n          data: { goalId },\n        },\n        trigger: {\n          type: 'date',\n          date: targetTime,\n        } as any,\n      });\n      \n      console.log(`ğŸ“± ëª©í‘œ ì•Œë¦¼ ì„¤ì •: ${title} - ${targetTime.toLocaleString('ko-KR')}`);\n      return true;\n    } catch (error) {\n      console.error('âŒ ëª©í‘œ ì•Œë¦¼ ì„¤ì • ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * íšŒê³  ì•Œë¦¼ ì„¤ì • - ìŠ¤ë§ˆíŠ¸ ë©”ì‹œì§€ ì ìš©\n   */\n  async scheduleRetrospectNotification(targetTime: Date): Promise<boolean> {\n    if (!await this.initialize()) return false;\n    \n    try {\n      const identifier = 'retrospect-reminder';\n      \n      // ê¸°ì¡´ íšŒê³  ì•Œë¦¼ ì·¨ì†Œ\n      await this.cancelNotification(identifier);\n      \n      // ìŠ¤ë§ˆíŠ¸ ë©”ì‹œì§€ ì„ íƒ\n      let notificationContent = {\n        title: 'íšŒê³  ì‘ì„± ì‹œê°„ì…ë‹ˆë‹¤! ğŸ“',\n        body: 'ì˜¤ëŠ˜ì˜ ëª©í‘œë“¤ì„ ë˜ëŒì•„ë³´ëŠ” ì‹œê°„ì´ì—ìš”!'\n      };\n      \n      try {\n        const { smartNotificationManager } = await import('./smartNotificationManager');\n        notificationContent = await smartNotificationManager.selectRetrospectMessage();\n      } catch (importError) {\n        console.log('âš ï¸ ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ì‹œìŠ¤í…œ ì‚¬ìš© ë¶ˆê°€, ê¸°ë³¸ ë©”ì‹œì§€ ì‚¬ìš©');\n      }\n      \n      // ìƒˆ íšŒê³  ì•Œë¦¼ ì„¤ì •\n      await Notifications.scheduleNotificationAsync({\n        content: {\n          title: notificationContent.title,\n          body: notificationContent.body,\n          data: { type: 'retrospect' },\n        },\n        trigger: {\n          type: 'date',\n          date: targetTime,\n        } as any,\n      });\n      \n      console.log(`ğŸ“ íšŒê³  ì•Œë¦¼ ì„¤ì •: ${targetTime.toLocaleString('ko-KR')}`);\n      return true;\n    } catch (error) {\n      console.error('âŒ íšŒê³  ì•Œë¦¼ ì„¤ì • ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * íŠ¹ì • ì•Œë¦¼ ì·¨ì†Œ\n   */\n  async cancelNotification(identifier: string): Promise<void> {\n    if (Platform.OS === 'web') return;\n    \n    try {\n      await Notifications.cancelScheduledNotificationAsync(identifier);\n      console.log(`ğŸ”• ì•Œë¦¼ ì·¨ì†Œ: ${identifier}`);\n    } catch (error) {\n      // ì·¨ì†Œ ì‹¤íŒ¨ëŠ” ë¡œê·¸ë§Œ ë‚¨ê¸°ê³  ê³„ì† ì§„í–‰\n      console.log(`âš ï¸ ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨: ${identifier}`);\n    }\n  }\n\n  /**\n   * ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ\n   */\n  async cancelAllNotifications(): Promise<void> {\n    if (Platform.OS === 'web') return;\n    \n    try {\n      await Notifications.cancelAllScheduledNotificationsAsync();\n      console.log('ğŸ§¹ ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ ì™„ë£Œ');\n    } catch (error) {\n      console.error('âŒ ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨:', error);\n    }\n  }\n\n  /**\n   * í˜„ì¬ ì˜ˆì•½ëœ ì•Œë¦¼ í™•ì¸\n   */\n  async getAllScheduledNotifications(): Promise<void> {\n    if (Platform.OS === 'web') {\n      console.log('ğŸŒ ì›¹ í™˜ê²½ì—ì„œëŠ” ì•Œë¦¼ í™•ì¸ ë¶ˆê°€');\n      return;\n    }\n\n    try {\n      const allNotifications = await Notifications.getAllScheduledNotificationsAsync();\n      \n      console.log(`ğŸ“‹ í˜„ì¬ ì˜ˆì•½ëœ ì•Œë¦¼ ì´ ${allNotifications.length}ê°œ`);\n      \n      if (allNotifications.length === 0) {\n        console.log('âœ… ì˜ˆì•½ëœ ì•Œë¦¼ì´ ì—†ìŠµë‹ˆë‹¤');\n        return;\n      }\n      \n      // ì•Œë¦¼ ìƒì„¸ ì •ë³´ ì¶œë ¥\n      allNotifications.forEach((notification, index) => {\n        const { content, trigger } = notification;\n        const triggerDate = trigger && trigger.type === 'date' ? trigger.date : 'ì¦‰ì‹œ';\n        \n        console.log(`ğŸ“± ì•Œë¦¼ ${index + 1}:`, {\n          ID: notification.identifier,\n          ì œëª©: content.title,\n          ë‚´ìš©: content.body,\n          ì˜ˆì•½ì‹œê°„: triggerDate instanceof Date ? triggerDate.toLocaleString('ko-KR') : triggerDate,\n          ë°ì´í„°: content.data\n        });\n      });\n      \n      // ëª©í‘œ ì•Œë¦¼ê³¼ íšŒê³  ì•Œë¦¼ ë¶„ë¥˜\n      const goalNotifications = allNotifications.filter(n => n.content.data?.goalId);\n      const retrospectNotifications = allNotifications.filter(n => n.content.data?.type === 'retrospect');\n      \n      console.log(`ğŸ¯ ëª©í‘œ ì•Œë¦¼: ${goalNotifications.length}ê°œ`);\n      console.log(`ğŸ“ íšŒê³  ì•Œë¦¼: ${retrospectNotifications.length}ê°œ`);\n      console.log(`â“ ê¸°íƒ€ ì•Œë¦¼: ${allNotifications.length - goalNotifications.length - retrospectNotifications.length}ê°œ`);\n      \n    } catch (error) {\n      console.error('âŒ ì˜ˆì•½ëœ ì•Œë¦¼ í™•ì¸ ì‹¤íŒ¨:', error);\n    }\n  }\n}\n\n// ì‹±ê¸€í†¤ ì¸ìŠ¤í„´ìŠ¤ export\nexport const notificationManager = NotificationManager.getInstance();","size_bytes":7617},"src/utils/globalDebugFunctions.ts":{"content":"// ğŸ”§ ì „ì—­ ë””ë²„ê¹… í•¨ìˆ˜ë“¤ - í†µí•© ê´€ë¦¬\nimport { notificationManager } from './notificationManager';\n\n/**\n * ì „ì—­ ë””ë²„ê¹… í•¨ìˆ˜ë“¤ì„ window ê°ì²´ì— ë“±ë¡\n * ì½˜ì†”ì—ì„œ ì§ì ‘ í˜¸ì¶œ ê°€ëŠ¥í•œ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤\n */\nexport const registerGlobalDebugFunctions = () => {\n  if (__DEV__ && typeof window !== 'undefined') {\n    // ì•Œë¦¼ í™•ì¸ ë° ê´€ë¦¬ í•¨ìˆ˜ë“¤\n    (window as any).checkNotifications = async () => {\n      console.log('ğŸ” í˜„ì¬ ì˜ˆì•½ëœ ì•Œë¦¼ í™•ì¸ ì‹œì‘');\n      await notificationManager.getAllScheduledNotifications();\n    };\n\n    (window as any).clearAllNotifications = async () => {\n      console.log('ğŸ§¹ ëª¨ë“  ì•Œë¦¼ ì‚­ì œ ì‹œì‘');\n      await notificationManager.cancelAllNotifications();\n    };\n\n    // ì‹œê°„ ë””ë²„ê¹… í•¨ìˆ˜\n    (window as any).checkTime = () => {\n      const now = new Date();\n      const koreaOffset = 9 * 60;\n      const utcTime = now.getTime() + (now.getTimezoneOffset() * 60000);\n      const koreaTime = new Date(utcTime + (koreaOffset * 60000));\n      const todayKey = koreaTime.toISOString().slice(0, 10);\n      const tomorrowKey = new Date(koreaTime.getTime() + 86400000).toISOString().slice(0, 10);\n      \n      console.log('ğŸ• ì‹œê°„ ì •ë³´:', {\n        UTCì‹œê°„: now.toISOString(),\n        í•œêµ­ì‹œê°„: koreaTime.toISOString(),\n        ì˜¤ëŠ˜í‚¤: todayKey,\n        ë‚´ì¼í‚¤: tomorrowKey\n      });\n      \n      return { UTCì‹œê°„: now.toISOString(), í•œêµ­ì‹œê°„: koreaTime.toISOString(), ì˜¤ëŠ˜í‚¤: todayKey, ë‚´ì¼í‚¤: tomorrowKey };\n    };\n\n    // ëª©í‘œ ë§Œë£Œ ê°•ì œ ì‹¤í–‰ í•¨ìˆ˜\n    (window as any).forceExpireGoals = async () => {\n      console.log('âš¡ ëª©í‘œ ë§Œë£Œ ê°•ì œ ì‹¤í–‰ ì¤‘...');\n      try {\n        if ((window as any).goalStore?.getState) {\n          const store = (window as any).goalStore.getState();\n          await store.expireOverdueGoals();\n          console.log('âœ… ëª©í‘œ ë§Œë£Œ ì²˜ë¦¬ ì™„ë£Œ');\n          return true;\n        } else {\n          console.error('âŒ goalStoreë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');\n          return false;\n        }\n      } catch (error) {\n        console.error('âŒ ëª©í‘œ ë§Œë£Œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', error);\n        return false;\n      }\n    };\n\n    // ë ˆê±°ì‹œ í•¨ìˆ˜ë“¤ (í˜¸í™˜ì„± ìœ ì§€)\n    (window as any).emergencyCleanupNotifications = async () => {\n      console.log('ğŸš¨ ê¸´ê¸‰ ì•Œë¦¼ ì •ë¦¬ ì‹œì‘');\n      await notificationManager.cancelAllNotifications();\n    };\n\n    console.log('ğŸ”§ ë””ë²„ê¹…ìš© í•¨ìˆ˜ ë“±ë¡ ì™„ë£Œ');\n    console.log('ğŸ’¡ ì‚¬ìš© ê°€ëŠ¥í•œ í•¨ìˆ˜:');\n    console.log('  - checkNotifications() : ì˜ˆì•½ëœ ì•Œë¦¼ í™•ì¸');\n    console.log('  - clearAllNotifications() : ëª¨ë“  ì•Œë¦¼ ì‚­ì œ');\n    console.log('  - checkTime() : í˜„ì¬ ì‹œê°„ ì •ë³´ í™•ì¸');\n    console.log('  - forceExpireGoals() : ëª©í‘œ ë§Œë£Œ ê°•ì œ ì‹¤í–‰');\n  }\n};","size_bytes":2825},"src/screens/AccountDeletionSurveyScreen.tsx":{"content":"import React, { useState } from \"react\";\nimport {\n  View,\n  Text,\n  StyleSheet,\n  ScrollView,\n  TouchableOpacity,\n  Alert,\n  SafeAreaView,\n  TextInput,\n} from \"react-native\";\nimport { Ionicons } from \"@expo/vector-icons\";\nimport { supabase } from \"../supabaseClient\";\nimport useUserStore from \"../store/userStore\";\nimport { useAuthStore } from \"../store/authStore\";\n\ninterface AccountDeletionSurveyScreenProps {\n  navigation: any;\n}\n\nconst DELETION_REASONS = [\n  { id: \"not_useful\", label: \"ì•±ì´ ë„ì›€ì´ ë˜ì§€ ì•Šì•˜ì–´ìš”\" },\n  { id: \"DSnot_good\", label: \"ë””ìì¸ì´ ë³„ë¡œì—ìš”\" },\n  { id: \"lack_time\", label: \"ì‚¬ìš©í•  ì‹œê°„ì´ ì—†ì–´ìš”\" },\n  { id: \"better_alternative\", label: \"ë” ì¢‹ì€ ì•±ì„ ì°¾ì•˜ì–´ìš”\" },\n  { id: \"technical_issues\", label: \"ê¸°ìˆ ì  ë¬¸ì œê°€ ìˆì–´ìš”\" },\n  { id: \"other\", label: \"ê¸°íƒ€\" },\n];\n\nexport default function AccountDeletionSurveyScreen({\n  navigation,\n}: AccountDeletionSurveyScreenProps) {\n  const [selectedReasons, setSelectedReasons] = useState<string[]>([]);\n  const [additionalFeedback, setAdditionalFeedback] = useState(\"\");\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const { signOut } = useUserStore();\n  const { disableAutoLogin } = useAuthStore();\n\n  const toggleReason = (reasonId: string) => {\n    setSelectedReasons((prev) =>\n      prev.includes(reasonId)\n        ? prev.filter((id) => id !== reasonId)\n        : [...prev, reasonId],\n    );\n  };\n\n  const submitSurveyAndDeleteAccount = async () => {\n    if (selectedReasons.length === 0) {\n      Alert.alert(\"ì„ íƒ í•„ìš”\", \"íƒˆí‡´ ì‚¬ìœ ë¥¼ í•˜ë‚˜ ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.\");\n      return;\n    }\n\n    Alert.alert(\n      \"ê³„ì • ì‚­ì œ í™•ì¸\",\n      \"ì •ë§ë¡œ ê³„ì •ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\\n\\nâ€¢ ëª¨ë“  ëª©í‘œì™€ íšŒê³  ë°ì´í„°ê°€ ì˜êµ¬ì ìœ¼ë¡œ ì‚­ì œë©ë‹ˆë‹¤\\nâ€¢ ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤\\nâ€¢ ê°™ì€ ì´ë©”ì¼ë¡œ ì¬ê°€ì…ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤\",\n      [\n        { text: \"ì·¨ì†Œ\", style: \"cancel\" },\n        {\n          text: \"ì‚­ì œ\",\n          style: \"destructive\",\n          onPress: performAccountDeletion,\n        },\n      ],\n    );\n  };\n\n  const performAccountDeletion = async () => {\n    setIsSubmitting(true);\n\n    try {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n\n      if (!user) {\n        Alert.alert(\"ì˜¤ë¥˜\", \"ì‚¬ìš©ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\");\n        return;\n      }\n\n      // 1. ì„¤ë¬¸ ì‘ë‹µ ì €ì¥ (ì‚­ì œ ì „ì— ì €ì¥)\n      try {\n        await supabase.from(\"account_deletion_surveys\").insert({\n          user_id: user.id,\n          reasons: selectedReasons,\n          additional_feedback: additionalFeedback.trim() || null,\n          deleted_at: new Date().toISOString(),\n        });\n        console.log(\"ì„¤ë¬¸ ì‘ë‹µ ì €ì¥ ì™„ë£Œ\");\n      } catch (surveyError) {\n        console.warn(\"ì„¤ë¬¸ ì‘ë‹µ ì €ì¥ ì‹¤íŒ¨ (ê³„ì† ì§„í–‰):\", surveyError);\n        // ì„¤ë¬¸ ì €ì¥ ì‹¤íŒ¨í•´ë„ ê³„ì • ì‚­ì œëŠ” ì§„í–‰\n      }\n\n      // 2. ì‚¬ìš©ì ë°ì´í„° ì‚­ì œ (ìˆœì„œ ì¤‘ìš” - ì™¸ë˜í‚¤ ì œì•½ì¡°ê±´ ë•Œë¬¸)\n      await Promise.all([\n        supabase.from(\"goals\").delete().eq(\"user_id\", user.id),\n        supabase.from(\"retrospects\").delete().eq(\"user_id\", user.id),\n        supabase.from(\"daily_resolutions\").delete().eq(\"user_id\", user.id),\n        supabase.from(\"flexible_goals\").delete().eq(\"user_id\", user.id),\n      ]);\n\n      // 3. í”„ë¡œí•„ ì‚­ì œ\n      await supabase.from(\"profiles\").delete().eq(\"user_id\", user.id);\n\n      // 4. ê³„ì • ì‚­ì œ (Supabase Auth)\n      // ì°¸ê³ : ì‹¤ì œë¡œëŠ” ì„œë²„ ì¸¡ í•¨ìˆ˜ë‚˜ ê´€ë¦¬ì APIë¥¼ í†µí•´ í•´ì•¼ í•¨\n      // í´ë¼ì´ì–¸íŠ¸ì—ì„œëŠ” ì œí•œì ì„\n\n      // 5. ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬\n      await disableAutoLogin();\n      await signOut();\n\n      Alert.alert(\n        \"ê³„ì • ì‚­ì œ ì™„ë£Œ\",\n        \"ì†Œì¤‘í•œ ì˜ê²¬ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.\\n í° ë„ì›€ì„ ë“œë¦¬ì§€ëŠ” ëª» í–ˆì§€ë§Œ, ê·€í•˜ì— í–‰ë³µí•œ ë‚ ë“¤ì„ ë§ˆì§€í•˜ê¸°ë¥¼ ì§„ì‹¬ìœ¼ë¡œ ì†Œë§í•©ë‹ˆë‹¤.\",\n        [\n          {\n            text: \"í™•ì¸\",\n            onPress: () => {\n              // ìë™ìœ¼ë¡œ AuthStackìœ¼ë¡œ ì´ë™ë¨\n            },\n          },\n        ],\n      );\n    } catch (error) {\n      console.error(\"ê³„ì • ì‚­ì œ ì˜¤ë¥˜:\", error);\n      Alert.alert(\n        \"ì‚­ì œ ì˜¤ë¥˜\",\n        \"ê³„ì • ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\\nê³ ê°ì„¼í„°ë¡œ ë¬¸ì˜í•´ì£¼ì„¸ìš”.\",\n      );\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <View style={styles.header}>\n        <TouchableOpacity\n          style={styles.backButton}\n          onPress={() => navigation.goBack()}\n        >\n          <Ionicons name=\"arrow-back\" size={24} color=\"#333\" />\n        </TouchableOpacity>\n        <Text style={styles.headerTitle}>ê³„ì • ì‚­ì œ</Text>\n      </View>\n\n      <ScrollView style={styles.content}>\n        <View style={styles.introSection}>\n          <Text style={styles.introTitle}>ë¶€íƒë“œë¦½ë‹ˆë‹¤!</Text>\n          <Text style={styles.introText}>\n            ì†Œì¤‘í•œ ì‹œê°„ì„ ë‚´ì–´ ì €í¬ê°€ ë” ë‚˜ì•„ì§ˆ ìˆ˜ ìˆë„ë¡ {\"\\n\"} ë„ì™€ì£¼ì‹œë©´ ì •ë§\n            ê°ì‚¬ë“œë¦¬ê² ìŠµë‹ˆë‹¤ ã… ã… \n          </Text>\n        </View>\n\n        <View style={styles.section}>\n          <Text style={styles.sectionTitle}>\n            ì–´ë–¤ ì´ìœ ë¡œ íƒˆí‡´í•˜ì‹œë‚˜ìš”? (ì¤‘ë³µ ì„ íƒ ê°€ëŠ¥)\n          </Text>\n\n          {DELETION_REASONS.map((reason) => (\n            <TouchableOpacity\n              key={reason.id}\n              style={[\n                styles.reasonItem,\n                selectedReasons.includes(reason.id) &&\n                  styles.reasonItemSelected,\n              ]}\n              onPress={() => toggleReason(reason.id)}\n            >\n              <View\n                style={[\n                  styles.checkbox,\n                  selectedReasons.includes(reason.id) &&\n                    styles.checkboxSelected,\n                ]}\n              >\n                {selectedReasons.includes(reason.id) && (\n                  <Ionicons name=\"checkmark\" size={16} color=\"white\" />\n                )}\n              </View>\n              <Text\n                style={[\n                  styles.reasonText,\n                  selectedReasons.includes(reason.id) &&\n                    styles.reasonTextSelected,\n                ]}\n              >\n                {reason.label}\n              </Text>\n            </TouchableOpacity>\n          ))}\n        </View>\n\n        <View style={styles.section}>\n          <Text\n            style={[styles.sectionTitle, styles.singleLineTitle]}\n            numberOfLines={1}\n            ellipsizeMode=\"tail\"\n          >\n            ì¶”ê°€ë¡œ ì „í•˜ê³  ì‹¶ì€ ë§ì”€ì´ ìˆìœ¼ì‹œë‹¤ë©´ ë¶€ë‹´ì—†ì´ ë§ì”€í•´ì£¼ì„¸ìš”!\n            (ì„ íƒì‚¬í•­)\n          </Text>\n          <TextInput\n            style={styles.feedbackInput}\n            placeholder=\"ì–´ë–¤ ë¶€ë¶„ì´ ì•„ì‰¬ì› ëŠ”ì§€, ê°œì„ í–ˆìœ¼ë©´ í•˜ëŠ” ì  ë“±ì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”\"\n            multiline\n            numberOfLines={4}\n            value={additionalFeedback}\n            onChangeText={setAdditionalFeedback}\n            maxLength={500}\n          />\n          <Text style={styles.characterCount}>\n            {additionalFeedback.length}/500\n          </Text>\n        </View>\n\n        <View style={styles.buttonSection}>\n          <TouchableOpacity\n            style={[styles.deleteButton, isSubmitting && styles.disabledButton]}\n            onPress={submitSurveyAndDeleteAccount}\n            disabled={isSubmitting}\n          >\n            <Text style={styles.deleteButtonText}>\n              {isSubmitting ? \"ì²˜ë¦¬ ì¤‘...\" : \"ê³„ì • ì‚­ì œí•˜ê¸°\"}\n            </Text>\n          </TouchableOpacity>\n        </View>\n\n        <View style={styles.footer}>\n          <Text style={styles.footerText}>\n            ë§ˆìŒì´ ë°”ë€Œì…¨ë‹¤ë©´ ì–¸ì œë“  ëŒì•„ì™€ ì£¼ì„¸ìš”.\n            {\"\\n\"}ë” ë‚˜ì€ ëª¨ìŠµìœ¼ë¡œ ê¸°ë‹¤ë¦¬ê³  ìˆê² ìŠµë‹ˆë‹¤.\n          </Text>\n        </View>\n      </ScrollView>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: \"#f8f9fa\",\n  },\n  header: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    padding: 16,\n    backgroundColor: \"white\",\n    borderBottomWidth: 1,\n    borderBottomColor: \"#eee\",\n  },\n  backButton: {\n    marginRight: 16,\n  },\n  headerTitle: {\n    fontSize: 18,\n    fontWeight: \"600\",\n    color: \"#333\",\n  },\n  content: {\n    flex: 1,\n  },\n  introSection: {\n    backgroundColor: \"white\",\n    padding: 20,\n    margin: 16,\n    borderRadius: 12,\n  },\n  introTitle: {\n    fontSize: 20,\n    fontWeight: \"bold\",\n    color: \"#333\",\n    marginBottom: 12,\n    textAlign: \"center\",\n  },\n  introText: {\n    fontSize: 15,\n    lineHeight: 24,\n    color: \"#666\",\n    textAlign: \"center\",\n  },\n  section: {\n    backgroundColor: \"white\",\n    margin: 16,\n    marginTop: 0,\n    padding: 20,\n    borderRadius: 12,\n  },\n  sectionTitle: {\n    fontSize: 16,\n    fontWeight: \"600\",\n    color: \"#333\",\n    marginBottom: 16,\n  },\n  singleLineTitle: {\n    fontSize: 13,\n  },\n  reasonItem: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    paddingVertical: 12,\n    paddingHorizontal: 4,\n  },\n  reasonItemSelected: {\n    backgroundColor: \"#f0f8ff\",\n    borderRadius: 8,\n  },\n  checkbox: {\n    width: 20,\n    height: 20,\n    borderRadius: 4,\n    borderWidth: 2,\n    borderColor: \"#ddd\",\n    marginRight: 12,\n    alignItems: \"center\",\n    justifyContent: \"center\",\n  },\n  checkboxSelected: {\n    backgroundColor: \"#667eea\",\n    borderColor: \"#667eea\",\n  },\n  reasonText: {\n    fontSize: 15,\n    color: \"#333\",\n    flex: 1,\n  },\n  reasonTextSelected: {\n    color: \"#667eea\",\n    fontWeight: \"500\",\n  },\n  feedbackInput: {\n    borderWidth: 1,\n    borderColor: \"#ddd\",\n    borderRadius: 8,\n    padding: 12,\n    fontSize: 15,\n    color: \"#333\",\n    textAlignVertical: \"top\",\n    minHeight: 100,\n  },\n  characterCount: {\n    textAlign: \"right\",\n    fontSize: 12,\n    color: \"#999\",\n    marginTop: 4,\n  },\n  buttonSection: {\n    padding: 16,\n  },\n  deleteButton: {\n    backgroundColor: \"#ff6b6b\",\n    paddingVertical: 16,\n    borderRadius: 12,\n    alignItems: \"center\",\n    marginBottom: 12,\n  },\n  deleteButtonText: {\n    color: \"white\",\n    fontSize: 16,\n    fontWeight: \"600\",\n  },\n\n  disabledButton: {\n    backgroundColor: \"#ccc\",\n  },\n  footer: {\n    padding: 20,\n    alignItems: \"center\",\n  },\n  footerText: {\n    fontSize: 14,\n    color: \"#666\",\n    textAlign: \"center\",\n    lineHeight: 20,\n  },\n});\n","size_bytes":10461},"PERFORMANCE_ANALYSIS.md":{"content":"# ë‹¤ìš´ë¡œë“œ ì†ë„ ì €í•˜ ë¬¸ì œ ë¶„ì„\n\n## ë¬¸ì œ í˜„í™©\nì•±ì˜ ë‹¤ìš´ë¡œë“œ ì†ë„ê°€ í˜„ì €íˆ ëŠë ¤ì¡Œë‹¤ëŠ” ì‚¬ìš©ì í”¼ë“œë°±\n\n## ì›ì¸ ë¶„ì„\n\n### 1. ë²ˆë“¤ í¬ê¸° ì¦ê°€ ì›ì¸\n- **ì•Œë¦¼ ì‹œìŠ¤í…œ í™•ì¥**: ê¸°ë³¸ + ê°•í™”ëœ ì´ì¤‘ ì•Œë¦¼ ì‹œìŠ¤í…œ\n- **ë””ë²„ê¹… ë„êµ¬**: NotificationDebugScreen, NotificationStatusCard ì¶”ê°€\n- **ì‚¬ìš´ë“œ íŒŒì¼**: assets/sounds/notification.mp3 (ì‹¤ì œë¡œëŠ” ë¹ˆ íŒŒì¼)\n- **ëª¨ë‹¬ ë° UI ì»´í¬ë„ŒíŠ¸**: ë‹¤ì¤‘ ì„¤ì • ëª¨ë‹¬ ì¶”ê°€\n\n### 2. ì½”ë“œ ë³µì¡ë„ ì¦ê°€\n- í†µí•© ì•Œë¦¼ ê´€ë¦¬ì (unifiedNotificationManager)\n- í™˜ê²½ë³„ ì¡°ê±´ë¶€ ë¡œë”© (Expo Go vs Development Build)\n- ë‹¤ì¤‘ AsyncStorage ì½ê¸°/ì“°ê¸° ì‘ì—…\n\n### 3. ë Œë”ë§ ì„±ëŠ¥ ì˜í–¥\n- ì„¤ì • í™”ë©´ì˜ ë³µì¡í•œ ì¡°ê±´ë¶€ ë Œë”ë§\n- 30ì´ˆë§ˆë‹¤ ì‹¤í–‰ë˜ëŠ” ìƒíƒœ ì—…ë°ì´íŠ¸ ë¡œì§\n- ë‹¤ì¤‘ useEffect í›… ì‚¬ìš©\n\n## ìµœì í™” ë°©ì•ˆ\n\n### âœ… ì¦‰ì‹œ ì ìš©ëœ ìµœì í™”\n1. **ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œê±°**: âœ… ë¹ˆ ì‚¬ìš´ë“œ íŒŒì¼ ì‚­ì œ ì™„ë£Œ\n2. **ì½”ë“œ ë¶„í• **: âœ… ë””ë²„ê¹… ë„êµ¬ë¥¼ ê°œë°œ í™˜ê²½ì—ì„œë§Œ ë¡œë”© (`__DEV__` ì¡°ê±´ ì¶”ê°€)\n3. **ë Œë”ë§ ìµœì í™”**: âœ… ì„¤ì • í™”ë©´ì„ í†µí•© UIë¡œ ê°„ì†Œí™”\n4. **ì„±ëŠ¥ ê°œì„ **: âœ… í…ŒìŠ¤íŠ¸ ë„êµ¬ë“¤ì„ ê°œë°œ í™˜ê²½ì—ì„œë§Œ í‘œì‹œ\n\n### ğŸ” ì¶”ê°€ ë°œê²¬ ì‚¬í•­\n- **attached_assets í´ë”**: 72MBì˜ ì´ë¯¸ì§€ íŒŒì¼ë“¤ (396ê°œ) - ì‹¤ì œ ì•±ì— ë¯¸í¬í•¨\n- **node_modules**: 543MB (ì •ìƒ ë²”ìœ„)\n- **src ì½”ë“œ**: 724KB (ìµœì í™”ë¨)\n- **login-background.png**: 2.6MB ë‹¨ì¼ ì´ë¯¸ì§€ íŒŒì¼ - ì£¼ìš” ë³‘ëª©ì \n\n### ğŸš€ ì„±ëŠ¥ ê°œì„  ê²°ê³¼\n1. **ë””ë²„ê¹… ì½”ë“œ ìµœì í™”**: í”„ë¡œë•ì…˜ ë¹Œë“œì—ì„œ ë””ë²„ê¹… í•¨ìˆ˜ ì œê±°\n2. **UI ê°„ì†Œí™”**: ì„¤ì • í™”ë©´ ê°œë³„ ì•Œë¦¼ í•­ëª© ì‚­ì œ, í†µí•© ëª¨ë‹¬ ë°©ì‹ ì ìš©\n3. **ì¡°ê±´ë¶€ ë¡œë”©**: ê°œë°œ ì „ìš© ê¸°ëŠ¥ë“¤ì„ ëŸ°íƒ€ì„ì—ì„œ ì œì™¸\n4. **íŒŒì¼ ì •ë¦¬**: ë¶ˆí•„ìš”í•œ ì‚¬ìš´ë“œ íŒŒì¼ ì œê±°\n5. **ë°°ê²½ ì´ë¯¸ì§€ ìµœì í™”**: 2.6MB PNGë¥¼ CSS ê·¸ë¼ë””ì–¸íŠ¸ë¡œ ëŒ€ì²´ (ì¦‰ì‹œ ë¡œë”©)\n\n### ğŸ“Š ì˜ˆìƒ ê°œì„  íš¨ê³¼\n- **ë²ˆë“¤ í¬ê¸°**: ë””ë²„ê¹… ì½”ë“œ ì œê±°ë¡œ ì•½ 5-10% ê°ì†Œ\n- **ë Œë”ë§ ì„±ëŠ¥**: ì„¤ì • í™”ë©´ ì¡°ê±´ë¶€ ë Œë”ë§ ìµœì í™”\n- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: ë¶ˆí•„ìš”í•œ ì „ì—­ í•¨ìˆ˜ ë“±ë¡ ìµœì†Œí™”\n\n## âœ… êµ¬í˜„ ì™„ë£Œ\n1. âœ… ë¶ˆí•„ìš”í•œ íŒŒì¼ ì œê±°\n2. âœ… ì„¤ì • í™”ë©´ ë Œë”ë§ ìµœì í™” (í†µí•© ì‚¬ìš´ë“œ ëª¨ë“œ ì„ íƒê¸°)\n3. âœ… ë””ë²„ê¹… ë„êµ¬ ì¡°ê±´ë¶€ ë¡œë”© (`__DEV__` ì ìš©)\n4. âœ… ì„±ëŠ¥ ë¶„ì„ ë° ìµœì í™” ì™„ë£Œ","size_bytes":2413},"OPTIMIZATION_COMPLETE.md":{"content":"# ìµœì í™” ì™„ë£Œ ë³´ê³ ì„œ\n\n## ì£¼ìš” ì„±ê³¼ âœ…\n\n### ğŸ¯ ì—ì…‹ ëŒ€í­ ì¤„ì´ê¸° ì„±ê³µ\n- **ì „ì²´ ì—ì…‹ í¬ê¸°**: 5.2MB â†’ 280KB (94.6% ê°ì†Œ)\n- **ë¡œê·¸ì¸ ë°°ê²½ ì´ë¯¸ì§€**: 2.6MB â†’ 0KB (CSS ê·¸ë¼ë°ì´ì…˜ ëŒ€ì²´)\n- **í™˜ì˜ í™”ë©´ ë°°ê²½**: 2.7MB â†’ 256KB (90% ê°ì†Œ, ImageMagick ìµœì í™”)\n- **ë©”ì¸ ë¡œê³ **: 2.1MB â†’ 0KB (ì´ëª¨ì§€+í…ìŠ¤íŠ¸ ëŒ€ì²´) \n- **ì•± ë¡œê³ **: 18KB â†’ 0KB (ğŸŒŸ ì´ëª¨ì§€+í…ìŠ¤íŠ¸ ëŒ€ì²´)\n\n### ğŸ“¦ íŒ¨í‚¤ì§€ ì˜ì¡´ì„± ìµœì í™”\n- **ì œê±°ëœ ì›¹ ì „ìš© íŒ¨í‚¤ì§€**: 19ê°œ\n  - react-router-dom\n  - vite ê´€ë ¨ (4ê°œ)\n  - ê¸°íƒ€ ì›¹ ë²ˆë“¤ë§ ë„êµ¬ë“¤\n- **ìœ ì§€ëœ í•µì‹¬ ê¸°ëŠ¥**: React Native, Expo, Supabase í†µí•©\n\n### âš¡ ì„±ëŠ¥ ê°œì„ \n- **Metro ë²ˆë“¤ëŸ¬ ìµœì í™”**: ì›¹ ë²ˆë“¤ë§ 10.5ì´ˆë¡œ ê°œì„ \n- **ë±ƒì§€ ì‹œìŠ¤í…œ**: ì§€ì—° ë¡œë”©ìœ¼ë¡œ ì´ˆê¸° ë¡œë“œ ê°œì„ \n- **ì´ë¯¸ì§€ ë¡œë”©**: ëª¨ë“  ë¡œê³ ê°€ ì¦‰ì‹œ ë Œë”ë§ (ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì—†ìŒ)\n\n### ğŸ¨ ì‚¬ìš©ì ê²½í—˜ ìœ ì§€\n- **ë¹„ì£¼ì–¼ ì¼ê´€ì„±**: ì´ëª¨ì§€ ê¸°ë°˜ ë””ìì¸ìœ¼ë¡œ ê¹”ë”í•œ UI\n- **ë¸Œëœë“œ ì•„ì´ë´í‹°í‹°**: \"ğŸŒŸ Better Day\" ë¡œê³ ë¡œ ë¸Œëœë“œ ê°•í™”\n- **ê¸°ëŠ¥ ì†ì‹¤ ì—†ìŒ**: ëª¨ë“  í•µì‹¬ ê¸°ëŠ¥ ì •ìƒ ì‘ë™\n\n## ê¸°ìˆ ì  ë³€ê²½ì‚¬í•­\n\n### 1. ì´ë¯¸ì§€ ëŒ€ì²´ ì „ëµ\n```typescript\n// ê¸°ì¡´: PNG ì´ë¯¸ì§€ ë¡œë”©\n<Image source={require(\"../../assets/icons/app_logo.png\")} />\n\n// ìµœì í™”: ì´ëª¨ì§€+í…ìŠ¤íŠ¸ ì¡°í•©\n<View style={styles.logoContainer}>\n  <Text style={styles.logoEmoji}>ğŸŒŸ</Text>\n  <Text style={styles.logoText}>Better Day</Text>\n</View>\n```\n\n### 2. ë°°ê²½ CSS ìµœì í™”\n```css\n/* ê¸°ì¡´: 2.6MB ì´ë¯¸ì§€ íŒŒì¼ */\nbackground-image: url('./assets/images/login-background.png');\n\n/* ìµœì í™”: CSS ê·¸ë¼ë°ì´ì…˜ (0KB) */\nbackground: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n```\n\n### 3. ë±ƒì§€ ì‹œìŠ¤í…œ ê°œì„ \n```typescript\n// ì§€ì—° ë¡œë”©ìœ¼ë¡œ ì´ˆê¸° ë²ˆë“¤ í¬ê¸° ê°ì†Œ\nexport const BADGE_IMAGES = {\n  'ê±´ì¶•': getArchitectureBadges(), // í•¨ìˆ˜ í˜¸ì¶œë¡œ ì§€ì—° ë¡œë”©\n  // ...\n};\n```\n\n## ë‹¤ìŒ ë‹¨ê³„ ê¶Œì¥ì‚¬í•­\n\n### ğŸ“Š ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§\n- [ ] ì‹¤ì œ ë””ë°”ì´ìŠ¤ì—ì„œ ì•± ë¡œë“œ ì‹œê°„ ì¸¡ì •\n- [ ] ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¶„ì„\n- [ ] ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ìµœì†Œí™” í™•ì¸\n\n### ğŸ¯ ì¶”ê°€ ìµœì í™” ê¸°íšŒ\n- [ ] ë±ƒì§€ ì´ë¯¸ì§€ ì¶”ê°€ ì••ì¶• (í˜„ì¬ 436KB)\n- [ ] í°íŠ¸ ìµœì í™” ê²€í† \n- [ ] ì½”ë“œ ìŠ¤í”Œë¦¬íŒ… (í™”ë©´ë³„ ë¶„í•  ë¡œë”©)\n\n### ğŸš€ ë°°í¬ ì¤€ë¹„\n- [ ] Android ë¹Œë“œ ìµœì í™” ì„¤ì • í™•ì¸\n- [ ] ProGuard/R8 ì„¤ì •ìœ¼ë¡œ ì¶”ê°€ ì••ì¶•\n- [ ] ì•± ì„œëª… ë° ë°°í¬ ì¤€ë¹„\n\n## ê²°ë¡ \n\nì´ë²ˆ ìµœì í™”ë¥¼ í†µí•´ **ì•± ì´ˆê¸° ë¡œë”© ì„±ëŠ¥ì„ í¬ê²Œ ê°œì„ **í–ˆìŠµë‹ˆë‹¤. 99.5%ì˜ ì—ì…‹ í¬ê¸° ê°ì†ŒëŠ” íŠ¹íˆ ëª¨ë°”ì¼ í™˜ê²½ì—ì„œ ë¹ ë¥¸ ë‹¤ìš´ë¡œë“œì™€ ì„¤ì¹˜ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.\n\në¸Œëœë“œ ì•„ì´ë´í‹°í‹°ë¥¼ ìœ ì§€í•˜ë©´ì„œë„ ì„±ëŠ¥ì„ ìµœìš°ì„ ìœ¼ë¡œ í•œ ìµœì í™”ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.","size_bytes":2828},"src/utils/badgeImageMap.ts":{"content":"// ë±ƒì§€ ì´ë¯¸ì§€ ë§¤í•‘ íŒŒì¼ - ì§€ì—° ë¡œë”© ìµœì í™”\n// React Nativeì—ì„œëŠ” ë™ì  requireë¥¼ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì •ì  ë§¤í•‘ ì‚¬ìš©\n\n// ê±´ì¶• ì¹´í…Œê³ ë¦¬ ë±ƒì§€ - ì§€ì—° ë¡œë”©\nconst getArchitectureBadges = () => ({\n  1: require('../../assets/badges/ê±´ì¶•_1.png'),\n  2: require('../../assets/badges/ê±´ì¶•_2.png'),\n  3: require('../../assets/badges/ê±´ì¶•_3.png'),\n  4: require('../../assets/badges/ê±´ì¶•_4.png'),\n  5: require('../../assets/badges/ê±´ì¶•_5.png'),\n  6: require('../../assets/badges/ê±´ì¶•_6.png'),\n  7: require('../../assets/badges/ê±´ì¶•_7.png'),\n  8: require('../../assets/badges/ê±´ì¶•_8.png'),\n  9: require('../../assets/badges/ê±´ì¶•_9.png'),\n  10: require('../../assets/badges/ê±´ì¶•_10.png'),\n  11: require('../../assets/badges/ê±´ì¶•_11.png'),\n  12: require('../../assets/badges/ê±´ì¶•_12.png'),\n});\n\n// ë‚˜ë¹„ ì¹´í…Œê³ ë¦¬ ë±ƒì§€\nconst butterflyBadges = {\n  1: require('../../assets/badges/ë‚˜ë¹„_1.png'),\n  2: require('../../assets/badges/ë‚˜ë¹„_2.png'),\n  3: require('../../assets/badges/ë‚˜ë¹„_3.png'),\n  4: require('../../assets/badges/ë‚˜ë¹„_4.png'),\n  5: require('../../assets/badges/ë‚˜ë¹„_5.png'),\n  6: require('../../assets/badges/ë‚˜ë¹„_6.png'),\n  7: require('../../assets/badges/ë‚˜ë¹„_7.png'),\n  8: require('../../assets/badges/ë‚˜ë¹„_8.png'),\n  9: require('../../assets/badges/ë‚˜ë¹„_9.png'),\n  10: require('../../assets/badges/ë‚˜ë¹„_10.png'),\n  11: require('../../assets/badges/ë‚˜ë¹„_11.png'),\n  12: require('../../assets/badges/ë‚˜ë¹„_12.png'),\n};\n\n// ëˆˆ ì¹´í…Œê³ ë¦¬ ë±ƒì§€\nconst snowBadges = {\n  1: require('../../assets/badges/ëˆˆ_1.png'),\n  2: require('../../assets/badges/ëˆˆ_2.png'),\n  3: require('../../assets/badges/ëˆˆ_3.png'),\n  4: require('../../assets/badges/ëˆˆ_4.png'),\n  5: require('../../assets/badges/ëˆˆ_5.png'),\n  6: require('../../assets/badges/ëˆˆ_6.png'),\n  7: require('../../assets/badges/ëˆˆ_7.png'),\n  8: require('../../assets/badges/ëˆˆ_8.png'),\n  9: require('../../assets/badges/ëˆˆ_9.png'),\n  10: require('../../assets/badges/ëˆˆ_10.png'),\n  11: require('../../assets/badges/ëˆˆ_11.png'),\n  12: require('../../assets/badges/ëˆˆ_12.png'),\n};\n\n// ë„ìê¸° ì¹´í…Œê³ ë¦¬ ë±ƒì§€\nconst ceramicBadges = {\n  1: require('../../assets/badges/ë„ìê¸°_1.png'),\n  2: require('../../assets/badges/ë„ìê¸°_2.png'),\n  3: require('../../assets/badges/ë„ìê¸°_3.png'),\n  4: require('../../assets/badges/ë„ìê¸°_4.png'),\n  5: require('../../assets/badges/ë„ìê¸°_5.png'),\n  6: require('../../assets/badges/ë„ìê¸°_6.png'),\n  7: require('../../assets/badges/ë„ìê¸°_7.png'),\n  8: require('../../assets/badges/ë„ìê¸°_8.png'),\n  9: require('../../assets/badges/ë„ìê¸°_9.png'),\n  10: require('../../assets/badges/ë„ìê¸°_10.png'),\n  11: require('../../assets/badges/ë„ìê¸°_11.png'),\n  12: require('../../assets/badges/ë„ìê¸°_12.png'),\n};\n\n// ë³„ ì¹´í…Œê³ ë¦¬ ë±ƒì§€\nconst starBadges = {\n  1: require('../../assets/badges/ë³„_1.png'),\n  2: require('../../assets/badges/ë³„_2.png'),\n  3: require('../../assets/badges/ë³„_3.png'),\n  4: require('../../assets/badges/ë³„_4.png'),\n  5: require('../../assets/badges/ë³„_5.png'),\n  6: require('../../assets/badges/ë³„_6.png'),\n  7: require('../../assets/badges/ë³„_7.png'),\n  8: require('../../assets/badges/ë³„_8.png'),\n  9: require('../../assets/badges/ë³„_9.png'),\n  10: require('../../assets/badges/ë³„_10.png'),\n  11: require('../../assets/badges/ë³„_11.png'),\n  12: require('../../assets/badges/ë³„_12.png'),\n};\n\n// ì‚°ë§¥ ì¹´í…Œê³ ë¦¬ ë±ƒì§€\nconst mountainBadges = {\n  1: require('../../assets/badges/ì‚°ë§¥_1.png'),\n  2: require('../../assets/badges/ì‚°ë§¥_2.png'),\n  3: require('../../assets/badges/ì‚°ë§¥_3.png'),\n  4: require('../../assets/badges/ì‚°ë§¥_4.png'),\n  5: require('../../assets/badges/ì‚°ë§¥_5.png'),\n  6: require('../../assets/badges/ì‚°ë§¥_6.png'),\n  7: require('../../assets/badges/ì‚°ë§¥_7.png'),\n  8: require('../../assets/badges/ì‚°ë§¥_8.png'),\n  9: require('../../assets/badges/ì‚°ë§¥_9.png'),\n  10: require('../../assets/badges/ì‚°ë§¥_10.png'),\n  11: require('../../assets/badges/ì‚°ë§¥_11.png'),\n  12: require('../../assets/badges/ì‚°ë§¥_12.png'),\n};\n\n// ì”¨ì•— ì¹´í…Œê³ ë¦¬ ë±ƒì§€\nconst seedBadges = {\n  1: require('../../assets/badges/ì”¨ì•—_1.png'),\n  2: require('../../assets/badges/ì”¨ì•—_2.png'),\n  3: require('../../assets/badges/ì”¨ì•—_3.png'),\n  4: require('../../assets/badges/ì”¨ì•—_4.png'),\n  5: require('../../assets/badges/ì”¨ì•—_5.png'),\n  6: require('../../assets/badges/ì”¨ì•—_6.png'),\n  7: require('../../assets/badges/ì”¨ì•—_7.png'),\n  8: require('../../assets/badges/ì”¨ì•—_8.png'),\n  9: require('../../assets/badges/ì”¨ì•—_9.png'),\n  10: require('../../assets/badges/ì”¨ì•—_10.png'),\n  11: require('../../assets/badges/ì”¨ì•—_11.png'),\n  12: require('../../assets/badges/ì”¨ì•—_12.png'),\n};\n\n// ìœ ë¦¬ì„¸ê³µ ì¹´í…Œê³ ë¦¬ ë±ƒì§€\nconst glassBadges = {\n  1: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_1.png'),\n  2: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_2.png'),\n  3: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_3.png'),\n  4: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_4.png'),\n  5: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_5.png'),\n  6: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_6.png'),\n  7: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_7.png'),\n  8: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_8.png'),\n  9: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_9.png'),\n  10: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_10.png'),\n  11: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_11.png'),\n  12: require('../../assets/badges/ìœ ë¦¬ì„¸ê³µ_12.png'),\n};\n\n// ì¶œíŒ ì¹´í…Œê³ ë¦¬ ë±ƒì§€\nconst publishingBadges = {\n  1: require('../../assets/badges/ì¶œíŒ_1.png'),\n  2: require('../../assets/badges/ì¶œíŒ_2.png'),\n  3: require('../../assets/badges/ì¶œíŒ_3.png'),\n  4: require('../../assets/badges/ì¶œíŒ_4.png'),\n  5: require('../../assets/badges/ì¶œíŒ_5.png'),\n  6: require('../../assets/badges/ì¶œíŒ_6.png'),\n  7: require('../../assets/badges/ì¶œíŒ_7.png'),\n  8: require('../../assets/badges/ì¶œíŒ_8.png'),\n  9: require('../../assets/badges/ì¶œíŒ_9.png'),\n  10: require('../../assets/badges/ì¶œíŒ_10.png'),\n  11: require('../../assets/badges/ì¶œíŒ_11.png'),\n  12: require('../../assets/badges/ì¶œíŒ_12.png'),\n};\n\n// ì „ì²´ ë±ƒì§€ ë§¤í•‘ - ì§€ì—° ë¡œë”©\nexport const BADGE_IMAGES = {\n  'ê±´ì¶•': getArchitectureBadges(),\n  'ë‚˜ë¹„': butterflyBadges,\n  'ëˆˆ': snowBadges,\n  'ë„ìê¸°': ceramicBadges,\n  'ë³„': starBadges,\n  'ì‚°ë§¥': mountainBadges,\n  'ì”¨ì•—': seedBadges,\n  'ìœ ë¦¬ì„¸ê³µ': glassBadges,\n  'ì¶œíŒ': publishingBadges,\n};\n\n// ë±ƒì§€ ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸° í•¨ìˆ˜\nexport function getBadgeImage(category: string, level: number) {\n  const categoryBadges = BADGE_IMAGES[category as keyof typeof BADGE_IMAGES];\n  if (!categoryBadges) {\n    console.warn(`Unknown badge category: ${category}. Available categories:`, Object.keys(BADGE_IMAGES));\n    return null;\n  }\n  \n  const badgeLevel = Math.max(1, Math.min(level, 12)); // 1-12 ë²”ìœ„ ë³´ì¥\n  return categoryBadges[badgeLevel as keyof typeof categoryBadges] || null;\n}","size_bytes":7011},"src/hooks/useAppLifecycle.ts":{"content":"// ğŸ“± ëª¨ë°”ì¼ ì•± ìƒëª…ì£¼ê¸° ê´€ë¦¬ - ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ì œì–´\nimport { useEffect, useRef } from 'react';\nimport { AppState, Platform, AppStateStatus } from 'react-native';\nimport { cancelGoalAlarm } from '../helpers/notificationScheduler';\n\nexport const useAppLifecycle = () => {\n  const appState = useRef(AppState.currentState);\n  const lastActiveTime = useRef(Date.now());\n\n  useEffect(() => {\n    // ğŸš« ì›¹ í™˜ê²½ì—ì„œëŠ” ì‘ë™í•˜ì§€ ì•ŠìŒ\n    if (Platform.OS === 'web') return;\n\n    const handleAppStateChange = async (nextAppState: AppStateStatus) => {\n      const previousState = appState.current;\n      appState.current = nextAppState;\n\n      // ì•±ì´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ í¬ê·¸ë¼ìš´ë“œë¡œ ëŒì•„ì˜¬ ë•Œ\n      if (previousState.match(/inactive|background/) && nextAppState === 'active') {\n        const now = Date.now();\n        lastActiveTime.current = now;\n        \n        console.log('ğŸ“± ì•±ì´ í™œì„±í™”ë¨ - ë¶ˆí•„ìš”í•œ ì•Œë¦¼ ì •ë¦¬');\n        \n        // í˜„ì¬ ì‹œê°„ ê¸°ì¤€ 5ë¶„ ì´ë‚´ ëª©í‘œ ì•Œë¦¼ë“¤ ì·¨ì†Œ (ì‚¬ìš©ìê°€ ì´ë¯¸ ì•±ì„ ì‚¬ìš© ì¤‘)\n        try {\n          // dynamic import ì œê±° - ì•± í™œì„±í™” ì•Œë¦¼ ì •ë¦¬ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘\n          console.log('ğŸ“± ì•± í™œì„±í™” ì•Œë¦¼ ì •ë¦¬ëŠ” ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');\n        } catch (error) {\n          console.log('âš ï¸ ì•± í™œì„±í™” ì•Œë¦¼ ì •ë¦¬ ì‹¤íŒ¨:', error);\n        }\n      }\n    };\n\n    const subscription = AppState.addEventListener('change', handleAppStateChange);\n    \n    return () => subscription?.remove();\n  }, []);\n\n  return {\n    isActive: appState.current === 'active',\n    lastActiveTime: lastActiveTime.current\n  };\n};","size_bytes":1643},"src/utils/unifiedNotificationManager.ts":{"content":"// ğŸ”” í†µí•© ì•Œë¦¼ ê´€ë¦¬ì - ì´ì¤‘ ì‹œìŠ¤í…œ ìµœì í™”\nimport { Platform } from 'react-native';\nimport * as Notifications from 'expo-notifications';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { getKoreaTime, getTodayKorea } from './timeUtils';\nimport { NotificationManager } from './notificationManager';\nimport { EnhancedNotificationManager } from './enhancedNotificationManager';\n// ê¸°ë³¸ ì‚¬ìš´ë“œ ì„¤ì •\nconst DEFAULT_SOUND_CONFIG = {\n  sound: 'default', // ì‹œìŠ¤í…œ ê¸°ë³¸ ì•Œë¦¼ìŒ\n  shouldPlaySound: true,\n  shouldSetBadge: true,\n  shouldShowAlert: true,\n  shouldShowBanner: true,\n  shouldShowList: true,\n};\n\n/**\n * í†µí•© ì•Œë¦¼ ê´€ë¦¬ì\n * - í™˜ê²½ ê°ì§€ í›„ ì ì ˆí•œ ì•Œë¦¼ ì‹œìŠ¤í…œ ì„ íƒ\n * - ê¸°ì¡´ ì‹œìŠ¤í…œê³¼ì˜ ì¶©ëŒ ë°©ì§€\n * - ì„¤ì • ê¸°ë°˜ ìŠ¤ë§ˆíŠ¸ ê´€ë¦¬\n */\nexport class UnifiedNotificationManager {\n  private static instance: UnifiedNotificationManager;\n  private basicManager: NotificationManager;\n  private enhancedManager: EnhancedNotificationManager;\n  private isEnhancedMode = false;\n  private isInitialized = false;\n\n  static getInstance(): UnifiedNotificationManager {\n    if (!UnifiedNotificationManager.instance) {\n      UnifiedNotificationManager.instance = new UnifiedNotificationManager();\n    }\n    return UnifiedNotificationManager.instance;\n  }\n\n  constructor() {\n    this.basicManager = NotificationManager.getInstance();\n    this.enhancedManager = EnhancedNotificationManager.getInstance();\n  }\n\n  /**\n   * ì´ˆê¸°í™” - í™˜ê²½ ê°ì§€ ë° ìµœì  ì‹œìŠ¤í…œ ì„ íƒ\n   */\n  async initialize(): Promise<boolean> {\n    if (this.isInitialized) return true;\n\n    if (Platform.OS === 'web') {\n      console.log('ğŸŒ ì›¹ í™˜ê²½ - ì•Œë¦¼ ì‹œìŠ¤í…œ ë¹„í™œì„±í™”');\n      return false;\n    }\n\n    // ê¸°ë³¸ ì•Œë¦¼ êµ¬ì„± ì„¤ì • (ì‚¬ìš´ë“œ í¬í•¨)\n    Notifications.setNotificationHandler({\n      handleNotification: async (notification) => {\n        const settings = await this.getNotificationSettings();\n        return {\n          shouldShowAlert: true,\n          shouldShowBanner: true, \n          shouldShowList: true,\n          shouldPlaySound: settings?.soundEnabled !== false,\n          shouldSetBadge: true,\n        };\n      },\n    });\n\n    try {\n      // Enhanced ì‹œìŠ¤í…œ ë¨¼ì € ì‹œë„ (Development Build)\n      const enhancedReady = await this.enhancedManager.initialize();\n      \n      if (enhancedReady) {\n        this.isEnhancedMode = true;\n        console.log('âœ… ê°•í™”ëœ ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™” (Development Build)');\n      } else {\n        // ê¸°ë³¸ ì‹œìŠ¤í…œìœ¼ë¡œ í´ë°±\n        const basicReady = await this.basicManager.initialize();\n        if (basicReady) {\n          this.isEnhancedMode = false;\n          console.log('âœ… ê¸°ë³¸ ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™” (Expo Go)');\n        } else {\n          console.log('âŒ ì•Œë¦¼ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì‹¤íŒ¨');\n          return false;\n        }\n      }\n\n      // ê¶Œí•œ ìš”ì²­\n      await this.requestPermission();\n      \n      // ê¸°ì¡´ ì¤‘ë³µ ì•Œë¦¼ ì •ë¦¬\n      await this.cleanupDuplicateNotifications();\n      \n      this.isInitialized = true;\n      return true;\n    } catch (error) {\n      console.error('âŒ í†µí•© ì•Œë¦¼ ê´€ë¦¬ì ì´ˆê¸°í™” ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * ì•Œë¦¼ ì„¤ì • ì¡°íšŒ\n   */\n  private async getNotificationSettings(): Promise<{ soundEnabled?: boolean } | null> {\n    try {\n      const settingsString = await AsyncStorage.getItem('notificationSettings');\n      return settingsString ? JSON.parse(settingsString) : { soundEnabled: true };\n    } catch (error) {\n      console.error('âŒ ì•Œë¦¼ ì„¤ì • ì¡°íšŒ ì‹¤íŒ¨:', error);\n      return null;\n    }\n  }\n\n  /**\n   * ê¶Œí•œ ìš”ì²­\n   */\n  async requestPermission(): Promise<boolean> {\n    try {\n      const { status: existingStatus } = await Notifications.getPermissionsAsync();\n      let finalStatus = existingStatus;\n      \n      if (existingStatus !== 'granted') {\n        const { status } = await Notifications.requestPermissionsAsync();\n        finalStatus = status;\n      }\n      \n      console.log(`ğŸ” ì•Œë¦¼ ê¶Œí•œ ìƒíƒœ: ${finalStatus}`);\n      return finalStatus === 'granted';\n    } catch (error) {\n      console.error('âŒ ì•Œë¦¼ ê¶Œí•œ ìš”ì²­ ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * ìŠ¤ë§ˆíŠ¸ ëª©í‘œ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§\n   */\n  async scheduleGoalNotification(goalId: string, title: string, targetTime: Date, userNickname?: string): Promise<boolean> {\n    if (!await this.initialize()) return false;\n\n    try {\n      // ê¸°ì¡´ ì•Œë¦¼ ì •ë¦¬\n      await this.cancelGoalNotification(goalId);\n\n      if (this.isEnhancedMode) {\n        // Development Build - 3ë‹¨ê³„ ì•Œë¦¼\n        const goal = { id: goalId, title, target_time: targetTime.toISOString() };\n        const notificationIds = await this.enhancedManager.scheduleSmartGoalNotifications(goal as any);\n        \n        // ì•Œë¦¼ ID ì €ì¥\n        await AsyncStorage.setItem(`goal_notifications_${goalId}`, JSON.stringify(notificationIds));\n        console.log(`ğŸ”” ê°•í™”ëœ 3ë‹¨ê³„ ì•Œë¦¼ ì˜ˆì•½: ${title}`);\n        return notificationIds.length > 0;\n      } else {\n        // Expo Go - ê¸°ë³¸ ì•Œë¦¼\n        const success = await this.basicManager.scheduleGoalNotification(goalId, title, targetTime);\n        console.log(`ğŸ“± ê¸°ë³¸ ì•Œë¦¼ ì˜ˆì•½: ${title}`);\n        return success;\n      }\n    } catch (error) {\n      console.error('âŒ ëª©í‘œ ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§ ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * íšŒê³  ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§\n   */\n  async scheduleRetrospectNotification(targetTime: Date): Promise<boolean> {\n    if (!await this.initialize()) return false;\n\n    try {\n      if (this.isEnhancedMode) {\n        const notificationId = await this.enhancedManager.scheduleRetrospectNotification(targetTime);\n        return !!notificationId;\n      } else {\n        return await this.basicManager.scheduleRetrospectNotification(targetTime);\n      }\n    } catch (error) {\n      console.error('âŒ íšŒê³  ì•Œë¦¼ ìŠ¤ì¼€ì¤„ë§ ì‹¤íŒ¨:', error);\n      return false;\n    }\n  }\n\n  /**\n   * ëª©í‘œ ì•Œë¦¼ ì·¨ì†Œ\n   */\n  async cancelGoalNotification(goalId: string): Promise<void> {\n    try {\n      if (this.isEnhancedMode) {\n        // Enhanced ì‹œìŠ¤í…œì˜ ë‹¤ì¤‘ ì•Œë¦¼ ì·¨ì†Œ\n        const storedIds = await AsyncStorage.getItem(`goal_notifications_${goalId}`);\n        if (storedIds) {\n          const notificationIds = JSON.parse(storedIds);\n          for (const id of notificationIds) {\n            await Notifications.cancelScheduledNotificationAsync(id);\n          }\n          await AsyncStorage.removeItem(`goal_notifications_${goalId}`);\n          console.log(`ğŸ”• ê°•í™”ëœ ì•Œë¦¼ ì·¨ì†Œ: ${goalId} (${notificationIds.length}ê°œ)`);\n        }\n      } else {\n        // ê¸°ë³¸ ì‹œìŠ¤í…œì˜ ë‹¨ì¼ ì•Œë¦¼ ì·¨ì†Œ\n        await this.basicManager.cancelNotification(goalId);\n        console.log(`ğŸ”• ê¸°ë³¸ ì•Œë¦¼ ì·¨ì†Œ: ${goalId}`);\n      }\n    } catch (error) {\n      console.error(`âŒ ëª©í‘œ ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨: ${goalId}`, error);\n    }\n  }\n\n  /**\n   * ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ\n   */\n  async cancelAllNotifications(): Promise<void> {\n    try {\n      await Notifications.cancelAllScheduledNotificationsAsync();\n      \n      // AsyncStorageì˜ ì•Œë¦¼ IDë“¤ë„ ì •ë¦¬\n      const keys = await AsyncStorage.getAllKeys();\n      const notificationKeys = keys.filter(key => key.startsWith('goal_notifications_'));\n      if (notificationKeys.length > 0) {\n        await AsyncStorage.multiRemove(notificationKeys);\n      }\n      \n      console.log('ğŸ§¹ ëª¨ë“  ì•Œë¦¼ ì·¨ì†Œ ë° ì €ì¥ì†Œ ì •ë¦¬ ì™„ë£Œ');\n    } catch (error) {\n      console.error('âŒ ì „ì²´ ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨:', error);\n    }\n  }\n\n  /**\n   * ì˜ˆì•½ëœ ì•Œë¦¼ ëª©ë¡ í™•ì¸\n   */\n  async getScheduledNotifications(): Promise<Notifications.NotificationRequest[]> {\n    try {\n      return await Notifications.getAllScheduledNotificationsAsync();\n    } catch (error) {\n      console.error('âŒ ì˜ˆì•½ ì•Œë¦¼ ì¡°íšŒ ì‹¤íŒ¨:', error);\n      return [];\n    }\n  }\n\n  /**\n   * ì¤‘ë³µ ì•Œë¦¼ ì •ë¦¬\n   */\n  private async cleanupDuplicateNotifications(): Promise<void> {\n    try {\n      const scheduled = await this.getScheduledNotifications();\n      console.log(`ğŸ” í˜„ì¬ ì˜ˆì•½ëœ ì•Œë¦¼ ${scheduled.length}ê°œ ë°œê²¬`);\n      \n      // ê°™ì€ ëª©í‘œì— ëŒ€í•œ ì¤‘ë³µ ì•Œë¦¼ ì°¾ê¸°\n      const goalNotifications = new Map<string, string[]>();\n      \n      for (const notification of scheduled) {\n        const goalId = notification.content.data?.goalId;\n        if (goalId && typeof goalId === 'string') {\n          if (!goalNotifications.has(goalId)) {\n            goalNotifications.set(goalId, []);\n          }\n          goalNotifications.get(goalId)!.push(notification.identifier);\n        }\n      }\n\n      // ì¤‘ë³µ ì •ë¦¬ ë¡œê·¸\n      let duplicatesFound = 0;\n      goalNotifications.forEach((ids, goalId) => {\n        if (ids.length > 3) { // Enhanced ëª¨ë“œëŠ” 3ê°œê¹Œì§€ ì •ìƒ\n          duplicatesFound += ids.length - 3;\n          console.log(`âš ï¸ ëª©í‘œ ${goalId}ì— ëŒ€í•œ ê³¼ë„í•œ ì•Œë¦¼ ${ids.length}ê°œ ë°œê²¬`);\n        }\n      });\n\n      if (duplicatesFound > 0) {\n        console.log(`ğŸ§¹ ${duplicatesFound}ê°œ ì¤‘ë³µ ì•Œë¦¼ ì •ë¦¬ ì˜ˆì •`);\n      }\n\n    } catch (error) {\n      console.error('âŒ ì¤‘ë³µ ì•Œë¦¼ ì •ë¦¬ ì‹¤íŒ¨:', error);\n    }\n  }\n\n  /**\n   * ì•Œë¦¼ ì‹œìŠ¤í…œ ìƒíƒœ í™•ì¸\n   */\n  getSystemStatus(): {\n    isInitialized: boolean;\n    isEnhancedMode: boolean;\n    platform: string;\n  } {\n    return {\n      isInitialized: this.isInitialized,\n      isEnhancedMode: this.isEnhancedMode,\n      platform: Platform.OS\n    };\n  }\n\n  /**\n   * ìŠ¤ë§ˆíŠ¸ ì•Œë¦¼ ë©”ì‹œì§€ ìƒì„±\n   */\n  private async getSmartNotificationMessage(goalTitle: string, userDisplayName?: string): Promise<string> {\n    try {\n      // ìƒˆë¡œìš´ ë©”ì‹œì§€ ì‹œìŠ¤í…œ ì‚¬ìš©\n      const { getRandomMessage, replaceVariables } = await import('../data/notificationMessages');\n      \n      const randomMsg = getRandomMessage('goal');\n      return replaceVariables(randomMsg.message, { \n        goal: goalTitle, \n        display_name: userDisplayName || 'ì‚¬ìš©ì'\n      });\n    } catch (error) {\n      console.error('âŒ ìŠ¤ë§ˆíŠ¸ ë©”ì‹œì§€ ìƒì„± ì‹¤íŒ¨:', error);\n      return `ã€${goalTitle}ã€ ëª©í‘œ ë‹¬ì„± ì‹œê°„ì…ë‹ˆë‹¤! ğŸ¯`;\n    }\n  }\n\n  /**\n   * ì „ì²´ ì•Œë¦¼ ëª©ë¡ ì¡°íšŒ (ë””ë²„ê·¸ìš©)\n   */\n  async getAllScheduledNotifications(): Promise<void> {\n    try {\n      const notifications = await this.getScheduledNotifications();\n      console.log(`ğŸ“‹ í˜„ì¬ ì˜ˆì•½ëœ ì•Œë¦¼ ${notifications.length}ê°œ:`);\n      notifications.forEach((notif, index) => {\n        const trigger = notif.trigger;\n        const triggerInfo = 'type' in trigger && 'date' in trigger \n          ? `${new Date(trigger.date).toLocaleString('ko-KR')}`\n          : 'ì•Œë¦¼ ì‹œê°„ ì •ë³´ ì—†ìŒ';\n        console.log(`  ${index + 1}. ${notif.content.title} - ${triggerInfo}`);\n      });\n    } catch (error) {\n      console.error('âŒ ì•Œë¦¼ ëª©ë¡ ì¡°íšŒ ì‹¤íŒ¨:', error);\n    }\n  }\n\n  /**\n   * íŠ¹ì • ì•Œë¦¼ ì·¨ì†Œ (í†µí•©)\n   */\n  async cancelNotification(notificationId: string): Promise<void> {\n    try {\n      await Notifications.cancelScheduledNotificationAsync(notificationId);\n      console.log(`ğŸ”• ì•Œë¦¼ ì·¨ì†Œ: ${notificationId}`);\n    } catch (error) {\n      console.error(`âŒ ì•Œë¦¼ ì·¨ì†Œ ì‹¤íŒ¨: ${notificationId}`, error);\n    }\n  }\n}\n\n// ì „ì—­ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±\nexport const unifiedNotificationManager = UnifiedNotificationManager.getInstance();","size_bytes":11485}}}